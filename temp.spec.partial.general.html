<!DOCTYPE html><html lang='en'><head><title>[temp.spec.partial.general]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>13</a> Templates <a class='abbr_ref' href='./#temp'>[temp]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>13.7</a> Template declarations <a class='abbr_ref' href='temp.decls#temp.spec.partial.general'>[temp.decls]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>13.7.6</a> Partial specialization <a class='abbr_ref' href='temp.spec.partial#general'>[temp.spec.partial]</a></h3><h4 ><a class='secnum' style='min-width:95pt'>13.7.6.1</a> General <a class='abbr_ref'>[temp.spec.partial.general]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3124'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'><a class='index' id=':specialization,class_template_partial'></a>A partial specialization of a template provides an alternative definition
of the template that is used instead of the primary definition when the
arguments in a specialization match those given in the partial
specialization (<a href='temp.spec.partial.match' title='13.7.6.2&emsp;Matching of partial specializations'>[temp.<span class='shy'></span>spec.<span class='shy'></span>partial.<span class='shy'></span>match]</a>)<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>A declaration of the primary template shall precede
any partial specialization of
that template<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>A partial specialization shall be reachable from any use of a template
specialization that would make use of the partial specialization as the result of
an implicit or explicit instantiation; no diagnostic is required<a class='hidden_link' href='#1.sentence-3'>.</a></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3137'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>Two partial specialization declarations declare the same entity
if they are partial specializations of the same template and have equivalent
<a href='temp.pre#nt:template-head' title='13.1&emsp;Preamble&emsp;[temp.pre]'><span id='ntref:template-head'><span class='textsf'><i >template-head</i></span></span></a><i >s</i> and template argument lists (<a href='temp.over.link' title='13.7.7.2&emsp;Function template overloading'>[temp.<span class='shy'></span>over.<span class='shy'></span>link]</a>)<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>Each partial specialization is a distinct template<a class='hidden_link' href='#2.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3143'>#</a></div><div class='texpara'><div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>: <span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T1, <span class='keyword'>class</span> T2, <span class='keyword'>int</span> I<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> A             <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, <span class='keyword'>int</span> I<span class='anglebracket'>&gt;</span>            <span class='keyword'>class</span> A<span class='anglebracket'>&lt;</span>T, T<span class='operator'>*</span>, I<span class='anglebracket'>&gt;</span>   <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T1, <span class='keyword'>class</span> T2, <span class='keyword'>int</span> I<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> A<span class='anglebracket'>&lt;</span>T1<span class='operator'>*</span>, T2, I<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>                   <span class='keyword'>class</span> A<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>, T<span class='operator'>*</span>, <span class='literal'>5</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T1, <span class='keyword'>class</span> T2, <span class='keyword'>int</span> I<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> A<span class='anglebracket'>&lt;</span>T1, T2<span class='operator'>*</span>, I<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
</span></div><div class='texpara'><div id='3.sentence-1' class='sentence'>The first declaration declares the primary (unspecialized) class template<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>The second and subsequent declarations declare partial specializations of
the primary template<a class='hidden_link' href='#3.sentence-2'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3158'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'>A partial specialization may be constrained (<a href='temp.constr' title='13.5&emsp;Template constraints'>[temp.<span class='shy'></span>constr]</a>)<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>: <span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C <span class='operator'>=</span> <span class='literal'>true</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> X <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> X<span class='anglebracket'>&lt;</span>T<span class='operator'>*</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;          <span class='comment'>// #1</span>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span>C T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> X<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;                  <span class='comment'>// #2</span>
</span> <div id='4.sentence-2' class='sentence'>
Both partial specializations are more specialized than the primary template<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>#1 is more specialized because the deduction of its template arguments
from the template argument list of the class template specialization succeeds,
while the reverse does not<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'>#2 is more specialized because the template arguments are equivalent,
but the partial specialization is more constrained (<a href='temp.constr.order' title='13.5.5&emsp;Partial ordering by constraints'>[temp.<span class='shy'></span>constr.<span class='shy'></span>order]</a>)<a class='hidden_link' href='#4.sentence-4'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3176'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>The template argument list of a partial specialization is
the <a href='temp.names#nt:template-argument-list' title='13.3&emsp;Names of template specializations&emsp;[temp.names]'><span id='ntref:template-argument-list'><span class='textsf'><i >template-argument-list</i></span></span></a> following the name of the template<a class='hidden_link' href='#5.sentence-1'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3180'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>A partial specialization may be declared in any
scope in which the corresponding primary template
may be defined (<a href='dcl.meaning' title='9.3.4&emsp;Meaning of declarators'>[dcl.<span class='shy'></span>meaning]</a>, <a href='class.mem' title='11.4&emsp;Class members'>[class.<span class='shy'></span>mem]</a>, <a href='temp.mem' title='13.7.3&emsp;Member templates'>[temp.<span class='shy'></span>mem]</a>)<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>: <span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>struct</span> C <span class='curlybracket'>{</span>
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T2<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> B <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T2<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> B<span class='anglebracket'>&lt;</span>T2<span class='operator'>*</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;      <span class='comment'>// partial specialization #1</span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;

<span class='comment'>// partial specialization of <span class='tcode_in_codeblock'>A&lt;T&gt;&#x200b;::&#x200b;C&#x200b;::&#x200b;B&lt;T2&gt;</span></span>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T2<span class='anglebracket'>&gt;</span>
  <span class='keyword'>struct</span> A<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>::</span>C<span class='operator'>::</span>B<span class='anglebracket'>&lt;</span>T2<span class='operator'>*</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;                   <span class='comment'>// #2</span>

A<span class='anglebracket'>&lt;</span><span class='keyword'>short</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>C<span class='operator'>::</span>B<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span> absip;                     <span class='comment'>// uses partial specialization #2</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3201'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'>Partial specialization declarations do not introduce a name<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>Instead, when the primary template name is used, any reachable partial
specializations of the primary template are also considered<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>: <div id='7.sentence-3' class='sentence'>One consequence is
that a <a href='namespace.udecl#nt:using-declaration' title='9.9&emsp;The using declaration&emsp;[namespace.udecl]'><span id='ntref:using-declaration'><span class='textsf'><i >using-declaration</i></span></span></a>
which refers to a class template does not restrict the set of partial specializations
that are found through the <a href='namespace.udecl#nt:using-declaration' title='9.9&emsp;The using declaration&emsp;[namespace.udecl]'><span id='ntref:using-declaration_'><span class='textsf'><i >using-declaration</i></span></span></a><a class='hidden_link' href='#7.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-4'>4</a></i>: <span class='codeblock'><span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T1, <span class='keyword'>class</span> T2<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> A <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;     <span class='comment'>// primary template</span>
<span class='curlybracket'>}</span>

<span class='keyword'>using</span> N<span class='operator'>::</span>A;                                     <span class='comment'>// refers to the primary template</span>

<span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> A<span class='anglebracket'>&lt;</span>T, T<span class='operator'>*</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;         <span class='comment'>// partial specialization</span>
<span class='curlybracket'>}</span>

A<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>,<span class='keyword'>int</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span> a;      <span class='comment'>// uses the partial specialization, which is found through the using-declaration</span>
                    <span class='comment'>// which refers to the primary template</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3228'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'>A non-type argument is non-specialized if it is the name of a non-type
parameter<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>All other non-type arguments are specialized<a class='hidden_link' href='#8.sentence-2'>.</a></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3233'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'>Within the argument list of a partial specialization,
the following restrictions apply:
<ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.1'>(9.1)</a></div><div class='texpara'><div id='9.1.sentence-1' class='sentence'>The type of a template parameter corresponding to a specialized non-type argument
shall not be dependent on a parameter of the partial specialization<a class='hidden_link' href='#9.1.sentence-1'>.</a></div> <div id='example-5' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-5'>5</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, T t<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> C <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> C<span class='anglebracket'>&lt;</span>T, <span class='literal'>1</span><span class='anglebracket'>&gt;</span>;              <span class='comment'>// error</span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span> <span class='keyword'>int</span> X, <span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span>array_ptr<span class='parenthesis'>)</span><span class='squarebracket'>[</span>X<span class='squarebracket'>]</span> <span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> A <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
<span class='keyword'>int</span> array<span class='squarebracket'>[</span><span class='literal'>5</span><span class='squarebracket'>]</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span> <span class='keyword'>int</span> X <span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> A<span class='anglebracket'>&lt;</span>X,<span class='operator'>&amp;</span>array<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;        <span class='comment'>// error</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='9.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.2'>(9.2)</a></div><div class='texpara'><div id='9.2.sentence-1' class='sentence'>The partial specialization shall be more specialized than the primary
template (<a href='temp.spec.partial.order' title='13.7.6.3&emsp;Partial ordering of partial specializations'>[temp.<span class='shy'></span>spec.<span class='shy'></span>partial.<span class='shy'></span>order]</a>)<a class='hidden_link' href='#9.2.sentence-1'>.</a></div></div></li><li id='9.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.3'>(9.3)</a></div><div class='texpara'><div id='9.3.sentence-1' class='sentence'>The template parameter list of a partial specialization shall not contain default
template argument values<a class='hidden_link' href='#9.3.sentence-1'>.</a><a class='footnoteref' href='#footnote-125' id='footnoteref-125' title='There is no context in which they would be used.'>125</a></div></div></li><li id='9.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.4'>(9.4)</a></div><div class='texpara'><div id='9.4.sentence-1' class='sentence'>An argument shall not contain an unexpanded pack<a class='hidden_link' href='#9.4.sentence-1'>.</a></div> <div id='9.4.sentence-2' class='sentence'>If
an argument is a pack expansion (<a href='temp.variadic' title='13.7.4&emsp;Variadic templates'>[temp.<span class='shy'></span>variadic]</a>), it shall be
the last argument in the template argument list<a class='hidden_link' href='#9.4.sentence-2'>.</a></div></div></li></ul></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/04e0ea7074c9b0d0ca939821ce0f575c589df6b7/source/templates.tex#L3266'>#</a></div><div class='texpara'><div id='10.sentence-1' class='sentence'>The usual access checking rules do not apply to non-dependent names
used to specify template arguments of the <a href='temp.names#nt:simple-template-id' title='13.3&emsp;Names of template specializations&emsp;[temp.names]'><span id='ntref:simple-template-id'><span class='textsf'><i >simple-template-id</i></span></span></a>
of the partial specialization<a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>: <div id='10.sentence-2' class='sentence'>The template arguments can be private types or
objects that would normally not be accessible<a class='hidden_link' href='#10.sentence-2'>.</a></div> <div id='10.sentence-3' class='sentence'>Dependent names cannot be checked when declaring the partial specialization,
but will be checked when substituting into the partial specialization<a class='hidden_link' href='#10.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-125'><div class='texpara'><a class='footnotenum' href='#footnote-125'>125)</a><a class='footnoteBacklink' href='#footnoteref-125'>125)</a> <div id='footnote-125.sentence-1' class='sentence'>There is no context in which they would be used<a class='hidden_link' href='#footnote-125.sentence-1'>.</a></div></div></div></div></body></html>