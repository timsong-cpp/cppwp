<!DOCTYPE html><html lang='en'><head><title>[class.union.anon]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>11</a> Classes <a class='abbr_ref' href='./#class'>[class]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>11.5</a> Unions <a class='abbr_ref' href='class.union#anon'>[class.union]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>11.5.2</a> Anonymous unions <a class='abbr_ref'>[class.union.anon]</a></h3><div class='texpara'><a class='index' id=':union,anonymous'></a></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9243ba5befaea8fd3e878e6114942db8d556a6e0/source/classes.tex#L3193'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>A union of the form
<div class='simplebnf'>
<span id=':union'><span class='texttt'><span class='keyword'>union</span></span></span> <span class='terminal'><span class='curlybracket'>{</span></span> <a href='class.mem.general#nt:member-specification' title='11.4.1&emsp;General&emsp;[class.mem.general]'><span id='ntref:member-specification'><span class='textsf'><i >member-specification</i></span></span></a> <span class='terminal'><span class='curlybracket'>}</span></span> <span class='terminal'>;</span>
</div>
is called an <a class='hidden_link' href='#def:anonymous_union' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:anonymous_union'><i >anonymous union</i></span></a>; it defines an unnamed type and
an unnamed object of that type called
an <a class='hidden_link' href='#def:member,anonymous_union' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:member,anonymous_union'><i >anonymous union member</i></span></a>
if it is a non-static data member or
an <a class='hidden_link' href='#def:variable,anonymous_union' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:variable,anonymous_union'><i >anonymous union variable</i></span></a> otherwise<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'><a class='index' id=':access_control,anonymous_union'></a><a class='index' id=':restriction,anonymous_union'></a>Each <a href='class.mem.general#nt:member-declaration' title='11.4.1&emsp;General&emsp;[class.mem.general]'><span id='ntref:member-declaration'><span class='textsf'><i >member-declaration</i></span></span></a> in the <a href='class.mem.general#nt:member-specification' title='11.4.1&emsp;General&emsp;[class.mem.general]'><span id='ntref:member-specification_'><span class='textsf'><i >member-specification</i></span></span></a>
of an anonymous union shall either define one or more public non-static data members or
be a <a href='dcl.pre#nt:static_assert-declaration' title='9.1&emsp;Preamble&emsp;[dcl.pre]'><span id='ntref:static_assert-declaration'><span class='textsf'><i >static_assert-declaration</i></span></span></a><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>Nested types, anonymous unions, and functions
shall not be declared within an anonymous union<a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'>The names of the members of an anonymous union
are bound in the scope inhabited by the union declaration<a class='hidden_link' href='#1.sentence-4'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>union</span> <span class='curlybracket'>{</span> <span class='keyword'>int</span> a; <span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span>;
  a <span class='operator'>=</span> <span class='literal'>1</span>;
  p <span class='operator'>=</span> <span class='literal'>"Jennifer"</span>;
<span class='curlybracket'>}</span>
</span></div><div class='texpara'><div id='1.sentence-5' class='sentence'>Here <span class='texttt'>a</span> and <span class='texttt'>p</span> are used like ordinary (non-member)
variables, but since they are union members they have the same address<a class='hidden_link' href='#1.sentence-5'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9243ba5befaea8fd3e878e6114942db8d556a6e0/source/classes.tex#L3227'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'><a class='index' id=':union,global_anonymous'></a><a class='index' id=':scope,anonymous_union_at_namespace'></a>An anonymous union declared in the scope of a namespace with external linkage
shall use the <a href='dcl.stc#nt:storage-class-specifier' title='9.2.2&emsp;Storage class specifiers&emsp;[dcl.stc]'><span id='ntref:storage-class-specifier'><span class='textsf'><i >storage-class-specifier</i></span></span></a> <span id=':static'><span class='texttt'><span class='keyword'>static</span></span></span><a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>Anonymous unions declared at block scope shall not use a <a href='dcl.stc#nt:storage-class-specifier' title='9.2.2&emsp;Storage class specifiers&emsp;[dcl.stc]'><span id='ntref:storage-class-specifier_'><span class='textsf'><i >storage-class-specifier</i></span></span></a>
that is not permitted in the declaration of a block variable<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>An anonymous union declaration at class scope shall not have
a <a href='dcl.stc#nt:storage-class-specifier' title='9.2.2&emsp;Storage class specifiers&emsp;[dcl.stc]'><span id='ntref:storage-class-specifier__'><span class='textsf'><i >storage-class-specifier</i></span></span></a><a class='hidden_link' href='#2.sentence-3'>.</a></div></div></div><div class='para nonNormativeOnly' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9243ba5befaea8fd3e878e6114942db8d556a6e0/source/classes.tex#L3237'>#</a></div><div class='texpara'><div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='3.sentence-1' class='sentence'>A union for which objects, pointers, or references are declared is not an anonymous union<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>union</span> <span class='curlybracket'>{</span> <span class='keyword'>int</span> aa; <span class='keyword'>char</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span> obj, <span class='operator'>*</span>ptr <span class='operator'>=</span> <span class='operator'>&amp;</span>obj;
  aa <span class='operator'>=</span> <span class='literal'>1</span>;           <span class='comment'>// error</span>
  ptr<span class='operator'>-</span><span class='anglebracket'>&gt;</span>aa <span class='operator'>=</span> <span class='literal'>1</span>;      <span class='comment'>// OK</span>
<span class='curlybracket'>}</span>
</span></div><div class='texpara'><div id='3.sentence-2' class='sentence'>The assignment to plain <span class='texttt'>aa</span> is ill-formed since the member name
is not visible outside the union, and even if it were visible, it is not
associated with any particular object<a class='hidden_link' href='#3.sentence-2'>.</a></div> —&nbsp;<i>end example</i>]</div></div> —&nbsp;<i>end note</i>]</div></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='3.sentence-3' class='sentence'>Initialization of unions with no user-declared constructors is described
in <a href='dcl.init.aggr' title='9.4.2&emsp;Aggregates'>[dcl.<span class='shy'></span>init.<span class='shy'></span>aggr]</a><a class='hidden_link' href='#3.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9243ba5befaea8fd3e878e6114942db8d556a6e0/source/classes.tex#L3259'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'><a class='index' id=':class,variant_member_of'></a>A <a class='hidden_link' href='#def:class,union-like' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:class,union-like'><i >union-like class</i></span></a> is a union or a class that has an anonymous union as a direct
member<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>A union-like class <span class='texttt'>X</span> has a set of <a class='hidden_link' href='#def:variant_member' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:variant_member'><i >variant members</i></span></a><a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>If <span class='texttt'>X</span> is a union, a non-static data member of <span class='texttt'>X</span> that is not an anonymous
union is a variant member of <span class='texttt'>X</span><a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'>In addition, a non-static data member of an
anonymous union that is a member of <span class='texttt'>X</span> is also a variant member of <span class='texttt'>X</span><a class='hidden_link' href='#4.sentence-4'>.</a></div> <div id='4.sentence-5' class='sentence'>At most one variant member of a union may have a default member initializer<a class='hidden_link' href='#4.sentence-5'>.</a></div> <div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>union</span> U <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>0</span>;
  <span class='keyword'>union</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> k;
  <span class='curlybracket'>}</span>;
  <span class='keyword'>union</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> z;
    <span class='keyword'>int</span> y <span class='operator'>=</span> <span class='literal'>1</span>;      <span class='comment'>// error: initialization for second variant member of <span class='tcode_in_codeblock'>U</span></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;
</span> —&nbsp;<i>end example</i>]</div></div></div></div></div></body></html>