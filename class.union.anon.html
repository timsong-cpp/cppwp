<!DOCTYPE html><html lang='en'><head><title>[class.union.anon]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>11</a> Classes <a class='abbr_ref' href='./#class'>[class]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>11.5</a> Unions <a class='abbr_ref' href='class.union#anon'>[class.union]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>11.5.1</a> Anonymous unions <a class='abbr_ref'>[class.union.anon]</a></h3><span class='indexparent'><a class='index' id=':union,anonymous'></a></span><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b79babd1f932cf4db11eb9e05713c015ce4855c7/source/classes.tex#L3272'>#</a></div><div id='1.sentence-1' class='sentence'>A union of the form
<pre class='ncsimplebnf'><span class='texttt'><span class='keyword'>union</span></span><span class='indexparent'><a class='index' id=':union'></a></span> <span class='terminal'><span class='curlybracket'>{</span></span> <a class='grammarterm' href='class.mem#nt:member-specification'>member-specification</a> <span class='terminal'><span class='curlybracket'>}</span></span> <span class='terminal'>;</span>
</pre>
is called an <a class='hidden_link' href='#def:anonymous_union' id='def:anonymous_union'><i >anonymous union</i></a>; it defines an unnamed type and
an unnamed object of that type called an <a class='hidden_link' href='#def:anonymous_union_object' id='def:anonymous_union_object'><i >anonymous union object</i></a><a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>Each <a class='grammarterm' href='class.mem#nt:member-declaration'>member-declaration</a> in the <a class='grammarterm' href='class.mem#nt:member-specification'>member-specification</a>
of an anonymous union shall either define a non-static data member or be a
<a class='grammarterm' href='dcl.pre#nt:static_assert-declaration'>static_assert-declaration</a><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>Nested types, anonymous unions, and functions
shall not be declared within an anonymous union<a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'>The names of the members of an anonymous union shall be distinct from
the names of any other entity in the scope in which the anonymous union
is declared<a class='hidden_link' href='#1.sentence-4'>.</a></div> <div id='1.sentence-5' class='sentence'>For the purpose of name lookup, after the anonymous union
definition, the members of the anonymous union are considered to have
been defined in the scope in which the anonymous union is declared<a class='hidden_link' href='#1.sentence-5'>.</a></div> <span class='indexparent'><a class='index' id=':initialization,union'></a></span><div id='1.example-1' class='example'>[&nbsp;<a class='example_link' href='#1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>union</span> <span class='curlybracket'>{</span> <span class='keyword'>int</span> a; <span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span>;
  a <span class='operator'>=</span> <span class='literal'>1</span>;
  p <span class='operator'>=</span> <span class='literal'>"Jennifer"</span>;
<span class='curlybracket'>}</span>
</pre><div id='1.sentence-6' class='sentence'>Here <span class='texttt'>a</span> and <span class='texttt'>p</span> are used like ordinary (non-member)
variables, but since they are union members they have the same address<a class='hidden_link' href='#1.sentence-6'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b79babd1f932cf4db11eb9e05713c015ce4855c7/source/classes.tex#L3303'>#</a></div><div id='2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':union,global_anonymous'></a></span><span class='indexparent'><a class='index' id=':scope,anonymous_union_at_namespace'></a></span>Anonymous unions declared in a named namespace or in the global
namespace shall be declared <span class='texttt'><span class='keyword'>static</span></span><a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>Anonymous unions declared at
block scope shall be declared with any storage class allowed for a
block-scope variable, or with no storage class<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>A storage class is not
allowed in a declaration of an anonymous union in a class scope<a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':access_control,anonymous_union'></a></span><span class='indexparent'><a class='index' id=':restriction,anonymous_union'></a></span>An anonymous union shall not have private or protected
members (<a href='class.access'>[class.access]</a>)<a class='hidden_link' href='#2.sentence-4'>.</a></div> <div id='2.sentence-5' class='sentence'>An anonymous union shall not have
member functions<a class='hidden_link' href='#2.sentence-5'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b79babd1f932cf4db11eb9e05713c015ce4855c7/source/classes.tex#L3317'>#</a></div><div id='3.sentence-1' class='sentence'>A union for which objects, pointers, or references are declared is not an anonymous union<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.example-1' class='example'>[&nbsp;<a class='example_link' href='#3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>union</span> <span class='curlybracket'>{</span> <span class='keyword'>int</span> aa; <span class='keyword'>char</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span> obj, <span class='operator'>*</span>ptr <span class='operator'>=</span> <span class='operator'>&amp;</span>obj;
  aa <span class='operator'>=</span> <span class='literal'>1</span>;           <span class='comment'>// error</span>
  ptr<span class='operator'>-</span><span class='anglebracket'>&gt;</span>aa <span class='operator'>=</span> <span class='literal'>1</span>;      <span class='comment'>// OK</span>
<span class='curlybracket'>}</span>
</pre><div id='3.sentence-2' class='sentence'>The assignment to plain <span class='texttt'>aa</span> is ill-formed since the member name
is not visible outside the union, and even if it were visible, it is not
associated with any particular object<a class='hidden_link' href='#3.sentence-2'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='3.note-1' class='note'>[&nbsp;<a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-3' class='sentence'>Initialization of unions with no user-declared constructors is described
in <a href='dcl.init.aggr'>[dcl.init.aggr]</a><a class='hidden_link' href='#3.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b79babd1f932cf4db11eb9e05713c015ce4855c7/source/classes.tex#L3337'>#</a></div><div id='4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':class,union-like'></a></span><span class='indexparent'><a class='index' id=':class,variant_member_of'></a></span>A <a class='hidden_link' href='#def:union-like_class' id='def:union-like_class'><i >union-like class</i></a> is a union or a class that has an anonymous union as a direct
member<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>A union-like class <span class='texttt'>X</span> has a set of <a class='hidden_link' href='#def:variant_member' id='def:variant_member'><i >variant members</i></a><a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>If <span class='texttt'>X</span> is a union, a non-static data member of <span class='texttt'>X</span> that is not an anonymous
union is a variant member of <span class='texttt'>X</span><a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'>In addition, a non-static data member of an
anonymous union that is a member of <span class='texttt'>X</span> is also a variant member of <span class='texttt'>X</span><a class='hidden_link' href='#4.sentence-4'>.</a></div> <div id='4.sentence-5' class='sentence'>At most one variant member of a union may have a default member initializer<a class='hidden_link' href='#4.sentence-5'>.</a></div> <div id='4.example-1' class='example'>[&nbsp;<a class='example_link' href='#4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>union</span> U <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>0</span>;
  <span class='keyword'>union</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> k;
  <span class='curlybracket'>}</span>;
  <span class='keyword'>union</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> z;
    <span class='keyword'>int</span> y <span class='operator'>=</span> <span class='literal'>1</span>;      <span class='comment'>// error: initialization for second variant member of <span class='tcode_in_codeblock'>U</span></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div></body></html>