<!DOCTYPE html><html lang='en'><head><title>[class.union.anon]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>9</a> Classes <a class='abbr_ref' href='./#class'>[class]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>9.3</a> Unions <a class='abbr_ref' href='class.union#anon'>[class.union]</a></h2><div id='class.union.anon'><h3 ><a class='secnum' style='min-width:103pt'>9.3.1</a> Anonymous unions <a class='abbr_ref'>[class.union.anon]</a></h3><p ><span class='indexparent'><a class='index' id='union,anonymous'></a></span>
</p><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><p >A union of the form</p><pre class='bnf'><span class='terminal'>union</span> <span class='terminal'>{</span> <i ><a href='class.mem#nt:member-specification'>member-specification</a></i> <span class='terminal'>}</span> <span class='terminal'>;</span></pre><p >is called an <a class='hidden_link' href='#def:anonymous_union' id='def:anonymous_union'><i>anonymous union</i></a>; it defines an unnamed object of unnamed
type. Each <i ><a href='class.mem#nt:member-declaration'>member-declaration</a></i> in the <i ><a href='class.mem#nt:member-specification'>member-specification</a></i>
of an anonymous union shall either define a non-static data member or be a
<i ><a href='dcl.dcl#nt:static_assert-declaration'>static_assert-declaration</a></i>.
[&nbsp;<i>Note:</i>
Nested types, anonymous unions, and functions cannot be declared within an anonymous
union.
<i>&nbsp;—&nbsp;end note</i>&nbsp;]
The names of the members of an anonymous union shall be distinct from
the names of any other entity in the scope in which the anonymous union
is declared. For the purpose of name lookup, after the anonymous union
definition, the members of the anonymous union are considered to have
been defined in the scope in which the anonymous union is declared.
<span class='indexparent'><a class='index' id='initialization,union'></a></span>[&nbsp;<i>Example:</i></p><pre class='codeblock'>
void f() {
  union { int a; const char* p; };
  a = 1;
  p = "Jennifer";
}
</pre><p >Here <span class='texttt'>a</span> and <span class='texttt'>p</span> are used like ordinary (nonmember)
variables, but since they are union members they have the same address.
<i>&nbsp;—&nbsp;end example</i>&nbsp;]</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><p ><span class='indexparent'><a class='index' id='union,global_anonymous'></a></span><span class='indexparent'><a class='index' id='scope,anonymous_union_at_namespace'></a></span>Anonymous unions declared in a named namespace or in the global
namespace shall be declared <span class='texttt'>static</span>. Anonymous unions declared at
block scope shall be declared with any storage class allowed for a
block-scope variable, or with no storage class. A storage class is not
allowed in a declaration of an anonymous union in a class scope.
<span class='indexparent'><a class='index' id='access_control,anonymous_union'></a></span><span class='indexparent'><a class='index' id='restriction,anonymous_union'></a></span>An anonymous union shall not have <span class='texttt'>private</span> or <span class='texttt'>protected</span>
members (Clause <a href='class.access'>[class.access]</a>). An anonymous union shall not have
member functions.</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><p >A union for which objects, pointers, or references are declared is not an anonymous union.
[&nbsp;<i>Example:</i></p><pre class='codeblock'>
void f() {
  union { int aa; char* p; } obj, *ptr = &amp;obj;
  aa = 1;                         <span class='comment'>// error
</span>  ptr-&gt;aa = 1;                    <span class='comment'>// OK
</span>}
</pre><p >The assignment to plain <span class='texttt'>aa</span> is ill-formed since the member name
is not visible outside the union, and even if it were visible, it is not
associated with any particular object.
<i>&nbsp;—&nbsp;end example</i>&nbsp;]
[&nbsp;<i>Note:</i>
Initialization of unions with no user-declared constructors is described
in (<a href='dcl.init.aggr'>[dcl.init.aggr]</a>).
<i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><p ><span class='indexparent'><a class='index' id='class,union-like'></a></span><span class='indexparent'><a class='index' id='class,variant_member_of'></a></span>A <a class='hidden_link' href='#def:union-like_class' id='def:union-like_class'><i>union-like class</i></a> is a union or a class that has an anonymous union as a direct
member. A union-like class <span class='texttt'>X</span> has a set of <a class='hidden_link' href='#def:variant_member' id='def:variant_member'><i>variant member</i></a>s.
If <span class='texttt'>X</span> is a union, a non-static data member of <span class='texttt'>X</span> that is not an anonymous
union is a variant member of <span class='texttt'>X</span>. In addition, a non-static data member of an
anonymous union that is a member of <span class='texttt'>X</span> is also a variant member of <span class='texttt'>X</span>.
At most one variant member of a union may have a default member initializer.
[&nbsp;<i>Example:</i></p><pre class='codeblock'>
union U {
  int x = 0;
  union {
    int k;
  };
  union {
    int z;
    int y = 1; <span class='comment'>// error: initialization for second variant member of <span class='texttt'>U</span>
</span>  };
};
</pre><p ><i>&nbsp;—&nbsp;end example</i>&nbsp;]</p></div></div></div></body></html>