<!DOCTYPE html><html lang='en'><head><title>[diff.cpp17.depr]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='annexnum' style='min-width:73pt'>Annex C&emsp;(informative)</a> Compatibility <a class='abbr_ref' href='./#diff'>[diff]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>C.5</a> C++ and ISO C++ 2017 <a class='abbr_ref' href='diff.cpp17#depr'>[diff.cpp17]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>C.5.12</a> <a href='depr'>[depr]</a>: compatibility features <a class='abbr_ref'>[diff.cpp17.depr]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aadf7684f1e6c2fe1fa15ffa0cf2ee45b5e56cd7/source/compatibility.tex#L2117'>#</a></div><div id='1.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>uncaught_&shy;exception</span><a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The function did not have a clear specification when multiple exceptions were
active, and has been superseded by <span class='texttt'>uncaught_&shy;exceptions</span><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>uncaught_&shy;exception</span> may fail
to compile<a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'>It might be revised to use <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>uncaught_&shy;exceptions</span> instead,
for clear and portable semantics<a class='hidden_link' href='#1.sentence-4'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aadf7684f1e6c2fe1fa15ffa0cf2ee45b5e56cd7/source/compatibility.tex#L2127'>#</a></div><div id='2.sentence-1' class='sentence'><b>Change:</b> Remove support for adaptable function API<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The deprecated support relied on a limited convention that could not be
extended to support the general case or new language features<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>It has been
superseded by direct language support with <span class='texttt'><span class='keyword'>decltype</span></span>, and by the
<span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>bind</span> and <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>not_&shy;fn</span> function templates<a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.sentence-4' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that relies on the presence of <span class='texttt'>result_&shy;type</span>,
<span class='texttt'>argument_&shy;type</span>, <span class='texttt'>first_&shy;argument_&shy;type</span>, or
<span class='texttt'>second_&shy;argument_&shy;type</span> in a standard library class may fail to compile<a class='hidden_link' href='#2.sentence-4'>.</a></div> <div id='2.sentence-5' class='sentence'>A
valid C++ 2017 program that calls <span class='texttt'>not1</span> or <span class='texttt'>not2</span>, or uses the
class templates <span class='texttt'>unary_&shy;negate</span> or <span class='texttt'>binary_&shy;negate</span>, may fail to
compile<a class='hidden_link' href='#2.sentence-5'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aadf7684f1e6c2fe1fa15ffa0cf2ee45b5e56cd7/source/compatibility.tex#L2142'>#</a></div><div id='3.sentence-1' class='sentence'><b>Change:</b> Remove redundant members from <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>allocator</span><a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'><br/><b>Rationale:</b> 
<span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>allocator</span> was overspecified, encouraging direct usage in user containers
rather than relying on <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>allocator_&shy;traits</span>, leading to poor containers<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that directly makes use of the <span class='texttt'>pointer</span>,
<span class='texttt'>const_&shy;pointer</span>, <span class='texttt'>reference</span>, <span class='texttt'>const_&shy;reference</span>,
<span class='texttt'>rebind</span>, <span class='texttt'>address</span>, <span class='texttt'>construct</span>, <span class='texttt'>destroy</span>, or
<span class='texttt'>max_&shy;size</span> members of <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>allocator</span>, or that directly calls
<span class='texttt'>allocate</span> with an additional hint argument, may fail to compile<a class='hidden_link' href='#3.sentence-3'>.</a></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aadf7684f1e6c2fe1fa15ffa0cf2ee45b5e56cd7/source/compatibility.tex#L2154'>#</a></div><div id='4.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>raw_&shy;storage_&shy;iterator</span><a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The iterator encouraged use of algorithms that might throw exceptions, but did
not return the number of elements successfully constructed that might need to
be destroyed in order to avoid leaks<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that uses this iterator class may fail to compile<a class='hidden_link' href='#4.sentence-3'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aadf7684f1e6c2fe1fa15ffa0cf2ee45b5e56cd7/source/compatibility.tex#L2163'>#</a></div><div id='5.sentence-1' class='sentence'><b>Change:</b> Remove temporary buffers API<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The temporary buffer facility was intended to provide an efficient optimization
for small memory requests, but there is little evidence this was achieved in
practice, while requiring the user to provide their own exception-safe wrappers
to guard use of the facility in many cases<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>get_&shy;temporary_&shy;buffer</span> or
<span class='texttt'>return_&shy;temporary_&shy;buffer</span> may fail to compile<a class='hidden_link' href='#5.sentence-3'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aadf7684f1e6c2fe1fa15ffa0cf2ee45b5e56cd7/source/compatibility.tex#L2174'>#</a></div><div id='6.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>shared_&shy;ptr<span class='operator'>:</span><span class='operator'>:</span>unique</span><a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The result of a call to this member function is not reliable in the presence of
multiple threads and weak pointers<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.sentence-3' class='sentence'>The member function <span class='texttt'>use_&shy;count</span> is
similarly unreliable, but has a clearer contract in such cases, and remains
available for well defined use in single-threaded cases<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='6.sentence-4' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>unique</span> on a <span class='texttt'>shared_&shy;ptr</span>
object may fail to compile<a class='hidden_link' href='#6.sentence-4'>.</a></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aadf7684f1e6c2fe1fa15ffa0cf2ee45b5e56cd7/source/compatibility.tex#L2184'>#</a></div><div id='7.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='depr.meta.types'>[depr.meta.types]</a>
<br/><b>Change:</b> Remove deprecated type traits<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The traits had unreliable or awkward interfaces<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>The <span class='texttt'>is_&shy;literal_&shy;type</span>
trait provided no way to detect which subset of constructors and member
functions of a type were declared <span class='texttt'><span class='keyword'>constexpr</span></span><a class='hidden_link' href='#7.sentence-3'>.</a></div> <div id='7.sentence-4' class='sentence'>The <span class='texttt'>result_&shy;of</span>
trait had a surprising syntax that could not report the result of a regular
function type<a class='hidden_link' href='#7.sentence-4'>.</a></div> <div id='7.sentence-5' class='sentence'>It has been superseded by the <span class='texttt'>invoke_&shy;result</span> trait<a class='hidden_link' href='#7.sentence-5'>.</a></div> <div id='7.sentence-6' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that relies on the <span class='texttt'>is_&shy;literal_&shy;type</span> or
<span class='texttt'>result_&shy;of</span> type traits, on the <span class='texttt'>is_&shy;literal_&shy;type_&shy;v</span> variable template,
or on the <span class='texttt'>result_&shy;of_&shy;t</span> alias template may fail to compile<a class='hidden_link' href='#7.sentence-6'>.</a></div></div></div></body></html>