<!DOCTYPE html><html lang='en'><head><title>[iterator.primitives]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>27</a> Iterators library <a class='abbr_ref' href='./#iterators'>[iterators]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>27.4</a> Iterator primitives <a class='abbr_ref'>[iterator.primitives]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L863'>#</a></div><div id='1.sentence-1' class='sentence'>To simplify the task of defining iterators, the library provides
several classes and functions:</div></div><div id='iterator.traits' class='section'><h3 ><a class='secnum' href='#iterator.traits' style='min-width:103pt'>27.4.1</a> Iterator traits <a class='abbr_ref' href='iterator.traits'>[iterator.traits]</a></h3><div class='para' id='iterator.traits-1'><div class='marginalizedparent'><a class='marginalized' href='#iterator.traits-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L869'>#</a></div><div id='iterator.traits-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:iterator_traits'></a></span>To implement algorithms only in terms of iterators, it is often necessary to
determine the value and
difference types that correspond to a particular iterator type<a class='hidden_link' href='#iterator.traits-1.sentence-1'>.</a></div> <div id='iterator.traits-1.sentence-2' class='sentence'>Accordingly, it is required that if
<span class='texttt'>Iterator</span>
is the type of an iterator,
the types</div><div id='iterator.traits-1.sentence-3' class='sentence'><pre class='codeblock'>
iterator_traits&lt;Iterator&gt;::difference_type
iterator_traits&lt;Iterator&gt;::value_type
iterator_traits&lt;Iterator&gt;::iterator_category</pre></div> <div id='iterator.traits-1.sentence-4' class='sentence'>be defined as the iterator's difference type, value type and iterator category, respectively<a class='hidden_link' href='#iterator.traits-1.sentence-4'>.</a></div> <div id='iterator.traits-1.sentence-5' class='sentence'>In addition, the types

<pre class='codeblock'>
iterator_traits&lt;Iterator&gt;::reference
iterator_traits&lt;Iterator&gt;::pointer</pre>shall be defined as the iterator's reference and pointer types, that is, for an
iterator object <span class='texttt'>a</span>, the same type as the type of <span class='texttt'>*a</span> and <span class='texttt'>a-&gt;</span>,
respectively<a class='hidden_link' href='#iterator.traits-1.sentence-5'>.</a></div> <div id='iterator.traits-1.sentence-6' class='sentence'>In the case of an output iterator, the types</div><div id='iterator.traits-1.sentence-7' class='sentence'><pre class='codeblock'>
iterator_traits&lt;Iterator&gt;::difference_type
iterator_traits&lt;Iterator&gt;::value_type
iterator_traits&lt;Iterator&gt;::reference
iterator_traits&lt;Iterator&gt;::pointer</pre></div> <div id='iterator.traits-1.sentence-8' class='sentence'>may be defined as <span class='texttt'>void</span><a class='hidden_link' href='#iterator.traits-1.sentence-8'>.</a></div></div><div class='para' id='iterator.traits-2'><div class='marginalizedparent'><a class='marginalized' href='#iterator.traits-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L906'>#</a></div><div id='iterator.traits-2.sentence-1' class='sentence'>If <span class='texttt'>Iterator</span> has valid (<a href='temp.deduct'>[temp.deduct]</a>) member
types <span class='texttt'>difference_&shy;type</span>, <span class='texttt'>value_&shy;type</span>, <span class='texttt'>pointer</span>,
<span class='texttt'>reference</span>, and <span class='texttt'>iterator_&shy;category</span>,
<span class='texttt'>iterator_&shy;traits&lt;Iterator&gt;</span>
shall have the following as publicly accessible members:
<pre class='codeblock'>
  using difference_type   = typename Iterator::difference_type;
  using value_type        = typename Iterator::value_type;
  using pointer           = typename Iterator::pointer;
  using reference         = typename Iterator::reference;
  using iterator_category = typename Iterator::iterator_category;</pre>
Otherwise, <span class='texttt'>iterator_&shy;traits&lt;Iterator&gt;</span>
shall have no members by any of the above names<a class='hidden_link' href='#iterator.traits-2.sentence-1'>.</a></div></div><div class='para' id='iterator.traits-3'><div class='marginalizedparent'><a class='marginalized' href='#iterator.traits-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L922'>#</a></div><div id='iterator.traits-3.sentence-1' class='sentence'>It is specialized for pointers as</div><div id='iterator.traits-3.sentence-2' class='sentence'><pre class='codeblock'>
namespace std {
  template&lt;class T&gt; struct iterator_traits&lt;T*&gt; {
    using difference_type   = ptrdiff_t;
    using value_type        = T;
    using pointer           = T*;
    using reference         = T&amp;;
    using iterator_category = random_access_iterator_tag;
  };
}</pre></div> <div id='iterator.traits-3.sentence-3' class='sentence'>and for pointers to const as

<pre class='codeblock'>
namespace std {
  template&lt;class T&gt; struct iterator_traits&lt;const T*&gt; {
    using difference_type   = ptrdiff_t;
    using value_type        = T;
    using pointer           = const T*;
    using reference         = const T&amp;;
    using iterator_category = random_access_iterator_tag;
  };
}</pre></div></div><div class='para' id='iterator.traits-4'><div class='marginalizedparent'><a class='marginalized' href='#iterator.traits-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L951'>#</a></div><div id='iterator.traits-4.sentence-1' class='sentence'><div id='iterator.traits-4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#iterator.traits-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='iterator.traits-4.sentence-2' class='sentence'>To implement a generic
<span class='texttt'>reverse</span>
function, a C++ program can do the following:</div><div id='iterator.traits-4.sentence-3' class='sentence'><pre class='codeblock'>
template &lt;class BidirectionalIterator&gt;
void reverse(BidirectionalIterator first, BidirectionalIterator last) {
  typename iterator_traits&lt;BidirectionalIterator&gt;::difference_type n =
    distance(first, last);
  --n;
  while(n &gt; 0) {
    typename iterator_traits&lt;BidirectionalIterator&gt;::value_type
     tmp = *first;
    *first++ = *--last;
    *last = tmp;
    n -= 2;
  }
}</pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div><div id='std.iterator.tags' class='section'><h3 ><a class='secnum' href='#std.iterator.tags' style='min-width:103pt'>27.4.2</a> Standard iterator tags <a class='abbr_ref' href='std.iterator.tags'>[std.iterator.tags]</a></h3><div class='para' id='std.iterator.tags-1'><div class='marginalizedparent'><a class='marginalized' href='#std.iterator.tags-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L976'>#</a></div><div id='std.iterator.tags-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:input_iterator_tag'></a></span><span class='indexparent'><a class='index' id='lib:output_iterator_tag'></a></span><span class='indexparent'><a class='index' id='lib:forward_iterator_tag'></a></span><span class='indexparent'><a class='index' id='lib:bidirectional_iterator_tag'></a></span><span class='indexparent'><a class='index' id='lib:random_access_iterator_tag'></a></span>It is often desirable for a
function template specialization
to find out what is the most specific category of its iterator
argument, so that the function can select the most efficient algorithm at compile time<a class='hidden_link' href='#std.iterator.tags-1.sentence-1'>.</a></div> <div id='std.iterator.tags-1.sentence-2' class='sentence'>To facilitate this, the
library introduces
<span class='textit'>category tag</span>
classes which are used as compile time tags for algorithm selection<a class='hidden_link' href='#std.iterator.tags-1.sentence-2'>.</a></div> <div id='std.iterator.tags-1.sentence-3' class='sentence'>They are:
<span class='texttt'>input_&shy;iterator_&shy;tag</span>,
<span class='texttt'>output_&shy;iterator_&shy;tag</span>,
<span class='texttt'>forward_&shy;iterator_&shy;tag</span>,
<span class='texttt'>bidirectional_&shy;iterator_&shy;tag</span>
and
<span class='texttt'>random_&shy;access_&shy;iterator_&shy;tag</span><a class='hidden_link' href='#std.iterator.tags-1.sentence-3'>.</a></div> <div id='std.iterator.tags-1.sentence-4' class='sentence'>For every iterator of type
<span class='texttt'>Iterator</span>,
<span class='texttt'>iterator_&shy;traits&lt;Iterator&gt;&#x200b;::&#x200b;iterator_&shy;category</span>
shall be defined to be the most specific category tag that describes the
iterator's behavior<a class='hidden_link' href='#std.iterator.tags-1.sentence-4'>.</a></div><div id='std.iterator.tags-1.sentence-5' class='sentence'><pre class='codeblock'>
namespace std {
  struct input_iterator_tag { };
  struct output_iterator_tag { };
  struct forward_iterator_tag: public input_iterator_tag { };
  struct bidirectional_iterator_tag: public forward_iterator_tag { };
  struct random_access_iterator_tag: public bidirectional_iterator_tag { };
}</pre></div></div><div class='para' id='std.iterator.tags-2'><div class='marginalizedparent'><a class='marginalized' href='#std.iterator.tags-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1013'>#</a></div><div id='std.iterator.tags-2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:empty'></a></span><span class='indexparent'><a class='index' id='lib:input_iterator_tag_'></a></span><span class='indexparent'><a class='index' id='lib:output_iterator_tag_'></a></span><span class='indexparent'><a class='index' id='lib:forward_iterator_tag_'></a></span><span class='indexparent'><a class='index' id='lib:bidirectional_iterator_tag_'></a></span><span class='indexparent'><a class='index' id='lib:random_access_iterator_tag_'></a></span><div id='std.iterator.tags-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#std.iterator.tags-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='std.iterator.tags-2.sentence-2' class='sentence'>For a program-defined iterator
<span class='texttt'>BinaryTreeIterator</span>,
it could be included
into the bidirectional iterator category by specializing the
<span class='texttt'>iterator_&shy;traits</span>
template:</div><div id='std.iterator.tags-2.sentence-3' class='sentence'><pre class='codeblock'>
template&lt;class T&gt; struct iterator_traits&lt;BinaryTreeIterator&lt;T&gt;&gt; {
  using iterator_category = bidirectional_iterator_tag;
  using difference_type   = ptrdiff_t;
  using value_type        = T;
  using pointer           = T*;
  using reference         = T&amp;;
};</pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='std.iterator.tags-3'><div class='marginalizedparent'><a class='marginalized' href='#std.iterator.tags-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1039'>#</a></div><div id='std.iterator.tags-3.sentence-1' class='sentence'><div id='std.iterator.tags-3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#std.iterator.tags-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='std.iterator.tags-3.sentence-2' class='sentence'>If
<span class='texttt'>evolve()</span>
is well defined for bidirectional iterators, but can be implemented more
efficiently for random access iterators, then the implementation is as follows:</div><div id='std.iterator.tags-3.sentence-3' class='sentence'><pre class='codeblock'>
template &lt;class BidirectionalIterator&gt;
inline void
evolve(BidirectionalIterator first, BidirectionalIterator last) {
  evolve(first, last,
    typename iterator_traits&lt;BidirectionalIterator&gt;::iterator_category());
}

template &lt;class BidirectionalIterator&gt;
void evolve(BidirectionalIterator first, BidirectionalIterator last,
  bidirectional_iterator_tag) {
  <span class='comment'>// more generic, but less efficient algorithm
</span>}

template &lt;class RandomAccessIterator&gt;
void evolve(RandomAccessIterator first, RandomAccessIterator last,
  random_access_iterator_tag) {
  <span class='comment'>// more efficient, but less generic algorithm
</span>}</pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div><div id='iterator.operations' class='section'><h3 ><a class='secnum' href='#iterator.operations' style='min-width:103pt'>27.4.3</a> Iterator operations <a class='abbr_ref' href='iterator.operations'>[iterator.operations]</a></h3><div class='para' id='iterator.operations-1'><div class='marginalizedparent'><a class='marginalized' href='#iterator.operations-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1070'>#</a></div><div id='iterator.operations-1.sentence-1' class='sentence'>Since only random access iterators provide
<span class='texttt'>+</span>
and
<span class='texttt'>-</span>
operators, the library provides two
function templates
<span class='texttt'>advance</span>
and
<span class='texttt'>distance</span><a class='hidden_link' href='#iterator.operations-1.sentence-1'>.</a></div> <div id='iterator.operations-1.sentence-2' class='sentence'>These
function templates
use
<span class='texttt'>+</span>
and
<span class='texttt'>-</span>
for random access iterators (and are, therefore, constant
time for them); for input, forward and bidirectional iterators they use
<span class='texttt'>++</span>
to provide linear time
implementations<a class='hidden_link' href='#iterator.operations-1.sentence-2'>.</a></div> <div id='iterator.operations-1.sentence-3' class='sentence'><span class='indexparent'><a class='index' id='lib:advance'></a></span></div></div><div id='iterator.operations-sentence-1' class='sentence'><code class='itemdecl'>template &lt;class InputIterator, class Distance&gt;
  constexpr void advance(InputIterator&amp; i, Distance n);
</code></div><div class='itemdescr'></div><div class='para' id='iterator.operations-2'><div class='marginalizedparent'><a class='marginalized' href='#iterator.operations-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1099'>#</a></div><div id='iterator.operations-2.sentence-1' class='sentence'><span class='textit'>Requires:</span> 
<span class='texttt'>n</span>
shall be negative only for bidirectional and random access iterators<a class='hidden_link' href='#iterator.operations-2.sentence-1'>.</a></div></div></div><div class='para' id='iterator.operations-3'><div class='marginalizedparent'><a class='marginalized' href='#iterator.operations-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1104'>#</a></div><div id='iterator.operations-3.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
Increments (or decrements for negative
<span class='texttt'>n</span>)
iterator reference
<span class='texttt'>i</span>
by
<span class='texttt'>n</span><a class='hidden_link' href='#iterator.operations-3.sentence-1'>.</a></div></div></div><div id='iterator.operations-sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:distance'></a></span></div><div id='iterator.operations-sentence-1' class='sentence'><code class='itemdecl'>template &lt;class InputIterator&gt;
  constexpr typename iterator_traits&lt;InputIterator&gt;::difference_type
    distance(InputIterator first, InputIterator last);
</code></div><div class='itemdescr'></div><div class='para' id='iterator.operations-4'><div class='marginalizedparent'><a class='marginalized' href='#iterator.operations-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1122'>#</a></div><div id='iterator.operations-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
If <span class='texttt'>InputIterator</span> meets the requirements of random access iterator,
returns <span class='texttt'>(last - first)</span>; otherwise, returns
the number of increments needed to get from
<span class='texttt'>first</span>
to
<span class='texttt'>last</span><a class='hidden_link' href='#iterator.operations-4.sentence-1'>.</a></div></div></div><div class='para' id='iterator.operations-5'><div class='marginalizedparent'><a class='marginalized' href='#iterator.operations-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1131'>#</a></div><div id='iterator.operations-5.sentence-1' class='sentence'><span class='textit'>Requires:</span> 
If <span class='texttt'>InputIterator</span> meets the requirements of random access iterator,
<span class='texttt'>last</span> shall be reachable from <span class='texttt'>first</span> or <span class='texttt'>first</span> shall be
reachable from <span class='texttt'>last</span>; otherwise,
<span class='texttt'>last</span>
shall be reachable from
<span class='texttt'>first</span><a class='hidden_link' href='#iterator.operations-5.sentence-1'>.</a></div></div></div><div id='iterator.operations-sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:next'></a></span></div><div id='iterator.operations-sentence-1' class='sentence'><code class='itemdecl'>template &lt;class InputIterator&gt;
  constexpr InputIterator next(InputIterator x,
    typename iterator_traits&lt;InputIterator&gt;::difference_type n = 1);
</code></div><div class='itemdescr'></div><div class='para' id='iterator.operations-6'><div class='marginalizedparent'><a class='marginalized' href='#iterator.operations-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1149'>#</a></div><div id='iterator.operations-6.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to: <span class='texttt'>advance(x, n); return x;</span></div></div></div><div id='iterator.operations-sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:prev'></a></span></div><div id='iterator.operations-sentence-1' class='sentence'><code class='itemdecl'>template &lt;class BidirectionalIterator&gt;
  constexpr BidirectionalIterator prev(BidirectionalIterator x,
    typename iterator_traits&lt;BidirectionalIterator&gt;::difference_type n = 1);
</code></div><div class='itemdescr'></div><div class='para' id='iterator.operations-7'><div class='marginalizedparent'><a class='marginalized' href='#iterator.operations-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/iterators.tex#L1161'>#</a></div><div id='iterator.operations-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to: <span class='texttt'>advance(x, -n); return x;</span></div></div></div></div></div></body></html>