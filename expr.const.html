<!DOCTYPE html><html lang='en'><head><title>[expr.const]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>7</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>7.7</a> Constant expressions <a class='abbr_ref'>[expr.const]</a></h2><div class='texpara'><a class='index' id=':expression,constant'></a></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7727'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>Certain contexts require expressions that satisfy additional
requirements as detailed in this subclause; other contexts have different
semantics depending on whether or not an expression satisfies these requirements<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>Expressions that satisfy these requirements,
assuming that <a href='class.copy.elision' title='11.9.6&emsp;Copy/move elision&emsp;[class.copy.elision]'>copy elision</a> is not performed,
are called
<a class='index' id='def:expression,constant'></a><a class='hidden_link' href='#def:constant_expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:constant_expression'><i >constant expressions</i></span></a><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='1.sentence-3' class='sentence'>Constant expressions can be evaluated
during translation<a class='hidden_link' href='#1.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><div class='bnf' id='nt:constant-expression'>
<a class='hidden_link' href='#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='nt:constant-expression'><span id=':constant-expression'>constant-expression<span class='textnormal'>:</span></span></span></a><br><a href='expr.cond#nt:conditional-expression' title='7.6.16&emsp;Conditional operator&emsp;[expr.cond]'><span id='ntref:conditional-expression'><span class='textsf'><i >conditional-expression</i></span></span></a>
</div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7746'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:constituent_value' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:constituent_value'><i >constituent values</i></span></a> of an object <span class='math'><span class='mathalpha'>o</span></span> are
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.1'>(2.1)</a></div>if <span class='math'><span class='mathalpha'>o</span></span> has scalar type, the value of <span class='math'><span class='mathalpha'>o</span></span>;</li><li id='2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.2'>(2.2)</a></div>otherwise, the constituent values of any direct subobjects of <span class='math'><span class='mathalpha'>o</span></span>
other than inactive union members<a class='hidden_link' href='#2.sentence-1'>.</a></li></ul></div> <div id='2.sentence-2' class='sentence'>
The <a class='hidden_link' href='#def:constituent_reference' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:constituent_reference'><i >constituent references</i></span></a> of an object <span class='math'><span class='mathalpha'>o</span></span> are
<ul class='itemize'><li id='2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.3'>(2.3)</a></div>any direct members of <span class='math'><span class='mathalpha'>o</span></span> that have reference type, and</li><li id='2.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.4'>(2.4)</a></div>the constituent references of any direct subobjects of <span class='math'><span class='mathalpha'>o</span></span>
other than inactive union members<a class='hidden_link' href='#2.sentence-2'>.</a></li></ul></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7764'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>The constituent values and constituent references of
a variable <span class='texttt'>x</span> are defined as follows:
<ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#3.1'>(3.1)</a></div><div class='texpara'><div id='3.1.sentence-1' class='sentence'>If <span class='texttt'>x</span> declares an object,
the constituent values and references of that object are
constituent values and references of <span class='texttt'>x</span><a class='hidden_link' href='#3.1.sentence-1'>.</a></div></div></li><li id='3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#3.2'>(3.2)</a></div><div class='texpara'><div id='3.2.sentence-1' class='sentence'>If <span class='texttt'>x</span> declares a reference,
that reference is a constituent reference of <span class='texttt'>x</span><a class='hidden_link' href='#3.2.sentence-1'>.</a></div></div></li></ul></div> <div id='3.sentence-2' class='sentence'>
For any constituent reference <span class='texttt'>r</span> of a variable <span class='texttt'>x</span>,
if <span class='texttt'>r</span> is bound to a temporary object or subobject thereof
whose lifetime is extended to that of <span class='texttt'>r</span>,
the constituent values and references of that temporary object
are also constituent values and references of <span class='texttt'>x</span>, recursively<a class='hidden_link' href='#3.sentence-2'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7782'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'>An object <span class='math'><span class='mathalpha'>o</span></span> is <a class='hidden_link' href='#def:constexpr-referenceable' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:constexpr-referenceable'><i >constexpr-referenceable</i></span></a> from a point <span class='math'><span class='mathalpha'>P</span></span> if
<ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#4.1'>(4.1)</a></div><span class='math'><span class='mathalpha'>o</span></span> has static storage duration, or</li><li id='4.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#4.2'>(4.2)</a></div><span class='math'><span class='mathalpha'>o</span></span> has automatic storage duration, and, letting <span class='texttt'>v</span> denote
<ul class='itemize'><li id='4.2.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#4.2.1'>(4.2.1)</a></div>the variable corresponding to <span class='math'><span class='mathalpha'>o</span></span>'s complete object or</li><li id='4.2.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#4.2.2'>(4.2.2)</a></div>the variable to whose lifetime that of <span class='math'><span class='mathalpha'>o</span></span> is extended,</li></ul>
the smallest scope enclosing <span class='texttt'>v</span> and the smallest scope enclosing <span class='math'><span class='mathalpha'>P</span></span>
that are neither
<ul class='itemize'><li id='4.2.3'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#4.2.3'>(4.2.3)</a></div>block scopes nor</li><li id='4.2.4'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#4.2.4'>(4.2.4)</a></div>function parameter scopes associated with
a <a href='expr.prim.req.general#nt:requirement-parameter-list' title='7.5.8.1&emsp;General&emsp;[expr.prim.req.general]'><span id='ntref:requirement-parameter-list'><span class='textsf'><i >requirement-parameter-list</i></span></span></a></li></ul>
are the same function parameter scope.</li></ul>
<div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> m;
  <span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> r;
<span class='curlybracket'>}</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>static</span> <span class='keyword'>int</span> sx;
  <span class='keyword'>thread_local</span> <span class='keyword'>int</span> tx;                  <span class='comment'>// <span class='tcode_in_codeblock'>tx</span> is never constexpr-referenceable</span>
  <span class='keyword'>int</span> ax;
  A aa <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='literal'>1</span>, <span class='literal'>2</span><span class='curlybracket'>}</span>;
  <span class='keyword'>static</span> A sa <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='literal'>3</span>, <span class='literal'>4</span><span class='curlybracket'>}</span>;
  <span class='comment'>// The objects <span class='tcode_in_codeblock'>sx</span>, <span class='tcode_in_codeblock'>ax</span>, and <span class='tcode_in_codeblock'>aa.m</span>, <span class='tcode_in_codeblock'>sa.m</span>, and the temporaries to which <span class='tcode_in_codeblock'>aa.r</span> and <span class='tcode_in_codeblock'>sa.r</span> are bound, are constexpr-referenceable.</span>
  <span class='keyword'>auto</span> lambda <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> ay;
    <span class='comment'>// The objects <span class='tcode_in_codeblock'>sx</span>, <span class='tcode_in_codeblock'>sa.m</span>, and <span class='tcode_in_codeblock'>ay</span> (but not <span class='tcode_in_codeblock'>ax</span> or <span class='tcode_in_codeblock'>aa</span>), and the</span>
    <span class='comment'>// temporary to which <span class='tcode_in_codeblock'>sa.r</span> is bound, are constexpr-referenceable.</span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7828'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>An object or reference <span class='texttt'>x</span> is
<a class='hidden_link' href='#def:constexpr-representable' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:constexpr-representable'><i >constexpr-representable</i></span></a> at a point <span class='math'><span class='mathalpha'>P</span></span> if,
for each constituent value of <span class='texttt'>x</span> that points to or past an object <span class='math'><span class='mathalpha'>o</span></span>,
and for each constituent reference of <span class='texttt'>x</span> that refers to an object <span class='math'><span class='mathalpha'>o</span></span>,
<span class='math'><span class='mathalpha'>o</span></span> is constexpr-referenceable from <span class='math'><span class='mathalpha'>P</span></span><a class='hidden_link' href='#5.sentence-1'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7835'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'><a class='index' id=':contract_evaluation_semantics,ignore'></a>
A variable <span class='texttt'>v</span> is <a class='hidden_link' href='#def:constant-initializable' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:constant-initializable'><i >constant-initializable</i></span></a> if
<ul class='itemize'><li id='6.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.1'>(6.1)</a></div>the full-expression of its initialization is a constant expression
when interpreted as a <a href='#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='ntref:constant-expression'><span class='textsf'><i >constant-expression</i></span></span></a>
with all contract assertions
using the ignore evaluation semantic (<a href='basic.contract.eval' title='6.10.2&emsp;Evaluation'>[basic.<span class='shy'></span>contract.<span class='shy'></span>eval]</a>),
<div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='6.1.sentence-1' class='sentence'>Within this evaluation,
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>is_<span class='shy'></span>constant_<span class='shy'></span>evaluated<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> (<a href='meta.const.eval' title='21.3.11&emsp;Constant evaluation context'>[meta.<span class='shy'></span>const.<span class='shy'></span>eval]</a>)
returns <span id=':true'><span class='texttt'><span class='literal'>true</span></span></span><a class='hidden_link' href='#6.1.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div>
<div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>:&ensp;<div id='6.1.sentence-2' class='sentence'>The initialization, when evaluated,
can still evaluate contract assertions
with other evaluation semantics,
resulting in a diagnostic or ill-formed program
if a contract violation occurs<a class='hidden_link' href='#6.1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></li><li id='6.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.2'>(6.2)</a></div>immediately after the initializing declaration of <span class='texttt'>v</span>,
the object or reference <span class='texttt'>x</span> declared by <span class='texttt'>v</span>
is constexpr-representable, and</li><li id='6.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.3'>(6.3)</a></div>if <span class='texttt'>x</span> has static or thread storage duration,
<span class='texttt'>x</span> is constexpr-representable at the nearest point
whose immediate scope is a namespace scope
that follows the initializing declaration of <span class='texttt'>v</span><a class='hidden_link' href='#6.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7867'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'>A constant-initializable variable is <a class='hidden_link' href='#def:constant-initialized' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:constant-initialized'><i >constant-initialized</i></span></a>
if either it has an initializer or
its type is const-default-constructible (<a href='dcl.init.general' title='9.5.1&emsp;General'>[dcl.<span class='shy'></span>init.<span class='shy'></span>general]</a>)<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> ax <span class='operator'>=</span> <span class='literal'>0</span>;                   <span class='comment'>// <span class='tcode_in_codeblock'>ax</span> is constant-initialized</span>
  <span class='keyword'>thread_local</span> <span class='keyword'>int</span> tx <span class='operator'>=</span> <span class='literal'>0</span>;      <span class='comment'>// <span class='tcode_in_codeblock'>tx</span> is constant-initialized</span>
  <span class='keyword'>static</span> <span class='keyword'>int</span> sx;                <span class='comment'>// <span class='tcode_in_codeblock'>sx</span> is not constant-initialized</span>
  <span class='keyword'>static</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> rss <span class='operator'>=</span> sx;         <span class='comment'>// <span class='tcode_in_codeblock'>rss</span> is constant-initialized</span>
  <span class='keyword'>static</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> rst <span class='operator'>=</span> tx;         <span class='comment'>// <span class='tcode_in_codeblock'>rst</span> is not constant-initialized</span>
  <span class='keyword'>static</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> rsa <span class='operator'>=</span> ax;         <span class='comment'>// <span class='tcode_in_codeblock'>rsa</span> is not constant-initialized</span>
  <span class='keyword'>thread_local</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> rts <span class='operator'>=</span> sx;   <span class='comment'>// <span class='tcode_in_codeblock'>rts</span> is constant-initialized</span>
  <span class='keyword'>thread_local</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> rtt <span class='operator'>=</span> tx;   <span class='comment'>// <span class='tcode_in_codeblock'>rtt</span> is not constant-initialized</span>
  <span class='keyword'>thread_local</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> rta <span class='operator'>=</span> ax;   <span class='comment'>// <span class='tcode_in_codeblock'>rta</span> is not constant-initialized</span>
  <span class='keyword'>int</span><span class='operator'>&amp;</span> ras <span class='operator'>=</span> sx;                <span class='comment'>// <span class='tcode_in_codeblock'>ras</span> is constant-initialized</span>
  <span class='keyword'>int</span><span class='operator'>&amp;</span> rat <span class='operator'>=</span> tx;                <span class='comment'>// <span class='tcode_in_codeblock'>rat</span> is not constant-initialized</span>
  <span class='keyword'>int</span><span class='operator'>&amp;</span> raa <span class='operator'>=</span> ax;                <span class='comment'>// <span class='tcode_in_codeblock'>raa</span> is constant-initialized</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7890'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'>A variable is <a class='hidden_link' href='#def:potentially-constant' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:potentially-constant'><i >potentially-constant</i></span></a> if
it is constexpr or
it has reference or non-volatile const-qualified integral or enumeration type<a class='hidden_link' href='#8.sentence-1'>.</a></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7895'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'>A constant-initialized potentially-constant variable <span class='math'><span class='mathalpha'>V</span></span> is
<a class='hidden_link' href='#def:usable_in_constant_expressions' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:usable_in_constant_expressions'><i >usable in constant expressions</i></span></a> at a point <span class='math'><span class='mathalpha'>P</span></span> if
<span class='math'><span class='mathalpha'>V</span></span>'s initializing declaration <span class='math'><span class='mathalpha'>D</span></span> is reachable from <span class='math'><span class='mathalpha'>P</span></span> and
<ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.1'>(9.1)</a></div><span class='math'><span class='mathalpha'>V</span></span> is constexpr,</li><li id='9.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.2'>(9.2)</a></div><span class='math'><span class='mathalpha'>V</span></span> is not initialized to a TU-local value, or</li><li id='9.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.3'>(9.3)</a></div><span class='math'><span class='mathalpha'>P</span></span> is in the same translation unit as <span class='math'><span class='mathalpha'>D</span></span><a class='hidden_link' href='#9.sentence-1'>.</a></li></ul></div> <div id='9.sentence-2' class='sentence'>
An object or reference is
<a class='hidden_link' href='#def:potentially_usable_in_constant_expressions' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:potentially_usable_in_constant_expressions'><i >potentially usable in constant expressions</i></span></a> at point <span class='math'><span class='mathalpha'>P</span></span> if it is
<ul class='itemize'><li id='9.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.4'>(9.4)</a></div>the object or reference declared by a variable
that is usable in constant expressions at <span class='math'><span class='mathalpha'>P</span></span>,</li><li id='9.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.5'>(9.5)</a></div>a temporary object of non-volatile const-qualified literal type
whose lifetime is extended (<a href='class.temporary' title='6.7.7&emsp;Temporary objects'>[class.<span class='shy'></span>temporary]</a>)
to that of a variable that is usable in constant expressions at <span class='math'><span class='mathalpha'>P</span></span>,</li><li id='9.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.6'>(9.6)</a></div>a <a href='temp.param' title='13.2&emsp;Template parameters&emsp;[temp.param]'>template parameter</a> object,</li><li id='9.7'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.7'>(9.7)</a></div>a <a href='lex.string' title='5.13.5&emsp;String literals&emsp;[lex.string]'>string literal</a> object,</li><li id='9.8'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.8'>(9.8)</a></div>a non-mutable subobject of any of the above, or</li><li id='9.9'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.9'>(9.9)</a></div>a reference member of any of the above<a class='hidden_link' href='#9.sentence-2'>.</a></li></ul></div> <div id='9.sentence-3' class='sentence'>
An object or reference is <a class='hidden_link' href='#def:usable_in_constant_expressions' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:usable_in_constant_expressions_'><i >usable in constant expressions</i></span></a> at point <span class='math'><span class='mathalpha'>P</span></span>
if it is an object or reference
that is potentially usable in constant expressions at <span class='math'><span class='mathalpha'>P</span></span> and
is constexpr-representable at <span class='math'><span class='mathalpha'>P</span></span><a class='hidden_link' href='#9.sentence-3'>.</a></div> <div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>int</span><span class='operator'>*</span> <span class='keyword'>const</span> <span class='operator'>&amp;</span> r;
<span class='curlybracket'>}</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span> x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>constexpr</span> A a <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='operator'>&amp;</span>x<span class='curlybracket'>}</span>;
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>a<span class='operator'>.</span>r <span class='operator'>=</span><span class='operator'>=</span> <span class='operator'>&amp;</span>x<span class='parenthesis'>)</span>;             <span class='comment'>// OK</span>
  <span class='squarebracket'>[</span><span class='operator'>&amp;</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
    <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>a<span class='operator'>.</span>r <span class='operator'>!</span><span class='operator'>=</span> <span class='literal'>nullptr</span><span class='parenthesis'>)</span>;      <span class='comment'>// error: <span class='tcode_in_codeblock'>a.r</span> is not usable in constant expressions at this point</span>
  <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L7942'>#</a></div><div class='texpara'><div id='10.sentence-1' class='sentence'>An expression <span class='math'><span class='mathalpha'>E</span></span> is a <a class='hidden_link' href='#def:expression,core_constant' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:expression,core_constant'><i >core constant expression</i></span></a>
unless the evaluation of <span class='math'><span class='mathalpha'>E</span></span>, following the rules of the abstract
machine (<a href='intro.execution' title='6.9.1&emsp;Sequential execution'>[intro.<span class='shy'></span>execution]</a>), would evaluate one of the following:
<ul class='itemize'><li id='10.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.1'>(10.1)</a></div><span id=':this'><span class='texttt'><span class='keyword'>this</span></span></span> (<a href='expr.prim.this' title='7.5.3&emsp;This'>[expr.<span class='shy'></span>prim.<span class='shy'></span>this]</a>), except
<ul class='itemize'><li id='10.1.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#10.1.1'>(10.1.1)</a></div>in a constexpr function (<a href='dcl.constexpr' title='9.2.6&emsp;The constexpr and consteval specifiers'>[dcl.<span class='shy'></span>constexpr]</a>)
that is being evaluated as part of <span class='math'><span class='mathalpha'>E</span></span> or</li><li id='10.1.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#10.1.2'>(10.1.2)</a></div>when appearing as the <a href='expr.post.general#nt:postfix-expression' title='7.6.1.1&emsp;General&emsp;[expr.post.general]'><span id='ntref:postfix-expression'><span class='textsf'><i >postfix-expression</i></span></span></a> of
an implicit or explicit class member access expression (<a href='expr.ref' title='7.6.1.5&emsp;Class member access'>[expr.<span class='shy'></span>ref]</a>);</li></ul></li><li id='10.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.2'>(10.2)</a></div>a control flow that passes through
a declaration of a block variable (<a href='basic.scope.block' title='6.4.3&emsp;Block scope'>[basic.<span class='shy'></span>scope.<span class='shy'></span>block]</a>) with
static (<a href='basic.stc.static' title='6.7.6.2&emsp;Static storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>static]</a>) or
thread (<a href='basic.stc.thread' title='6.7.6.3&emsp;Thread storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>thread]</a>) storage duration,
unless that variable is usable in constant expressions;
<div id='example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-4'>4</a></i>:&ensp;<span class='codeblock'><span class='keyword'>constexpr</span> <span class='keyword'>char</span> test<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>5</span>;
  <span class='keyword'>static</span> <span class='keyword'>constexpr</span> <span class='keyword'>char</span> c<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='literal'>"Hello World"</span>;
  <span class='keyword'>return</span> <span class='operator'>*</span><span class='parenthesis'>(</span>c <span class='operator'>+</span> x<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span><span class='literal'>' '</span> <span class='operator'>=</span><span class='operator'>=</span> test<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span> —&nbsp;<i>end example</i>]</div></div></li><li id='10.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.3'>(10.3)</a></div>an invocation of a non-constexpr function;<a class='footnoteref' href='#footnote-67' id='footnoteref-67' title='Overload resolution ([over.match]) is applied as usual.'>67</a></li><li id='10.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.4'>(10.4)</a></div>an invocation of an undefined constexpr function;</li><li id='10.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.5'>(10.5)</a></div>an invocation of an instantiated constexpr function
that is not constexpr-suitable;</li><li id='10.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.6'>(10.6)</a></div>an invocation of a virtual function (<a href='class.virtual' title='11.7.3&emsp;Virtual functions'>[class.<span class='shy'></span>virtual]</a>)
for an object whose dynamic type is constexpr-unknown;</li><li id='10.7'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.7'>(10.7)</a></div>an expression that would exceed the implementation-defined
limits (see <a href='implimits' title='Annex B&emsp;(informative)&emsp;Implementation quantities'>[implimits]</a>);</li><li id='10.8'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.8'>(10.8)</a></div>an operation that would have undefined or erroneous behavior
as specified in <a href='intro' title='4&emsp;General principles'>[intro]</a> through <a href='cpp' title='15&emsp;Preprocessing directives'>[cpp]</a>;<a class='footnoteref' href='#footnote-68' id='footnoteref-68' title='This includes, for example, signed integer overflow ([expr.pre]), certain pointer arithmetic ([expr.add]), division by zero ([expr.mul]), or certain shift operations ([expr.shift]).'>68</a></li><li id='10.9'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.9'>(10.9)</a></div>an <a href='conv.lval' title='7.3.2&emsp;Lvalue-to-rvalue conversion&emsp;[conv.lval]'>lvalue-to-rvalue conversion</a> unless
it is applied to
<ul class='itemize'><li id='10.9.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#10.9.1'>(10.9.1)</a></div>a glvalue of type <span class='mathit'>cv</span> <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>nullptr_<span class='shy'></span>t</span>,</li><li id='10.9.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#10.9.2'>(10.9.2)</a></div>a non-volatile glvalue that refers to an object that is
  usable in constant expressions, or</li><li id='10.9.3'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#10.9.3'>(10.9.3)</a></div>a non-volatile glvalue of literal type that refers to a non-volatile object
  whose lifetime began within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li></ul></li><li id='10.10'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.10'>(10.10)</a></div>an lvalue-to-rvalue conversion
that is applied to a glvalue
that refers to a non-active member of a union or a subobject thereof;</li><li id='10.11'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.11'>(10.11)</a></div>an lvalue-to-rvalue conversion that is applied to
an object with an <a href='basic.indet#def:value,indeterminate' title='6.7.5&emsp;Indeterminate and erroneous values&emsp;[basic.indet]'>indeterminate value</a>;</li><li id='10.12'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.12'>(10.12)</a></div>an invocation of an implicitly-defined copy/move constructor or
copy/move assignment operator
for a union whose active member (if any) is mutable,
unless the lifetime of the union object began within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li><li id='10.13'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.13'>(10.13)</a></div>in a <a href='expr.prim.lambda.general#nt:lambda-expression' title='7.5.6.1&emsp;General&emsp;[expr.prim.lambda.general]'><span id='ntref:lambda-expression'><span class='textsf'><i >lambda-expression</i></span></span></a>,
a reference to <span id=':this_'><span class='texttt'><span class='keyword'>this</span></span></span> or to a variable with
automatic storage duration defined outside that
<a href='expr.prim.lambda.general#nt:lambda-expression' title='7.5.6.1&emsp;General&emsp;[expr.prim.lambda.general]'><span id='ntref:lambda-expression_'><span class='textsf'><i >lambda-expression</i></span></span></a>, where
the reference would be an odr-use (<a href='basic.def.odr#term.odr.use' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>, <a href='expr.prim.lambda' title='7.5.6&emsp;Lambda expressions'>[expr.<span class='shy'></span>prim.<span class='shy'></span>lambda]</a>);
<div id='example-5' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-5'>5</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> <span class='keyword'>int</span> n <span class='operator'>=</span> <span class='literal'>0</span>;
  <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
    <span class='keyword'>constexpr</span> <span class='keyword'>int</span> i <span class='operator'>=</span> n;        <span class='comment'>// OK, <span class='tcode_in_codeblock'>n</span> is not odr-used here</span>
    <span class='keyword'>constexpr</span> <span class='keyword'>int</span> j <span class='operator'>=</span> <span class='operator'>*</span><span class='operator'>&amp;</span>n;      <span class='comment'>// error: <span class='tcode_in_codeblock'>&amp;n</span> would be an odr-use of <span class='tcode_in_codeblock'>n</span></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div>
<div id='note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-4'>4</a></i>:&ensp;<div id='10.13.sentence-1' class='sentence'>If the odr-use occurs in an invocation
of a function call operator of a closure type,
it no longer refers to <span id=':this__'><span class='texttt'><span class='keyword'>this</span></span></span> or to an enclosing
variable with automatic storage duration
due to the transformation (<a href='expr.prim.lambda.capture' title='7.5.6.3&emsp;Captures'>[expr.<span class='shy'></span>prim.<span class='shy'></span>lambda.<span class='shy'></span>capture]</a>)
of the <a href='expr.prim.id.general#nt:id-expression' title='7.5.5.1&emsp;General&emsp;[expr.prim.id.general]'><span id='ntref:id-expression'><span class='textsf'><i >id-expression</i></span></span></a> into
an access of the corresponding data member<a class='hidden_link' href='#10.13.sentence-1'>.</a></div> <div id='example-6' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-6'>6</a></i>:&ensp;<span class='codeblock'><span class='keyword'>auto</span> monad <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> v<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> v; <span class='curlybracket'>}</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>auto</span> bind <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> m<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> fvm<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> fvm<span class='parenthesis'>(</span>m<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;

<span class='comment'>// OK to capture objects with automatic storage duration created during constant expression evaluation.</span>
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>bind<span class='parenthesis'>(</span>monad<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span>monad<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> monad<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span> —&nbsp;<i>end example</i>]</div></div> —&nbsp;<i>end note</i>]</div></div></li><li id='10.14'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.14'>(10.14)</a></div>a conversion
from a prvalue <span class='texttt'>P</span> of type “pointer to <span class='mathit'>cv</span> <span id=':void'><span class='texttt'><span class='keyword'>void</span></span></span>”
to a type “<i >cv1</i> pointer to  <span class='texttt'>T</span>”,
where  <span class='texttt'>T</span> is not <i >cv2</i> <span id=':void_'><span class='texttt'><span class='keyword'>void</span></span></span>,
unless <span class='texttt'>P</span>
is a null pointer value or
points to an object whose type is similar to <span class='texttt'>T</span>;</li><li id='10.15'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.15'>(10.15)</a></div>a <span id=':reinterpret_cast'><span class='texttt'><span class='keyword'>reinterpret_<span class='shy'></span>cast</span></span></span> (<a href='expr.reinterpret.cast' title='7.6.1.10&emsp;Reinterpret cast'>[expr.<span class='shy'></span>reinterpret.<span class='shy'></span>cast]</a>);</li><li id='10.16'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.16'>(10.16)</a></div>a modification of an object (<a href='expr.assign' title='7.6.19&emsp;Assignment and compound assignment operators'>[expr.<span class='shy'></span>assign]</a>, <a href='expr.post.incr' title='7.6.1.6&emsp;Increment and decrement'>[expr.<span class='shy'></span>post.<span class='shy'></span>incr]</a>, <a href='expr.pre.incr' title='7.6.2.3&emsp;Increment and decrement'>[expr.<span class='shy'></span>pre.<span class='shy'></span>incr]</a>)
unless it is applied to a non-volatile lvalue of literal type
that refers to a non-volatile object
whose lifetime began within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li><li id='10.17'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.17'>(10.17)</a></div>an invocation of a destructor (<a href='class.dtor' title='11.4.7&emsp;Destructors'>[class.<span class='shy'></span>dtor]</a>) or a function call
whose <a href='expr.post.general#nt:postfix-expression' title='7.6.1.1&emsp;General&emsp;[expr.post.general]'><span id='ntref:postfix-expression_'><span class='textsf'><i >postfix-expression</i></span></span></a> names a pseudo-destructor (<a href='expr.call' title='7.6.1.3&emsp;Function call'>[expr.<span class='shy'></span>call]</a>),
in either case for an object whose lifetime did not begin within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li><li id='10.18'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.18'>(10.18)</a></div>a <a href='expr.new#nt:new-expression' title='7.6.2.8&emsp;New&emsp;[expr.new]'><span id='ntref:new-expression'><span class='textsf'><i >new-expression</i></span></span></a> (<a href='expr.new' title='7.6.2.8&emsp;New'>[expr.<span class='shy'></span>new]</a>),
unless either
<ul class='itemize'><li id='10.18.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#10.18.1'>(10.18.1)</a></div>the selected allocation function is
a replaceable global allocation function (<a href='new.delete.single' title='17.6.3.2&emsp;Single-object forms'>[new.<span class='shy'></span>delete.<span class='shy'></span>single]</a>, <a href='new.delete.array' title='17.6.3.3&emsp;Array forms'>[new.<span class='shy'></span>delete.<span class='shy'></span>array]</a>) and
the allocated storage is deallocated within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>, or</li><li id='10.18.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#10.18.2'>(10.18.2)</a></div>the selected allocation function is
a non-allocating form (<a href='new.delete.placement' title='17.6.3.4&emsp;Non-allocating forms'>[new.<span class='shy'></span>delete.<span class='shy'></span>placement]</a>)
with an allocated type <span class='texttt'>T</span>, where
<ul class='itemize'><li id='10.18.2.1'><div class='marginalizedparent' style='left:-45mm'><a class='marginalized' href='#10.18.2.1'>(10.18.2.1)</a></div>the placement argument to the <a href='expr.new#nt:new-expression' title='7.6.2.8&emsp;New&emsp;[expr.new]'><span id='ntref:new-expression_'><span class='textsf'><i >new-expression</i></span></span></a> points to
an object whose type is similar to <span class='texttt'>T</span> (<a href='conv.qual' title='7.3.6&emsp;Qualification conversions'>[conv.<span class='shy'></span>qual]</a>) or,
if <span class='texttt'>T</span> is an array type,
to the first element of an object of a type similar to <span class='texttt'>T</span>, and</li><li id='10.18.2.2'><div class='marginalizedparent' style='left:-45mm'><a class='marginalized' href='#10.18.2.2'>(10.18.2.2)</a></div>the placement argument points to storage
whose duration began within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li></ul></li></ul></li><li id='10.19'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.19'>(10.19)</a></div>a <a href='expr.delete#nt:delete-expression' title='7.6.2.9&emsp;Delete&emsp;[expr.delete]'><span id='ntref:delete-expression'><span class='textsf'><i >delete-expression</i></span></span></a> (<a href='expr.delete' title='7.6.2.9&emsp;Delete'>[expr.<span class='shy'></span>delete]</a>),
unless it deallocates a region of storage
allocated within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li><li id='10.20'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.20'>(10.20)</a></div>a call to an instance of
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>allocator<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>allocate</span> (<a href='allocator.members' title='20.2.10.2&emsp;Members'>[allocator.<span class='shy'></span>members]</a>),
unless the allocated storage is deallocated within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li><li id='10.21'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.21'>(10.21)</a></div>a call to an instance of
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>allocator<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>deallocate</span> (<a href='allocator.members' title='20.2.10.2&emsp;Members'>[allocator.<span class='shy'></span>members]</a>),
unless it deallocates a region of storage
allocated within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li><li id='10.22'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.22'>(10.22)</a></div>a construction of an exception object,
unless the exception object and
all of its implicit copies created by invocations of
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>current_<span class='shy'></span>exception</span> or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>rethrow_<span class='shy'></span>exception</span> (<a href='propagation' title='17.9.7&emsp;Exception propagation'>[propagation]</a>)
are destroyed within the evaluation of <span class='math'><span class='mathalpha'>E</span></span>;</li><li id='10.23'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.23'>(10.23)</a></div>an <a href='expr.await#nt:await-expression' title='7.6.2.4&emsp;Await&emsp;[expr.await]'><span id='ntref:await-expression'><span class='textsf'><i >await-expression</i></span></span></a> (<a href='expr.await' title='7.6.2.4&emsp;Await'>[expr.<span class='shy'></span>await]</a>);</li><li id='10.24'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.24'>(10.24)</a></div>a <a href='expr.yield#nt:yield-expression' title='7.6.17&emsp;Yielding a value&emsp;[expr.yield]'><span id='ntref:yield-expression'><span class='textsf'><i >yield-expression</i></span></span></a> (<a href='expr.yield' title='7.6.17&emsp;Yielding a value'>[expr.<span class='shy'></span>yield]</a>);</li><li id='10.25'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.25'>(10.25)</a></div>a three-way comparison (<a href='expr.spaceship' title='7.6.8&emsp;Three-way comparison operator'>[expr.<span class='shy'></span>spaceship]</a>),
relational (<a href='expr.rel' title='7.6.9&emsp;Relational operators'>[expr.<span class='shy'></span>rel]</a>), or equality (<a href='expr.eq' title='7.6.10&emsp;Equality operators'>[expr.<span class='shy'></span>eq]</a>)
operator where the result is unspecified;</li><li id='10.26'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.26'>(10.26)</a></div>a <span id=':dynamic_cast'><span class='texttt'><span class='keyword'>dynamic_<span class='shy'></span>cast</span></span></span> (<a href='expr.dynamic.cast' title='7.6.1.7&emsp;Dynamic cast'>[expr.<span class='shy'></span>dynamic.<span class='shy'></span>cast]</a>) or
<span id=':typeid'><span class='texttt'><span class='keyword'>typeid</span></span></span> (<a href='expr.typeid' title='7.6.1.8&emsp;Type identification'>[expr.<span class='shy'></span>typeid]</a>) expression
on a glvalue that refers to an object
whose dynamic type is constexpr-unknown;</li><li id='10.27'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.27'>(10.27)</a></div>a <span class='texttt'><span class='keyword'>dynamic_<span class='shy'></span>cast</span></span> (<a href='expr.dynamic.cast' title='7.6.1.7&emsp;Dynamic cast'>[expr.<span class='shy'></span>dynamic.<span class='shy'></span>cast]</a>) expression,
<span class='texttt'><span class='keyword'>typeid</span></span> (<a href='expr.typeid' title='7.6.1.8&emsp;Type identification'>[expr.<span class='shy'></span>typeid]</a>) expression, or
<span class='texttt'><span class='keyword'>new</span><span class='operator'>-</span>expression</span> (<a href='expr.new' title='7.6.2.8&emsp;New'>[expr.<span class='shy'></span>new]</a>)
that would throw an exception
where no definition of the exception type is reachable;</li><li id='10.28'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.28'>(10.28)</a></div>an <a href='dcl.asm#nt:asm-declaration' title='9.11&emsp;The asm declaration&emsp;[dcl.asm]'><span id='ntref:asm-declaration'><span class='textsf'><i >asm-declaration</i></span></span></a> (<a href='dcl.asm' title='9.11&emsp;The asm declaration'>[dcl.<span class='shy'></span>asm]</a>);</li><li id='10.29'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.29'>(10.29)</a></div>an invocation of the <span id='lib:va_arg'><span class='texttt'>va_<span class='shy'></span>arg</span></span> macro (<a href='cstdarg.syn' title='17.14.2&emsp;Header &lt;cstdarg&gt; synopsis'>[cstdarg.<span class='shy'></span>syn]</a>);</li><li id='10.30'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.30'>(10.30)</a></div>a non-constant library call (<a href='defns.nonconst.libcall' title='3.35&emsp;non-constant library call'>[defns.<span class='shy'></span>nonconst.<span class='shy'></span>libcall]</a>);
or</li><li id='10.31'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#10.31'>(10.31)</a></div>a <span id=':goto'><span class='texttt'><span class='keyword'>goto</span></span></span> statement (<a href='stmt.goto' title='8.7.6&emsp;The goto statement'>[stmt.<span class='shy'></span>goto]</a>)<a class='hidden_link' href='#10.sentence-1'>.</a> <div class='texpara'><div id='note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-5'>5</a></i>:&ensp;<div id='10.31.sentence-2' class='sentence'>A <span id=':goto_'><span class='texttt'><span class='keyword'>goto</span></span></span> statement introduced by equivalence (<a href='stmt' title='8&emsp;Statements'>[stmt]</a>)
is not in scope<a class='hidden_link' href='#10.31.sentence-2'>.</a></div> <div id='10.31.sentence-3' class='sentence'>For example, a <span id=':while'><span class='texttt'><span class='keyword'>while</span></span></span> statement (<a href='stmt.while' title='8.6.2&emsp;The while statement'>[stmt.<span class='shy'></span>while]</a>)
can be executed during constant evaluation<a class='hidden_link' href='#10.31.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li></ul></div></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8190'>#</a></div><div class='texpara'><div id='11.sentence-1' class='sentence'>It is
<a class='index' id=':whether_an_expression_is_a_core_constant_expression'></a>implementation-defined
whether <span class='math'><span class='mathalpha'>E</span></span> is a core constant expression
if <span class='math'><span class='mathalpha'>E</span></span> satisfies the constraints of a core constant expression, but
evaluation of <span class='math'><span class='mathalpha'>E</span></span> has runtime-undefined behavior<a class='hidden_link' href='#11.sentence-1'>.</a></div></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8197'>#</a></div><div class='texpara'><div id='12.sentence-1' class='sentence'>It is unspecified whether <span class='math'><span class='mathalpha'>E</span></span> is a core constant expression
if <span class='math'><span class='mathalpha'>E</span></span> satisfies the constraints of a core constant expression, but
evaluation of <span class='math'><span class='mathalpha'>E</span></span> would evaluate
<ul class='itemize'><li id='12.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#12.1'>(12.1)</a></div>an operation that has undefined behavior
as specified in <a href='library' title='16&emsp;Library introduction'>[library]</a> through <a href='exec' title='33&emsp;Execution control library'>[exec]</a> or</li><li id='12.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#12.2'>(12.2)</a></div>an invocation of the <span id='lib:va_start'><span class='texttt'>va_<span class='shy'></span>start</span></span> macro (<a href='cstdarg.syn' title='17.14.2&emsp;Header &lt;cstdarg&gt; synopsis'>[cstdarg.<span class='shy'></span>syn]</a>)<a class='hidden_link' href='#12.sentence-1'>.</a></li></ul></div></div></div><div class='para nonNormativeOnly' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8209'>#</a></div><div class='texpara'><div id='example-7' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-7'>7</a></i>:&ensp;<span class='codeblock'><span class='keyword'>int</span> x;                              <span class='comment'>// not constant</span>
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>constexpr</span> A<span class='parenthesis'>(</span><span class='keyword'>bool</span> b<span class='parenthesis'>)</span> <span class='operator'>:</span> m<span class='parenthesis'>(</span>b<span class='operator'>?</span><span class='literal'>42</span><span class='operator'>:</span>x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>
  <span class='keyword'>int</span> m;
<span class='curlybracket'>}</span>;
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> v <span class='operator'>=</span> A<span class='parenthesis'>(</span><span class='literal'>true</span><span class='parenthesis'>)</span><span class='operator'>.</span>m;        <span class='comment'>// OK, constructor call initializes <span class='tcode_in_codeblock'>m</span> with the value <span class='tcode_in_codeblock'>42</span></span>

<span class='keyword'>constexpr</span> <span class='keyword'>int</span> w <span class='operator'>=</span> A<span class='parenthesis'>(</span><span class='literal'>false</span><span class='parenthesis'>)</span><span class='operator'>.</span>m;       <span class='comment'>// error: initializer for <span class='tcode_in_codeblock'>m</span> is <span class='tcode_in_codeblock'>x</span>, which is non-constant</span>

<span class='keyword'>constexpr</span> <span class='keyword'>int</span> f1<span class='parenthesis'>(</span><span class='keyword'>int</span> k<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>int</span> x <span class='operator'>=</span> k;              <span class='comment'>// error: <span class='tcode_in_codeblock'>x</span> is not initialized by a constant expression</span>
                                    <span class='comment'>// because lifetime of <span class='tcode_in_codeblock'>k</span> began outside the initializer of <span class='tcode_in_codeblock'>x</span></span>
  <span class='keyword'>return</span> x;
<span class='curlybracket'>}</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> f2<span class='parenthesis'>(</span><span class='keyword'>int</span> k<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x <span class='operator'>=</span> k;                        <span class='comment'>// OK, not required to be a constant expression</span>
                                    <span class='comment'>// because <span class='tcode_in_codeblock'>x</span> is not <span id=':constexpr'><span class='tcode_in_codeblock'>constexpr</span></span></span>
  <span class='keyword'>return</span> x;
<span class='curlybracket'>}</span>

<span class='keyword'>constexpr</span> <span class='keyword'>int</span> incr<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>&amp;</span>n<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='operator'>+</span><span class='operator'>+</span>n;
<span class='curlybracket'>}</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> g<span class='parenthesis'>(</span><span class='keyword'>int</span> k<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>int</span> x <span class='operator'>=</span> incr<span class='parenthesis'>(</span>k<span class='parenthesis'>)</span>;        <span class='comment'>// error: <span class='tcode_in_codeblock'>incr(k)</span> is not a core constant expression</span>
                                    <span class='comment'>// because lifetime of <span class='tcode_in_codeblock'>k</span> began outside the expression <span class='tcode_in_codeblock'>incr(k)</span></span>
  <span class='keyword'>return</span> x;
<span class='curlybracket'>}</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> h<span class='parenthesis'>(</span><span class='keyword'>int</span> k<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x <span class='operator'>=</span> incr<span class='parenthesis'>(</span>k<span class='parenthesis'>)</span>;                  <span class='comment'>// OK, <span class='tcode_in_codeblock'>incr(k)</span> is not required to be a core constant expression</span>
  <span class='keyword'>return</span> x;
<span class='curlybracket'>}</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> y <span class='operator'>=</span> h<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;             <span class='comment'>// OK, initializes <span class='tcode_in_codeblock'>y</span> with the value <span class='tcode_in_codeblock'>2</span></span>
                                    <span class='comment'>// <span class='tcode_in_codeblock'>h(1)</span> is a core constant expression because</span>
                                    <span class='comment'>// the lifetime of <span class='tcode_in_codeblock'>k</span> begins inside <span class='tcode_in_codeblock'>h(1)</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8250'>#</a></div><div class='texpara'><div id='14.sentence-1' class='sentence'>For the purposes of determining
whether an expression <span class='math'><span class='mathalpha'>E</span></span> is a core constant expression,
the evaluation of the body of a member function of <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>allocator<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span></span>
as defined in <a href='allocator.members' title='20.2.10.2&emsp;Members'>[allocator.<span class='shy'></span>members]</a>, where <span class='texttt'>T</span> is a literal type,
is ignored<a class='hidden_link' href='#14.sentence-1'>.</a></div></div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8257'>#</a></div><div class='texpara'><div id='15.sentence-1' class='sentence'>For the purposes of determining whether <span class='math'><span class='mathalpha'>E</span></span> is a core constant expression,
the evaluation of a call to
a trivial copy/move constructor or copy/move assignment operator of a union
is considered to copy/move the active member of the union, if any<a class='hidden_link' href='#15.sentence-1'>.</a></div> <div id='note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-6'>6</a></i>:&ensp;<div id='15.sentence-2' class='sentence'>The copy/move of the active member is trivial<a class='hidden_link' href='#15.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8266'>#</a></div><div class='texpara'><div id='16.sentence-1' class='sentence'>For the purposes of determining whether <span class='math'><span class='mathalpha'>E</span></span> is a core constant expression,
the evaluation of an <a href='expr.prim.id.general#nt:id-expression' title='7.5.5.1&emsp;General&emsp;[expr.prim.id.general]'><span id='ntref:id-expression_'><span class='textsf'><i >id-expression</i></span></span></a>
that names a structured binding <span class='texttt'>v</span> (<a href='dcl.struct.bind' title='9.7&emsp;Structured binding declarations'>[dcl.<span class='shy'></span>struct.<span class='shy'></span>bind]</a>) has the
following semantics:
<ul class='itemize'><li id='16.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#16.1'>(16.1)</a></div><div class='texpara'><div id='16.1.sentence-1' class='sentence'>If <span class='texttt'>v</span> is an lvalue referring to the object bound to an invented reference <span class='texttt'>r</span>,
the behavior is as if <span class='texttt'>r</span> were nominated<a class='hidden_link' href='#16.1.sentence-1'>.</a></div></div></li><li id='16.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#16.2'>(16.2)</a></div><div class='texpara'><div id='16.2.sentence-1' class='sentence'>Otherwise, if <span class='texttt'>v</span> names an array element or class member,
the behavior is that of
evaluating <span class='texttt'><span class='math'><span class='mathalpha'>e</span></span><span class='squarebracket'>[</span><span class='math'><span class='mathalpha'>i</span></span><span class='squarebracket'>]</span></span> or <span class='texttt'><span class='math'><span class='mathalpha'>e</span></span><span class='operator'>.</span><span class='math'><span class='mathalpha'>m</span></span></span>, respectively,
where <span class='math'><span class='mathalpha'>e</span></span> is the name of the variable
initialized from the initializer of the structured binding declaration, and
<span class='math'><span class='mathalpha'>i</span></span> is the index of the element referred to by <span class='texttt'>v</span> or
<span class='math'><span class='mathalpha'>m</span></span> is the name of the member referred to by <span class='texttt'>v</span>, respectively<a class='hidden_link' href='#16.2.sentence-1'>.</a></div></div></li></ul></div> <div id='example-8' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-8'>8</a></i>:&ensp;<span class='codeblock'><span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>tuple<span class='anglebracket'>&gt;</span>
<span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>mutable</span> <span class='keyword'>int</span> m;
  <span class='keyword'>constexpr</span> S<span class='parenthesis'>(</span><span class='keyword'>int</span> m<span class='parenthesis'>)</span><span class='operator'>:</span> m<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
  <span class='keyword'>virtual</span> <span class='keyword'>int</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
<span class='curlybracket'>}</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span>std<span class='operator'>::</span>tuple<span class='anglebracket'>&lt;</span>S<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span> t<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>auto</span> <span class='squarebracket'>[</span>r<span class='squarebracket'>]</span> <span class='operator'>=</span> t;
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>r<span class='operator'>.</span>g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;            <span class='comment'>// error: dynamic type is constexpr-unknown</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>auto</span> <span class='squarebracket'>[</span>m<span class='squarebracket'>]</span> <span class='operator'>=</span> S<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>m <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;                <span class='comment'>// error: lvalue-to-rvalue conversion on mutable</span>
                                        <span class='comment'>// subobject <span class='tcode_in_codeblock'>e.m</span>, where <span class='tcode_in_codeblock'>e</span> is a constexpr object of type <span class='tcode_in_codeblock'>S</span></span>
  <span class='keyword'>using</span> A <span class='operator'>=</span> <span class='keyword'>int</span><span class='squarebracket'>[</span><span class='literal'>2</span><span class='squarebracket'>]</span>;
  <span class='keyword'>constexpr</span> <span class='keyword'>auto</span> <span class='squarebracket'>[</span>v0, v1<span class='squarebracket'>]</span> <span class='operator'>=</span> A<span class='curlybracket'>{</span><span class='literal'>2</span>, <span class='literal'>3</span><span class='curlybracket'>}</span>;
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>v0 <span class='operator'>+</span> v1 <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>5</span><span class='parenthesis'>)</span>;          <span class='comment'>// OK, equivalent to <span class='tcode_in_codeblock'>e[0] + e[1]</span> where <span class='tcode_in_codeblock'>e</span> is a constexpr array</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8305'>#</a></div><div class='texpara'><div id='17.sentence-1' class='sentence'>During the evaluation of an expression <span class='math'><span class='mathalpha'>E</span></span> as a core constant expression,
all <a href='expr.prim.id.general#nt:id-expression' title='7.5.5.1&emsp;General&emsp;[expr.prim.id.general]'><span id='ntref:id-expression__'><span class='textsf'><i >id-expression</i></span></span></a><i >s</i> and uses of <span class='texttt'><span class='operator'>*</span><span id=':this___'><span class='texttt'><span class='keyword'>this</span></span></span></span>
that refer to an object or reference
whose lifetime did not begin with the evaluation of <span class='math'><span class='mathalpha'>E</span></span>
are treated as referring to a specific instance of that object or reference
whose lifetime and that of all subobjects (including all union members)
includes the entire constant evaluation<a class='hidden_link' href='#17.sentence-1'>.</a></div> <div id='17.sentence-2' class='sentence'>For such an object that is not usable in constant expressions,
the dynamic type of the object is <a class='hidden_link' href='#def:constexpr-unknown' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:constexpr-unknown'><i >constexpr-unknown</i></span></a><a class='hidden_link' href='#17.sentence-2'>.</a></div> <div id='17.sentence-3' class='sentence'>For such a reference that is not usable in constant expressions,
the reference is treated as binding to
an unspecified object of the referenced type
whose lifetime and that of all subobjects includes
the entire constant evaluation and whose dynamic type is constexpr-unknown<a class='hidden_link' href='#17.sentence-3'>.</a></div> <div id='example-9' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-9'>9</a></i>:&ensp;<span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T, size_t N<span class='anglebracket'>&gt;</span>
<span class='keyword'>constexpr</span> size_t array_size<span class='parenthesis'>(</span>T <span class='parenthesis'>(</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span><span class='squarebracket'>[</span>N<span class='squarebracket'>]</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> N;
<span class='curlybracket'>}</span>

<span class='keyword'>void</span> use_array<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='keyword'>const</span> <span class='parenthesis'>(</span><span class='operator'>&amp;</span>gold_medal_mel<span class='parenthesis'>)</span><span class='squarebracket'>[</span><span class='literal'>2</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>auto</span> gold <span class='operator'>=</span> array_size<span class='parenthesis'>(</span>gold_medal_mel<span class='parenthesis'>)</span>;     <span class='comment'>// OK</span>
<span class='curlybracket'>}</span>

<span class='keyword'>constexpr</span> <span class='keyword'>auto</span> olympic_mile<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> <span class='keyword'>int</span> ledecky <span class='operator'>=</span> <span class='literal'>1500</span>;
  <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> ledecky; <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>olympic_mile<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>1500</span><span class='parenthesis'>)</span>;                <span class='comment'>// OK</span>

<span class='keyword'>struct</span> Swim <span class='curlybracket'>{</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>int</span> phelps<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>28</span>; <span class='curlybracket'>}</span>
  <span class='keyword'>virtual</span> <span class='keyword'>constexpr</span> <span class='keyword'>int</span> lochte<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>12</span>; <span class='curlybracket'>}</span>
  <span class='keyword'>int</span> coughlin <span class='operator'>=</span> <span class='literal'>12</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>constexpr</span> <span class='keyword'>int</span> how_many<span class='parenthesis'>(</span>Swim<span class='operator'>&amp;</span> swam<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  Swim<span class='operator'>*</span> p <span class='operator'>=</span> <span class='operator'>&amp;</span>swam;
  <span class='keyword'>return</span> <span class='parenthesis'>(</span>p <span class='operator'>+</span> <span class='literal'>1</span> <span class='operator'>-</span> <span class='literal'>1</span><span class='parenthesis'>)</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span>phelps<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>void</span> splash<span class='parenthesis'>(</span>Swim<span class='operator'>&amp;</span> swam<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>swam<span class='operator'>.</span>phelps<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>28</span><span class='parenthesis'>)</span>;           <span class='comment'>// OK</span>
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span><span class='operator'>&amp;</span>swam<span class='parenthesis'>)</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span>phelps<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>28</span><span class='parenthesis'>)</span>;       <span class='comment'>// OK</span>

  Swim<span class='operator'>*</span> pswam <span class='operator'>=</span> <span class='operator'>&amp;</span>swam;
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>pswam<span class='operator'>-</span><span class='anglebracket'>&gt;</span>phelps<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>28</span><span class='parenthesis'>)</span>;         <span class='comment'>// error: lvalue-to-rvalue conversion on a pointer</span>
                                                <span class='comment'>// not usable in constant expressions</span>

  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>how_many<span class='parenthesis'>(</span>swam<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>28</span><span class='parenthesis'>)</span>;          <span class='comment'>// OK</span>
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>Swim<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='operator'>.</span>lochte<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>12</span><span class='parenthesis'>)</span>;         <span class='comment'>// OK</span>

  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>swam<span class='operator'>.</span>lochte<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>12</span><span class='parenthesis'>)</span>;           <span class='comment'>// error: invoking virtual function on reference</span>
                                                <span class='comment'>// with constexpr-unknown dynamic type</span>

  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span>swam<span class='operator'>.</span>coughlin <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>12</span><span class='parenthesis'>)</span>;           <span class='comment'>// error: lvalue-to-rvalue conversion on an object</span>
                                                <span class='comment'>// not usable in constant expressions</span>
<span class='curlybracket'>}</span>

<span class='keyword'>extern</span> Swim dc;
<span class='keyword'>extern</span> Swim<span class='operator'>&amp;</span> trident;

<span class='keyword'>constexpr</span> <span class='keyword'>auto</span><span class='operator'>&amp;</span> sandeno   <span class='operator'>=</span> <span class='keyword'>typeid</span><span class='parenthesis'>(</span>dc<span class='parenthesis'>)</span>;         <span class='comment'>// OK, can only be <span class='tcode_in_codeblock'>typeid(Swim)</span></span>
<span class='keyword'>constexpr</span> <span class='keyword'>auto</span><span class='operator'>&amp;</span> gallagher <span class='operator'>=</span> <span class='keyword'>typeid</span><span class='parenthesis'>(</span>trident<span class='parenthesis'>)</span>;    <span class='comment'>// error: constexpr-unknown dynamic type</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8374'>#</a></div><div class='texpara'><div id='18.sentence-1' class='sentence'>An object <span class='texttt'>a</span> is said to have <a class='hidden_link' href='#def:destruction,constant' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:destruction,constant'><i >constant destruction</i></span></a> if
<ul class='itemize'><li id='18.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#18.1'>(18.1)</a></div>it is not of class type nor (possibly multidimensional) array thereof, or</li><li id='18.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#18.2'>(18.2)</a></div>it is of class type or (possibly multidimensional) array thereof,
  that class type has a constexpr destructor, and
  for a hypothetical expression <span class='math'><span class='mathalpha'>E</span></span>
  whose only effect is to destroy <span class='texttt'>a</span>,
  <span class='math'><span class='mathalpha'>E</span></span> would be a core constant expression
  if the lifetime of <span class='texttt'>a</span> and its non-mutable subobjects
  (but not its mutable subobjects) were considered to start within <span class='math'><span class='mathalpha'>E</span></span><a class='hidden_link' href='#18.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8389'>#</a></div><div class='texpara'><div id='19.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:expression,integral_constant' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:expression,integral_constant'><i >integral constant expression</i></span></a>
is an expression of integral or
unscoped enumeration type, implicitly converted to a prvalue, where the converted expression is a core constant expression<a class='hidden_link' href='#19.sentence-1'>.</a></div> <div id='note-7' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-7'>7</a></i>:&ensp;<div id='19.sentence-2' class='sentence'>Such expressions can be
used as bit-field lengths (<a href='class.bit' title='11.4.10&emsp;Bit-fields'>[class.<span class='shy'></span>bit]</a>), as enumerator
initializers if the underlying type is not fixed (<a href='dcl.enum' title='9.8.1&emsp;Enumeration declarations'>[dcl.<span class='shy'></span>enum]</a>),
and as <a href='dcl.align' title='9.13.2&emsp;Alignment specifier&emsp;[dcl.align]'>alignments</a><a class='hidden_link' href='#19.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='20'><div class='marginalizedparent'><a class='marginalized' href='#20'>20</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8400'>#</a></div><div class='texpara'><div id='20.sentence-1' class='sentence'>If an expression of literal class type is used in a context where an
integral constant expression is required, then that expression is
contextually implicitly converted (<a href='conv' title='7.3&emsp;Standard conversions'>[conv]</a>) to an integral or unscoped
enumeration type
and the selected conversion function shall be <span id=':constexpr_'><span class='texttt'><span class='keyword'>constexpr</span></span></span><a class='hidden_link' href='#20.sentence-1'>.</a></div> <div id='example-10' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-10'>10</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>constexpr</span> A<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span> <span class='operator'>:</span> val<span class='parenthesis'>(</span>i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> val; <span class='curlybracket'>}</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>operator</span> <span class='keyword'>long</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>42</span>; <span class='curlybracket'>}</span>
<span class='keyword'>private</span><span class='operator'>:</span>
  <span class='keyword'>int</span> val;
<span class='curlybracket'>}</span>;
<span class='keyword'>constexpr</span> A a <span class='operator'>=</span> <span class='keyword'>alignof</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
<span class='keyword'>alignas</span><span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='keyword'>int</span> n;               <span class='comment'>// error: ambiguous conversion</span>
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span> <span class='keyword'>int</span> n <span class='operator'>:</span> a; <span class='curlybracket'>}</span>;        <span class='comment'>// error: ambiguous conversion</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='21'><div class='marginalizedparent'><a class='marginalized' href='#21'>21</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8421'>#</a></div><div class='texpara'><div id='21.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:expression,converted_constant' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:expression,converted_constant'><i >converted constant expression</i></span></a>
of type <span class='texttt'>T</span> is an
expression, implicitly converted to type <span class='texttt'>T</span>, where
the converted expression is a constant expression and the
implicit conversion sequence contains only
<ul class='itemize'><li id='21.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.1'>(21.1)</a></div>user-defined conversions,</li><li id='21.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.2'>(21.2)</a></div>lvalue-to-rvalue conversions (<a href='conv.lval' title='7.3.2&emsp;Lvalue-to-rvalue conversion'>[conv.<span class='shy'></span>lval]</a>),</li><li id='21.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.3'>(21.3)</a></div>array-to-pointer conversions (<a href='conv.array' title='7.3.3&emsp;Array-to-pointer conversion'>[conv.<span class='shy'></span>array]</a>),</li><li id='21.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.4'>(21.4)</a></div>function-to-pointer conversions (<a href='conv.func' title='7.3.4&emsp;Function-to-pointer conversion'>[conv.<span class='shy'></span>func]</a>),</li><li id='21.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.5'>(21.5)</a></div>qualification conversions (<a href='conv.qual' title='7.3.6&emsp;Qualification conversions'>[conv.<span class='shy'></span>qual]</a>),</li><li id='21.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.6'>(21.6)</a></div>integral promotions (<a href='conv.prom' title='7.3.7&emsp;Integral promotions'>[conv.<span class='shy'></span>prom]</a>),</li><li id='21.7'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.7'>(21.7)</a></div>integral conversions (<a href='conv.integral' title='7.3.9&emsp;Integral conversions'>[conv.<span class='shy'></span>integral]</a>) other than narrowing conversions (<a href='dcl.init.list' title='9.5.5&emsp;List-initialization'>[dcl.<span class='shy'></span>init.<span class='shy'></span>list]</a>),</li><li id='21.8'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.8'>(21.8)</a></div>floating-point promotions (<a href='conv.fpprom' title='7.3.8&emsp;Floating-point promotion'>[conv.<span class='shy'></span>fpprom]</a>),</li><li id='21.9'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.9'>(21.9)</a></div>floating-point conversions (<a href='conv.double' title='7.3.10&emsp;Floating-point conversions'>[conv.<span class='shy'></span>double]</a>) where
  the source value can be represented exactly in the destination type,</li><li id='21.10'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.10'>(21.10)</a></div>null pointer conversions (<a href='conv.ptr' title='7.3.12&emsp;Pointer conversions'>[conv.<span class='shy'></span>ptr]</a>) from <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>nullptr_<span class='shy'></span>t</span>,</li><li id='21.11'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.11'>(21.11)</a></div>null member pointer conversions (<a href='conv.mem' title='7.3.13&emsp;Pointer-to-member conversions'>[conv.<span class='shy'></span>mem]</a>) from <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>nullptr_<span class='shy'></span>t</span>, and</li><li id='21.12'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#21.12'>(21.12)</a></div>function pointer conversions (<a href='conv.fctptr' title='7.3.14&emsp;Function pointer conversions'>[conv.<span class='shy'></span>fctptr]</a>),</li></ul>
and where the reference binding (if any) binds directly<a class='hidden_link' href='#21.sentence-1'>.</a></div> <div id='note-8' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-8'>8</a></i>:&ensp;<div id='21.sentence-2' class='sentence'>Such expressions can be used in <span id=':new'><span class='texttt'><span class='keyword'>new</span></span></span>
expressions (<a href='expr.new' title='7.6.2.8&emsp;New'>[expr.<span class='shy'></span>new]</a>), as case expressions (<a href='stmt.switch' title='8.5.3&emsp;The switch statement'>[stmt.<span class='shy'></span>switch]</a>),
as enumerator initializers if the underlying type is
fixed (<a href='dcl.enum' title='9.8.1&emsp;Enumeration declarations'>[dcl.<span class='shy'></span>enum]</a>), as array bounds (<a href='dcl.array' title='9.3.4.5&emsp;Arrays'>[dcl.<span class='shy'></span>array]</a>), and
as constant template
arguments (<a href='temp.arg' title='13.4&emsp;Template arguments'>[temp.<span class='shy'></span>arg]</a>)<a class='hidden_link' href='#21.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='21.sentence-3' class='sentence'><a class='index' id=':conversion,contextual_to_constant_expression_of_type_bool'></a>A <a class='hidden_link' href='#def:contextually_converted_constant_expression_of_type_bool' id='def:contextually_converted_constant_expression_of_type_bool'><i>contextually converted constant expression of type <span class='texttt'><span class='keyword'>bool</span></span></i></a> is
an expression, contextually converted to <span id=':bool'><span class='texttt'><span class='keyword'>bool</span></span></span> (<a href='conv' title='7.3&emsp;Standard conversions'>[conv]</a>),
where the converted expression is a constant expression and
the conversion sequence contains only the conversions above<a class='hidden_link' href='#21.sentence-3'>.</a></div></div></div><div class='para' id='22'><div class='marginalizedparent'><a class='marginalized' href='#22'>22</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8458'>#</a></div><div class='texpara'><div id='22.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:expression,constant' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:expression,constant_'><i >constant expression</i></span></a> is either
a glvalue core constant expression that refers to
an object or a non-immediate function, or
a prvalue core constant expression whose result object (<a href='basic.lval' title='7.2.1&emsp;Value category'>[basic.<span class='shy'></span>lval]</a>)
satisfies the following constraints:
<ul class='itemize'><li id='22.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#22.1'>(22.1)</a></div>each constituent reference refers to an object or a non-immediate function,</li><li id='22.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#22.2'>(22.2)</a></div>no constituent value of scalar type is an indeterminate or erroneous value (<a href='basic.indet' title='6.7.5&emsp;Indeterminate and erroneous values'>[basic.<span class='shy'></span>indet]</a>),</li><li id='22.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#22.3'>(22.3)</a></div>no constituent value of pointer type is a pointer to an immediate function or
an invalid pointer value (<a href='basic.compound' title='6.8.4&emsp;Compound types'>[basic.<span class='shy'></span>compound]</a>), and</li><li id='22.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#22.4'>(22.4)</a></div>no constituent value of pointer-to-member type designates an immediate function<a class='hidden_link' href='#22.sentence-1'>.</a></li></ul></div> <div id='note-9' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-9'>9</a></i>:&ensp;<div id='22.sentence-2' class='sentence'>A glvalue core constant expression
that either refers to or points to an unspecified object
is not a constant expression<a class='hidden_link' href='#22.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='example-11' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-11'>11</a></i>:&ensp;<span class='codeblock'><span class='keyword'>consteval</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>42</span>; <span class='curlybracket'>}</span>
<span class='keyword'>consteval</span> <span class='keyword'>auto</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> f; <span class='curlybracket'>}</span>
<span class='keyword'>consteval</span> <span class='keyword'>int</span> h<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span>p<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> p<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> r <span class='operator'>=</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                          <span class='comment'>// OK</span>
<span class='keyword'>constexpr</span> <span class='keyword'>auto</span> e <span class='operator'>=</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// error: a pointer to an immediate function is</span>
                                                <span class='comment'>// not a permitted result of a constant expression</span>

<span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x;
  <span class='keyword'>constexpr</span> S<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
<span class='keyword'>int</span> i<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>constexpr</span> S s;                                <span class='comment'>// error: <span class='tcode_in_codeblock'>s.x</span> has erroneous value</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='23'><div class='marginalizedparent'><a class='marginalized' href='#23'>23</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8499'>#</a></div><div class='texpara'><div id='23.sentence-1' class='sentence'><i >Recommended practice</i>: Implementations should provide consistent results of floating-point evaluations,
irrespective of whether the evaluation is performed
during translation or during program execution<a class='hidden_link' href='#23.sentence-1'>.</a></div> <div id='note-10' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-10'>10</a></i>:&ensp;<div id='23.sentence-2' class='sentence'>Since this document
imposes no restrictions on the accuracy of floating-point operations, it is unspecified whether the
evaluation of a floating-point expression during translation yields the same result as the
evaluation of the same expression (or the same operations on the same values) during program
execution<a class='hidden_link' href='#23.sentence-2'>.</a></div> <div id='example-12' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-12'>12</a></i>:&ensp;<span class='codeblock'><span class='keyword'>bool</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>char</span> array<span class='squarebracket'>[</span><span class='literal'>1</span> <span class='operator'>+</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='literal'>1</span> <span class='operator'>+</span> <span class='literal'>0.2</span> <span class='operator'>-</span> <span class='literal'>0.1</span> <span class='operator'>-</span> <span class='literal'>0.1</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;   <span class='comment'>// Must be evaluated during translation</span>
    <span class='keyword'>int</span> size <span class='operator'>=</span> <span class='literal'>1</span> <span class='operator'>+</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='literal'>1</span> <span class='operator'>+</span> <span class='literal'>0.2</span> <span class='operator'>-</span> <span class='literal'>0.1</span> <span class='operator'>-</span> <span class='literal'>0.1</span><span class='parenthesis'>)</span>;    <span class='comment'>// May be evaluated at runtime</span>
    <span class='keyword'>return</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>array<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> size;
<span class='curlybracket'>}</span>
</span> <div id='23.sentence-3' class='sentence'>
It is unspecified whether the value of <span class='texttt'>f<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> will be <span class='texttt'><span class='literal'>true</span></span> or <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#23.sentence-3'>.</a></div> —&nbsp;<i>end example</i>]</div></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='24'><div class='marginalizedparent'><a class='marginalized' href='#24'>24</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8522'>#</a></div><div class='texpara'><div id='24.sentence-1' class='sentence'>An expression or conversion is in an <a class='hidden_link' href='#def:immediate_function_context' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:immediate_function_context'><i >immediate function context</i></span></a>
if it is potentially evaluated and either:
<ul class='itemize'><li id='24.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#24.1'>(24.1)</a></div>its innermost enclosing non-block scope is
a function parameter scope of an immediate function,</li><li id='24.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#24.2'>(24.2)</a></div>it is a subexpression of a manifestly constant-evaluated expression
or conversion, or</li><li id='24.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#24.3'>(24.3)</a></div>its enclosing statement is enclosed (<a href='stmt.pre' title='8.1&emsp;Preamble'>[stmt.<span class='shy'></span>pre]</a>) by
the <a href='stmt.block#nt:compound-statement' title='8.4&emsp;Compound statement or block&emsp;[stmt.block]'><span id='ntref:compound-statement'><span class='textsf'><i >compound-statement</i></span></span></a> of a consteval if statement (<a href='stmt.if' title='8.5.2&emsp;The if statement'>[stmt.<span class='shy'></span>if]</a>)<a class='hidden_link' href='#24.sentence-1'>.</a></li></ul></div> <div id='24.sentence-2' class='sentence'>
An invocation is an <a class='hidden_link' href='#def:immediate_invocation' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:immediate_invocation'><i >immediate invocation</i></span></a>
if it is a potentially-evaluated explicit or implicit invocation of
an immediate function and
is not in an immediate function context<a class='hidden_link' href='#24.sentence-2'>.</a></div> <div id='24.sentence-3' class='sentence'>An aggregate initialization is an immediate invocation
if it evaluates a default member initializer
that has a subexpression that is an immediate-escalating expression<a class='hidden_link' href='#24.sentence-3'>.</a></div></div></div><div class='para' id='25'><div class='marginalizedparent'><a class='marginalized' href='#25'>25</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8544'>#</a></div><div class='texpara'><div id='25.sentence-1' class='sentence'><a class='index' id='def:expression,immediate-escalating'></a><a class='index' id='def:conversion,immediate-escalating'></a><a class='index' id='def:immediate-escalating,expression|seeexpression,_immediate-escalating'></a><a class='index' id='def:immediate-escalating,conversion|seeconversion,_immediate-escalating'></a>An expression or conversion is <a class='hidden_link' href='#def:immediate-escalating' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:immediate-escalating'><i >immediate-escalating</i></span></a>
if it is not initially in an immediate function context
and it is either
<ul class='itemize'><li id='25.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#25.1'>(25.1)</a></div>a potentially-evaluated <a href='expr.prim.id.general#nt:id-expression' title='7.5.5.1&emsp;General&emsp;[expr.prim.id.general]'><span id='ntref:id-expression___'><span class='textsf'><i >id-expression</i></span></span></a>
that denotes an immediate function
that is not a subexpression of an immediate invocation, or</li><li id='25.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#25.2'>(25.2)</a></div>an immediate invocation that is not a constant expression
and is not a subexpression of an immediate invocation<a class='hidden_link' href='#25.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='26'><div class='marginalizedparent'><a class='marginalized' href='#26'>26</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8562'>#</a></div><div class='texpara'><div id='26.sentence-1' class='sentence'><a class='index' id='def:immediate-escalating,function|seefunction,_immediate-escalating'></a>An <a class='hidden_link' href='#def:function,immediate-escalating' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:function,immediate-escalating'><i >immediate-escalating</i></span></a> function is
<ul class='itemize'><li id='26.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#26.1'>(26.1)</a></div>the call operator of a lambda that is not declared
with the <span id=':consteval'><span class='texttt'><span class='keyword'>consteval</span></span></span> specifier,</li><li id='26.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#26.2'>(26.2)</a></div>a defaulted special member function
that is not declared with the <span id=':consteval_'><span class='texttt'><span class='keyword'>consteval</span></span></span> specifier, or</li><li id='26.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#26.3'>(26.3)</a></div>a function that results from the instantiation
of a templated entity defined with the <span id=':constexpr__'><span class='texttt'><span class='keyword'>constexpr</span></span></span> specifier<a class='hidden_link' href='#26.sentence-1'>.</a></li></ul></div> <div id='26.sentence-2' class='sentence'>
An immediate-escalating expression shall appear only
in an immediate-escalating function<a class='hidden_link' href='#26.sentence-2'>.</a></div></div></div><div class='para' id='27'><div class='marginalizedparent'><a class='marginalized' href='#27'>27</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8579'>#</a></div><div class='texpara'><div id='27.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:function,immediate' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:function,immediate'><i >immediate function</i></span></a> is a function or constructor that is
<ul class='itemize'><li id='27.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#27.1'>(27.1)</a></div>declared with the <span id=':consteval__'><span class='texttt'><span class='keyword'>consteval</span></span></span> specifier, or</li><li id='27.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#27.2'>(27.2)</a></div>an immediate-escalating function <span class='texttt'><i >F</i></span>
whose function body contains an immediate-escalating expression <span class='texttt'><i >E</i></span>
such that <span class='texttt'><i >E</i></span>'s innermost enclosing non-block scope
is <span class='texttt'><i >F</i></span>'s function parameter scope<a class='hidden_link' href='#27.sentence-1'>.</a> <div class='texpara'><div id='note-11' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-11'>11</a></i>:&ensp;<div id='27.2.sentence-2' class='sentence'>Default member initializers used to initialize
a base or member subobject (<a href='class.base.init' title='11.9.3&emsp;Initializing bases and members'>[class.<span class='shy'></span>base.<span class='shy'></span>init]</a>)
are considered to be part of the function body (<a href='dcl.fct.def.general' title='9.6.1&emsp;General'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>def.<span class='shy'></span>general]</a>)<a class='hidden_link' href='#27.2.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li></ul></div> <div id='example-13' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-13'>13</a></i>:&ensp;<span class='codeblock'><span class='keyword'>consteval</span> <span class='keyword'>int</span> id<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> i; <span class='curlybracket'>}</span>
<span class='keyword'>constexpr</span> <span class='keyword'>char</span> id<span class='parenthesis'>(</span><span class='keyword'>char</span> c<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> c; <span class='curlybracket'>}</span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> t <span class='operator'>+</span> id<span class='parenthesis'>(</span>t<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>auto</span> a <span class='operator'>=</span> <span class='operator'>&amp;</span>f<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span>;              <span class='comment'>// OK, <span class='tcode_in_codeblock'>f&lt;char&gt;</span> is not an immediate function</span>
<span class='keyword'>auto</span> b <span class='operator'>=</span> <span class='operator'>&amp;</span>f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span>;               <span class='comment'>// error: <span class='tcode_in_codeblock'>f&lt;int&gt;</span> is an immediate function</span>

<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>f<span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>6</span><span class='parenthesis'>)</span>;       <span class='comment'>// OK</span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> g<span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>          <span class='comment'>// <span class='tcode_in_codeblock'>g&lt;int&gt;</span> is not an immediate function</span>
  <span class='keyword'>return</span> t <span class='operator'>+</span> id<span class='parenthesis'>(</span><span class='literal'>42</span><span class='parenthesis'>)</span>;            <span class='comment'>// because <span class='tcode_in_codeblock'>id(42)</span> is already a constant</span>
<span class='curlybracket'>}</span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, <span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span>
<span class='keyword'>constexpr</span> <span class='keyword'>bool</span> is_not<span class='parenthesis'>(</span>T t, F f<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> not f<span class='parenthesis'>(</span>t<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>consteval</span> <span class='keyword'>bool</span> is_even<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> i <span class='operator'>%</span> <span class='literal'>2</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span>; <span class='curlybracket'>}</span>

<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>is_not<span class='parenthesis'>(</span><span class='literal'>5</span>, is_even<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;      <span class='comment'>// OK</span>

<span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>0</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
<span class='keyword'>constexpr</span> T h<span class='parenthesis'>(</span>T t <span class='operator'>=</span> id<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>    <span class='comment'>// <span class='tcode_in_codeblock'>h&lt;int&gt;</span> is not an immediate function</span>
                                <span class='comment'>// <span class='tcode_in_codeblock'>id(x)</span> is not evaluated when parsing the default argument (<a href='dcl.fct.default' title='9.3.4.7&emsp;Default arguments'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>default]</a>, <a href='temp.inst' title='13.9.2&emsp;Implicit instantiation'>[temp.<span class='shy'></span>inst]</a>)</span>
    <span class='keyword'>return</span> t;
<span class='curlybracket'>}</span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
<span class='keyword'>constexpr</span> T hh<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>              <span class='comment'>// <span class='tcode_in_codeblock'>hh&lt;int&gt;</span> is an immediate function because of the invocation</span>
  <span class='keyword'>return</span> h<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                <span class='comment'>// of the immediate function <span class='tcode_in_codeblock'>id</span> in the default argument of <span class='tcode_in_codeblock'>h&lt;int&gt;</span></span>
<span class='curlybracket'>}</span>

<span class='keyword'>int</span> i <span class='operator'>=</span> hh<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;              <span class='comment'>// error: <span class='tcode_in_codeblock'>hh&lt;int&gt;()</span> is an immediate-escalating expression</span>
                                <span class='comment'>// outside of an immediate-escalating function</span>

<span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x;
  <span class='keyword'>int</span> y <span class='operator'>=</span> id<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> k<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>          <span class='comment'>// <span class='tcode_in_codeblock'>k&lt;int&gt;</span> is not an immediate function because <span class='tcode_in_codeblock'>A(42)</span> is a</span>
  <span class='keyword'>return</span> A<span class='parenthesis'>(</span><span class='literal'>42</span><span class='parenthesis'>)</span><span class='operator'>.</span>y;               <span class='comment'>// constant expression and thus not immediate-escalating</span>
<span class='curlybracket'>}</span>

<span class='keyword'>constexpr</span> <span class='keyword'>int</span> l<span class='parenthesis'>(</span><span class='keyword'>int</span> c<span class='parenthesis'>)</span> pre<span class='parenthesis'>(</span>c <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>2</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='parenthesis'>(</span>c <span class='operator'>%</span> <span class='literal'>2</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span> <span class='operator'>?</span> c <span class='operator'>/</span> <span class='literal'>0</span> <span class='operator'>:</span> c;
<span class='curlybracket'>}</span>

<span class='keyword'>const</span> <span class='keyword'>int</span> i0 <span class='operator'>=</span> l<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;    <span class='comment'>// dynamic initialization; contract violation or undefined behavior</span>
<span class='keyword'>const</span> <span class='keyword'>int</span> i1 <span class='operator'>=</span> l<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;    <span class='comment'>// static initialization; value of <span class='tcode_in_codeblock'>1</span> or contract violation at compile time</span>
<span class='keyword'>const</span> <span class='keyword'>int</span> i2 <span class='operator'>=</span> l<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span>;    <span class='comment'>// dynamic initialization; undefined behavior</span>
<span class='keyword'>const</span> <span class='keyword'>int</span> i3 <span class='operator'>=</span> l<span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span>;    <span class='comment'>// static initialization; value of <span class='tcode_in_codeblock'>3</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='28'><div class='marginalizedparent'><a class='marginalized' href='#28'>28</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8662'>#</a></div><div class='texpara'><div id='28.sentence-1' class='sentence'>An expression or conversion is <a class='hidden_link' href='#def:manifestly_constant-evaluated' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:manifestly_constant-evaluated'><i >manifestly constant-evaluated</i></span></a>
if it is:
<ul class='itemize'><li id='28.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#28.1'>(28.1)</a></div>a <a href='#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='ntref:constant-expression_'><span class='textsf'><i >constant-expression</i></span></span></a>, or</li><li id='28.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#28.2'>(28.2)</a></div>the condition of a constexpr if statement (<a href='stmt.if' title='8.5.2&emsp;The if statement'>[stmt.<span class='shy'></span>if]</a>), or</li><li id='28.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#28.3'>(28.3)</a></div>an immediate invocation, or</li><li id='28.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#28.4'>(28.4)</a></div>the result of substitution into an atomic constraint expression
to determine whether it is satisfied (<a href='temp.constr.atomic' title='13.5.2.3&emsp;Atomic constraints'>[temp.<span class='shy'></span>constr.<span class='shy'></span>atomic]</a>), or</li><li id='28.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#28.5'>(28.5)</a></div>the initializer of a variable
that is usable in constant expressions or
has constant initialization (<a href='basic.start.static' title='6.9.3.2&emsp;Static initialization'>[basic.<span class='shy'></span>start.<span class='shy'></span>static]</a>)<a class='hidden_link' href='#28.sentence-1'>.</a><a class='footnoteref' href='#footnote-69' id='footnoteref-69' title='Testing this condition can involve a trial evaluation of its initializer, with evaluations of contract assertions using the ignore evaluation semantic ([basic.contract.eval]), as described above.'>69</a> <div class='texpara'><div id='example-14' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-14'>14</a></i>:&ensp;<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>bool</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> X <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
X<span class='anglebracket'>&lt;</span>std<span class='operator'>::</span>is_constant_evaluated<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span> x;                      <span class='comment'>// type <span class='tcode_in_codeblock'>X&lt;true&gt;</span></span>
<span class='keyword'>int</span> y;
<span class='keyword'>const</span> <span class='keyword'>int</span> a <span class='operator'>=</span> std<span class='operator'>::</span>is_constant_evaluated<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>?</span> y <span class='operator'>:</span> <span class='literal'>1</span>;     <span class='comment'>// dynamic initialization to 1</span>
<span class='keyword'>double</span> z<span class='squarebracket'>[</span>a<span class='squarebracket'>]</span>;                                            <span class='comment'>// error: <span class='tcode_in_codeblock'>a</span> is not usable</span>
                                                        <span class='comment'>// in constant expressions</span>
<span class='keyword'>const</span> <span class='keyword'>int</span> b <span class='operator'>=</span> std<span class='operator'>::</span>is_constant_evaluated<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='literal'>2</span> <span class='operator'>:</span> y;     <span class='comment'>// static initialization to 2</span>
<span class='keyword'>int</span> c <span class='operator'>=</span> y <span class='operator'>+</span> <span class='parenthesis'>(</span>std<span class='operator'>::</span>is_constant_evaluated<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='literal'>2</span> <span class='operator'>:</span> y<span class='parenthesis'>)</span>;     <span class='comment'>// dynamic initialization to <span class='tcode_in_codeblock'>y+y</span></span>

<span class='keyword'>constexpr</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> <span class='keyword'>int</span> n <span class='operator'>=</span> std<span class='operator'>::</span>is_constant_evaluated<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='literal'>13</span> <span class='operator'>:</span> <span class='literal'>17</span>; <span class='comment'>// <span class='tcode_in_codeblock'>n</span> is 13</span>
  <span class='keyword'>int</span> m <span class='operator'>=</span> std<span class='operator'>::</span>is_constant_evaluated<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='literal'>13</span> <span class='operator'>:</span> <span class='literal'>17</span>;       <span class='comment'>// <span class='tcode_in_codeblock'>m</span> can be 13 or 17 (see below)</span>
  <span class='keyword'>char</span> arr<span class='squarebracket'>[</span>n<span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>; <span class='comment'>// char[13]</span>
  <span class='keyword'>return</span> m <span class='operator'>+</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>arr<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>int</span> p <span class='operator'>=</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                                            <span class='comment'>// <span class='tcode_in_codeblock'>m</span> is 13; initialized to 26</span>
<span class='keyword'>int</span> q <span class='operator'>=</span> p <span class='operator'>+</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                                        <span class='comment'>// <span class='tcode_in_codeblock'>m</span> is 17 for this call; initialized to 56</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li></ul></div> <div id='note-12' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-12'>12</a></i>:&ensp;<div id='28.sentence-2' class='sentence'>Except for a <a href='dcl.pre#nt:static_assert-message' title='9.1&emsp;Preamble&emsp;[dcl.pre]'><span id='ntref:static_assert-message'><span class='textsf'><i >static_assert-message</i></span></span></a>,
a manifestly constant-evaluated expression
is evaluated even in an unevaluated operand (<a href='expr.context#term.unevaluated.operand' title='7.2.3&emsp;Context dependence'>[expr.<span class='shy'></span>context]</a>)<a class='hidden_link' href='#28.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='29'><div class='marginalizedparent'><a class='marginalized' href='#29'>29</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/expressions.tex#L8709'>#</a></div><div class='texpara'><div id='29.sentence-1' class='sentence'><a class='index' id=':expression,potentially_constant_evaluated'></a>An expression or conversion is <a class='hidden_link' href='#def:potentially_constant_evaluated' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:potentially_constant_evaluated'><i >potentially constant evaluated</i></span></a>
if it is:
<ul class='itemize'><li id='29.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#29.1'>(29.1)</a></div>a manifestly constant-evaluated expression,</li><li id='29.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#29.2'>(29.2)</a></div>a <a href='basic.def.odr#def:potentially_evaluated' title='6.3&emsp;One-definition rule&emsp;[basic.def.odr]'>potentially-evaluated</a> expression,</li><li id='29.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#29.3'>(29.3)</a></div>an immediate subexpression of a <a href='dcl.init.general#nt:braced-init-list' title='9.5.1&emsp;General&emsp;[dcl.init.general]'><span id='ntref:braced-init-list'><span class='textsf'><i >braced-init-list</i></span></span></a>,<a class='footnoteref' href='#footnote-70' id='footnoteref-70' title='In some cases, constant evaluation is needed to determine whether a narrowing conversion is performed ([dcl.init.list]).'>70</a></li><li id='29.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#29.4'>(29.4)</a></div>an expression of the form <span class='texttt'><span class='operator'>&amp;</span></span> <a href='expr.cast#nt:cast-expression' title='7.6.3&emsp;Explicit type conversion (cast notation)&emsp;[expr.cast]'><span id='ntref:cast-expression'><span class='textsf'><i >cast-expression</i></span></span></a>
that occurs within a templated entity,<a class='footnoteref' href='#footnote-71' id='footnoteref-71' title='In some cases, constant evaluation is needed to determine whether such an expression is value-dependent ([temp.dep.constexpr]).'>71</a>
or</li><li id='29.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#29.5'>(29.5)</a></div>a potentially-evaluated subexpression (<a href='intro.execution' title='6.9.1&emsp;Sequential execution'>[intro.<span class='shy'></span>execution]</a>) of one of the above<a class='hidden_link' href='#29.sentence-1'>.</a></li></ul></div></div><div class='texpara'><div id='29.sentence-2' class='sentence'><a class='index' id=':function,needed_for_constant_evaluation'></a><a class='index' id=':variable,needed_for_constant_evaluation'></a>A function or variable is
<a class='hidden_link' href='#def:needed_for_constant_evaluation' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='def:needed_for_constant_evaluation'><i >needed for constant evaluation</i></span></a>
if it is:
<ul class='itemize'><li id='29.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#29.6'>(29.6)</a></div>a constexpr function that
<a href='basic.def.odr#def:function,named_by_expression_or_conversion' title='6.3&emsp;One-definition rule&emsp;[basic.def.odr]'>is named by</a>
an expression
that is potentially constant evaluated, or</li><li id='29.7'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#29.7'>(29.7)</a></div>a potentially-constant variable named by a potentially constant evaluated expression<a class='hidden_link' href='#29.sentence-2'>.</a></li></ul></div></div><div class='texpara'></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-67'><div class='texpara'><a class='footnotenum' href='#footnote-67'>67)</a><a class='footnoteBacklink' href='#footnoteref-67'>67)</a> <div id='footnote-67.sentence-1' class='sentence'>Overload resolution (<a href='over.match' title='12.2&emsp;Overload resolution'>[over.<span class='shy'></span>match]</a>)
is applied as usual<a class='hidden_link' href='#footnote-67.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-68'><div class='texpara'><a class='footnotenum' href='#footnote-68'>68)</a><a class='footnoteBacklink' href='#footnoteref-68'>68)</a> <div id='footnote-68.sentence-1' class='sentence'>This includes,
for example, signed integer overflow (<a href='expr.pre' title='7.1&emsp;Preamble'>[expr.<span class='shy'></span>pre]</a>), certain
pointer arithmetic (<a href='expr.add' title='7.6.6&emsp;Additive operators'>[expr.<span class='shy'></span>add]</a>), division by
zero (<a href='expr.mul' title='7.6.5&emsp;Multiplicative operators'>[expr.<span class='shy'></span>mul]</a>), or certain shift operations (<a href='expr.shift' title='7.6.7&emsp;Shift operators'>[expr.<span class='shy'></span>shift]</a>)<a class='hidden_link' href='#footnote-68.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-69'><div class='texpara'><a class='footnotenum' href='#footnote-69'>69)</a><a class='footnoteBacklink' href='#footnoteref-69'>69)</a> <div id='footnote-69.sentence-1' class='sentence'>Testing this condition
can involve a trial evaluation of its initializer,
with evaluations of contract assertions
using the ignore evaluation semantic (<a href='basic.contract.eval' title='6.10.2&emsp;Evaluation'>[basic.<span class='shy'></span>contract.<span class='shy'></span>eval]</a>),
as described above<a class='hidden_link' href='#footnote-69.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-70'><div class='texpara'><a class='footnotenum' href='#footnote-70'>70)</a><a class='footnoteBacklink' href='#footnoteref-70'>70)</a> <div id='footnote-70.sentence-1' class='sentence'>In some cases, constant evaluation is needed to determine whether a narrowing conversion is performed (<a href='dcl.init.list' title='9.5.5&emsp;List-initialization'>[dcl.<span class='shy'></span>init.<span class='shy'></span>list]</a>)<a class='hidden_link' href='#footnote-70.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-71'><div class='texpara'><a class='footnotenum' href='#footnote-71'>71)</a><a class='footnoteBacklink' href='#footnoteref-71'>71)</a> <div id='footnote-71.sentence-1' class='sentence'>In some cases, constant evaluation is needed to determine whether such an expression is value-dependent (<a href='temp.dep.constexpr' title='13.8.3.4&emsp;Value-dependent expressions'>[temp.<span class='shy'></span>dep.<span class='shy'></span>constexpr]</a>)<a class='hidden_link' href='#footnote-71.sentence-1'>.</a></div></div></div></div></body></html>