<!DOCTYPE html><html lang='en'><head><title>[expr.const]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>8</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>8.20</a> Constant expressions <a class='abbr_ref'>[expr.const]</a></h2><span class='indexparent'><a class='index' id=':expression,constant'></a></span><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/119b98d70d24612e425fb2ae1b6caffb93689b89/source/expressions.tex#L4914'>#</a></div><div id='1.sentence-1' class='sentence'>Certain contexts require expressions that satisfy additional
requirements as detailed in this subclause; other contexts have different
semantics depending on whether or not an expression satisfies these requirements<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>Expressions that satisfy these requirements,
assuming that copy elision is performed,
are called
<span class='indexparent'><a class='index' id=':expression,constant_'></a></span><a class='hidden_link' href='#def:constant_expression' id='def:constant_expression'><i >constant expressions</i></a><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='1.sentence-3' class='sentence'>Constant expressions can be evaluated
during translation<a class='hidden_link' href='#1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> <pre class='bnf'><a class='nontermdef' id='nt:constant-expression'>constant-expression:</a>
&#9;<i ><a href='expr.cond#nt:conditional-expression'>conditional-expression</a></i>
</pre></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/119b98d70d24612e425fb2ae1b6caffb93689b89/source/expressions.tex#L4930'>#</a></div><div id='2.sentence-1' class='sentence'>An expression <span class='texttt'>e</span> is a
<a class='hidden_link' href='#def:expression,core_constant' id='def:expression,core_constant'><i >core constant expression</i></a>
unless the evaluation of <span class='texttt'>e</span>, following the rules of the <a href='intro.execution'>abstract
machine</a>, would evaluate one of the following expressions:</div><div id='2.sentence-2' class='sentence'><ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.1'>(2.1)</a></div><div id='2.1.sentence-1' class='sentence'><a href='expr.prim.this'><span class='texttt'>this</span></a>, except in a constexpr
function or a constexpr constructor that is being evaluated as part
of <span class='texttt'>e</span>;</div></li><li id='2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.2'>(2.2)</a></div><div id='2.2.sentence-1' class='sentence'>an invocation of a function other than
a constexpr constructor for a literal class,
a constexpr function,
or an implicit invocation of a trivial destructor (<a href='class.dtor'>[class.dtor]</a>)
<div id='2.2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#2.2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.2.sentence-2' class='sentence'><a href='over.match'>Overload resolution</a>
is applied as usual</div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> ;</div></li><li id='2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.3'>(2.3)</a></div><div id='2.3.sentence-1' class='sentence'>an invocation of an undefined constexpr function or an
undefined constexpr constructor;</div></li><li id='2.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.4'>(2.4)</a></div><div id='2.4.sentence-1' class='sentence'>an invocation of an instantiated constexpr function or
constexpr constructor that fails to satisfy the requirements
for a constexpr function or
<a href='dcl.constexpr'>constexpr</a> constructor;</div></li><li id='2.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.5'>(2.5)</a></div><div id='2.5.sentence-1' class='sentence'>an expression that would exceed the <a href='implimits'>implementation-defined
limits</a>;</div></li><li id='2.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.6'>(2.6)</a></div><div id='2.6.sentence-1' class='sentence'>an operation that would have undefined behavior
as specified in Clauses <a href='intro'>[intro]</a> through <a href='cpp'>[cpp]</a>
of this International Standard <div id='2.6.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#2.6.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.6.sentence-2' class='sentence'>including,
for example, signed integer overflow (Clause <a href='expr'>[expr]</a>), certain
pointer arithmetic (<a href='expr.add'>[expr.add]</a>), <a href='expr.mul'>division by
zero</a>, or certain <a href='expr.shift'>shift operations</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> ;</div></li><li id='2.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.7'>(2.7)</a></div><div id='2.7.sentence-1' class='sentence'>an <a href='conv.lval'>lvalue-to-rvalue conversion</a> unless
it is applied to
<ul class='itemize'><li id='2.7.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#2.7.1'>(2.7.1)</a></div><div id='2.7.1.sentence-1' class='sentence'>
  a non-volatile glvalue of integral or enumeration type that refers
  to a complete non-volatile const object with a preceding initialization,
  initialized with a constant expression, or</div></li><li id='2.7.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#2.7.2'>(2.7.2)</a></div><div id='2.7.2.sentence-1' class='sentence'>a non-volatile glvalue that refers to a subobject of a <a href='lex.string'>string
  literal</a>, or</div></li><li id='2.7.3'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#2.7.3'>(2.7.3)</a></div><div id='2.7.3.sentence-1' class='sentence'>a non-volatile glvalue that refers to a non-volatile object
  defined with <span class='texttt'>constexpr</span>, or that refers to a non-mutable subobject
  of such an object, or</div></li><li id='2.7.4'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#2.7.4'>(2.7.4)</a></div><div id='2.7.4.sentence-1' class='sentence'>a non-volatile glvalue of literal type that refers to a non-volatile object
  whose lifetime began within the evaluation of <span class='texttt'>e</span>;</div></li></ul></div></li><li id='2.8'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.8'>(2.8)</a></div><div id='2.8.sentence-1' class='sentence'>an <a href='conv.lval'>lvalue-to-rvalue conversion</a>
that is applied to a glvalue
that refers to a non-active member of a union or a subobject thereof;</div></li><li id='2.9'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.9'>(2.9)</a></div><div id='2.9.sentence-1' class='sentence'>an invocation of an implicitly-defined copy/move constructor or
copy/move assignment operator
for a union whose active member (if any) is mutable,
unless the lifetime of the union object began within the evaluation of <span class='texttt'>e</span>;</div></li><li id='2.10'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.10'>(2.10)</a></div><div id='2.10.sentence-1' class='sentence'>an <a href='expr.ass'>assignment expression</a>
or invocation of an assignment operator (<a href='class.copy'>[class.copy]</a>)
that would change the active member of a union;</div></li><li id='2.11'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.11'>(2.11)</a></div><div id='2.11.sentence-1' class='sentence'>an <i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i> that refers to a variable or
data member of reference type
unless the reference has a preceding initialization and either</div><div id='2.11.sentence-2' class='sentence'><ul class='itemize'><li id='2.11.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#2.11.1'>(2.11.1)</a></div><div id='2.11.1.sentence-1' class='sentence'>
  it is initialized with a constant expression or</div></li><li id='2.11.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#2.11.2'>(2.11.2)</a></div><div id='2.11.2.sentence-1' class='sentence'>its lifetime began within the evaluation of <span class='texttt'>e</span>;</div></li></ul></div></li><li id='2.12'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.12'>(2.12)</a></div><div id='2.12.sentence-1' class='sentence'>in a <i ><a href='expr.prim.lambda#nt:lambda-expression'>lambda-expression</a></i>,
a reference to <span class='texttt'>this</span> or to a variable with
automatic storage duration defined outside that
<i ><a href='expr.prim.lambda#nt:lambda-expression'>lambda-expression</a></i>, where
the reference would be an <a href='basic.def.odr'>odr-use</a>;
<div id='2.12.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#2.12.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
void g() {
  const int n = 0;
  [=] {
    constexpr int i = n;   <span class='comment'>// OK, <span class='tcode_in_codeblock'>n</span> is not odr-used and not captured here
</span>    constexpr int j = *&amp;n; <span class='comment'>// ill-formed, <span class='tcode_in_codeblock'>&amp;n</span> would be an odr-use of <span class='tcode_in_codeblock'>n</span>
</span>  };
}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> 
<div id='2.12.note-3' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#2.12.note-3'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.12.sentence-2' class='sentence'>If the odr-use occurs in an invocation
of a function call operator of a closure type,
it no longer refers to <span class='texttt'>this</span> or to an enclosing automatic variable
due to the transformation (<a href='expr.prim.lambda.capture'>[expr.prim.lambda.capture]</a>)
of the <span class='grammarterm'>id-expression</span> into
an access of the corresponding data member<a class='hidden_link' href='#2.12.sentence-2'>.</a></div> <div id='2.12.example-2' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#2.12.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
auto monad = [](auto v) { return [=] { return v; }; };
auto bind = [](auto m) {
  return [=](auto fvm) { return fvm(m()); };
};

<span class='comment'>// OK to have captures to automatic objects created during constant expression evaluation.
</span>static_assert(bind(monad(2))(monad)() == monad(2)());</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></li><li id='2.13'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.13'>(2.13)</a></div><div id='2.13.sentence-1' class='sentence'>a conversion from type <span class='textit'>cv</span> <span class='texttt'>void*</span> to a pointer-to-object type;</div></li><li id='2.14'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.14'>(2.14)</a></div><div id='2.14.sentence-1' class='sentence'>a <a href='expr.dynamic.cast'>dynamic cast</a>;</div></li><li id='2.15'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.15'>(2.15)</a></div><div id='2.15.sentence-1' class='sentence'>a <a href='expr.reinterpret.cast'><span class='texttt'>reinterpret_&shy;cast</span></a>;</div></li><li id='2.16'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.16'>(2.16)</a></div><div id='2.16.sentence-1' class='sentence'>a <a href='expr.pseudo'>pseudo-destructor call</a>;</div></li><li id='2.17'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.17'>(2.17)</a></div><div id='2.17.sentence-1' class='sentence'>modification of an object (<a href='expr.ass'>[expr.ass]</a>, <a href='expr.post.incr'>[expr.post.incr]</a>,
<a href='expr.pre.incr'>[expr.pre.incr]</a>)
unless it is applied to a non-volatile lvalue of literal type
that refers to a non-volatile object
whose lifetime began within the evaluation of <span class='texttt'>e</span>;</div></li><li id='2.18'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.18'>(2.18)</a></div><div id='2.18.sentence-1' class='sentence'>a <a href='expr.typeid'>typeid expression</a> whose operand is a glvalue of a
polymorphic class type;</div></li><li id='2.19'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.19'>(2.19)</a></div><div id='2.19.sentence-1' class='sentence'>a <i ><a href='expr.new#nt:new-expression'>new-expression</a></i>;</div></li><li id='2.20'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.20'>(2.20)</a></div><div id='2.20.sentence-1' class='sentence'>a <i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i>;</div></li><li id='2.21'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.21'>(2.21)</a></div><div id='2.21.sentence-1' class='sentence'>a <a href='expr.rel'>relational</a> or <a href='expr.eq'>equality</a>
operator where the result is unspecified; or</div></li><li id='2.22'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.22'>(2.22)</a></div><div id='2.22.sentence-1' class='sentence'>a <i ><a href='expr.throw#nt:throw-expression'>throw-expression</a></i><a class='hidden_link' href='#2.22.sentence-1'>.</a></div></li></ul></div><div id='2.sentence-3' class='sentence'>If <span class='texttt'>e</span> satisfies the constraints of a core constant expression, but
evaluation of <span class='texttt'>e</span> would evaluate an operation that has undefined behavior
as specified in Clauses <a href='library'>[library]</a> through <a href='thread'>[thread]</a> of this
International Standard, it is unspecified whether <span class='texttt'>e</span> is a core constant
expression<a class='hidden_link' href='#2.sentence-3'>.</a></div><div style='height:0.6em;display:block'></div><div id='2.example-3' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#2.example-3'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
int x;                              <span class='comment'>// not constant
</span>struct A {
  constexpr A(bool b) : m(b?42:x) { }
  int m;
};
constexpr int v = A(true).m;        <span class='comment'>// OK: constructor call initializes <span class='tcode_in_codeblock'>m</span> with the value <span class='tcode_in_codeblock'>42</span>
</span>
constexpr int w = A(false).m;       <span class='comment'>// error: initializer for <span class='tcode_in_codeblock'>m</span> is <span class='tcode_in_codeblock'>x</span>, which is non-constant
</span>
constexpr int f1(int k) {
  constexpr int x = k;              <span class='comment'>// error: <span class='tcode_in_codeblock'>x</span> is not initialized by a constant expression
</span>                                    <span class='comment'>// because lifetime of <span class='tcode_in_codeblock'>k</span> began outside the initializer of <span class='tcode_in_codeblock'>x</span>
</span>  return x;
}
constexpr int f2(int k) {
  int x = k;                        <span class='comment'>// OK: not required to be a constant expression
</span>                                    <span class='comment'>// because <span class='tcode_in_codeblock'>x</span> is not <span class='tcode_in_codeblock'>constexpr</span>
</span>  return x;
}

constexpr int incr(int &amp;n) {
  return ++n;
}
constexpr int g(int k) {
  constexpr int x = incr(k);        <span class='comment'>// error: <span class='tcode_in_codeblock'>incr(k)</span> is not a core constant expression
</span>                                    <span class='comment'>// because lifetime of <span class='tcode_in_codeblock'>k</span> began outside the expression <span class='tcode_in_codeblock'>incr(k)</span>
</span>  return x;
}
constexpr int h(int k) {
  int x = incr(k);                  <span class='comment'>// OK: <span class='tcode_in_codeblock'>incr(k)</span> is not required to be a core constant expression
</span>  return x;
}
constexpr int y = h(1);             <span class='comment'>// OK: initializes <span class='tcode_in_codeblock'>y</span> with the value <span class='tcode_in_codeblock'>2</span>
</span>                                    <span class='comment'>// <span class='tcode_in_codeblock'>h(1)</span> is a core constant expression because
</span>                                    <span class='comment'>// the lifetime of <span class='tcode_in_codeblock'>k</span> begins inside <span class='tcode_in_codeblock'>h(1)</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/119b98d70d24612e425fb2ae1b6caffb93689b89/source/expressions.tex#L5145'>#</a></div><div id='3.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:expression,integral_constant' id='def:expression,integral_constant'><i >integral constant expression</i></a>
is an expression of integral or
unscoped enumeration type, implicitly converted to a prvalue, where the converted expression is a core constant expression<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-2' class='sentence'>Such expressions may be
used as <a href='class.bit'>bit-field</a> lengths, as enumerator
initializers if the underlying type is not fixed (<a href='dcl.enum'>[dcl.enum]</a>),
and as <a href='dcl.align'>alignments</a><a class='hidden_link' href='#3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/119b98d70d24612e425fb2ae1b6caffb93689b89/source/expressions.tex#L5156'>#</a></div><div id='4.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:expression,converted_constant' id='def:expression,converted_constant'><i >converted constant expression</i></a>
of type <span class='texttt'>T</span> is an
expression, implicitly converted to type <span class='texttt'>T</span>, where
the converted expression is a constant expression and the
implicit conversion sequence contains only
<ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div><div id='4.1.sentence-1' class='sentence'>user-defined conversions,</div></li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div><div id='4.2.sentence-1' class='sentence'><a href='conv.lval'>lvalue-to-rvalue conversions</a>,</div></li><li id='4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.3'>(4.3)</a></div><div id='4.3.sentence-1' class='sentence'><a href='conv.array'>array-to-pointer conversions</a>,</div></li><li id='4.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.4'>(4.4)</a></div><div id='4.4.sentence-1' class='sentence'><a href='conv.func'>function-to-pointer conversions</a>,</div></li><li id='4.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.5'>(4.5)</a></div><div id='4.5.sentence-1' class='sentence'><a href='conv.qual'>qualification conversions</a>,</div></li><li id='4.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.6'>(4.6)</a></div><div id='4.6.sentence-1' class='sentence'><a href='conv.prom'>integral promotions</a>,</div></li><li id='4.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.7'>(4.7)</a></div><div id='4.7.sentence-1' class='sentence'><a href='conv.integral'>integral conversions</a> other than
<a href='dcl.init.list#def:narrowing_conversion'>narrowing conversions</a>,</div></li><li id='4.8'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.8'>(4.8)</a></div><div id='4.8.sentence-1' class='sentence'><a href='conv.ptr#def:null_pointer_conversion'>null pointer conversions</a> from <span class='texttt'>std&#x200b;::&#x200b;nullptr_&shy;t</span>,</div></li><li id='4.9'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.9'>(4.9)</a></div><div id='4.9.sentence-1' class='sentence'><a href='conv.mem#def:null_member_pointer_conversion'>null member pointer conversions</a> from <span class='texttt'>std&#x200b;::&#x200b;nullptr_&shy;t</span>, and</div></li><li id='4.10'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.10'>(4.10)</a></div><div id='4.10.sentence-1' class='sentence'><a href='conv.fctptr'>function pointer conversions</a>,</div></li></ul>
and where the reference binding (if any) binds directly<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='4.sentence-3' class='sentence'>Such expressions may be used in <a href='expr.new'><span class='texttt'>new</span>
expressions</a>, as <a href='stmt.switch'>case expressions</a>,
as enumerator initializers if the underlying type is
<a href='dcl.enum#def:type,underlying,fixed'>fixed</a>, as <a href='dcl.array'>array</a> bounds, and
as non-type <a href='temp.arg'>template arguments</a><a class='hidden_link' href='#4.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='4.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':conversion,contextual_to_constant_expression_of_type_bool'></a></span>A <a class='hidden_link' href='#def:contextually_converted_constant_expression_of_type_bool' id='def:contextually_converted_constant_expression_of_type_bool'><i>contextually converted constant expression of type <span class='texttt'>bool</span></i></a> is
an expression, <a href='conv#def:conversion,contextual_to_bool'>contextually converted to <span class='texttt'>bool</span></a>,
where the converted expression is a constant expression and
the conversion sequence contains only the conversions above<a class='hidden_link' href='#4.sentence-2'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/119b98d70d24612e425fb2ae1b6caffb93689b89/source/expressions.tex#L5191'>#</a></div><div id='5.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:expression,constant' id='def:expression,constant'><i >constant expression</i></a> is either
a glvalue core constant expression that refers to
an entity that is a permitted result of a constant expression (as defined below), or
a prvalue core constant expression whose value
satisfies the following constraints:
<ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.1'>(5.1)</a></div><div id='5.1.sentence-1' class='sentence'>
  if the value is an object of class type,
  each non-static data member of reference type refers to
  an entity that is a permitted result of a constant expression,</div></li><li id='5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.2'>(5.2)</a></div><div id='5.2.sentence-1' class='sentence'>if the value is of pointer type, it contains
  the address of an object with static storage duration,
  the address past the end of such an object (<a href='expr.add'>[expr.add]</a>),
  the address of a function,
  or a null pointer value, and</div></li><li id='5.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.3'>(5.3)</a></div><div id='5.3.sentence-1' class='sentence'>if the value is an object of class or array type,
  each subobject satisfies these constraints for the value<a class='hidden_link' href='#5.3.sentence-1'>.</a></div></li></ul></div> <div id='5.sentence-2' class='sentence'>
An entity is a
<a class='hidden_link' href='#def:constant_expression,permitted_result_of' id='def:constant_expression,permitted_result_of'><i >permitted result of a constant expression</i></a>
if it is an
object with static storage duration that is either not a temporary object or is
a temporary object whose value satisfies the above constraints, or it is a
function<a class='hidden_link' href='#5.sentence-2'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/119b98d70d24612e425fb2ae1b6caffb93689b89/source/expressions.tex#L5219'>#</a></div><div id='6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='6.sentence-1' class='sentence'>Since this International Standard
imposes no restrictions on the accuracy of floating-point operations, it is unspecified whether the
evaluation of a floating-point expression during translation yields the same result as the
evaluation of the same expression (or the same operations on the same values) during program
execution<a class='hidden_link' href='#6.sentence-1'>.</a><a class='footnotenum' href='#footnote-89'>89</a></div> <div id='6.sentence-2' class='sentence'> <div id='6.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
bool f() {
    char array[1 + int(1 + 0.2 - 0.1 - 0.1)];  <span class='comment'>// Must be evaluated during translation
</span>    int size = 1 + int(1 + 0.2 - 0.1 - 0.1);   <span class='comment'>// May be evaluated at runtime
</span>    return sizeof(array) == size;
}</pre> <div id='6.sentence-3' class='sentence'>
It is unspecified whether the value of <span class='texttt'>f()</span> will be <span class='texttt'>true</span> or <span class='texttt'>false</span><a class='hidden_link' href='#6.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/119b98d70d24612e425fb2ae1b6caffb93689b89/source/expressions.tex#L5237'>#</a></div><div id='7.sentence-1' class='sentence'>If an expression of literal class type is used in a context where an
integral constant expression is required, then that expression is
<a href='conv#def:contextually_implicitly_converted'>contextually implicitly converted</a> to an integral or unscoped
enumeration type
and the selected conversion function shall be <span class='texttt'>constexpr</span><a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A {
  constexpr A(int i) : val(i) { }
  constexpr operator int() const { return val; }
  constexpr operator long() const { return 42; }
private:
  int val;
};
template&lt;int&gt; struct X { };
constexpr A a = alignof(int);
alignas(a) int n;              <span class='comment'>// error: ambiguous conversion
</span>struct B { int n : a; };       <span class='comment'>// error: ambiguous conversion
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  </div><div class='footnote' id='footnote-89'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-89'>89)</a></div><div id='footnote-89.sentence-1' class='sentence'>Nonetheless, implementations should provide consistent results,
irrespective of whether the evaluation was performed during translation and/or during program
execution<a class='hidden_link' href='#footnote-89.sentence-1'>.</a></div></div></div></body></html>