<!DOCTYPE html><html lang='en'><head><title>[temp.deduct.general]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>13</a> Templates <a class='abbr_ref' href='./#temp'>[temp]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>13.10</a> Function template specializations <a class='abbr_ref' href='temp.fct.spec#temp.deduct.general'>[temp.fct.spec]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>13.10.3</a> Template argument deduction <a class='abbr_ref' href='temp.deduct#general'>[temp.deduct]</a></h3><h4 ><a class='secnum' style='min-width:95pt'>13.10.3.1</a> General <a class='abbr_ref'>[temp.deduct.general]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L6980'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>When a
function template
specialization is referenced, all of the
template arguments shall have values<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>The values can be
explicitly specified or, in some cases, be deduced from the use
or obtained from default
<a href='temp.names#nt:template-argument' title='13.3&emsp;Names of template specializations&emsp;[temp.names]'><span id='ntref:template-argument'><span class='textsf'><i >template-argument</i></span></span></a><i >s</i><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>: <div id='1.sentence-3' class='sentence'><span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span>Array<span class='anglebracket'>&lt;</span>dcomplex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> cv, Array<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> ci<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  sort<span class='parenthesis'>(</span>cv<span class='parenthesis'>)</span>;                     <span class='comment'>// calls <span class='tcode_in_codeblock'>sort(Array&lt;dcomplex&gt;&amp;)</span></span>
  sort<span class='parenthesis'>(</span>ci<span class='parenthesis'>)</span>;                     <span class='comment'>// calls <span class='tcode_in_codeblock'>sort(Array&lt;int&gt;&amp;)</span></span>
<span class='curlybracket'>}</span>
</span>
and
<span class='codeblock'><span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='keyword'>double</span> d<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i <span class='operator'>=</span> convert<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>d<span class='parenthesis'>)</span>;      <span class='comment'>// calls <span class='tcode_in_codeblock'>convert&lt;int,double&gt;(double)</span></span>
  <span class='keyword'>int</span> c <span class='operator'>=</span> convert<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>d<span class='parenthesis'>)</span>;     <span class='comment'>// calls <span class='tcode_in_codeblock'>convert&lt;char,double&gt;(double)</span></span>
<span class='curlybracket'>}</span>
</span></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7005'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>When an explicit template argument list is specified, if the
given <a href='temp.names#nt:template-id' title='13.3&emsp;Names of template specializations&emsp;[temp.names]'><span id='ntref:template-id'><span class='textsf'><i >template-id</i></span></span></a> is not valid (<a href='temp.names' title='13.3&emsp;Names of template specializations'>[temp.<span class='shy'></span>names]</a>),
type deduction fails<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>Otherwise, the specified template argument values are substituted for the
corresponding template parameters as specified below<a class='hidden_link' href='#2.sentence-2'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7012'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>After this substitution is performed, the function parameter type
adjustments described in <a href='dcl.fct' title='9.3.4.6&emsp;Functions'>[dcl.<span class='shy'></span>fct]</a> are performed<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>: <div id='3.sentence-2' class='sentence'>A parameter type of “<span class='texttt'><span class='keyword'>void</span> <span class='parenthesis'>(</span><span class='keyword'>const</span> <span class='keyword'>int</span>, <span class='keyword'>int</span><span class='squarebracket'>[</span><span class='literal'>5</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span></span>” becomes
“<span class='texttt'><span class='keyword'>void</span><span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span>,<span class='keyword'>int</span><span class='operator'>*</span><span class='parenthesis'>)</span></span>”<a class='hidden_link' href='#3.sentence-2'>.</a></div> —&nbsp;<i>end example</i>]</div></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>: <div id='3.sentence-3' class='sentence'>A top-level qualifier in a function parameter declaration does not affect
the function type but still affects the type of the function parameter
variable within the function<a class='hidden_link' href='#3.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> X<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='keyword'>const</span> X x<span class='parenthesis'>)</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Z<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> h<span class='parenthesis'>(</span>Z, Z<span class='operator'>*</span><span class='parenthesis'>)</span>;

<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='comment'>// #1: function type is <span class='tcode_in_codeblock'>f(int)</span>, <span class='tcode_in_codeblock'>t</span> is non <span id=':const'><span class='tcode_in_codeblock'>const</span></span></span>
  f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;

  <span class='comment'>// #2: function type is <span class='tcode_in_codeblock'>f(int)</span>, <span class='tcode_in_codeblock'>t</span> is <span id=':const_'><span class='tcode_in_codeblock'>const</span></span></span>
  f<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;

  <span class='comment'>// #3: function type is <span class='tcode_in_codeblock'>g(int)</span>, <span class='tcode_in_codeblock'>x</span> is <span id=':const__'><span class='tcode_in_codeblock'>const</span></span></span>
  g<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;

  <span class='comment'>// #4: function type is <span class='tcode_in_codeblock'>g(int)</span>, <span class='tcode_in_codeblock'>x</span> is <span id=':const___'><span class='tcode_in_codeblock'>const</span></span></span>
  g<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;

  <span class='comment'>// #5: function type is <span class='tcode_in_codeblock'>h(int, const int*)</span></span>
  h<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>1</span>,<span class='literal'>0</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para nonNormativeOnly' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7049'>#</a></div><div class='texpara'><div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>: <div id='4.sentence-1' class='sentence'><span class='texttt'>f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span></span> and <span class='texttt'>f<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span></span> call distinct functions
even though both of the functions called have the same function type<a class='hidden_link' href='#4.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7055'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>The resulting substituted and adjusted function type is used as
the type of the function template for template argument
deduction<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'>If a template argument has not been deduced and its
corresponding template parameter has a default argument, the
template argument is determined by substituting the template
arguments determined for preceding template parameters into the
default argument<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>If the substitution results in an invalid type,
as described above, type deduction fails<a class='hidden_link' href='#5.sentence-3'>.</a></div> <div id='example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-4'>4</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, <span class='keyword'>class</span> U <span class='operator'>=</span> <span class='keyword'>double</span><span class='anglebracket'>&gt;</span>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span>T t <span class='operator'>=</span> <span class='literal'>0</span>, U u <span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;

<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span><span class='literal'>1</span>, <span class='literal'>'c'</span><span class='parenthesis'>)</span>;        <span class='comment'>// <span class='tcode_in_codeblock'>f&lt;int,char&gt;(1,'c')</span></span>
  f<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;             <span class='comment'>// <span class='tcode_in_codeblock'>f&lt;int,double&gt;(1,0)</span></span>
  f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;              <span class='comment'>// error: <span class='tcode_in_codeblock'>T</span> cannot be deduced</span>
  f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;         <span class='comment'>// <span class='tcode_in_codeblock'>f&lt;int,double&gt;(0,0)</span></span>
  f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>,<span class='keyword'>char</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;    <span class='comment'>// <span class='tcode_in_codeblock'>f&lt;int,char&gt;(0,0)</span></span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><div id='5.sentence-4' class='sentence'>When all template arguments have been deduced or obtained from
default template arguments, all uses of template parameters in
the template parameter list of the template
are replaced with the corresponding deduced
or default argument values<a class='hidden_link' href='#5.sentence-4'>.</a></div> <div id='5.sentence-5' class='sentence'>If the substitution results in an
invalid type, as described above, type deduction fails<a class='hidden_link' href='#5.sentence-5'>.</a></div> <div id='5.sentence-6' class='sentence'>If the function template has associated constraints (<a href='temp.constr.decl' title='13.5.3&emsp;Constrained declarations'>[temp.<span class='shy'></span>constr.<span class='shy'></span>decl]</a>),
those constraints are checked for satisfaction (<a href='temp.constr.constr' title='13.5.2&emsp;Constraints'>[temp.<span class='shy'></span>constr.<span class='shy'></span>constr]</a>)<a class='hidden_link' href='#5.sentence-6'>.</a></div> <div id='5.sentence-7' class='sentence'>If the constraints are not satisfied, type deduction fails<a class='hidden_link' href='#5.sentence-7'>.</a></div> <div id='5.sentence-8' class='sentence'>In the context of a function call, if type deduction has not yet failed, then
for those function parameters for which the function call has arguments,
each function parameter with a type that was non-dependent
before substitution of any explicitly-specified template arguments
is checked against its corresponding argument;
if the corresponding argument cannot be implicitly converted
to the parameter type, type deduction fails<a class='hidden_link' href='#5.sentence-8'>.</a></div> <div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>: <div id='5.sentence-9' class='sentence'>Overload resolution will check the other parameters, including
parameters with dependent types in which
no template parameters participate in template argument deduction and
parameters that became non-dependent due to substitution of
explicitly-specified template arguments<a class='hidden_link' href='#5.sentence-9'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='5.sentence-10' class='sentence'>
If type deduction has not yet failed, then
all uses of template parameters in the function type are
replaced with the corresponding deduced or default argument values<a class='hidden_link' href='#5.sentence-10'>.</a></div> <div id='5.sentence-11' class='sentence'>If the substitution results in an invalid type, as described above,
type deduction fails<a class='hidden_link' href='#5.sentence-11'>.</a></div> <div id='example-5' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-5'>5</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Z <span class='curlybracket'>{</span>
  <span class='keyword'>typedef</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>x xx;
<span class='curlybracket'>}</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C <span class='operator'>=</span> <span class='keyword'>requires</span> <span class='curlybracket'>{</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>A; <span class='curlybracket'>}</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span>C T<span class='anglebracket'>&gt;</span> <span class='keyword'>typename</span> Z<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>::</span>xx f<span class='parenthesis'>(</span><span class='keyword'>void</span> <span class='operator'>*</span>, T<span class='parenthesis'>)</span>;          <span class='comment'>// #1</span>
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span>, T<span class='parenthesis'>)</span>;                      <span class='comment'>// #2</span>
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span><span class='curlybracket'>}</span> a;
<span class='keyword'>struct</span> ZZ <span class='curlybracket'>{</span>
  <span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, <span class='keyword'>class</span> <span class='operator'>=</span> <span class='keyword'>typename</span> Z<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>::</span>xx<span class='anglebracket'>&gt;</span> <span class='keyword'>operator</span> T <span class='operator'>*</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  ZZ zz;
  f<span class='parenthesis'>(</span><span class='literal'>1</span>, a<span class='parenthesis'>)</span>;              <span class='comment'>// OK, deduction fails for #1 because there is no conversion from <span class='tcode_in_codeblock'>int</span> to <span class='tcode_in_codeblock'><span id=':void'><span class='tcode_in_codeblock'>void</span></span>*</span></span>
  f<span class='parenthesis'>(</span>zz, <span class='literal'>42</span><span class='parenthesis'>)</span>;            <span class='comment'>// OK, deduction fails for #1 because <span class='tcode_in_codeblock'>C&lt;int&gt;</span> is not satisfied</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7128'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>At certain points in the template argument deduction process it is necessary
to take a function type that makes use of template parameters and replace those
template parameters with the corresponding template arguments<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>This is done at
the beginning of template argument deduction when any explicitly specified
template arguments are substituted into the function type, and again at the end
of template argument deduction when any template arguments that were deduced or
obtained from default arguments are substituted<a class='hidden_link' href='#6.sentence-2'>.</a></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7137'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'><a class='index' id=':deduction,deduction_substitution_loci'></a>The <a class='hidden_link' href='#def:deduction_substitution_loci' title='13.10.3.1&emsp;General&emsp;[temp.deduct.general]'><span id='def:deduction_substitution_loci'><i >deduction substitution loci</i></span></a> are
<ul class='itemize'><li id='7.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.1'>(7.1)</a></div>the function type outside of the <a href='except.spec#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier'><span class='textsf'><i >noexcept-specifier</i></span></span></a>,</li><li id='7.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.2'>(7.2)</a></div>the <a href='dcl.fct.spec#nt:explicit-specifier' title='9.2.3&emsp;Function specifiers&emsp;[dcl.fct.spec]'><span id='ntref:explicit-specifier'><span class='textsf'><i >explicit-specifier</i></span></span></a>, and</li><li id='7.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.3'>(7.3)</a></div>the template parameter declarations<a class='hidden_link' href='#7.sentence-1'>.</a></li></ul></div> <div id='7.sentence-2' class='sentence'>
The substitution occurs in all types and expressions that are used
in the deduction substitution loci<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>The expressions include not only
constant expressions such as those that appear in array bounds or as nontype
template arguments but also general expressions (i.e., non-constant expressions)
inside <span class='texttt'><span class='keyword'>sizeof</span></span>, <span id=':decltype'><span class='texttt'><span class='keyword'>decltype</span></span></span>, and other contexts that allow non-constant
expressions<a class='hidden_link' href='#7.sentence-3'>.</a></div> <div id='7.sentence-4' class='sentence'>The substitution proceeds in lexical order and stops when
a condition that causes deduction to fail is encountered<a class='hidden_link' href='#7.sentence-4'>.</a></div> <div id='7.sentence-5' class='sentence'>If substitution into different declarations of the same function template would
cause template instantiations to occur in a different order or not at all,
the program is ill-formed; no diagnostic required<a class='hidden_link' href='#7.sentence-5'>.</a></div> <div id='note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-4'>4</a></i>: <div id='7.sentence-6' class='sentence'>The equivalent substitution in exception specifications is
done only when the <a href='except.spec#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier_'><span class='textsf'><i >noexcept-specifier</i></span></span></a> is instantiated,
at which point a program is ill-formed
if the substitution results in an invalid type or expression<a class='hidden_link' href='#7.sentence-6'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='example-6' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-6'>6</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> A <span class='curlybracket'>{</span> <span class='keyword'>using</span> X <span class='operator'>=</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>X; <span class='curlybracket'>}</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>X f<span class='parenthesis'>(</span><span class='keyword'>typename</span> A<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>::</span>X<span class='parenthesis'>)</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>auto</span> g<span class='parenthesis'>(</span><span class='keyword'>typename</span> A<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>::</span>X<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>X;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>X h<span class='parenthesis'>(</span><span class='keyword'>typename</span> A<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>::</span>X<span class='parenthesis'>)</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>auto</span> h<span class='parenthesis'>(</span><span class='keyword'>typename</span> A<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>::</span>X<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>X;   <span class='comment'>// redeclaration</span>
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>

<span class='keyword'>void</span> x<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;        <span class='comment'>// OK, substituting return type causes deduction to fail</span>
  g<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;        <span class='comment'>// error, substituting parameter type instantiates <span class='tcode_in_codeblock'>A&lt;int&gt;</span></span>
  h<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;        <span class='comment'>// ill-formed, no diagnostic required</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7181'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'>If a substitution results in an invalid type or expression, type deduction fails<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>An
invalid type or expression is one that would be ill-formed, with a diagnostic
required, if written in the same context using the substituted arguments<a class='hidden_link' href='#8.sentence-2'>.</a></div> <div id='note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-5'>5</a></i>: <div id='8.sentence-3' class='sentence'>If no
diagnostic is required, the program is still ill-formed<a class='hidden_link' href='#8.sentence-3'>.</a></div> <div id='8.sentence-4' class='sentence'>Access checking is done
as part of the substitution
process<a class='hidden_link' href='#8.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='8.sentence-5' class='sentence'>
Invalid types and expressions can result in a deduction failure
only in the immediate context of the deduction substitution loci<a class='hidden_link' href='#8.sentence-5'>.</a></div> <div id='note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-6'>6</a></i>: <div id='8.sentence-6' class='sentence'>The substitution into types and expressions can result
in effects such as the instantiation of class template specializations and/or
function template specializations, the generation of implicitly-defined functions,
etc<a class='hidden_link' href='#8.sentence-6'>.</a></div> <div id='8.sentence-7' class='sentence'>Such effects are not in the “immediate context” and can result in the
program being ill-formed<a class='hidden_link' href='#8.sentence-7'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7201'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'>A <a href='expr.prim.lambda.general#nt:lambda-expression' title='7.5.5.1&emsp;General&emsp;[expr.prim.lambda.general]'><span id='ntref:lambda-expression'><span class='textsf'><i >lambda-expression</i></span></span></a> appearing in a function type
or a template parameter is not considered part of the immediate context
for the purposes of template argument deduction<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='note-7' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-7'>7</a></i>: <div id='9.sentence-2' class='sentence'>The intent is to avoid requiring implementations to deal with
substitution failure involving arbitrary statements<a class='hidden_link' href='#9.sentence-2'>.</a></div> <div id='example-7' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-7'>7</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>auto</span> f<span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> T<span class='operator'>::</span>invalid; <span class='curlybracket'>}</span> <span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
f<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;               <span class='comment'>// error: invalid expression not part of the immediate context</span>

<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, std<span class='operator'>::</span>size_t <span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> T<span class='operator'>::</span>invalid; <span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> g<span class='parenthesis'>(</span>T<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
g<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;               <span class='comment'>// error: invalid expression not part of the immediate context</span>

<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>auto</span> h<span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='squarebracket'>[</span>x <span class='operator'>=</span> T<span class='operator'>::</span>invalid<span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
h<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;               <span class='comment'>// error: invalid expression not part of the immediate context</span>

<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>auto</span> i<span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>invalid <span class='curlybracket'>{</span> <span class='curlybracket'>}</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> i<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
i<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;               <span class='comment'>// error: invalid expression not part of the immediate context</span>

<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>auto</span> j<span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> x<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>decltype</span><span class='parenthesis'>(</span>x<span class='operator'>.</span>invalid<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span> <span class='parenthesis'>(</span>t<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;   <span class='comment'>// #1</span>
<span class='keyword'>void</span> j<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;                                                            <span class='comment'>// #2</span>
j<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;               <span class='comment'>// deduction fails on #1, calls #2</span>
</span> —&nbsp;<i>end example</i>]</div></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7238'>#</a></div><div class='texpara'><div id='example-8' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-8'>8</a></i>: <span class='codeblock'><span class='keyword'>struct</span> X <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> Y <span class='curlybracket'>{</span>
  Y<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;

<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>auto</span> f<span class='parenthesis'>(</span>T t1, T t2<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>decltype</span><span class='parenthesis'>(</span>t1 <span class='operator'>+</span> t2<span class='parenthesis'>)</span>;     <span class='comment'>// #1</span>
X f<span class='parenthesis'>(</span>Y, Y<span class='parenthesis'>)</span>;                                                      <span class='comment'>// #2</span>

X x1, x2;
X x3 <span class='operator'>=</span> f<span class='parenthesis'>(</span>x1, x2<span class='parenthesis'>)</span>;   <span class='comment'>// deduction fails on #1 (cannot add <span class='tcode_in_codeblock'>X+X</span>), calls #2</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para nonNormativeOnly' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7254'>#</a></div><div class='texpara'><div id='note-8' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-8'>8</a></i>: <div id='11.sentence-1' class='sentence'>Type deduction can fail for the following reasons:
<ul class='itemize'><li id='11.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.1'>(11.1)</a></div><div class='texpara'><div id='11.1.sentence-1' class='sentence'>Attempting to instantiate a pack expansion containing multiple packs of differing lengths<a class='hidden_link' href='#11.1.sentence-1'>.</a></div></div></li><li id='11.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.2'>(11.2)</a></div><div class='texpara'><div id='11.2.sentence-1' class='sentence'>Attempting to create an array with an element type that is <span id=':void_'><span class='texttt'><span class='keyword'>void</span></span></span>, a
function type, or a reference type, or attempting
to create an array with a size that is zero or negative<a class='hidden_link' href='#11.2.sentence-1'>.</a></div> <div id='example-9' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-9'>9</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span>T<span class='squarebracket'>[</span><span class='literal'>5</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span>;
<span class='keyword'>int</span> I <span class='operator'>=</span> f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
<span class='keyword'>int</span> j <span class='operator'>=</span> f<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;             <span class='comment'>// invalid array</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='11.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.3'>(11.3)</a></div><div class='texpara'><div id='11.3.sentence-1' class='sentence'>Attempting to use a type that is not a class or enumeration type in a qualified name<a class='hidden_link' href='#11.3.sentence-1'>.</a></div> <div id='example-10' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-10'>10</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='keyword'>typename</span> T<span class='operator'>::</span>B<span class='operator'>*</span><span class='parenthesis'>)</span>;
<span class='keyword'>int</span> i <span class='operator'>=</span> f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='11.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.4'>(11.4)</a></div><div class='texpara'><div id='11.4.sentence-1' class='sentence'>Attempting to use a type in a <a href='expr.prim.id.qual#nt:nested-name-specifier' title='7.5.4.3&emsp;Qualified names&emsp;[expr.prim.id.qual]'><span id='ntref:nested-name-specifier'><span class='textsf'><i >nested-name-specifier</i></span></span></a> of a
<a href='expr.prim.id.qual#nt:qualified-id' title='7.5.4.3&emsp;Qualified names&emsp;[expr.prim.id.qual]'><span id='ntref:qualified-id'><span class='textsf'><i >qualified-id</i></span></span></a> when
that type does not contain the specified member, or
<ul class='itemize'><li id='11.4.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#11.4.1'>(11.4.1)</a></div>the specified member is not a type where a type is required, or</li><li id='11.4.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#11.4.2'>(11.4.2)</a></div>the specified member is not a template where a template is required, or</li><li id='11.4.3'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#11.4.3'>(11.4.3)</a></div>the specified member is not a non-type where a non-type is required<a class='hidden_link' href='#11.4.sentence-1'>.</a></li></ul></div> <div id='example-11' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-11'>11</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>int</span> I<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> X <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Z <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>typename</span> T<span class='operator'>::</span>Y<span class='operator'>*</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span>X<span class='anglebracket'>&lt;</span>T<span class='operator'>::</span>N<span class='anglebracket'>&gt;</span><span class='operator'>*</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> h<span class='parenthesis'>(</span>Z<span class='anglebracket'>&lt;</span>T<span class='operator'>::</span>TT<span class='anglebracket'>&gt;</span><span class='operator'>*</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span> <span class='keyword'>int</span> Y; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> C <span class='curlybracket'>{</span>
  <span class='keyword'>typedef</span> <span class='keyword'>int</span> N;
<span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> D <span class='curlybracket'>{</span>
  <span class='keyword'>typedef</span> <span class='keyword'>int</span> TT;
<span class='curlybracket'>}</span>;

<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='comment'>// Deduction fails in each of these cases:</span>
  f<span class='anglebracket'>&lt;</span>A<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;          <span class='comment'>// <span class='tcode_in_codeblock'>A</span> does not contain a member <span class='tcode_in_codeblock'>Y</span></span>
  f<span class='anglebracket'>&lt;</span>B<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;          <span class='comment'>// The <span class='tcode_in_codeblock'>Y</span> member of <span class='tcode_in_codeblock'>B</span> is not a type</span>
  g<span class='anglebracket'>&lt;</span>C<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;          <span class='comment'>// The <span class='tcode_in_codeblock'>N</span> member of <span class='tcode_in_codeblock'>C</span> is not a non-type</span>
  h<span class='anglebracket'>&lt;</span>D<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;          <span class='comment'>// The <span class='tcode_in_codeblock'>TT</span> member of <span class='tcode_in_codeblock'>D</span> is not a template</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='11.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.5'>(11.5)</a></div><div class='texpara'><div id='11.5.sentence-1' class='sentence'>Attempting to create a pointer to reference type<a class='hidden_link' href='#11.5.sentence-1'>.</a></div></div></li><li id='11.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.6'>(11.6)</a></div><div class='texpara'><div id='11.6.sentence-1' class='sentence'>Attempting to create a reference to <span id=':void__'><span class='texttt'><span class='keyword'>void</span></span></span><a class='hidden_link' href='#11.6.sentence-1'>.</a></div></div></li><li id='11.7'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.7'>(11.7)</a></div><div class='texpara'><div id='11.7.sentence-1' class='sentence'>Attempting to create “pointer to member of <span class='texttt'>T</span>” when <span class='texttt'>T</span> is not a
class type<a class='hidden_link' href='#11.7.sentence-1'>.</a></div> <div id='example-12' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-12'>12</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span> T<span class='operator'>::</span><span class='operator'>*</span><span class='parenthesis'>)</span>;
<span class='keyword'>int</span> i <span class='operator'>=</span> f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='11.8'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.8'>(11.8)</a></div><div class='texpara'><div id='11.8.sentence-1' class='sentence'>Attempting to give an invalid type to a non-type template parameter<a class='hidden_link' href='#11.8.sentence-1'>.</a></div> <div id='example-13' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-13'>13</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> S <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span>S<span class='anglebracket'>&lt;</span>T, T<span class='curlybracket'>{</span><span class='curlybracket'>}</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span><span class='parenthesis'>)</span>;   <span class='comment'>// #1</span>
<span class='keyword'>class</span> X <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> m;
<span class='curlybracket'>}</span>;
<span class='keyword'>int</span> i0 <span class='operator'>=</span> f<span class='anglebracket'>&lt;</span>X<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;   <span class='comment'>// #1 uses a value of non-structural type <span class='tcode_in_codeblock'>X</span> as a non-type template argument</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='11.9'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.9'>(11.9)</a></div><div class='texpara'><div id='11.9.sentence-1' class='sentence'>Attempting to perform an invalid conversion in either a template
argument expression, or an expression used in the function
declaration<a class='hidden_link' href='#11.9.sentence-1'>.</a></div> <div id='example-14' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-14'>14</a></i>: <span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, T<span class='operator'>*</span><span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
<span class='keyword'>int</span> i2 <span class='operator'>=</span> f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>,<span class='literal'>1</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;           <span class='comment'>// can't convert <span class='tcode_in_codeblock'>1</span> to <span class='tcode_in_codeblock'>int*</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='11.10'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#11.10'>(11.10)</a></div><div class='texpara'><div id='11.10.sentence-1' class='sentence'>Attempting to create a function type in which a parameter has a type
of <span id=':void___'><span class='texttt'><span class='keyword'>void</span></span></span>, or in which the return type is a function type
or array type<a class='hidden_link' href='#11.10.sentence-1'>.</a></div></div></li></ul></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/a4b1ffd9e65188ae19c29dffd2db42cb1558cee2/source/templates.tex#L7359'>#</a></div><div class='texpara'><div id='example-15' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-15'>15</a></i>: <div id='12.sentence-1' class='sentence'>In the following example,
assuming a <span class='texttt'><span class='keyword'>signed</span> <span class='keyword'>char</span></span>
cannot represent the value 1000,
a <a href='dcl.init.list#def:conversion,narrowing' title='9.4.5&emsp;List-initialization&emsp;[dcl.init.list]'>narrowing conversion</a>
would be required
to convert the <a href='temp.names#nt:template-argument' title='13.3&emsp;Names of template specializations&emsp;[temp.names]'><span id='ntref:template-argument_'><span class='textsf'><i >template-argument</i></span></span></a>
of type <span class='texttt'><span class='keyword'>int</span></span> to <span class='texttt'><span class='keyword'>signed</span> <span class='keyword'>char</span></span>,
therefore substitution fails for the
second template (<a href='temp.arg.nontype' title='13.4.3&emsp;Template non-type arguments'>[temp.<span class='shy'></span>arg.<span class='shy'></span>nontype]</a>)<a class='hidden_link' href='#12.sentence-1'>.</a></div></div><div class='texpara'><span class='codeblock'><span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>signed</span> <span class='keyword'>char</span><span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
<span class='keyword'>int</span> i1 <span class='operator'>=</span> f<span class='anglebracket'>&lt;</span><span class='literal'>1000</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;            <span class='comment'>// OK</span>
<span class='keyword'>int</span> i2 <span class='operator'>=</span> f<span class='anglebracket'>&lt;</span><span class='literal'>1</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;               <span class='comment'>// ambiguous; not narrowing</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div></div></body></html>