<!DOCTYPE html><html lang='en'><head><title>[expr.typeid]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>7</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>7.6</a> Compound expressions <a class='abbr_ref' href='expr.compound#expr.typeid'>[expr.compound]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>7.6.1</a> Postfix expressions <a class='abbr_ref' href='expr.post#expr.typeid'>[expr.post]</a></h3><h4 ><a class='secnum' style='min-width:95pt'>7.6.1.8</a> Type identification <a class='abbr_ref'>[expr.typeid]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/expressions.tex#L3597'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'><a class='index' id=':expression,type_identification'></a>The result of a <span id=':typeid'><span class='texttt'><span class='keyword'>typeid</span></span></span> expression is an lvalue of static type
<a class='index' id=':type_info'></a><a class='index' id='lib:type_info'></a><span class='texttt'><span class='keyword'>const</span></span> <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span> (<a href='type.info' title='17.7.3&emsp;Class type_&shy;info'>[type.<span class='shy'></span>info]</a>) and dynamic type <span class='texttt'><span class='keyword'>const</span></span>
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span> or <span class='texttt'><span class='keyword'>const</span></span> <i >name</i> where <i >name</i> is an
<a class='index' id=':derived_type_for_typeid'></a>implementation-defined class publicly derived from
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span> which preserves the behavior described
in <a href='type.info' title='17.7.3&emsp;Class type_&shy;info'>[type.<span class='shy'></span>info]</a><a class='hidden_link' href='#1.sentence-1'>.</a><a class='footnoteref' href='#footnote-59' id='footnoteref-59' title='The recommended name for such a class is extended_&shy;type_&shy;info.'>59</a></div> <div id='1.sentence-2' class='sentence'>
The lifetime of the object referred to by the lvalue extends to the end
of the program<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>Whether or not the destructor is called for the
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span> object at the end of the program is unspecified<a class='hidden_link' href='#1.sentence-3'>.</a></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/expressions.tex#L3615'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>When <span class='texttt'><span class='keyword'>typeid</span></span> is applied to a glvalue whose type is a
polymorphic class type (<a href='class.virtual' title='11.7.3&emsp;Virtual functions'>[class.<span class='shy'></span>virtual]</a>), the result refers to a
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span> object representing the type of the most derived
object (<a href='intro.object' title='6.7.2&emsp;Object model'>[intro.<span class='shy'></span>object]</a>) (that is, the dynamic type) to which the
glvalue refers<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>If the glvalue is obtained by applying the
unary <span class='texttt'><span class='operator'>*</span></span> operator to a pointer<a class='footnoteref' href='#footnote-60' id='footnoteref-60' title='If p is an expression of pointer type, then *p, (*p), *(p), ((*p)), *((p)), and so on all meet this requirement.'>60</a>
and the pointer is a null pointer value (<a href='basic.compound' title='6.8.3&emsp;Compound types'>[basic.<span class='shy'></span>compound]</a>), the
<span class='texttt'><span class='keyword'>typeid</span></span> expression throws an exception (<a href='except.throw' title='14.2&emsp;Throwing an exception'>[except.<span class='shy'></span>throw]</a>) of
a type that would match a handler of type
<a class='index' id=':bad_typeid'></a><a class='index' id='lib:bad_typeid'></a><span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>bad_&shy;typeid</span>
exception (<a href='bad.typeid' title='17.7.5&emsp;Class bad_&shy;typeid'>[bad.<span class='shy'></span>typeid]</a>)<a class='hidden_link' href='#2.sentence-2'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/expressions.tex#L3636'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>When <span class='texttt'><span class='keyword'>typeid</span></span> is applied to an expression other than a glvalue of
a polymorphic class type, the result refers to a <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span>
object representing the static type of the expression<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'><a href='conv.lval' title='7.3.2&emsp;Lvalue-to-rvalue conversion&emsp;[conv.lval]'>Lvalue-to-rvalue</a>, <a href='conv.array' title='7.3.3&emsp;Array-to-pointer conversion&emsp;[conv.array]'>array-to-pointer</a>,
and <a href='conv.func' title='7.3.4&emsp;Function-to-pointer conversion&emsp;[conv.func]'>function-to-pointer</a> conversions are not applied to
the expression<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.sentence-3' class='sentence'>If the expression is a prvalue,
the <a href='conv.rval' title='7.3.5&emsp;Temporary materialization conversion&emsp;[conv.rval]'>temporary materialization conversion</a>
is applied<a class='hidden_link' href='#3.sentence-3'>.</a></div> <div id='3.sentence-4' class='sentence'>The expression is an <a href='expr.prop#def:unevaluated_operand' title='7.2&emsp;Properties of expressions&emsp;[expr.prop]'>unevaluated operand</a><a class='hidden_link' href='#3.sentence-4'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/expressions.tex#L3648'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'>When <span class='texttt'><span class='keyword'>typeid</span></span> is applied to a <a href='dcl.name#nt:type-id' title='9.3.2&emsp;Type names&emsp;[dcl.name]'><span id='ntref:type-id'><span class='textsf'><i >type-id</i></span></span></a>, the result
refers to a <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span> object representing the type of the
<a href='dcl.name#nt:type-id' title='9.3.2&emsp;Type names&emsp;[dcl.name]'><span id='ntref:type-id_'><span class='textsf'><i >type-id</i></span></span></a><a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>If the type of the <a href='dcl.name#nt:type-id' title='9.3.2&emsp;Type names&emsp;[dcl.name]'><span id='ntref:type-id__'><span class='textsf'><i >type-id</i></span></span></a> is a reference
to a possibly cv-qualified type, the result of the
<span class='texttt'><span class='keyword'>typeid</span></span> expression refers to a <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span> object
representing the cv-unqualified referenced type<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>If the type of
the <a href='dcl.name#nt:type-id' title='9.3.2&emsp;Type names&emsp;[dcl.name]'><span id='ntref:type-id___'><span class='textsf'><i >type-id</i></span></span></a> is a class type or a reference to a class type,
the class shall be completely-defined<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>: <div id='4.sentence-4' class='sentence'>The <a href='dcl.name#nt:type-id' title='9.3.2&emsp;Type names&emsp;[dcl.name]'><span id='ntref:type-id____'><span class='textsf'><i >type-id</i></span></span></a> cannot denote a function type with
a <a href='dcl.decl.general#nt:cv-qualifier-seq' title='9.3.1&emsp;General&emsp;[dcl.decl.general]'><span id='ntref:cv-qualifier-seq'><span class='textsf'><i >cv-qualifier-seq</i></span></span></a> or a <a href='dcl.decl.general#nt:ref-qualifier' title='9.3.1&emsp;General&emsp;[dcl.decl.general]'><span id='ntref:ref-qualifier'><span class='textsf'><i >ref-qualifier</i></span></span></a> (<a href='dcl.fct' title='9.3.4.6&emsp;Functions'>[dcl.<span class='shy'></span>fct]</a>)<a class='hidden_link' href='#4.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/expressions.tex#L3662'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>If the type of the expression or <a href='dcl.name#nt:type-id' title='9.3.2&emsp;Type names&emsp;[dcl.name]'><span id='ntref:type-id_____'><span class='textsf'><i >type-id</i></span></span></a> is a
cv-qualified type, the result of the <span class='texttt'><span class='keyword'>typeid</span></span> expression refers
to a <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>type_&shy;info</span> object representing the cv-unqualified
type<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>: <span class='codeblock'><span class='keyword'>class</span> D <span class='curlybracket'>{</span> <span class='comment'>/* ... */</span> <span class='curlybracket'>}</span>;
D d1;
<span class='keyword'>const</span> D d2;

<span class='keyword'>typeid</span><span class='parenthesis'>(</span>d1<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='keyword'>typeid</span><span class='parenthesis'>(</span>d2<span class='parenthesis'>)</span>;       <span class='comment'>// yields <span class='tcode_in_codeblock'>true</span></span>
<span class='keyword'>typeid</span><span class='parenthesis'>(</span>D<span class='parenthesis'>)</span>  <span class='operator'>=</span><span class='operator'>=</span> <span class='keyword'>typeid</span><span class='parenthesis'>(</span><span class='keyword'>const</span> D<span class='parenthesis'>)</span>;  <span class='comment'>// yields <span class='tcode_in_codeblock'>true</span></span>
<span class='keyword'>typeid</span><span class='parenthesis'>(</span>D<span class='parenthesis'>)</span>  <span class='operator'>=</span><span class='operator'>=</span> <span class='keyword'>typeid</span><span class='parenthesis'>(</span>d2<span class='parenthesis'>)</span>;       <span class='comment'>// yields <span class='tcode_in_codeblock'>true</span></span>
<span class='keyword'>typeid</span><span class='parenthesis'>(</span>D<span class='parenthesis'>)</span>  <span class='operator'>=</span><span class='operator'>=</span> <span class='keyword'>typeid</span><span class='parenthesis'>(</span><span class='keyword'>const</span> D<span class='operator'>&amp;</span><span class='parenthesis'>)</span>; <span class='comment'>// yields <span class='tcode_in_codeblock'>true</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/expressions.tex#L3680'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>If the header <a href='support.rtti.general#header:%3ctypeinfo%3e' title='17.7.1&emsp;General&emsp;[support.rtti.general]'><span id='headerref:<typeinfo>'><span class='texttt'>&lt;typeinfo&gt;</span></span></a>
is not imported or included prior
to a use of <span class='texttt'><span class='keyword'>typeid</span></span>, the program is ill-formed<a class='hidden_link' href='#6.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/expressions.tex#L3685'>#</a></div><div class='texpara'><div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>: <div id='7.sentence-1' class='sentence'>Subclause <a href='class.cdtor' title='11.9.5&emsp;Construction and destruction'>[class.<span class='shy'></span>cdtor]</a> describes the behavior of <span class='texttt'><span class='keyword'>typeid</span></span>
applied to an object under construction or destruction<a class='hidden_link' href='#7.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-59'><div class='texpara'><a class='footnotenum' href='#footnote-59'>59)</a><a class='footnoteBacklink' href='#footnoteref-59'>59)</a> <div id='footnote-59.sentence-1' class='sentence'>The recommended name for such a class is
<span class='texttt'>extended_&shy;type_&shy;info</span><a class='hidden_link' href='#footnote-59.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-60'><div class='texpara'><a class='footnotenum' href='#footnote-60'>60)</a><a class='footnoteBacklink' href='#footnoteref-60'>60)</a> <div id='footnote-60.sentence-1' class='sentence'>If <span class='texttt'>p</span> is an expression of
pointer type, then <span class='texttt'><span class='operator'>*</span>p</span>,
<span class='texttt'><span class='parenthesis'>(</span><span class='operator'>*</span>p<span class='parenthesis'>)</span></span>, <span class='texttt'><span class='operator'>*</span><span class='parenthesis'>(</span>p<span class='parenthesis'>)</span></span>, <span class='texttt'><span class='parenthesis'>(</span><span class='parenthesis'>(</span><span class='operator'>*</span>p<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span>, <span class='texttt'><span class='operator'>*</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span>p<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span>, and so on
all meet this requirement<a class='hidden_link' href='#footnote-60.sentence-1'>.</a></div></div></div></div></body></html>