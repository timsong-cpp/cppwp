<!DOCTYPE html><html lang='en'><head><title>[depr.locale.stdcvt]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='annexnum' style='min-width:50pt'>Annex D&emsp;(normative)</a> Compatibility features <a class='abbr_ref' href='./#depr'>[depr]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>D.21</a> Deprecated standard code conversion facets <a class='abbr_ref'>[depr.locale.stdcvt]</a></h2><div id='general' class='section'><h3 ><a class='secnum' href='#general' style='min-width:80pt'>D.21.1</a> General <a class='abbr_ref' href='depr.locale.stdcvt.general'>[depr.locale.stdcvt.general]</a></h3><div class='para' id='general-1'><div class='marginalizedparent'><a class='marginalized' href='#general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/2c6009b1c756eb2e0391e9460d8f70b29015cc9c/source/future.tex#L2028'>#</a></div><div class='texpara'><div id='general-1.sentence-1' class='sentence'>The header <span id='header:<codecvt>'><span id=':<codecvt>'><span class='texttt'><span class='anglebracket'>&lt;</span>codecvt<span class='anglebracket'>&gt;</span></span></span></span> provides
code conversion facets for various character encodings<a class='hidden_link' href='#general-1.sentence-1'>.</a></div></div></div></div><div id='depr.codecvt.syn' class='section'><h3 ><a class='secnum' href='#depr.codecvt.syn' style='min-width:80pt'>D.21.2</a> Header <span class='texttt'>&lt;codecvt&gt;</span> synopsis <a class='abbr_ref' href='depr.codecvt.syn'>[depr.codecvt.syn]</a></h3><div class='texpara'><span id='lib:codecvt_utf8_utf16'><span id='lib:codecvt_utf16'><span id='lib:codecvt_utf8'><span id='lib:codecvt_mode'><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>enum</span> codecvt_mode <span class='curlybracket'>{</span>
    consume_header <span class='operator'>=</span> <span class='literal'>4</span>,
    generate_header <span class='operator'>=</span> <span class='literal'>2</span>,
    little_endian <span class='operator'>=</span> <span class='literal'>1</span>
  <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Elem, <span class='keyword'>unsigned</span> <span class='keyword'>long</span> Maxcode <span class='operator'>=</span> <span class='literal'>0x10ffff</span>, codecvt_mode Mode <span class='operator'>=</span> <span class='parenthesis'>(</span>codecvt_mode<span class='parenthesis'>)</span><span class='literal'>0</span><span class='anglebracket'>&gt;</span>
    <span class='keyword'>class</span> codecvt_utf8 <span class='operator'>:</span> <span class='keyword'>public</span> codecvt<span class='anglebracket'>&lt;</span>Elem, <span class='keyword'>char</span>, mbstate_t<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
    <span class='keyword'>public</span><span class='operator'>:</span>
      <span class='keyword'>explicit</span> codecvt_utf8<span class='parenthesis'>(</span>size_t refs <span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;
      <span class='operator'>~</span>codecvt_utf8<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Elem, <span class='keyword'>unsigned</span> <span class='keyword'>long</span> Maxcode <span class='operator'>=</span> <span class='literal'>0x10ffff</span>, codecvt_mode Mode <span class='operator'>=</span> <span class='parenthesis'>(</span>codecvt_mode<span class='parenthesis'>)</span><span class='literal'>0</span><span class='anglebracket'>&gt;</span>
    <span class='keyword'>class</span> codecvt_utf16 <span class='operator'>:</span> <span class='keyword'>public</span> codecvt<span class='anglebracket'>&lt;</span>Elem, <span class='keyword'>char</span>, mbstate_t<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
    <span class='keyword'>public</span><span class='operator'>:</span>
      <span class='keyword'>explicit</span> codecvt_utf16<span class='parenthesis'>(</span>size_t refs <span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;
      <span class='operator'>~</span>codecvt_utf16<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Elem, <span class='keyword'>unsigned</span> <span class='keyword'>long</span> Maxcode <span class='operator'>=</span> <span class='literal'>0x10ffff</span>, codecvt_mode Mode <span class='operator'>=</span> <span class='parenthesis'>(</span>codecvt_mode<span class='parenthesis'>)</span><span class='literal'>0</span><span class='anglebracket'>&gt;</span>
    <span class='keyword'>class</span> codecvt_utf8_utf16 <span class='operator'>:</span> <span class='keyword'>public</span> codecvt<span class='anglebracket'>&lt;</span>Elem, <span class='keyword'>char</span>, mbstate_t<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
    <span class='keyword'>public</span><span class='operator'>:</span>
      <span class='keyword'>explicit</span> codecvt_utf8_utf16<span class='parenthesis'>(</span>size_t refs <span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;
      <span class='operator'>~</span>codecvt_utf8_utf16<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></span></span></span></div></div><div id='req' class='section'><h3 ><a class='secnum' href='#req' style='min-width:80pt'>D.21.3</a> Requirements <a class='abbr_ref' href='depr.locale.stdcvt.req'>[depr.locale.stdcvt.req]</a></h3><div class='para' id='req-1'><div class='marginalizedparent'><a class='marginalized' href='#req-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/2c6009b1c756eb2e0391e9460d8f70b29015cc9c/source/future.tex#L2071'>#</a></div><div class='texpara'><div id='req-1.sentence-1' class='sentence'>For each of the three code conversion facets <span class='texttt'>codecvt_&shy;utf8</span>,
<span class='texttt'>codecvt_&shy;utf16</span>, and <span class='texttt'>codecvt_&shy;utf8_&shy;utf16</span>:
<ul class='itemize'><li id='req-1.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-1.1'>(1.1)</a></div><div class='texpara'><div id='req-1.1.sentence-1' class='sentence'><span class='texttt'>Elem</span> is the wide-character type, such as
  <span class='texttt'><span class='keyword'>wchar_&shy;t</span></span>, <span class='texttt'><span class='keyword'>char16_&shy;t</span></span>, or <span class='texttt'><span class='keyword'>char32_&shy;t</span></span><a class='hidden_link' href='#req-1.1.sentence-1'>.</a></div></div></li><li id='req-1.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-1.2'>(1.2)</a></div><div class='texpara'><div id='req-1.2.sentence-1' class='sentence'><span class='texttt'>Maxcode</span> is the largest wide-character code that the facet
  will read or write without reporting a conversion error<a class='hidden_link' href='#req-1.2.sentence-1'>.</a></div></div></li><li id='req-1.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-1.3'>(1.3)</a></div><div class='texpara'><div id='req-1.3.sentence-1' class='sentence'>If <span class='texttt'><span class='parenthesis'>(</span>Mode <span class='operator'>&amp;</span> consume_&shy;header<span class='parenthesis'>)</span></span>, the facet shall consume an
  initial header sequence, if present, when reading a multibyte sequence
  to determine the endianness of the subsequent multibyte sequence to be read<a class='hidden_link' href='#req-1.3.sentence-1'>.</a></div></div></li><li id='req-1.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-1.4'>(1.4)</a></div><div class='texpara'><div id='req-1.4.sentence-1' class='sentence'>If <span class='texttt'><span class='parenthesis'>(</span>Mode <span class='operator'>&amp;</span> generate_&shy;header<span class='parenthesis'>)</span></span>, the facet shall generate an
  initial header sequence when writing a multibyte sequence to advertise
  the endianness of the subsequent multibyte sequence to be written<a class='hidden_link' href='#req-1.4.sentence-1'>.</a></div></div></li><li id='req-1.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-1.5'>(1.5)</a></div><div class='texpara'><div id='req-1.5.sentence-1' class='sentence'>If <span class='texttt'><span class='parenthesis'>(</span>Mode <span class='operator'>&amp;</span> little_&shy;endian<span class='parenthesis'>)</span></span>, the facet shall generate a
  multibyte sequence in little-endian order,
  as opposed to the default big-endian order<a class='hidden_link' href='#req-1.5.sentence-1'>.</a></div></div></li></ul></div></div></div><div class='para' id='req-2'><div class='marginalizedparent'><a class='marginalized' href='#req-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/2c6009b1c756eb2e0391e9460d8f70b29015cc9c/source/future.tex#L2095'>#</a></div><div class='texpara'><div id='req-2.sentence-1' class='sentence'>For the facet <span class='texttt'>codecvt_&shy;utf8</span><a class='index' id='lib:codecvt_utf8_'></a>:
<ul class='itemize'><li id='req-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-2.1'>(2.1)</a></div><div class='texpara'><div id='req-2.1.sentence-1' class='sentence'>The facet shall convert between UTF-8 multibyte sequences
  and UCS-2 or UTF-32 (depending on the size of <span class='texttt'>Elem</span>)
  within the program<a class='hidden_link' href='#req-2.1.sentence-1'>.</a></div></div></li><li id='req-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-2.2'>(2.2)</a></div><div class='texpara'><div id='req-2.2.sentence-1' class='sentence'>Endianness shall not affect how multibyte sequences are read or written<a class='hidden_link' href='#req-2.2.sentence-1'>.</a></div></div></li><li id='req-2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-2.3'>(2.3)</a></div><div class='texpara'><div id='req-2.3.sentence-1' class='sentence'>The multibyte sequences may be written as either a text or a binary file<a class='hidden_link' href='#req-2.3.sentence-1'>.</a></div></div></li></ul></div></div></div><div class='para' id='req-3'><div class='marginalizedparent'><a class='marginalized' href='#req-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/2c6009b1c756eb2e0391e9460d8f70b29015cc9c/source/future.tex#L2108'>#</a></div><div class='texpara'><div id='req-3.sentence-1' class='sentence'>For the facet <span class='texttt'>codecvt_&shy;utf16</span><a class='index' id='lib:codecvt_utf16_'></a>:
<ul class='itemize'><li id='req-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-3.1'>(3.1)</a></div><div class='texpara'><div id='req-3.1.sentence-1' class='sentence'>The facet shall convert between UTF-16 multibyte sequences
  and UCS-2 or UTF-32 (depending on the size of <span class='texttt'>Elem</span>)
  within the program<a class='hidden_link' href='#req-3.1.sentence-1'>.</a></div></div></li><li id='req-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-3.2'>(3.2)</a></div><div class='texpara'><div id='req-3.2.sentence-1' class='sentence'>Multibyte sequences shall be read or written
  according to the <span class='texttt'>Mode</span> flag, as set out above<a class='hidden_link' href='#req-3.2.sentence-1'>.</a></div></div></li><li id='req-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-3.3'>(3.3)</a></div><div class='texpara'><div id='req-3.3.sentence-1' class='sentence'>The multibyte sequences may be written only as a binary file<a class='hidden_link' href='#req-3.3.sentence-1'>.</a></div> <div id='req-3.3.sentence-2' class='sentence'>Attempting to write to a text file produces undefined behavior<a class='hidden_link' href='#req-3.3.sentence-2'>.</a></div></div></li></ul></div></div></div><div class='para' id='req-4'><div class='marginalizedparent'><a class='marginalized' href='#req-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/2c6009b1c756eb2e0391e9460d8f70b29015cc9c/source/future.tex#L2123'>#</a></div><div class='texpara'><div id='req-4.sentence-1' class='sentence'>For the facet <span class='texttt'>codecvt_&shy;utf8_&shy;utf16</span><a class='index' id='lib:codecvt_utf8_utf16_'></a>:
<ul class='itemize'><li id='req-4.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-4.1'>(4.1)</a></div><div class='texpara'><div id='req-4.1.sentence-1' class='sentence'>The facet shall convert between UTF-8 multibyte sequences
  and UTF-16 (one or two 16-bit codes) within the program<a class='hidden_link' href='#req-4.1.sentence-1'>.</a></div></div></li><li id='req-4.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-4.2'>(4.2)</a></div><div class='texpara'><div id='req-4.2.sentence-1' class='sentence'>Endianness shall not affect how multibyte sequences are read or written<a class='hidden_link' href='#req-4.2.sentence-1'>.</a></div></div></li><li id='req-4.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req-4.3'>(4.3)</a></div><div class='texpara'><div id='req-4.3.sentence-1' class='sentence'>The multibyte sequences may be written as either a text or a binary file<a class='hidden_link' href='#req-4.3.sentence-1'>.</a></div></div></li></ul></div></div></div><div class='para' id='req-5'><div class='marginalizedparent'><a class='marginalized' href='#req-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/2c6009b1c756eb2e0391e9460d8f70b29015cc9c/source/future.tex#L2135'>#</a></div><div class='texpara'><div id='req-5.sentence-1' class='sentence'>The encoding forms UTF-8, UTF-16, and UTF-32 are specified in ISO/IEC 10646<a class='hidden_link' href='#req-5.sentence-1'>.</a></div> <div id='req-5.sentence-2' class='sentence'>The encoding form UCS-2 is specified in ISO/IEC 10646:2003<a class='hidden_link' href='#req-5.sentence-2'>.</a><a class='footnotenum' href='#footnote-332' id='footnoteref-332' title='Cancelled and replaced by ISO/IEC 10646:2017.'>332</a></div></div></div><div class='footnote' id='footnote-332'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-332'>332)</a></div><div class='texpara'><div id='footnote-332.sentence-1' class='sentence'>Cancelled and replaced by ISO/IEC 10646:2017<a class='hidden_link' href='#footnote-332.sentence-1'>.</a></div>&nbsp;<a href='#footnoteref-332'>тое</a></div></div></div></div></body></html>