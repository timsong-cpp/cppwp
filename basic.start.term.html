<!DOCTYPE html><html lang='en'><head><title>[basic.start.term]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>6.10</a> Program execution <a class='abbr_ref' href='basic.exec#basic.start.term'>[basic.exec]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>6.10.3</a> Start and termination <a class='abbr_ref' href='basic.start#term'>[basic.start]</a></h3><h4 ><a class='secnum' style='min-width:95pt'>6.10.3.4</a> Termination <a class='abbr_ref'>[basic.start.term]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7530'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'><a class='index' id=':program,termination'></a><a class='index' id=':object,destructor_static'></a><a class='index' id=':main_function,return_from'></a>Constructed complete objects (<a href='dcl.init' title='9.5&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)
with static storage duration are destroyed
and functions registered with <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span>
are called as part of a call to
<a class='index' id=':exit'></a><a class='index' id='lib:exit'></a><span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> (<a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>)<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>The call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> is sequenced before
the destructions and the registered functions<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='1.sentence-3' class='sentence'>Returning from <span class='texttt'>main</span> invokes <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> (<a href='basic.start.main' title='6.10.3.1&emsp;main function'>[basic.<span class='shy'></span>start.<span class='shy'></span>main]</a>)<a class='hidden_link' href='#1.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7547'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>Constructed complete objects with thread storage duration within a given thread
are destroyed as a result of returning from the initial function of that thread and as a
result of that thread calling <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span><a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>The destruction of those constructed objects
is sequenced before releasing the storage for
any object with thread storage duration within that thread (<a href='basic.stc.thread' title='6.8.6.3&emsp;Thread storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>thread]</a>)<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>The destruction of those constructed objects
strongly happens before destroying
any object with static storage duration<a class='hidden_link' href='#2.sentence-3'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7558'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>The destruction of a complete object with thread storage duration within a given thread
and having constant destruction (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>)
is sequenced after the destruction of any other complete object
with thread storage duration within the thread<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>The destruction of a complete object with static storage duration
and having constant destruction
is sequenced after the destruction of any other complete object
with static storage duration
and after any call to a function passed to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span><a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.sentence-3' class='sentence'>The sequencing rules in the remainder of this subclause
apply only to complete objects not having constant destruction<a class='hidden_link' href='#3.sentence-3'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7571'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'>If the deemed construction (<a href='dcl.init.general' title='9.5.1&emsp;General'>[dcl.<span class='shy'></span>init.<span class='shy'></span>general]</a>) of a complete object with static
storage duration strongly happens before that of another, the completion of the destruction
of the second is sequenced before the initiation of the destruction of the first<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>If the deemed construction of a complete object with thread
storage duration is sequenced before that of another, the completion of the destruction
of the second is sequenced before the initiation of the destruction of the first<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>If an object is
initialized statically, the object is destroyed in the same order as if
the object was dynamically initialized<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'>If the destruction of an object with static or thread storage duration
exits via an exception,
the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> is called (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#4.sentence-4'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<div id='4.sentence-5' class='sentence'>In the following program,
the elements of <span class='texttt'>a</span> are destroyed,
followed by <span class='texttt'>dt</span>, and
finally by the two <span class='texttt'>Btemp</span> objects:
<span class='codeblock'><span class='keyword'>struct</span> DTemp <span class='curlybracket'>{</span> <span class='operator'>~</span>DTemp<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> Temp <span class='curlybracket'>{</span>
  <span class='operator'>~</span>Temp<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>static</span> DTemp dt;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> BTemp <span class='curlybracket'>{</span>
  <span class='operator'>~</span>BTemp<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> BTemp <span class='operator'>&amp;</span>tb;
  <span class='operator'>~</span>A<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
A a<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='parenthesis'>(</span>Temp<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, BTemp<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>, BTemp<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>}</span>;

<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
</span></div> <div id='4.sentence-6' class='sentence'>
If the array <span class='texttt'>a</span> were an object with automatic storage duration,
the <span class='texttt'>Btemp</span> temporaries would be destroyed
as each element of the array is destroyed (<a href='class.temporary' title='6.8.7&emsp;Temporary objects'>[class.<span class='shy'></span>temporary]</a>)<a class='hidden_link' href='#4.sentence-6'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7612'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>If a function contains a block variable of static or thread storage duration that has been
destroyed and the function is called during the destruction of an object with static or
thread storage duration, the program has undefined behavior if the flow of control
passes through the definition of the previously destroyed block variable<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='5.sentence-2' class='sentence'>Likewise, the behavior is undefined
if the block variable is used indirectly (e.g., through a pointer)
after its destruction<a class='hidden_link' href='#5.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7623'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'><a class='index' id=':atexit'></a><a class='index' id='lib:atexit'></a>If the deemed construction of a complete object with static storage
duration strongly happens before a call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> (see
<a href='cstdlib.syn#header:%3ccstdlib%3e' title='17.2.2&emsp;Header &lt;cstdlib&gt; synopsis&emsp;[cstdlib.syn]'><span id='headerref:<cstdlib>'><span class='texttt'>&lt;cstdlib&gt;</span></span></a>, <a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>), the call to the function passed to
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> is sequenced before the initiation of the destruction of the object<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>If a call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> strongly happens before the deemed construction of
a complete object with static storage duration,
the completion of the destruction of the
object is sequenced before the call to the function passed to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span><a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.sentence-3' class='sentence'>If a
call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> strongly happens before another call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span>, the
call to the function passed to the second <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> call is sequenced before
the call to the function passed to the first <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> call<a class='hidden_link' href='#6.sentence-3'>.</a></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7638'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'>If there is a use of a standard library object or function not permitted within signal
handlers (<a href='support.runtime' title='17.14&emsp;Other runtime support'>[support.<span class='shy'></span>runtime]</a>) that does not happen before (<a href='intro.multithread' title='6.10.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)
completion of destruction of objects with static storage duration and execution of
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> registered functions (<a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>), the program has
undefined behavior<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>:&ensp;<div id='7.sentence-2' class='sentence'>If there is a use of an object with static storage
duration that does not happen before the object's destruction, the program has undefined
behavior<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>Terminating every thread before a call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> or the exit from
<span class='texttt'>main</span> is sufficient, but not necessary, to satisfy these requirements<a class='hidden_link' href='#7.sentence-3'>.</a></div> <div id='7.sentence-4' class='sentence'>These
requirements permit thread managers as static-storage-duration objects<a class='hidden_link' href='#7.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7652'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'><a class='index' id=':abort'></a><a class='index' id='lib:abort'></a><a class='index' id=':termination,program'></a>Calling the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>abort<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> declared in
<a href='cstdlib.syn#header:%3ccstdlib%3e' title='17.2.2&emsp;Header &lt;cstdlib&gt; synopsis&emsp;[cstdlib.syn]'><span id='headerref:<cstdlib>_'><span class='texttt'>&lt;cstdlib&gt;</span></span></a> terminates the program without executing any destructors
and without calling
the functions passed to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>at_<span class='shy'></span>quick_<span class='shy'></span>exit<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#8.sentence-1'>.</a></div> 
</div></div></div></body></html>