<!DOCTYPE html><html lang='en'><head><title>[class.union]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>11</a> Classes <a class='abbr_ref' href='./#class'>[class]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>11.5</a> Unions <a class='abbr_ref'>[class.union]</a></h2><span class='indexparent'><a class='index' id=':union'></a></span><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3107'>#</a></div><div id='1.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:union' id='def:union'><i >union</i></a> is a class defined with the <a class='grammarterm' href='class.pre#nt:class-key'>class-key</a>
<span class='texttt'><span class='keyword'>union</span></span><a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3111'>#</a></div><div id='2.sentence-1' class='sentence'>In a union,
a non-static data member is <a class='hidden_link' href='#def:active,union_member' id='def:active,union_member'><i >active</i></a>
if its name refers to an object
whose lifetime has begun and has not ended (<a href='basic.life'>[basic.life]</a>)<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>At most one of the non-static data members of an object of union type
can be active at any
time, that is, the value of at most one of the non-static data members can be
stored in a union at any time<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.note-1' class='note'>[&nbsp;<a class='note_link' href='#2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-3' class='sentence'>One special guarantee is made in order to
simplify the use of unions: If a standard-layout union contains several standard-layout
structs that share a common initial sequence (<a href='class.mem'>[class.mem]</a>), and
if a non-static data member of an object of this standard-layout union type
is active and is one of the standard-layout structs,
it is permitted to inspect the common initial sequence
of any of the standard-layout struct members;
see <a href='class.mem'>[class.mem]</a><a class='hidden_link' href='#2.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3131'>#</a></div><div id='3.sentence-1' class='sentence'>The size of a union is sufficient to contain the largest
of its non-static data members<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>Each non-static data member is allocated
as if it were the sole member of a non-union class<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.note-1' class='note'>[&nbsp;<a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-3' class='sentence'>A union object and its non-static data members are
pointer-interconvertible (<a href='basic.compound'>[basic.compound]</a>, <a href='expr.static.cast'>[expr.static.cast]</a>)<a class='hidden_link' href='#3.sentence-3'>.</a></div> <div id='3.sentence-4' class='sentence'>As a consequence, all non-static data members of a
union object have the same address<a class='hidden_link' href='#3.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3142'>#</a></div><div id='4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':member_function,union'></a></span><span class='indexparent'><a class='index' id=':constructor,union'></a></span><span class='indexparent'><a class='index' id=':destructor,union'></a></span>A union can have member functions (including constructors and destructors),
<span class='indexparent'><a class='index' id=':restriction,union'></a></span>but it shall not have virtual (<a href='class.virtual'>[class.virtual]</a>) functions<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>A union shall not have
base classes<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>A union shall not be used as a base class<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':restriction,union_'></a></span>If a union contains a non-static data member of
reference type the program is ill-formed<a class='hidden_link' href='#4.sentence-4'>.</a></div> <div id='4.note-1' class='note'>[&nbsp;<a class='note_link' href='#4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='4.sentence-5' class='sentence'>Absent default member initializers (<a href='class.mem'>[class.mem]</a>),
if any non-static data member of a union has a non-trivial
default constructor (<a href='class.default.ctor'>[class.default.ctor]</a>),
copy constructor, move constructor (<a href='class.copy.ctor'>[class.copy.ctor]</a>),
copy assignment operator, move assignment operator (<a href='class.copy.assign'>[class.copy.assign]</a>),
or destructor (<a href='class.dtor'>[class.dtor]</a>), the corresponding member function
of the union must be user-provided or it will
be implicitly deleted (<a href='dcl.fct.def.delete'>[dcl.fct.def.delete]</a>) for the union<a class='hidden_link' href='#4.sentence-5'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3164'>#</a></div><div id='5.example-1' class='example'>[&nbsp;<a class='example_link' href='#5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='5.sentence-1' class='sentence'>Consider the following union:</div><pre class='codeblock'>
<span class='keyword'>union</span> U <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i;
  <span class='keyword'>float</span> f;
  std<span class='operator'>::</span>string s;
<span class='curlybracket'>}</span>;
</pre><div id='5.sentence-2' class='sentence'>Since <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>string</span> (<a href='string.classes'>[string.classes]</a>) declares non-trivial versions of all of the special
member functions, <span class='texttt'>U</span> will have an implicitly deleted default constructor,
copy/move constructor,
copy/move assignment operator, and destructor<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>To use <span class='texttt'>U</span>, some or all of these member functions
must be user-provided<a class='hidden_link' href='#5.sentence-3'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3184'>#</a></div><div id='6.sentence-1' class='sentence'>When the left operand of an assignment operator
involves a member access expression (<a href='expr.ref'>[expr.ref]</a>)
that nominates a union member,
it may begin the lifetime of that union member,
as described below<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>For an expression <span class='texttt'>E</span>,
define the set <span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>E</span>)</span>
of subexpressions of <span class='texttt'>E</span>
as follows:
<ul class='itemize'><li id='6.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#6.1'>(6.1)</a></div>If <span class='texttt'>E</span> is of the form <span class='texttt'>A<span class='operator'>.</span>B</span>,
<span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>E</span>)</span> contains the elements of <span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>A</span>)</span>,
and also contains <span class='texttt'>A<span class='operator'>.</span>B</span>
if <span class='texttt'>B</span> names a union member of a non-class, non-array type,
or of a class type with a trivial default constructor that is not deleted,
or an array of such types.</li><li id='6.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#6.2'>(6.2)</a></div>If <span class='texttt'>E</span> is of the form <span class='texttt'>A<span class='squarebracket'>[</span>B<span class='squarebracket'>]</span></span>
and is interpreted as a built-in array subscripting operator,
<span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>E</span>)</span> is <span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>A</span>)</span> if <span class='texttt'>A</span> is of array type,
<span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>B</span>)</span> if <span class='texttt'>B</span> is of array type,
and empty otherwise.</li><li id='6.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#6.3'>(6.3)</a></div>Otherwise, <span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>E</span>)</span> is empty.</li></ul></div> <div id='6.sentence-3' class='sentence'>
In an assignment expression of the form <span class='texttt'>E1 <span class='operator'>=</span> E2</span>
that uses either the built-in assignment operator (<a href='expr.ass'>[expr.ass]</a>)
or a trivial assignment operator (<a href='class.copy.assign'>[class.copy.assign]</a>),
for each element <span class='texttt'>X</span> of <span class='math'><span class='mathalpha'>S</span>(</span><span class='texttt'>E1</span><span class='math'>)</span>,
if modification of <span class='texttt'>X</span> would have undefined behavior under <a href='basic.life'>[basic.life]</a>,
an object of the type of <span class='texttt'>X</span> is implicitly created
in the nominated storage;
no initialization is performed and
the beginning of its lifetime is sequenced after
the value computation of the left and right operands
and before the assignment<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='6.note-1' class='note'>[&nbsp;<a class='note_link' href='#6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='6.sentence-4' class='sentence'>This ends the lifetime of the previously-active
member of the union, if any (<a href='basic.life'>[basic.life]</a>)<a class='hidden_link' href='#6.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='6.example-1' class='example'>[&nbsp;<a class='example_link' href='#6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>union</span> A <span class='curlybracket'>{</span> <span class='keyword'>int</span> x; <span class='keyword'>int</span> y<span class='squarebracket'>[</span><span class='literal'>4</span><span class='squarebracket'>]</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span> A a; <span class='curlybracket'>}</span>;
<span class='keyword'>union</span> C <span class='curlybracket'>{</span> B b; <span class='keyword'>int</span> k; <span class='curlybracket'>}</span>;
<span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  C c;                  <span class='comment'>// does not start lifetime of any union member</span>
  c<span class='operator'>.</span>b<span class='operator'>.</span>a<span class='operator'>.</span>y<span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='literal'>4</span>;       <span class='comment'>// OK: <span class='math'><span class='mathalpha'>S</span>(</span><span class='tcode_in_codeblock'>c.b.a.y[3]</span><span class='math'>)</span> contains <span class='tcode_in_codeblock'>c.b</span> and <span class='tcode_in_codeblock'>c.b.a.y</span>;</span>
                        <span class='comment'>// creates objects to hold union members <span class='tcode_in_codeblock'>c.b</span> and <span class='tcode_in_codeblock'>c.b.a.y</span></span>
  <span class='keyword'>return</span> c<span class='operator'>.</span>b<span class='operator'>.</span>a<span class='operator'>.</span>y<span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span>;    <span class='comment'>// OK: <span class='tcode_in_codeblock'>c.b.a.y</span> refers to newly created object (see <a href='basic.life'>[basic.life]</a>)</span>
<span class='curlybracket'>}</span>

<span class='keyword'>struct</span> X <span class='curlybracket'>{</span> <span class='keyword'>const</span> <span class='keyword'>int</span> a; <span class='keyword'>int</span> b; <span class='curlybracket'>}</span>;
<span class='keyword'>union</span> Y <span class='curlybracket'>{</span> X x; <span class='keyword'>int</span> k; <span class='curlybracket'>}</span>;
<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  Y y <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='curlybracket'>{</span> <span class='literal'>1</span>, <span class='literal'>2</span> <span class='curlybracket'>}</span> <span class='curlybracket'>}</span>;   <span class='comment'>// OK, <span class='tcode_in_codeblock'>y.x</span> is active union member (<a href='class.mem'>[class.mem]</a>)</span>
  <span class='keyword'>int</span> n <span class='operator'>=</span> y<span class='operator'>.</span>x<span class='operator'>.</span>a;
  y<span class='operator'>.</span>k <span class='operator'>=</span> <span class='literal'>4</span>;              <span class='comment'>// OK: ends lifetime of <span class='tcode_in_codeblock'>y.x</span>, <span class='tcode_in_codeblock'>y.k</span> is active member of union</span>
  y<span class='operator'>.</span>x<span class='operator'>.</span>b <span class='operator'>=</span> n;            <span class='comment'>// undefined behavior: <span class='tcode_in_codeblock'>y.x.b</span> modified outside its lifetime,</span>
                        <span class='comment'>// <span class='math'><span class='mathalpha'>S</span>(</span><span class='tcode_in_codeblock'>y.x.b</span><span class='math'>)</span> is empty because <span class='tcode_in_codeblock'>X</span>'s default constructor is deleted,</span>
                        <span class='comment'>// so union member <span class='tcode_in_codeblock'>y.x</span>'s lifetime does not implicitly start</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3251'>#</a></div><div id='7.note-1' class='note'>[&nbsp;<a class='note_link' href='#7.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='7.sentence-1' class='sentence'>In general, one must use explicit destructor calls and placement
<a class='grammarterm' href='expr.new#nt:new-expression'>new-expression</a> to change the active member of a union<a class='hidden_link' href='#7.sentence-1'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='7.example-1' class='example'>[&nbsp;<a class='example_link' href='#7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='7.sentence-2' class='sentence'>Consider an object <span class='texttt'>u</span> of a <span class='texttt'><span class='keyword'>union</span></span> type <span class='texttt'>U</span> having non-static data members
<span class='texttt'>m</span> of type <span class='texttt'>M</span> and <span class='texttt'>n</span> of type <span class='texttt'>N</span><a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>If <span class='texttt'>M</span> has a non-trivial
destructor and <span class='texttt'>N</span> has a non-trivial constructor (for instance, if they declare or inherit
virtual functions), the active member of <span class='texttt'>u</span> can be safely switched from <span class='texttt'>m</span> to
<span class='texttt'>n</span> using the destructor and placement <a class='grammarterm' href='expr.new#nt:new-expression'>new-expression</a> as follows:</div><pre class='codeblock'>
u<span class='operator'>.</span>m<span class='operator'>.</span><span class='operator'>~</span>M<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>new</span> <span class='parenthesis'>(</span><span class='operator'>&amp;</span>u<span class='operator'>.</span>n<span class='parenthesis'>)</span> N;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div id='anon' class='section'><h3 ><a class='secnum' href='#anon' style='min-width:103pt'>11.5.1</a> Anonymous unions <a class='abbr_ref' href='class.union.anon'>[class.union.anon]</a></h3><span class='indexparent'><a class='index' id=':union,anonymous'></a></span><div class='para' id='anon-1'><div class='marginalizedparent'><a class='marginalized' href='#anon-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3272'>#</a></div><div id='anon-1.sentence-1' class='sentence'>A union of the form
<pre class='ncsimplebnf'><span class='texttt'><span class='keyword'>union</span></span><span class='indexparent'><a class='index' id=':union_'></a></span> <span class='terminal'><span class='curlybracket'>{</span></span> <a class='grammarterm' href='class.mem#nt:member-specification'>member-specification</a> <span class='terminal'><span class='curlybracket'>}</span></span> <span class='terminal'>;</span>
</pre>
is called an <a class='hidden_link' href='#def:anonymous_union' id='def:anonymous_union'><i >anonymous union</i></a>; it defines an unnamed type and
an unnamed object of that type called an <a class='hidden_link' href='#def:anonymous_union_object' id='def:anonymous_union_object'><i >anonymous union object</i></a><a class='hidden_link' href='#anon-1.sentence-1'>.</a></div> <div id='anon-1.sentence-2' class='sentence'>Each <a class='grammarterm' href='class.mem#nt:member-declaration'>member-declaration</a> in the <a class='grammarterm' href='class.mem#nt:member-specification'>member-specification</a>
of an anonymous union shall either define a non-static data member or be a
<a class='grammarterm' href='dcl.pre#nt:static_assert-declaration'>static_assert-declaration</a><a class='hidden_link' href='#anon-1.sentence-2'>.</a></div> <div id='anon-1.sentence-3' class='sentence'>Nested types, anonymous unions, and functions
shall not be declared within an anonymous union<a class='hidden_link' href='#anon-1.sentence-3'>.</a></div> <div id='anon-1.sentence-4' class='sentence'>The names of the members of an anonymous union shall be distinct from
the names of any other entity in the scope in which the anonymous union
is declared<a class='hidden_link' href='#anon-1.sentence-4'>.</a></div> <div id='anon-1.sentence-5' class='sentence'>For the purpose of name lookup, after the anonymous union
definition, the members of the anonymous union are considered to have
been defined in the scope in which the anonymous union is declared<a class='hidden_link' href='#anon-1.sentence-5'>.</a></div> <span class='indexparent'><a class='index' id=':initialization,union'></a></span><div id='anon-1.example-1' class='example'>[&nbsp;<a class='example_link' href='#anon-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>union</span> <span class='curlybracket'>{</span> <span class='keyword'>int</span> a; <span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span>;
  a <span class='operator'>=</span> <span class='literal'>1</span>;
  p <span class='operator'>=</span> <span class='literal'>"Jennifer"</span>;
<span class='curlybracket'>}</span>
</pre><div id='anon-1.sentence-6' class='sentence'>Here <span class='texttt'>a</span> and <span class='texttt'>p</span> are used like ordinary (non-member)
variables, but since they are union members they have the same address<a class='hidden_link' href='#anon-1.sentence-6'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='anon-2'><div class='marginalizedparent'><a class='marginalized' href='#anon-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3303'>#</a></div><div id='anon-2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':union,global_anonymous'></a></span><span class='indexparent'><a class='index' id=':scope,anonymous_union_at_namespace'></a></span>Anonymous unions declared in a named namespace or in the global
namespace shall be declared <span class='texttt'><span class='keyword'>static</span></span><a class='hidden_link' href='#anon-2.sentence-1'>.</a></div> <div id='anon-2.sentence-2' class='sentence'>Anonymous unions declared at
block scope shall be declared with any storage class allowed for a
block-scope variable, or with no storage class<a class='hidden_link' href='#anon-2.sentence-2'>.</a></div> <div id='anon-2.sentence-3' class='sentence'>A storage class is not
allowed in a declaration of an anonymous union in a class scope<a class='hidden_link' href='#anon-2.sentence-3'>.</a></div> <div id='anon-2.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':access_control,anonymous_union'></a></span><span class='indexparent'><a class='index' id=':restriction,anonymous_union'></a></span>An anonymous union shall not have private or protected
members (<a href='class.access'>[class.access]</a>)<a class='hidden_link' href='#anon-2.sentence-4'>.</a></div> <div id='anon-2.sentence-5' class='sentence'>An anonymous union shall not have
member functions<a class='hidden_link' href='#anon-2.sentence-5'>.</a></div></div><div class='para' id='anon-3'><div class='marginalizedparent'><a class='marginalized' href='#anon-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3317'>#</a></div><div id='anon-3.sentence-1' class='sentence'>A union for which objects, pointers, or references are declared is not an anonymous union<a class='hidden_link' href='#anon-3.sentence-1'>.</a></div> <div id='anon-3.example-1' class='example'>[&nbsp;<a class='example_link' href='#anon-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>union</span> <span class='curlybracket'>{</span> <span class='keyword'>int</span> aa; <span class='keyword'>char</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span> obj, <span class='operator'>*</span>ptr <span class='operator'>=</span> <span class='operator'>&amp;</span>obj;
  aa <span class='operator'>=</span> <span class='literal'>1</span>;           <span class='comment'>// error</span>
  ptr<span class='operator'>-</span><span class='anglebracket'>&gt;</span>aa <span class='operator'>=</span> <span class='literal'>1</span>;      <span class='comment'>// OK</span>
<span class='curlybracket'>}</span>
</pre><div id='anon-3.sentence-2' class='sentence'>The assignment to plain <span class='texttt'>aa</span> is ill-formed since the member name
is not visible outside the union, and even if it were visible, it is not
associated with any particular object<a class='hidden_link' href='#anon-3.sentence-2'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='anon-3.note-1' class='note'>[&nbsp;<a class='note_link' href='#anon-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='anon-3.sentence-3' class='sentence'>Initialization of unions with no user-declared constructors is described
in <a href='dcl.init.aggr'>[dcl.init.aggr]</a><a class='hidden_link' href='#anon-3.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='anon-4'><div class='marginalizedparent'><a class='marginalized' href='#anon-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0958eadbf361605099a5882737a689708f64118e/source/classes.tex#L3337'>#</a></div><div id='anon-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':class,union-like'></a></span><span class='indexparent'><a class='index' id=':class,variant_member_of'></a></span>A <a class='hidden_link' href='#def:union-like_class' id='def:union-like_class'><i >union-like class</i></a> is a union or a class that has an anonymous union as a direct
member<a class='hidden_link' href='#anon-4.sentence-1'>.</a></div> <div id='anon-4.sentence-2' class='sentence'>A union-like class <span class='texttt'>X</span> has a set of <a class='hidden_link' href='#def:variant_member' id='def:variant_member'><i >variant members</i></a><a class='hidden_link' href='#anon-4.sentence-2'>.</a></div> <div id='anon-4.sentence-3' class='sentence'>If <span class='texttt'>X</span> is a union, a non-static data member of <span class='texttt'>X</span> that is not an anonymous
union is a variant member of <span class='texttt'>X</span><a class='hidden_link' href='#anon-4.sentence-3'>.</a></div> <div id='anon-4.sentence-4' class='sentence'>In addition, a non-static data member of an
anonymous union that is a member of <span class='texttt'>X</span> is also a variant member of <span class='texttt'>X</span><a class='hidden_link' href='#anon-4.sentence-4'>.</a></div> <div id='anon-4.sentence-5' class='sentence'>At most one variant member of a union may have a default member initializer<a class='hidden_link' href='#anon-4.sentence-5'>.</a></div> <div id='anon-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#anon-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>union</span> U <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>0</span>;
  <span class='keyword'>union</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> k;
  <span class='curlybracket'>}</span>;
  <span class='keyword'>union</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> z;
    <span class='keyword'>int</span> y <span class='operator'>=</span> <span class='literal'>1</span>;      <span class='comment'>// error: initialization for second variant member of <span class='tcode_in_codeblock'>U</span></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div></div></body></html>