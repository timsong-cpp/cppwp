<!DOCTYPE html><html lang='en'><head><title>[class.union]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>11</a> Classes <a class='abbr_ref' href='./#class'>[class]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>11.5</a> Unions <a class='abbr_ref'>[class.union]</a></h2><div id='general' class='section'><h3 ><a class='secnum' href='#general' style='min-width:80pt'>11.5.1</a> General <a class='abbr_ref' href='class.union.general'>[class.union.general]</a></h3><div class='texpara'><a class='index' id=':union'></a></div><div class='para' id='general-1'><div class='marginalizedparent'><a class='marginalized' href='#general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3133'>#</a></div><div class='texpara'><div id='general-1.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:union' title='11.5.1&emsp;General&emsp;[class.union.general]'><span id='def:union'><i >union</i></span></a> is a class defined with the <a href='class.pre#nt:class-key' title='11.1&emsp;Preamble&emsp;[class.pre]'><span id='ntref:class-key'><span class='textsf'><i >class-key</i></span></span></a>
<span id=':union_'><span class='texttt'><span class='keyword'>union</span></span></span><a class='hidden_link' href='#general-1.sentence-1'>.</a></div></div></div><div class='para' id='general-2'><div class='marginalizedparent'><a class='marginalized' href='#general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3137'>#</a></div><div class='texpara'><div id='general-2.sentence-1' class='sentence'>In a union,
a non-static data member is <a class='hidden_link' href='#def:active,union_member' title='11.5.1&emsp;General&emsp;[class.union.general]'><span id='def:active,union_member'><i >active</i></span></a>
if its name refers to an object
whose lifetime has begun and has not ended (<a href='basic.life' title='6.7.4&emsp;Lifetime'>[basic.<span class='shy'></span>life]</a>)<a class='hidden_link' href='#general-2.sentence-1'>.</a></div> <div id='general-2.sentence-2' class='sentence'>At most one of the non-static data members of an object of union type
can be active at any
time, that is, the value of at most one of the non-static data members can be
stored in a union at any time<a class='hidden_link' href='#general-2.sentence-2'>.</a></div> <div id='general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#general-note-1'>1</a></i>:&ensp;<div id='general-2.sentence-3' class='sentence'>One special guarantee is made in order to
simplify the use of unions: If a standard-layout union contains several standard-layout
structs that share a common initial sequence (<a href='class.mem' title='11.4&emsp;Class members'>[class.<span class='shy'></span>mem]</a>), and
if a non-static data member of an object of this standard-layout union type
is active and is one of the standard-layout structs,
the common initial sequence of any of the standard-layout struct members can be inspected;
see <a href='class.mem' title='11.4&emsp;Class members'>[class.<span class='shy'></span>mem]</a><a class='hidden_link' href='#general-2.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='general-3'><div class='marginalizedparent'><a class='marginalized' href='#general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3156'>#</a></div><div class='texpara'><div id='general-3.sentence-1' class='sentence'>The size of a union is sufficient to contain the largest
of its non-static data members<a class='hidden_link' href='#general-3.sentence-1'>.</a></div> <div id='general-3.sentence-2' class='sentence'>Each non-static data member is allocated
as if it were the sole member of a non-union class<a class='hidden_link' href='#general-3.sentence-2'>.</a></div> <div id='general-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#general-note-2'>2</a></i>:&ensp;<div id='general-3.sentence-3' class='sentence'>A union object and its non-static data members are
pointer-interconvertible (<a href='basic.compound' title='6.8.4&emsp;Compound types'>[basic.<span class='shy'></span>compound]</a>, <a href='expr.static.cast' title='7.6.1.9&emsp;Static cast'>[expr.<span class='shy'></span>static.<span class='shy'></span>cast]</a>)<a class='hidden_link' href='#general-3.sentence-3'>.</a></div> <div id='general-3.sentence-4' class='sentence'>As a consequence, all non-static data members of a
union object have the same address<a class='hidden_link' href='#general-3.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='general-4'><div class='marginalizedparent'><a class='marginalized' href='#general-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3167'>#</a></div><div class='texpara'><div id='general-4.sentence-1' class='sentence'><a class='index' id=':member_function,union'></a><a class='index' id=':constructor,union'></a><a class='index' id=':destructor,union'></a>A union can have member functions (including constructors and destructors),
<a class='index' id=':restriction,union'></a>but it shall not have virtual (<a href='class.virtual' title='11.7.3&emsp;Virtual functions'>[class.<span class='shy'></span>virtual]</a>) functions<a class='hidden_link' href='#general-4.sentence-1'>.</a></div> <div id='general-4.sentence-2' class='sentence'>A union shall not have
base classes<a class='hidden_link' href='#general-4.sentence-2'>.</a></div> <div id='general-4.sentence-3' class='sentence'>A union shall not be used as a base class<a class='hidden_link' href='#general-4.sentence-3'>.</a></div> <div id='general-4.sentence-4' class='sentence'><a class='index' id=':restriction,union_'></a>If a union contains a non-static data member of
reference type, the program is ill-formed<a class='hidden_link' href='#general-4.sentence-4'>.</a></div> <div id='general-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#general-note-3'>3</a></i>:&ensp;<div id='general-4.sentence-5' class='sentence'>If any non-static data member of a union has a non-trivial
copy constructor,
move constructor (<a href='class.copy.ctor' title='11.4.5.3&emsp;Copy/move constructors'>[class.<span class='shy'></span>copy.<span class='shy'></span>ctor]</a>),
copy assignment operator, or
move assignment operator (<a href='class.copy.assign' title='11.4.6&emsp;Copy/move assignment operator'>[class.<span class='shy'></span>copy.<span class='shy'></span>assign]</a>),
the corresponding member function
of the union must be user-provided or it will
be implicitly deleted (<a href='dcl.fct.def.delete' title='9.6.3&emsp;Deleted definitions'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>def.<span class='shy'></span>delete]</a>) for the union<a class='hidden_link' href='#general-4.sentence-5'>.</a></div> <div id='general-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#general-example-1'>1</a></i>:&ensp;<div id='general-4.sentence-6' class='sentence'>Consider the following union:
<span class='codeblock'><span class='keyword'>union</span> U <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i;
  <span class='keyword'>float</span> f;
  std<span class='operator'>::</span>string s;
<span class='curlybracket'>}</span>;
</span></div> <div id='general-4.sentence-7' class='sentence'>
Since <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>string</span> (<a href='string.classes' title='27.4&emsp;String classes'>[string.<span class='shy'></span>classes]</a>) declares non-trivial versions of all of the special
member functions, <span class='texttt'>U</span> will have an implicitly deleted
copy/move constructor and copy/move assignment operator<a class='hidden_link' href='#general-4.sentence-7'>.</a></div> <div id='general-4.sentence-8' class='sentence'>The default constructor and destructor of <span class='texttt'>U</span> are both trivial
even though <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>string</span> has
a non-trivial default constructor and a non-trivial destructor<a class='hidden_link' href='#general-4.sentence-8'>.</a></div> —&nbsp;<i>end example</i>]</div></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='general-5'><div class='marginalizedparent'><a class='marginalized' href='#general-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3205'>#</a></div><div class='texpara'><div id='general-5.sentence-1' class='sentence'>When the left operand of an assignment operator
involves a member access expression (<a href='expr.ref' title='7.6.1.5&emsp;Class member access'>[expr.<span class='shy'></span>ref]</a>)
that nominates a union member,
it may begin the lifetime of that union member,
as described below<a class='hidden_link' href='#general-5.sentence-1'>.</a></div> <div id='general-5.sentence-2' class='sentence'>For an expression <span class='texttt'>E</span>,
define the set <span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>E</span>)</span>
of subexpressions of <span class='texttt'>E</span>
as follows:
<ul class='itemize'><li id='general-5.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#general-5.1'>(5.1)</a></div><div class='texpara'><div id='general-5.1.sentence-1' class='sentence'>If <span class='texttt'>E</span> is of the form <span class='texttt'>A<span class='operator'>.</span>B</span>,
<span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>E</span>)</span> contains the elements of <span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>A</span>)</span>,
and also contains <span class='texttt'>A<span class='operator'>.</span>B</span>
if <span class='texttt'>B</span> names a union member of a non-class, non-array type,
or of a class type with a trivial default constructor that is not deleted,
or an array of such types<a class='hidden_link' href='#general-5.1.sentence-1'>.</a></div></div></li><li id='general-5.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#general-5.2'>(5.2)</a></div><div class='texpara'><div id='general-5.2.sentence-1' class='sentence'>If <span class='texttt'>E</span> is of the form <span class='texttt'>A<span class='squarebracket'>[</span>B<span class='squarebracket'>]</span></span>
and is interpreted as a built-in array subscripting operator,
<span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>E</span>)</span> is <span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>A</span>)</span> if <span class='texttt'>A</span> is of array type,
<span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>B</span>)</span> if <span class='texttt'>B</span> is of array type,
and empty otherwise<a class='hidden_link' href='#general-5.2.sentence-1'>.</a></div></div></li><li id='general-5.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#general-5.3'>(5.3)</a></div><div class='texpara'><div id='general-5.3.sentence-1' class='sentence'>Otherwise, <span class='math'><span class='mathalpha'>S</span>(<span class='mathtt'>E</span>)</span> is empty<a class='hidden_link' href='#general-5.3.sentence-1'>.</a></div></div></li></ul></div> <div id='general-5.sentence-3' class='sentence'>
In an assignment expression of the form <span class='texttt'>E1 <span class='operator'>=</span> E2</span>
that uses either the built-in assignment operator (<a href='expr.assign' title='7.6.19&emsp;Assignment and compound assignment operators'>[expr.<span class='shy'></span>assign]</a>)
or a trivial assignment operator (<a href='class.copy.assign' title='11.4.6&emsp;Copy/move assignment operator'>[class.<span class='shy'></span>copy.<span class='shy'></span>assign]</a>),
for each element <span class='texttt'>X</span> of <span class='math'><span class='mathalpha'>S</span>(</span><span class='texttt'>E1</span><span class='math'>)</span> and
each anonymous union member <span class='texttt'>X</span> (<a href='#anon' title='11.5.2&emsp;Anonymous unions'>[class.<span class='shy'></span>union.<span class='shy'></span>anon]</a>) that
is a member of a union and
has such an element as an immediate subobject (recursively),
if modification of <span class='texttt'>X</span> would have undefined behavior under <a href='basic.life' title='6.7.4&emsp;Lifetime'>[basic.<span class='shy'></span>life]</a>,
an object of the type of <span class='texttt'>X</span> is implicitly created
in the nominated storage;
no initialization is performed and
the beginning of its lifetime is sequenced after
the value computation of the left and right operands
and before the assignment<a class='hidden_link' href='#general-5.sentence-3'>.</a></div> <div id='general-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#general-note-4'>4</a></i>:&ensp;<div id='general-5.sentence-4' class='sentence'>This ends the lifetime of the previously-active
member of the union, if any (<a href='basic.life' title='6.7.4&emsp;Lifetime'>[basic.<span class='shy'></span>life]</a>)<a class='hidden_link' href='#general-5.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='general-example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#general-example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>union</span> A <span class='curlybracket'>{</span> <span class='keyword'>int</span> x; <span class='keyword'>int</span> y<span class='squarebracket'>[</span><span class='literal'>4</span><span class='squarebracket'>]</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span> A a; <span class='curlybracket'>}</span>;
<span class='keyword'>union</span> C <span class='curlybracket'>{</span> B b; <span class='keyword'>int</span> k; <span class='curlybracket'>}</span>;
<span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  C c;                  <span class='comment'>// does not start lifetime of any union member</span>
  c<span class='operator'>.</span>b<span class='operator'>.</span>a<span class='operator'>.</span>y<span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='literal'>4</span>;       <span class='comment'>// OK, <span class='math'><span class='mathalpha'>S</span>(</span><span class='tcode_in_codeblock'>c.b.a.y[3]</span><span class='math'>)</span> contains <span class='tcode_in_codeblock'>c.b</span> and <span class='tcode_in_codeblock'>c.b.a.y</span>;</span>
                        <span class='comment'>// creates objects to hold union members <span class='tcode_in_codeblock'>c.b</span> and <span class='tcode_in_codeblock'>c.b.a.y</span></span>
  <span class='keyword'>return</span> c<span class='operator'>.</span>b<span class='operator'>.</span>a<span class='operator'>.</span>y<span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span>;    <span class='comment'>// OK, <span class='tcode_in_codeblock'>c.b.a.y</span> refers to newly created object (see <a href='basic.life' title='6.7.4&emsp;Lifetime'>[basic.<span class='shy'></span>life]</a>)</span>
<span class='curlybracket'>}</span>

<span class='keyword'>struct</span> X <span class='curlybracket'>{</span> <span class='keyword'>const</span> <span class='keyword'>int</span> a; <span class='keyword'>int</span> b; <span class='curlybracket'>}</span>;
<span class='keyword'>union</span> Y <span class='curlybracket'>{</span> X x; <span class='keyword'>int</span> k; <span class='curlybracket'>}</span>;
<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  Y y <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='curlybracket'>{</span> <span class='literal'>1</span>, <span class='literal'>2</span> <span class='curlybracket'>}</span> <span class='curlybracket'>}</span>;   <span class='comment'>// OK, <span class='tcode_in_codeblock'>y.x</span> is active union member (<a href='class.mem' title='11.4&emsp;Class members'>[class.<span class='shy'></span>mem]</a>)</span>
  <span class='keyword'>int</span> n <span class='operator'>=</span> y<span class='operator'>.</span>x<span class='operator'>.</span>a;
  y<span class='operator'>.</span>k <span class='operator'>=</span> <span class='literal'>4</span>;              <span class='comment'>// OK, ends lifetime of <span class='tcode_in_codeblock'>y.x</span>, <span class='tcode_in_codeblock'>y.k</span> is active member of union</span>
  y<span class='operator'>.</span>x<span class='operator'>.</span>b <span class='operator'>=</span> n;            <span class='comment'>// undefined behavior: <span class='tcode_in_codeblock'>y.x.b</span> modified outside its lifetime,</span>
                        <span class='comment'>// <span class='math'><span class='mathalpha'>S</span>(</span><span class='tcode_in_codeblock'>y.x.b</span><span class='math'>)</span> is empty because <span class='tcode_in_codeblock'>X</span>'s default constructor is deleted,</span>
                        <span class='comment'>// so union member <span class='tcode_in_codeblock'>y.x</span>'s lifetime does not implicitly start</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para nonNormativeOnly' id='general-6'><div class='marginalizedparent'><a class='marginalized' href='#general-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3275'>#</a></div><div class='texpara'><div id='general-note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#general-note-5'>5</a></i>:&ensp;<div id='general-6.sentence-1' class='sentence'>In cases where the above rule does not apply,
the active member of a union can only be changed by
the use of a placement <a href='expr.new#nt:new-expression' title='7.6.2.8&emsp;New&emsp;[expr.new]'><span id='ntref:new-expression'><span class='textsf'><i >new-expression</i></span></span></a><a class='hidden_link' href='#general-6.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='general-example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#general-example-3'>3</a></i>:&ensp;<div id='general-6.sentence-2' class='sentence'>Consider an object <span class='texttt'>u</span> of a <span id=':union__'><span class='texttt'><span class='keyword'>union</span></span></span> type <span class='texttt'>U</span> having non-static data members
<span class='texttt'>m</span> of type <span class='texttt'>M</span> and <span class='texttt'>n</span> of type <span class='texttt'>N</span><a class='hidden_link' href='#general-6.sentence-2'>.</a></div> <div id='general-6.sentence-3' class='sentence'>If <span class='texttt'>M</span> has a non-trivial
destructor and <span class='texttt'>N</span> has a non-trivial constructor (for instance, if they declare or inherit
virtual functions), the active member of <span class='texttt'>u</span> can be safely switched from <span class='texttt'>m</span> to
<span class='texttt'>n</span> using the destructor and placement <a href='expr.new#nt:new-expression' title='7.6.2.8&emsp;New&emsp;[expr.new]'><span id='ntref:new-expression_'><span class='textsf'><i >new-expression</i></span></span></a> as follows:
<span class='codeblock'>u<span class='operator'>.</span>m<span class='operator'>.</span><span class='operator'>~</span>M<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>new</span> <span class='parenthesis'>(</span><span class='operator'>&amp;</span>u<span class='operator'>.</span>n<span class='parenthesis'>)</span> N;
</span></div> —&nbsp;<i>end example</i>]</div></div></div></div></div><div id='anon' class='section'><h3 ><a class='secnum' href='#anon' style='min-width:80pt'>11.5.2</a> Anonymous unions <a class='abbr_ref' href='class.union.anon'>[class.union.anon]</a></h3><div class='texpara'><a class='index' id=':union,anonymous'></a></div><div class='para' id='anon-1'><div class='marginalizedparent'><a class='marginalized' href='#anon-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3296'>#</a></div><div class='texpara'><div id='anon-1.sentence-1' class='sentence'>A union of the form
<div class='simplebnf'>
<span id=':union___'><span class='texttt'><span class='keyword'>union</span></span></span> <span class='terminal'><span class='curlybracket'>{</span></span> <a href='class.mem.general#nt:member-specification' title='11.4.1&emsp;General&emsp;[class.mem.general]'><span id='ntref:member-specification'><span class='textsf'><i >member-specification</i></span></span></a> <span class='terminal'><span class='curlybracket'>}</span></span> <span class='terminal'>;</span>
</div>
is called an <a class='hidden_link' href='#def:anonymous_union' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:anonymous_union'><i >anonymous union</i></span></a>; it defines an unnamed type and
an unnamed object of that type called
an <a class='hidden_link' href='#def:member,anonymous_union' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:member,anonymous_union'><i >anonymous union member</i></span></a>
if it is a non-static data member or
an <a class='hidden_link' href='#def:variable,anonymous_union' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:variable,anonymous_union'><i >anonymous union variable</i></span></a> otherwise<a class='hidden_link' href='#anon-1.sentence-1'>.</a></div> <div id='anon-1.sentence-2' class='sentence'><a class='index' id=':access_control,anonymous_union'></a><a class='index' id=':restriction,anonymous_union'></a>Each <a href='class.mem.general#nt:member-declaration' title='11.4.1&emsp;General&emsp;[class.mem.general]'><span id='ntref:member-declaration'><span class='textsf'><i >member-declaration</i></span></span></a> in the <a href='class.mem.general#nt:member-specification' title='11.4.1&emsp;General&emsp;[class.mem.general]'><span id='ntref:member-specification_'><span class='textsf'><i >member-specification</i></span></span></a>
of an anonymous union shall either define one or more public non-static data members or
be a <a href='dcl.pre#nt:static_assert-declaration' title='9.1&emsp;Preamble&emsp;[dcl.pre]'><span id='ntref:static_assert-declaration'><span class='textsf'><i >static_assert-declaration</i></span></span></a><a class='hidden_link' href='#anon-1.sentence-2'>.</a></div> <div id='anon-1.sentence-3' class='sentence'>Nested types, anonymous unions, and functions
shall not be declared within an anonymous union<a class='hidden_link' href='#anon-1.sentence-3'>.</a></div> <div id='anon-1.sentence-4' class='sentence'>The names of the members of an anonymous union
are bound in the scope inhabited by the union declaration<a class='hidden_link' href='#anon-1.sentence-4'>.</a></div> <div id='anon-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#anon-example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>union</span> <span class='curlybracket'>{</span> <span class='keyword'>int</span> a; <span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span>;
  a <span class='operator'>=</span> <span class='literal'>1</span>;
  p <span class='operator'>=</span> <span class='literal'>"Jennifer"</span>;
<span class='curlybracket'>}</span>
</span></div><div class='texpara'><div id='anon-1.sentence-5' class='sentence'>Here <span class='texttt'>a</span> and <span class='texttt'>p</span> are used like ordinary (non-member)
variables, but since they are union members they have the same address<a class='hidden_link' href='#anon-1.sentence-5'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='anon-2'><div class='marginalizedparent'><a class='marginalized' href='#anon-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3330'>#</a></div><div class='texpara'><div id='anon-2.sentence-1' class='sentence'><a class='index' id=':union,global_anonymous'></a><a class='index' id=':scope,anonymous_union_at_namespace'></a>An anonymous union declared in the scope of a namespace with external linkage
shall use the <a href='dcl.stc#nt:storage-class-specifier' title='9.2.2&emsp;Storage class specifiers&emsp;[dcl.stc]'><span id='ntref:storage-class-specifier'><span class='textsf'><i >storage-class-specifier</i></span></span></a> <span id=':static'><span class='texttt'><span class='keyword'>static</span></span></span><a class='hidden_link' href='#anon-2.sentence-1'>.</a></div> <div id='anon-2.sentence-2' class='sentence'>Anonymous unions declared at block scope shall not use a <a href='dcl.stc#nt:storage-class-specifier' title='9.2.2&emsp;Storage class specifiers&emsp;[dcl.stc]'><span id='ntref:storage-class-specifier_'><span class='textsf'><i >storage-class-specifier</i></span></span></a>
that is not permitted in the declaration of a block variable<a class='hidden_link' href='#anon-2.sentence-2'>.</a></div> <div id='anon-2.sentence-3' class='sentence'>An anonymous union declaration at class scope shall not have
a <a href='dcl.stc#nt:storage-class-specifier' title='9.2.2&emsp;Storage class specifiers&emsp;[dcl.stc]'><span id='ntref:storage-class-specifier__'><span class='textsf'><i >storage-class-specifier</i></span></span></a><a class='hidden_link' href='#anon-2.sentence-3'>.</a></div></div></div><div class='para nonNormativeOnly' id='anon-3'><div class='marginalizedparent'><a class='marginalized' href='#anon-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3340'>#</a></div><div class='texpara'><div id='anon-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#anon-note-1'>1</a></i>:&ensp;<div id='anon-3.sentence-1' class='sentence'>A union for which objects, pointers, or references are declared is not an anonymous union<a class='hidden_link' href='#anon-3.sentence-1'>.</a></div> <div id='anon-example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#anon-example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>union</span> <span class='curlybracket'>{</span> <span class='keyword'>int</span> aa; <span class='keyword'>char</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span> obj, <span class='operator'>*</span>ptr <span class='operator'>=</span> <span class='operator'>&amp;</span>obj;
  aa <span class='operator'>=</span> <span class='literal'>1</span>;           <span class='comment'>// error</span>
  ptr<span class='operator'>-</span><span class='anglebracket'>&gt;</span>aa <span class='operator'>=</span> <span class='literal'>1</span>;      <span class='comment'>// OK</span>
<span class='curlybracket'>}</span>
</span></div><div class='texpara'><div id='anon-3.sentence-2' class='sentence'>The assignment to plain <span class='texttt'>aa</span> is ill-formed since the member name
is not visible outside the union, and even if it were visible, it is not
associated with any particular object<a class='hidden_link' href='#anon-3.sentence-2'>.</a></div> —&nbsp;<i>end example</i>]</div></div> —&nbsp;<i>end note</i>]</div></div> <div id='anon-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#anon-note-2'>2</a></i>:&ensp;<div id='anon-3.sentence-3' class='sentence'>Initialization of unions with no user-declared constructors is described
in <a href='dcl.init.aggr' title='9.5.2&emsp;Aggregates'>[dcl.<span class='shy'></span>init.<span class='shy'></span>aggr]</a><a class='hidden_link' href='#anon-3.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='anon-4'><div class='marginalizedparent'><a class='marginalized' href='#anon-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/classes.tex#L3362'>#</a></div><div class='texpara'><div id='anon-4.sentence-1' class='sentence'><a class='index' id=':class,variant_member_of'></a>A <a class='hidden_link' href='#def:class,union-like' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:class,union-like'><i >union-like class</i></span></a> is a union or a class that has an anonymous union as a direct
member<a class='hidden_link' href='#anon-4.sentence-1'>.</a></div> <div id='anon-4.sentence-2' class='sentence'>A union-like class <span class='texttt'>X</span> has a set of <a class='hidden_link' href='#def:variant_member' title='11.5.2&emsp;Anonymous unions&emsp;[class.union.anon]'><span id='def:variant_member'><i >variant members</i></span></a><a class='hidden_link' href='#anon-4.sentence-2'>.</a></div> <div id='anon-4.sentence-3' class='sentence'>If <span class='texttt'>X</span> is a union, a non-static data member of <span class='texttt'>X</span> that is not an anonymous
union is a variant member of <span class='texttt'>X</span><a class='hidden_link' href='#anon-4.sentence-3'>.</a></div> <div id='anon-4.sentence-4' class='sentence'>In addition, a non-static data member of an
anonymous union that is a member of <span class='texttt'>X</span> is also a variant member of <span class='texttt'>X</span><a class='hidden_link' href='#anon-4.sentence-4'>.</a></div> <div id='anon-4.sentence-5' class='sentence'>At most one variant member of a union may have a default member initializer<a class='hidden_link' href='#anon-4.sentence-5'>.</a></div> <div id='anon-example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#anon-example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>union</span> U <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>0</span>;
  <span class='keyword'>union</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> k;
  <span class='curlybracket'>}</span>;
  <span class='keyword'>union</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> z;
    <span class='keyword'>int</span> y <span class='operator'>=</span> <span class='literal'>1</span>;      <span class='comment'>// error: initialization for second variant member of <span class='tcode_in_codeblock'>U</span></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;
</span> —&nbsp;<i>end example</i>]</div></div></div></div></div></div></body></html>