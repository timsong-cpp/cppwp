<!DOCTYPE html><html lang='en'><head><title>[basic.exec]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>6.9</a> Program execution <a class='abbr_ref'>[basic.exec]</a></h2><div id='intro.execution' class='section'><h3 ><a class='secnum' href='#intro.execution' style='min-width:80pt'>6.9.1</a> Sequential execution <a class='abbr_ref' href='intro.execution'>[intro.execution]</a></h3><div class='para' id='intro.execution-1'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5404'>#</a></div><div class='texpara'><div id='intro.execution-1.sentence-1' class='sentence'>An instance of each object with <a href='basic.stc.auto' title='6.7.5.4&emsp;Automatic storage duration&emsp;[basic.stc.auto]'>automatic storage
duration</a> is associated with each entry into its
block<a class='hidden_link' href='#intro.execution-1.sentence-1'>.</a></div> <div id='intro.execution-1.sentence-2' class='sentence'>Such an object exists and retains its last-stored value during
the execution of the block and while the block is suspended (by a call
of a function, suspension of a coroutine (<a href='expr.await' title='7.6.2.4&emsp;Await'>[expr.<span class='shy'></span>await]</a>), or receipt of a signal)<a class='hidden_link' href='#intro.execution-1.sentence-2'>.</a></div></div></div><div class='para' id='intro.execution-2'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5411'>#</a></div><div class='texpara'><div id='intro.execution-2.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:constituent_expression' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:constituent_expression'><i >constituent expression</i></span></a> is defined as follows:
<ul class='itemize'><li id='intro.execution-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-2.1'>(2.1)</a></div><div class='texpara'><div id='intro.execution-2.1.sentence-1' class='sentence'>The constituent expression of an expression is that expression<a class='hidden_link' href='#intro.execution-2.1.sentence-1'>.</a></div></div></li><li id='intro.execution-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-2.2'>(2.2)</a></div><div class='texpara'><div id='intro.execution-2.2.sentence-1' class='sentence'>The constituent expressions of a <a href='dcl.init.general#nt:braced-init-list' title='9.4.1&emsp;General&emsp;[dcl.init.general]'><span id='ntref:braced-init-list'><span class='textsf'><i >braced-init-list</i></span></span></a> or
of a (possibly parenthesized) <a href='expr.post.general#nt:expression-list' title='7.6.1.1&emsp;General&emsp;[expr.post.general]'><span id='ntref:expression-list'><span class='textsf'><i >expression-list</i></span></span></a>
are the constituent expressions of the elements of the respective list<a class='hidden_link' href='#intro.execution-2.2.sentence-1'>.</a></div></div></li><li id='intro.execution-2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-2.3'>(2.3)</a></div><div class='texpara'><div id='intro.execution-2.3.sentence-1' class='sentence'>The constituent expressions of a <a href='dcl.init.general#nt:brace-or-equal-initializer' title='9.4.1&emsp;General&emsp;[dcl.init.general]'><span id='ntref:brace-or-equal-initializer'><span class='textsf'><i >brace-or-equal-initializer</i></span></span></a>
of the form <span class='texttt'><span class='operator'>=</span></span> <a href='dcl.init.general#nt:initializer-clause' title='9.4.1&emsp;General&emsp;[dcl.init.general]'><span id='ntref:initializer-clause'><span class='textsf'><i >initializer-clause</i></span></span></a>
are the constituent expressions of the <a href='dcl.init.general#nt:initializer-clause' title='9.4.1&emsp;General&emsp;[dcl.init.general]'><span id='ntref:initializer-clause_'><span class='textsf'><i >initializer-clause</i></span></span></a><a class='hidden_link' href='#intro.execution-2.3.sentence-1'>.</a></div></div></li></ul></div> <div id='intro.execution-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#intro.execution-example-1'>1</a></i>: <span class='codeblock'><span class='keyword'>struct</span> A <span class='curlybracket'>{</span> <span class='keyword'>int</span> x; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span> <span class='keyword'>int</span> y; <span class='keyword'>struct</span> A a; <span class='curlybracket'>}</span>;
B b <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='literal'>5</span>, <span class='curlybracket'>{</span> <span class='literal'>1</span><span class='operator'>+</span><span class='literal'>1</span> <span class='curlybracket'>}</span> <span class='curlybracket'>}</span>;
</span> <div id='intro.execution-2.sentence-2' class='sentence'>
The constituent expressions of the <a href='dcl.init.general#nt:initializer' title='9.4.1&emsp;General&emsp;[dcl.init.general]'><span id='ntref:initializer'><span class='textsf'><i >initializer</i></span></span></a>
used for the initialization of <span class='texttt'>b</span> are <span class='texttt'><span class='literal'>5</span></span> and <span class='texttt'><span class='literal'>1</span><span class='operator'>+</span><span class='literal'>1</span></span><a class='hidden_link' href='#intro.execution-2.sentence-2'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='intro.execution-3'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5435'>#</a></div><div class='texpara'><div id='intro.execution-3.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:immediate_subexpression' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:immediate_subexpression'><i >immediate subexpressions</i></span></a> of an expression <span class='math'><span class='mathalpha'>E</span></span> are
<ul class='itemize'><li id='intro.execution-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-3.1'>(3.1)</a></div>the constituent expressions of <span class='math'><span class='mathalpha'>E</span></span>'s operands (<a href='expr.prop' title='7.2&emsp;Properties of expressions'>[expr.<span class='shy'></span>prop]</a>),</li><li id='intro.execution-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-3.2'>(3.2)</a></div>any function call that <span class='math'><span class='mathalpha'>E</span></span> implicitly invokes,</li><li id='intro.execution-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-3.3'>(3.3)</a></div>if <span class='math'><span class='mathalpha'>E</span></span> is a <a href='expr.prim.lambda.general#nt:lambda-expression' title='7.5.5.1&emsp;General&emsp;[expr.prim.lambda.general]'><span id='ntref:lambda-expression'><span class='textsf'><i >lambda-expression</i></span></span></a> (<a href='expr.prim.lambda' title='7.5.5&emsp;Lambda expressions'>[expr.<span class='shy'></span>prim.<span class='shy'></span>lambda]</a>),
the initialization of the entities captured by copy and
the constituent expressions of the <a href='dcl.init.general#nt:initializer' title='9.4.1&emsp;General&emsp;[dcl.init.general]'><span id='ntref:initializer_'><span class='textsf'><i >initializer</i></span></span></a> of the <a href='expr.prim.lambda.capture#nt:init-capture' title='7.5.5.3&emsp;Captures&emsp;[expr.prim.lambda.capture]'><span id='ntref:init-capture'><span class='textsf'><i >init-capture</i></span></span></a><i >s</i>,</li><li id='intro.execution-3.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-3.4'>(3.4)</a></div>if <span class='math'><span class='mathalpha'>E</span></span> is a <a href='expr.call' title='7.6.1.3&emsp;Function call&emsp;[expr.call]'>function call</a> or implicitly invokes a function,
the constituent expressions of each default argument (<a href='dcl.fct.default' title='9.3.4.7&emsp;Default arguments'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>default]</a>)
used in the call, or</li><li id='intro.execution-3.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-3.5'>(3.5)</a></div>if <span class='math'><span class='mathalpha'>E</span></span> creates an aggregate object (<a href='dcl.init.aggr' title='9.4.2&emsp;Aggregates'>[dcl.<span class='shy'></span>init.<span class='shy'></span>aggr]</a>),
the constituent expressions of each default member initializer (<a href='class.mem' title='11.4&emsp;Class members'>[class.<span class='shy'></span>mem]</a>)
used in the initialization<a class='hidden_link' href='#intro.execution-3.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='intro.execution-4'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5456'>#</a></div><div class='texpara'><div id='intro.execution-4.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:subexpression' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:subexpression'><i >subexpression</i></span></a> of an expression <span class='math'><span class='mathalpha'>E</span></span> is
an immediate subexpression of <span class='math'><span class='mathalpha'>E</span></span> or
a subexpression of an immediate subexpression of <span class='math'><span class='mathalpha'>E</span></span><a class='hidden_link' href='#intro.execution-4.sentence-1'>.</a></div> <div id='intro.execution-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.execution-note-1'>1</a></i>: <div id='intro.execution-4.sentence-2' class='sentence'>Expressions appearing in the <a href='stmt.block#nt:compound-statement' title='8.4&emsp;Compound statement or block&emsp;[stmt.block]'><span id='ntref:compound-statement'><span class='textsf'><i >compound-statement</i></span></span></a> of a <a href='expr.prim.lambda.general#nt:lambda-expression' title='7.5.5.1&emsp;General&emsp;[expr.prim.lambda.general]'><span id='ntref:lambda-expression_'><span class='textsf'><i >lambda-expression</i></span></span></a>
are not subexpressions of the <a href='expr.prim.lambda.general#nt:lambda-expression' title='7.5.5.1&emsp;General&emsp;[expr.prim.lambda.general]'><span id='ntref:lambda-expression__'><span class='textsf'><i >lambda-expression</i></span></span></a><a class='hidden_link' href='#intro.execution-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.execution-5'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5465'>#</a></div><div class='texpara'><div id='intro.execution-5.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:full-expression' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:full-expression'><i >full-expression</i></span></a> is
<ul class='itemize'><li id='intro.execution-5.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-5.1'>(5.1)</a></div>an <a href='expr.prop#def:unevaluated_operand' title='7.2&emsp;Properties of expressions&emsp;[expr.prop]'>unevaluated operand</a>,</li><li id='intro.execution-5.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-5.2'>(5.2)</a></div>a <a href='expr.const#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='ntref:constant-expression'><span class='textsf'><i >constant-expression</i></span></span></a> (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>),</li><li id='intro.execution-5.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-5.3'>(5.3)</a></div>an immediate invocation (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>),</li><li id='intro.execution-5.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-5.4'>(5.4)</a></div>an <a href='dcl.decl.general#nt:init-declarator' title='9.3.1&emsp;General&emsp;[dcl.decl.general]'><span id='ntref:init-declarator'><span class='textsf'><i >init-declarator</i></span></span></a> (<a href='dcl.decl' title='9.3&emsp;Declarators'>[dcl.<span class='shy'></span>decl]</a>) or
a <a href='class.base.init#nt:mem-initializer' title='11.9.3&emsp;Initializing bases and members&emsp;[class.base.init]'><span id='ntref:mem-initializer'><span class='textsf'><i >mem-initializer</i></span></span></a> (<a href='class.base.init' title='11.9.3&emsp;Initializing bases and members'>[class.<span class='shy'></span>base.<span class='shy'></span>init]</a>),
including the constituent expressions of the initializer,</li><li id='intro.execution-5.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-5.5'>(5.5)</a></div>an invocation of a destructor generated at the end of the lifetime
of an object other than a temporary object (<a href='class.temporary' title='6.7.7&emsp;Temporary objects'>[class.<span class='shy'></span>temporary]</a>)
whose lifetime has not been extended, or</li><li id='intro.execution-5.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.execution-5.6'>(5.6)</a></div>an expression that is not a subexpression of another expression and
that is not otherwise part of a full-expression<a class='hidden_link' href='#intro.execution-5.sentence-1'>.</a></li></ul></div> <div id='intro.execution-5.sentence-2' class='sentence'>
If a language construct is defined to produce an implicit call of a function,
a use of the language construct is considered to be an expression
for the purposes of this definition<a class='hidden_link' href='#intro.execution-5.sentence-2'>.</a></div> <div id='intro.execution-5.sentence-3' class='sentence'>Conversions applied to the result of an expression in order to satisfy the requirements
of the language construct in which the expression appears
are also considered to be part of the full-expression<a class='hidden_link' href='#intro.execution-5.sentence-3'>.</a></div> <div id='intro.execution-5.sentence-4' class='sentence'>For an initializer, performing the initialization of the entity
(including evaluating default member initializers of an aggregate)
is also considered part of the full-expression<a class='hidden_link' href='#intro.execution-5.sentence-4'>.</a></div> <div id='intro.execution-example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#intro.execution-example-2'>2</a></i>: <span class='codeblock'><span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  S<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span><span class='operator'>:</span> I<span class='parenthesis'>(</span>i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>            <span class='comment'>// full-expression is initialization of <span class='tcode_in_codeblock'>I</span></span>
  <span class='keyword'>int</span><span class='operator'>&amp;</span> v<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> I; <span class='curlybracket'>}</span>
  <span class='operator'>~</span>S<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><span class='literal'>false</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>
<span class='keyword'>private</span><span class='operator'>:</span>
  <span class='keyword'>int</span> I;
<span class='curlybracket'>}</span>;

S s1<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;                        <span class='comment'>// full-expression comprises call of <span class='tcode_in_codeblock'>S&#x200b;::&#x200b;S(int)</span></span>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  S s2 <span class='operator'>=</span> <span class='literal'>2</span>;                     <span class='comment'>// full-expression comprises call of <span class='tcode_in_codeblock'>S&#x200b;::&#x200b;S(int)</span></span>
  <span class='keyword'>if</span> <span class='parenthesis'>(</span>S<span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span><span class='operator'>.</span>v<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>                 <span class='comment'>// full-expression includes lvalue-to-rvalue and <span class='tcode_in_codeblock'>int</span> to <span class='tcode_in_codeblock'>bool</span> conversions,</span>
                                <span class='comment'>// performed before temporary is deleted at end of full-expression</span>
  <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>
  <span class='keyword'>bool</span> b <span class='operator'>=</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>S<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;       <span class='comment'>// exception specification of destructor of <span class='tcode_in_codeblock'>S</span> considered for <span class='tcode_in_codeblock'>noexcept</span></span>

  <span class='comment'>// full-expression is destruction of <span class='tcode_in_codeblock'>s2</span> at end of block</span>
<span class='curlybracket'>}</span>
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span>
  B<span class='parenthesis'>(</span>S <span class='operator'>=</span> S<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
B b<span class='squarebracket'>[</span><span class='literal'>2</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> B<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, B<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>}</span>;          <span class='comment'>// full-expression is the entire initialization</span>
                                <span class='comment'>// including the destruction of temporaries</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para nonNormativeOnly' id='intro.execution-6'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5523'>#</a></div><div class='texpara'><div id='intro.execution-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.execution-note-2'>2</a></i>: <div id='intro.execution-6.sentence-1' class='sentence'>The evaluation of a full-expression can include the
evaluation of subexpressions that are not lexically part of the
full-expression<a class='hidden_link' href='#intro.execution-6.sentence-1'>.</a></div> <div id='intro.execution-6.sentence-2' class='sentence'>For example, subexpressions involved in evaluating
default arguments (<a href='dcl.fct.default' title='9.3.4.7&emsp;Default arguments'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>default]</a>) are considered to
be created in the expression that calls the function, not the expression
that defines the default argument<a class='hidden_link' href='#intro.execution-6.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.execution-7'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5533'>#</a></div><div class='texpara'><div id='intro.execution-7.sentence-1' class='sentence'><a class='index' id=':value_computation'></a>Reading an object designated by a <span class='texttt'><span class='keyword'>volatile</span></span>
glvalue (<a href='basic.lval' title='7.2.1&emsp;Value category'>[basic.<span class='shy'></span>lval]</a>), modifying an object, calling a library I/O
function, or calling a function that does any of those operations are
all
<a class='hidden_link' href='#def:side_effects' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:side_effects'><i >side effects</i></span></a>, which are changes in the state of the execution
environment<a class='hidden_link' href='#intro.execution-7.sentence-1'>.</a></div> <div id='intro.execution-7.sentence-2' class='sentence'><a class='hidden_link' href='#def:evaluation' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:evaluation'><i >Evaluation</i></span></a> of an expression (or a
subexpression) in general includes both value computations (including
determining the identity of an object for glvalue evaluation and fetching
a value previously assigned to an object for prvalue evaluation) and
initiation of side effects<a class='hidden_link' href='#intro.execution-7.sentence-2'>.</a></div> <div id='intro.execution-7.sentence-3' class='sentence'>When a call to a library I/O function
returns or an access through a volatile glvalue is evaluated the side
effect is considered complete, even though some external actions implied
by the call (such as the I/O itself) or by the <span class='texttt'><span class='keyword'>volatile</span></span> access
may not have completed yet<a class='hidden_link' href='#intro.execution-7.sentence-3'>.</a></div></div></div><div class='para' id='intro.execution-8'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5550'>#</a></div><div class='texpara'><div id='intro.execution-8.sentence-1' class='sentence'><a class='hidden_link' href='#def:sequenced_before' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:sequenced_before'><i >Sequenced before</i></span></a> is an asymmetric, transitive, pair-wise relation between
evaluations executed by a single thread (<a href='#intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>), which induces
a partial order among those evaluations<a class='hidden_link' href='#intro.execution-8.sentence-1'>.</a></div> <div id='intro.execution-8.sentence-2' class='sentence'>Given any two evaluations <i >A</i> and
<i >B</i>, if <i >A</i> is sequenced before <i >B</i>
(or, equivalently, <i >B</i> is <a class='hidden_link' href='#def:sequenced_after' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:sequenced_after'><i >sequenced after</i></span></a> <i >A</i>),
then the execution of
<i >A</i> shall precede the execution of <i >B</i><a class='hidden_link' href='#intro.execution-8.sentence-2'>.</a></div> <div id='intro.execution-8.sentence-3' class='sentence'>If <i >A</i> is not sequenced
before <i >B</i> and <i >B</i> is not sequenced before <i >A</i>, then <i >A</i> and
<i >B</i> are <a class='hidden_link' href='#def:unsequenced' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:unsequenced'><i >unsequenced</i></span></a><a class='hidden_link' href='#intro.execution-8.sentence-3'>.</a></div> <div id='intro.execution-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.execution-note-3'>3</a></i>: <div id='intro.execution-8.sentence-4' class='sentence'>The execution of unsequenced
evaluations can overlap<a class='hidden_link' href='#intro.execution-8.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.execution-8.sentence-5' class='sentence'>
Evaluations <i >A</i> and <i >B</i> are
<a class='hidden_link' href='#def:indeterminately_sequenced' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'><span id='def:indeterminately_sequenced'><i >indeterminately sequenced</i></span></a> when either <i >A</i> is sequenced before
<i >B</i> or <i >B</i> is sequenced before <i >A</i>, but it is unspecified which<a class='hidden_link' href='#intro.execution-8.sentence-5'>.</a></div> <div id='intro.execution-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.execution-note-4'>4</a></i>: <div id='intro.execution-8.sentence-6' class='sentence'>Indeterminately sequenced evaluations cannot overlap, but either
can be executed first<a class='hidden_link' href='#intro.execution-8.sentence-6'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.execution-8.sentence-7' class='sentence'>
An expression <i >X</i>
is said to be sequenced before
an expression <i >Y</i> if
every value computation and every side effect
associated with the expression <i >X</i>
is sequenced before
every value computation and every side effect
associated with the expression <i >Y</i><a class='hidden_link' href='#intro.execution-8.sentence-7'>.</a></div></div></div><div class='para' id='intro.execution-9'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5580'>#</a></div><div class='texpara'><div id='intro.execution-9.sentence-1' class='sentence'>Every
<a class='index' id=':value_computation_'></a>value computation and
<a class='index' id=':side_effects'></a>side effect associated with a full-expression is
sequenced before every value computation and side effect associated with the
next full-expression to be evaluated<a class='hidden_link' href='#intro.execution-9.sentence-1'>.</a><a class='footnoteref' href='#footnote-41' id='footnoteref-41' title='As specified in [class.temporary], after a full-expression is evaluated, a sequence of zero or more invocations of destructor functions for temporary objects takes place, usually in reverse order of the construction of each temporary object.'>41</a></div></div></div><div class='para' id='intro.execution-10'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5595'>#</a></div><div class='texpara'><div id='intro.execution-10.sentence-1' class='sentence'><a class='index' id=':evaluation,unspecified_order_of'></a>Except where noted, evaluations of operands of individual operators and
of subexpressions of individual expressions are unsequenced<a class='hidden_link' href='#intro.execution-10.sentence-1'>.</a></div> <div id='intro.execution-note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.execution-note-5'>5</a></i>: <div id='intro.execution-10.sentence-2' class='sentence'>In an expression that is evaluated more than once during the execution
of a program, unsequenced and indeterminately sequenced evaluations of
its subexpressions need not be performed consistently in different
evaluations<a class='hidden_link' href='#intro.execution-10.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.execution-10.sentence-3' class='sentence'>
The value computations of the operands of an
operator are sequenced before the value computation of the result of the
operator<a class='hidden_link' href='#intro.execution-10.sentence-3'>.</a></div> <div id='intro.execution-10.sentence-4' class='sentence'>If a
<a class='index' id=':side_effects_'></a>side effect on a memory location (<a href='intro.memory' title='6.7.1&emsp;Memory model'>[intro.<span class='shy'></span>memory]</a>) is unsequenced
relative to either another side effect on the same memory location or
a value computation using the value of any object in the same memory location,
and they are not potentially concurrent (<a href='#intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>),
the behavior is undefined<a class='hidden_link' href='#intro.execution-10.sentence-4'>.</a></div> <div id='intro.execution-note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.execution-note-6'>6</a></i>: <div id='intro.execution-10.sentence-5' class='sentence'>The next subclause imposes similar, but more complex restrictions on
potentially concurrent computations<a class='hidden_link' href='#intro.execution-10.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><div id='intro.execution-example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#intro.execution-example-3'>3</a></i>: <span class='codeblock'><span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  i <span class='operator'>=</span> <span class='literal'>7</span>, i<span class='operator'>+</span><span class='operator'>+</span>, i<span class='operator'>+</span><span class='operator'>+</span>;              <span class='comment'>// <span class='tcode_in_codeblock'>i</span> becomes <span class='tcode_in_codeblock'>9</span></span>

  i <span class='operator'>=</span> i<span class='operator'>+</span><span class='operator'>+</span> <span class='operator'>+</span> <span class='literal'>1</span>;                  <span class='comment'>// the value of <span class='tcode_in_codeblock'>i</span> is incremented</span>
  i <span class='operator'>=</span> i<span class='operator'>+</span><span class='operator'>+</span> <span class='operator'>+</span> i;                  <span class='comment'>// undefined behavior</span>
  i <span class='operator'>=</span> i <span class='operator'>+</span> <span class='literal'>1</span>;                    <span class='comment'>// the value of <span class='tcode_in_codeblock'>i</span> is incremented</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='intro.execution-11'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5631'>#</a></div><div class='texpara'><div id='intro.execution-11.sentence-1' class='sentence'>When calling a function (whether or not the function is inline), every
<a class='index' id=':value_computation__'></a>value computation and
<a class='index' id=':side_effects__'></a>side effect associated with any argument
expression, or with the postfix expression designating the called
function, is sequenced before execution of every expression or statement
in the body of the called function<a class='hidden_link' href='#intro.execution-11.sentence-1'>.</a></div> <div id='intro.execution-11.sentence-2' class='sentence'>For each function invocation <i >F</i>,
for every evaluation <i >A</i> that occurs within <i >F</i> and
every evaluation <i >B</i> that does not occur within <i >F</i> but
is evaluated on the same thread and as part of the same signal handler (if any),
either <i >A</i> is sequenced before <i >B</i> or
<i >B</i> is sequenced before <i >A</i><a class='hidden_link' href='#intro.execution-11.sentence-2'>.</a><a class='footnoteref' href='#footnote-42' id='footnoteref-42' title='In other words, function executions do not interleave with each other.'>42</a></div> <div id='intro.execution-note-7' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.execution-note-7'>7</a></i>: <div id='intro.execution-11.sentence-3' class='sentence'>If <i >A</i> and <i >B</i> would not otherwise be sequenced then they are
indeterminately sequenced<a class='hidden_link' href='#intro.execution-11.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.execution-11.sentence-4' class='sentence'>
Several contexts in C++ cause evaluation of a function call, even
though no corresponding function call syntax appears in the translation
unit<a class='hidden_link' href='#intro.execution-11.sentence-4'>.</a></div> <div id='intro.execution-example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#intro.execution-example-4'>4</a></i>: <div id='intro.execution-11.sentence-5' class='sentence'>Evaluation of a <a href='expr.new#nt:new-expression' title='7.6.2.8&emsp;New&emsp;[expr.new]'><span id='ntref:new-expression'><span class='textsf'><i >new-expression</i></span></span></a> invokes one or more allocation
and constructor functions; see <a href='expr.new' title='7.6.2.8&emsp;New'>[expr.<span class='shy'></span>new]</a><a class='hidden_link' href='#intro.execution-11.sentence-5'>.</a></div> <div id='intro.execution-11.sentence-6' class='sentence'>For another example,
invocation of a conversion function (<a href='class.conv.fct' title='11.4.8.3&emsp;Conversion functions'>[class.<span class='shy'></span>conv.<span class='shy'></span>fct]</a>) can arise in
contexts in which no function call syntax appears<a class='hidden_link' href='#intro.execution-11.sentence-6'>.</a></div> —&nbsp;<i>end example</i>]</div></div> <div id='intro.execution-11.sentence-7' class='sentence'>
The sequencing constraints on the execution of the called function (as
described above) are features of the function calls as evaluated,
regardless of the syntax of the expression that calls the function<a class='hidden_link' href='#intro.execution-11.sentence-7'>.</a></div> <a class='index' id=':behavior,on_receipt_of_signal'></a><a class='index' id=':signal'></a></div></div><div class='para' id='intro.execution-12'><div class='marginalizedparent'><a class='marginalized' href='#intro.execution-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5670'>#</a></div><div class='texpara'><div id='intro.execution-12.sentence-1' class='sentence'>If a signal handler is executed as a result of a call to the <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>raise</span>
function, then the execution of the handler is sequenced after the invocation
of the <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>raise</span> function and before its return<a class='hidden_link' href='#intro.execution-12.sentence-1'>.</a></div> <div id='intro.execution-note-8' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.execution-note-8'>8</a></i>: <div id='intro.execution-12.sentence-2' class='sentence'>When a signal is received for another reason, the execution of the
signal handler is usually unsequenced with respect to the rest of the program<a class='hidden_link' href='#intro.execution-12.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> </div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-41'><div class='texpara'><a class='footnotenum' href='#footnote-41'>41)</a><a class='footnoteBacklink' href='#footnoteref-41'>41)</a> <div id='footnote-41.sentence-1' class='sentence'>As specified
in <a href='class.temporary' title='6.7.7&emsp;Temporary objects'>[class.<span class='shy'></span>temporary]</a>, after a full-expression is evaluated, a sequence of
zero or more invocations of destructor functions for temporary objects takes
place, usually in reverse order of the construction of each temporary object<a class='hidden_link' href='#footnote-41.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-42'><div class='texpara'><a class='footnotenum' href='#footnote-42'>42)</a><a class='footnoteBacklink' href='#footnoteref-42'>42)</a> <div id='footnote-42.sentence-1' class='sentence'>In other words,
function executions do not interleave with each other<a class='hidden_link' href='#footnote-42.sentence-1'>.</a></div></div></div></div><div id='intro.multithread' class='section'><h3 ><a class='secnum' href='#intro.multithread' style='min-width:80pt'>6.9.2</a> Multi-threaded executions and data races <a class='abbr_ref' href='intro.multithread'>[intro.multithread]</a></h3><div id='intro.multithread.general' class='section'><h4 ><a class='secnum' href='#intro.multithread.general' style='min-width:95pt'>6.9.2.1</a> General <a class='abbr_ref' href='intro.multithread.general'>[intro.multithread.general]</a></h4><div class='para' id='intro.multithread.general-1'><div class='marginalizedparent'><a class='marginalized' href='#intro.multithread.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5684'>#</a></div><div class='texpara'><div id='intro.multithread.general-1.sentence-1' class='sentence'><a class='index' id=':threads,multiple'></a><a class='index' id=':atomic,operation'></a>A <a class='hidden_link' href='#def:thread_of_execution' title='6.9.2.1&emsp;General&emsp;[intro.multithread.general]'><span id='def:thread_of_execution'><i >thread of execution</i></span></a> (also known as a <a class='hidden_link' href='#def:thread' title='6.9.2.1&emsp;General&emsp;[intro.multithread.general]'><span id='def:thread'><i >thread</i></span></a>) is a single flow of
control within a program, including the initial invocation of a specific
top-level function, and recursively including every function invocation
subsequently executed by the thread<a class='hidden_link' href='#intro.multithread.general-1.sentence-1'>.</a></div> <div id='intro.multithread.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.multithread.general-note-1'>1</a></i>: <div id='intro.multithread.general-1.sentence-2' class='sentence'>When one thread creates another,
the initial call to the top-level function of the new thread is executed by the
new thread, not by the creating thread<a class='hidden_link' href='#intro.multithread.general-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.multithread.general-1.sentence-3' class='sentence'>
Every thread in a program can
potentially access every object and function in a program<a class='hidden_link' href='#intro.multithread.general-1.sentence-3'>.</a><a class='footnoteref' href='#footnote-43' id='footnoteref-43' title='An object with automatic or thread storage duration ([basic.stc]) is associated with one specific thread, and can be accessed by a different thread only indirectly through a pointer or reference ([basic.compound]).'>43</a></div> <div id='intro.multithread.general-1.sentence-4' class='sentence'>
Under a hosted
implementation, a C++ program can have more than one thread running
concurrently<a class='hidden_link' href='#intro.multithread.general-1.sentence-4'>.</a></div> <div id='intro.multithread.general-1.sentence-5' class='sentence'>The execution of each thread proceeds as defined by the remainder
of this document<a class='hidden_link' href='#intro.multithread.general-1.sentence-5'>.</a></div> <div id='intro.multithread.general-1.sentence-6' class='sentence'>The execution of the entire program consists of an execution
of all of its threads<a class='hidden_link' href='#intro.multithread.general-1.sentence-6'>.</a></div> <div id='intro.multithread.general-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.multithread.general-note-2'>2</a></i>: <div id='intro.multithread.general-1.sentence-7' class='sentence'>Usually the execution can be viewed as an
interleaving of all its threads<a class='hidden_link' href='#intro.multithread.general-1.sentence-7'>.</a></div> <div id='intro.multithread.general-1.sentence-8' class='sentence'>However, some kinds of atomic operations, for
example, allow executions inconsistent with a simple interleaving, as described
below<a class='hidden_link' href='#intro.multithread.general-1.sentence-8'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.multithread.general-1.sentence-9' class='sentence'><a class='index' id=':implementation,freestanding'></a>Under a freestanding implementation, it is <a class='index' id=':number_of_threads_in_a_program_under_a_freestanding_implementation'></a>implementation-defined whether a program can
have more than one thread of execution<a class='hidden_link' href='#intro.multithread.general-1.sentence-9'>.</a></div></div></div><div class='para' id='intro.multithread.general-2'><div class='marginalizedparent'><a class='marginalized' href='#intro.multithread.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5720'>#</a></div><div class='texpara'><div id='intro.multithread.general-2.sentence-1' class='sentence'>For a signal handler that is not executed as a result of a call to the
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>raise</span> function, it is unspecified which thread of execution
contains the signal handler invocation<a class='hidden_link' href='#intro.multithread.general-2.sentence-1'>.</a></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-43'><div class='texpara'><a class='footnotenum' href='#footnote-43'>43)</a><a class='footnoteBacklink' href='#footnoteref-43'>43)</a> <div id='footnote-43.sentence-1' class='sentence'>An object
with automatic or thread storage duration (<a href='basic.stc' title='6.7.5&emsp;Storage duration'>[basic.<span class='shy'></span>stc]</a>) is associated with
one specific thread, and can be accessed by a different thread only indirectly
through a pointer or reference (<a href='basic.compound' title='6.8.3&emsp;Compound types'>[basic.<span class='shy'></span>compound]</a>)<a class='hidden_link' href='#footnote-43.sentence-1'>.</a></div></div></div></div><div id='intro.races' class='section'><h4 ><a class='secnum' href='#intro.races' style='min-width:95pt'>6.9.2.2</a> Data races <a class='abbr_ref' href='intro.races'>[intro.races]</a></h4><div class='para' id='intro.races-1'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5727'>#</a></div><div class='texpara'><div id='intro.races-1.sentence-1' class='sentence'>The value of an object visible to a thread <span class='math'><span class='mathalpha'>T</span></span> at a particular point is the
initial value of the object, a value assigned to the object by <span class='math'><span class='mathalpha'>T</span></span>, or a
value assigned to the object by another thread, according to the rules below<a class='hidden_link' href='#intro.races-1.sentence-1'>.</a></div> <div id='intro.races-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-1'>1</a></i>: <div id='intro.races-1.sentence-2' class='sentence'>In some cases, there might instead be undefined behavior<a class='hidden_link' href='#intro.races-1.sentence-2'>.</a></div> <div id='intro.races-1.sentence-3' class='sentence'>Much of this
subclause is motivated by the desire to support atomic operations with explicit
and detailed visibility constraints<a class='hidden_link' href='#intro.races-1.sentence-3'>.</a></div> <div id='intro.races-1.sentence-4' class='sentence'>However, it also implicitly supports a
simpler view for more restricted programs<a class='hidden_link' href='#intro.races-1.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-2'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5738'>#</a></div><div class='texpara'><div id='intro.races-2.sentence-1' class='sentence'>Two expression evaluations <a class='hidden_link' href='#def:conflict' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:conflict'><i >conflict</i></span></a> if one of them modifies a memory
location (<a href='intro.memory' title='6.7.1&emsp;Memory model'>[intro.<span class='shy'></span>memory]</a>) and the other one reads or modifies the same
memory location<a class='hidden_link' href='#intro.races-2.sentence-1'>.</a></div></div></div><div class='para' id='intro.races-3'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5743'>#</a></div><div class='texpara'><div id='intro.races-3.sentence-1' class='sentence'>The library defines a number of atomic operations (<a href='atomics' title='31&emsp;Atomic operations library'>[atomics]</a>) and
operations on mutexes (<a href='thread' title='32&emsp;Thread support library'>[thread]</a>) that are specially identified as
synchronization operations<a class='hidden_link' href='#intro.races-3.sentence-1'>.</a></div> <div id='intro.races-3.sentence-2' class='sentence'>These operations play a special role in making
assignments in one thread visible to another<a class='hidden_link' href='#intro.races-3.sentence-2'>.</a></div> <div id='intro.races-3.sentence-3' class='sentence'>A synchronization operation on one
or more memory locations is either a consume operation, an acquire operation, a
release operation, or both an acquire and release operation<a class='hidden_link' href='#intro.races-3.sentence-3'>.</a></div> <div id='intro.races-3.sentence-4' class='sentence'>A synchronization
operation without an associated memory location is a fence and can be either an
acquire fence, a release fence, or both an acquire and release fence<a class='hidden_link' href='#intro.races-3.sentence-4'>.</a></div> <div id='intro.races-3.sentence-5' class='sentence'>In
addition, there are relaxed atomic operations, which are not synchronization
operations, and atomic read-modify-write operations, which have special
characteristics<a class='hidden_link' href='#intro.races-3.sentence-5'>.</a></div> <div id='intro.races-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-2'>2</a></i>: <div id='intro.races-3.sentence-6' class='sentence'>For example, a call that acquires a mutex will
perform an acquire operation on the locations comprising the mutex<a class='hidden_link' href='#intro.races-3.sentence-6'>.</a></div> <div id='intro.races-3.sentence-7' class='sentence'>Correspondingly, a call that releases the same mutex will perform a release
operation on those same locations<a class='hidden_link' href='#intro.races-3.sentence-7'>.</a></div> <div id='intro.races-3.sentence-8' class='sentence'>Informally, performing a release operation on
<span class='math'><span class='mathalpha'>A</span></span> forces prior
<a class='index' id=':side_effects___'></a>side effects on other memory locations to become visible
to other threads that later perform a consume or an acquire operation on
<span class='math'><span class='mathalpha'>A</span></span><a class='hidden_link' href='#intro.races-3.sentence-8'>.</a></div> <div id='intro.races-3.sentence-9' class='sentence'>“Relaxed” atomic operations are not synchronization operations even
though, like synchronization operations, they cannot contribute to data races<a class='hidden_link' href='#intro.races-3.sentence-9'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-4'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5768'>#</a></div><div class='texpara'><div id='intro.races-4.sentence-1' class='sentence'>All modifications to a particular atomic object <span class='math'><span class='mathalpha'>M</span></span> occur in some
particular total order, called the <a class='hidden_link' href='#def:modification_order' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:modification_order'><i >modification order</i></span></a> of <span class='math'><span class='mathalpha'>M</span></span><a class='hidden_link' href='#intro.races-4.sentence-1'>.</a></div> <div id='intro.races-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-3'>3</a></i>: <div id='intro.races-4.sentence-2' class='sentence'>There is a separate order for each
atomic object<a class='hidden_link' href='#intro.races-4.sentence-2'>.</a></div> <div id='intro.races-4.sentence-3' class='sentence'>There is no requirement that these can be combined into a single
total order for all objects<a class='hidden_link' href='#intro.races-4.sentence-3'>.</a></div> <div id='intro.races-4.sentence-4' class='sentence'>In general this will be impossible since different
threads can observe modifications to different objects in inconsistent orders<a class='hidden_link' href='#intro.races-4.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-5'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5778'>#</a></div><div class='texpara'><div id='intro.races-5.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:release_sequence' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:release_sequence'><i >release sequence</i></span></a> headed
by a release operation <span class='math'><span class='mathalpha'>A</span></span> on an atomic object <span class='math'><span class='mathalpha'>M</span></span>
is a maximal contiguous sub-sequence of
<a class='index' id=':side_effects____'></a>side effects in the modification order of <span class='math'><span class='mathalpha'>M</span></span>,
where the first operation is <span class='math'><span class='mathalpha'>A</span></span>, and
every subsequent operation is an atomic read-modify-write operation<a class='hidden_link' href='#intro.races-5.sentence-1'>.</a></div></div></div><div class='para' id='intro.races-6'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5787'>#</a></div><div class='texpara'><div id='intro.races-6.sentence-1' class='sentence'>Certain library calls <a class='hidden_link' href='#def:synchronize_with' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:synchronize_with'><i >synchronize with</i></span></a> other library calls performed by
another thread<a class='hidden_link' href='#intro.races-6.sentence-1'>.</a></div> <div id='intro.races-6.sentence-2' class='sentence'>For example, an atomic store-release synchronizes with a
load-acquire that takes its value from the store (<a href='atomics.order' title='31.4&emsp;Order and consistency'>[atomics.<span class='shy'></span>order]</a>)<a class='hidden_link' href='#intro.races-6.sentence-2'>.</a></div> <div id='intro.races-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-4'>4</a></i>: <div id='intro.races-6.sentence-3' class='sentence'>Except in the specified cases, reading a later value does not
necessarily ensure visibility as described below<a class='hidden_link' href='#intro.races-6.sentence-3'>.</a></div> <div id='intro.races-6.sentence-4' class='sentence'>Such a requirement would
sometimes interfere with efficient implementation<a class='hidden_link' href='#intro.races-6.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.races-note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-5'>5</a></i>: <div id='intro.races-6.sentence-5' class='sentence'>The
specifications of the synchronization operations define when one reads the value
written by another<a class='hidden_link' href='#intro.races-6.sentence-5'>.</a></div> <div id='intro.races-6.sentence-6' class='sentence'>For atomic objects, the definition is clear<a class='hidden_link' href='#intro.races-6.sentence-6'>.</a></div> <div id='intro.races-6.sentence-7' class='sentence'>All operations
on a given mutex occur in a single total order<a class='hidden_link' href='#intro.races-6.sentence-7'>.</a></div> <div id='intro.races-6.sentence-8' class='sentence'>Each mutex acquisition “reads
the value written” by the last mutex release<a class='hidden_link' href='#intro.races-6.sentence-8'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-7'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5804'>#</a></div><div class='texpara'><div id='intro.races-7.sentence-1' class='sentence'>An evaluation <span class='math'><span class='mathalpha'>A</span></span> <a class='hidden_link' href='#def:carries_a_dependency' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:carries_a_dependency'><i >carries a dependency</i></span></a> to an evaluation <span class='math'><span class='mathalpha'>B</span></span> if
<ul class='itemize'><li id='intro.races-7.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-7.1'>(7.1)</a></div>the value of <span class='math'><span class='mathalpha'>A</span></span> is used as an operand of <span class='math'><span class='mathalpha'>B</span></span>, unless:
<ul class='itemize'><li id='intro.races-7.1.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#intro.races-7.1.1'>(7.1.1)</a></div><span class='math'><span class='mathalpha'>B</span></span> is an invocation of any specialization of
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>kill_&shy;dependency</span> (<a href='atomics.order' title='31.4&emsp;Order and consistency'>[atomics.<span class='shy'></span>order]</a>), or</li><li id='intro.races-7.1.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#intro.races-7.1.2'>(7.1.2)</a></div><span class='math'><span class='mathalpha'>A</span></span> is the left operand of a built-in logical AND (<span class='texttt'><span class='operator'>&amp;</span><span class='operator'>&amp;</span></span>,
see <a href='expr.log.and' title='7.6.14&emsp;Logical AND operator'>[expr.<span class='shy'></span>log.<span class='shy'></span>and]</a>) or logical OR (<span class='texttt'><span class='operator'>|</span><span class='operator'>|</span></span>, see <a href='expr.log.or' title='7.6.15&emsp;Logical OR operator'>[expr.<span class='shy'></span>log.<span class='shy'></span>or]</a>)
operator, or</li><li id='intro.races-7.1.3'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#intro.races-7.1.3'>(7.1.3)</a></div><span class='math'><span class='mathalpha'>A</span></span> is the left operand of a conditional (<span class='texttt'><span class='operator'>?</span><span class='operator'>:</span></span>, see <a href='expr.cond' title='7.6.16&emsp;Conditional operator'>[expr.<span class='shy'></span>cond]</a>)
operator, or</li><li id='intro.races-7.1.4'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#intro.races-7.1.4'>(7.1.4)</a></div><span class='math'><span class='mathalpha'>A</span></span> is the left operand of the built-in comma (<span class='texttt'>,</span>)
operator (<a href='expr.comma' title='7.6.20&emsp;Comma operator'>[expr.<span class='shy'></span>comma]</a>);</li></ul> or</li><li id='intro.races-7.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-7.2'>(7.2)</a></div><span class='math'><span class='mathalpha'>A</span></span> writes a scalar object or bit-field <span class='math'><span class='mathalpha'>M</span></span>, <span class='math'><span class='mathalpha'>B</span></span> reads the value
written by <span class='math'><span class='mathalpha'>A</span></span> from <span class='math'><span class='mathalpha'>M</span></span>, and <span class='math'><span class='mathalpha'>A</span></span> is sequenced before <span class='math'><span class='mathalpha'>B</span></span>, or</li><li id='intro.races-7.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-7.3'>(7.3)</a></div>for some evaluation <span class='math'><span class='mathalpha'>X</span></span>, <span class='math'><span class='mathalpha'>A</span></span> carries a dependency to <span class='math'><span class='mathalpha'>X</span></span>, and
<span class='math'><span class='mathalpha'>X</span></span> carries a dependency to <span class='math'><span class='mathalpha'>B</span></span><a class='hidden_link' href='#intro.races-7.sentence-1'>.</a></li></ul></div> <div id='intro.races-note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-6'>6</a></i>: <div id='intro.races-7.sentence-2' class='sentence'>“Carries a dependency to” is a subset of “is sequenced before”,
and is similarly strictly intra-thread<a class='hidden_link' href='#intro.races-7.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-8'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5835'>#</a></div><div class='texpara'><div id='intro.races-8.sentence-1' class='sentence'>An evaluation <span class='math'><span class='mathalpha'>A</span></span> is <a class='hidden_link' href='#def:dependency-ordered_before' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:dependency-ordered_before'><i >dependency-ordered before</i></span></a> an evaluation
<span class='math'><span class='mathalpha'>B</span></span> if
<ul class='itemize'><li id='intro.races-8.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-8.1'>(8.1)</a></div><span class='math'><span class='mathalpha'>A</span></span> performs a release operation on an atomic object <span class='math'><span class='mathalpha'>M</span></span>, and, in
another thread, <span class='math'><span class='mathalpha'>B</span></span> performs a consume operation on <span class='math'><span class='mathalpha'>M</span></span> and reads
the value written by <span class='math'><span class='mathalpha'>A</span></span>, or</li><li id='intro.races-8.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-8.2'>(8.2)</a></div>for some evaluation <span class='math'><span class='mathalpha'>X</span></span>, <span class='math'><span class='mathalpha'>A</span></span> is dependency-ordered before <span class='math'><span class='mathalpha'>X</span></span> and
<span class='math'><span class='mathalpha'>X</span></span> carries a dependency to <span class='math'><span class='mathalpha'>B</span></span><a class='hidden_link' href='#intro.races-8.sentence-1'>.</a></li></ul></div> <div id='intro.races-note-7' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-7'>7</a></i>: <div id='intro.races-8.sentence-2' class='sentence'>The relation “is dependency-ordered before” is analogous to
“synchronizes with”, but uses release/consume in place of release/acquire<a class='hidden_link' href='#intro.races-8.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-9'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5853'>#</a></div><div class='texpara'><div id='intro.races-9.sentence-1' class='sentence'>An evaluation <span class='math'><span class='mathalpha'>A</span></span> <a class='hidden_link' href='#def:inter-thread_happens_before' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:inter-thread_happens_before'><i >inter-thread happens before</i></span></a> an evaluation <span class='math'><span class='mathalpha'>B</span></span>
if
<ul class='itemize'><li id='intro.races-9.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-9.1'>(9.1)</a></div><span class='math'><span class='mathalpha'>A</span></span> synchronizes with <span class='math'><span class='mathalpha'>B</span></span>, or</li><li id='intro.races-9.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-9.2'>(9.2)</a></div><span class='math'><span class='mathalpha'>A</span></span> is dependency-ordered before <span class='math'><span class='mathalpha'>B</span></span>, or</li><li id='intro.races-9.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-9.3'>(9.3)</a></div>for some evaluation <span class='math'><span class='mathalpha'>X</span></span>
  <ul class='itemize'><li id='intro.races-9.3.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#intro.races-9.3.1'>(9.3.1)</a></div><span class='math'><span class='mathalpha'>A</span></span> synchronizes with <span class='math'><span class='mathalpha'>X</span></span> and <span class='math'><span class='mathalpha'>X</span></span>
    is sequenced before <span class='math'><span class='mathalpha'>B</span></span>, or</li><li id='intro.races-9.3.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#intro.races-9.3.2'>(9.3.2)</a></div><span class='math'><span class='mathalpha'>A</span></span> is sequenced before <span class='math'><span class='mathalpha'>X</span></span> and <span class='math'><span class='mathalpha'>X</span></span>
    inter-thread happens before <span class='math'><span class='mathalpha'>B</span></span>, or</li><li id='intro.races-9.3.3'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#intro.races-9.3.3'>(9.3.3)</a></div><span class='math'><span class='mathalpha'>A</span></span> inter-thread happens before <span class='math'><span class='mathalpha'>X</span></span> and <span class='math'><span class='mathalpha'>X</span></span>
    inter-thread happens before <span class='math'><span class='mathalpha'>B</span></span><a class='hidden_link' href='#intro.races-9.sentence-1'>.</a></li></ul></li></ul></div> <div id='intro.races-note-8' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-8'>8</a></i>: <div id='intro.races-9.sentence-2' class='sentence'>The “inter-thread happens before” relation describes arbitrary
concatenations of “sequenced before”, “synchronizes with” and
“dependency-ordered before” relationships, with two exceptions<a class='hidden_link' href='#intro.races-9.sentence-2'>.</a></div> <div id='intro.races-9.sentence-3' class='sentence'>The first
exception is that a concatenation is not permitted to end with
“dependency-ordered before” followed by “sequenced before”<a class='hidden_link' href='#intro.races-9.sentence-3'>.</a></div> <div id='intro.races-9.sentence-4' class='sentence'>The reason for
this limitation is that a consume operation participating in a
“dependency-ordered before” relationship provides ordering only with respect
to operations to which this consume operation actually carries a dependency<a class='hidden_link' href='#intro.races-9.sentence-4'>.</a></div> <div id='intro.races-9.sentence-5' class='sentence'>The
reason that this limitation applies only to the end of such a concatenation is
that any subsequent release operation will provide the required ordering for a
prior consume operation<a class='hidden_link' href='#intro.races-9.sentence-5'>.</a></div> <div id='intro.races-9.sentence-6' class='sentence'>The second exception is that a concatenation is not
permitted to consist entirely of “sequenced before”<a class='hidden_link' href='#intro.races-9.sentence-6'>.</a></div> <div id='intro.races-9.sentence-7' class='sentence'>The reasons for this
limitation are (1) to permit “inter-thread happens before” to be transitively
closed and (2) the “happens before” relation, defined below, provides for
relationships consisting entirely of “sequenced before”<a class='hidden_link' href='#intro.races-9.sentence-7'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-10'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5893'>#</a></div><div class='texpara'><div id='intro.races-10.sentence-1' class='sentence'>An evaluation <span class='math'><span class='mathalpha'>A</span></span> <a class='hidden_link' href='#def:happens_before' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:happens_before'><i >happens before</i></span></a> an evaluation <span class='math'><span class='mathalpha'>B</span></span>
(or, equivalently, <span class='math'><span class='mathalpha'>B</span></span> <a class='hidden_link' href='#def:happens_after' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:happens_after'><i >happens after</i></span></a> <span class='math'><span class='mathalpha'>A</span></span>) if:
<ul class='itemize'><li id='intro.races-10.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-10.1'>(10.1)</a></div><span class='math'><span class='mathalpha'>A</span></span> is sequenced before <span class='math'><span class='mathalpha'>B</span></span>, or</li><li id='intro.races-10.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-10.2'>(10.2)</a></div><span class='math'><span class='mathalpha'>A</span></span> inter-thread happens before <span class='math'><span class='mathalpha'>B</span></span><a class='hidden_link' href='#intro.races-10.sentence-1'>.</a></li></ul></div> <div id='intro.races-10.sentence-2' class='sentence'>
The implementation shall ensure that no program execution demonstrates a cycle
in the “happens before” relation<a class='hidden_link' href='#intro.races-10.sentence-2'>.</a></div> <div id='intro.races-note-9' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-9'>9</a></i>: <div id='intro.races-10.sentence-3' class='sentence'>This cycle would otherwise be
possible only through the use of consume operations<a class='hidden_link' href='#intro.races-10.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-11'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5907'>#</a></div><div class='texpara'><div id='intro.races-11.sentence-1' class='sentence'>An evaluation <span class='math'><span class='mathalpha'>A</span></span> <a class='hidden_link' href='#def:simply_happens_before' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:simply_happens_before'><i >simply happens before</i></span></a> an evaluation <span class='math'><span class='mathalpha'>B</span></span>
if either
<ul class='itemize'><li id='intro.races-11.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-11.1'>(11.1)</a></div><span class='math'><span class='mathalpha'>A</span></span> is sequenced before <span class='math'><span class='mathalpha'>B</span></span>, or</li><li id='intro.races-11.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-11.2'>(11.2)</a></div><span class='math'><span class='mathalpha'>A</span></span> synchronizes with <span class='math'><span class='mathalpha'>B</span></span>, or</li><li id='intro.races-11.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-11.3'>(11.3)</a></div><span class='math'><span class='mathalpha'>A</span></span> simply happens before <span class='math'><span class='mathalpha'>X</span></span> and
<span class='math'><span class='mathalpha'>X</span></span> simply happens before <span class='math'><span class='mathalpha'>B</span></span><a class='hidden_link' href='#intro.races-11.sentence-1'>.</a></li></ul></div> <div id='intro.races-note-10' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-10'>10</a></i>: <div id='intro.races-11.sentence-2' class='sentence'>In the absence of consume operations,
the happens before and simply happens before relations are identical<a class='hidden_link' href='#intro.races-11.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-12'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5921'>#</a></div><div class='texpara'><div id='intro.races-12.sentence-1' class='sentence'>An evaluation <span class='math'><span class='mathalpha'>A</span></span> <a class='hidden_link' href='#def:strongly_happens_before' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:strongly_happens_before'><i >strongly happens before</i></span></a>
an evaluation <span class='math'><span class='mathalpha'>D</span></span> if, either
<ul class='itemize'><li id='intro.races-12.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-12.1'>(12.1)</a></div><span class='math'><span class='mathalpha'>A</span></span> is sequenced before <span class='math'><span class='mathalpha'>D</span></span>, or</li><li id='intro.races-12.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-12.2'>(12.2)</a></div><span class='math'><span class='mathalpha'>A</span></span> synchronizes with <span class='math'><span class='mathalpha'>D</span></span>, and
both <span class='math'><span class='mathalpha'>A</span></span> and <span class='math'><span class='mathalpha'>D</span></span> are
sequentially consistent atomic operations (<a href='atomics.order' title='31.4&emsp;Order and consistency'>[atomics.<span class='shy'></span>order]</a>), or</li><li id='intro.races-12.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-12.3'>(12.3)</a></div>there are evaluations <span class='math'><span class='mathalpha'>B</span></span> and <span class='math'><span class='mathalpha'>C</span></span>
such that <span class='math'><span class='mathalpha'>A</span></span> is sequenced before <span class='math'><span class='mathalpha'>B</span></span>,
<span class='math'><span class='mathalpha'>B</span></span> simply happens before <span class='math'><span class='mathalpha'>C</span></span>, and
<span class='math'><span class='mathalpha'>C</span></span> is sequenced before <span class='math'><span class='mathalpha'>D</span></span>, or</li><li id='intro.races-12.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-12.4'>(12.4)</a></div>there is an evaluation <span class='math'><span class='mathalpha'>B</span></span> such that
<span class='math'><span class='mathalpha'>A</span></span> strongly happens before <span class='math'><span class='mathalpha'>B</span></span>, and
<span class='math'><span class='mathalpha'>B</span></span> strongly happens before <span class='math'><span class='mathalpha'>D</span></span><a class='hidden_link' href='#intro.races-12.sentence-1'>.</a></li></ul></div> <div id='intro.races-note-11' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-11'>11</a></i>: <div id='intro.races-12.sentence-2' class='sentence'>Informally, if <span class='math'><span class='mathalpha'>A</span></span> strongly happens before <span class='math'><span class='mathalpha'>B</span></span>,
then <span class='math'><span class='mathalpha'>A</span></span> appears to be evaluated before <span class='math'><span class='mathalpha'>B</span></span>
in all contexts<a class='hidden_link' href='#intro.races-12.sentence-2'>.</a></div> <div id='intro.races-12.sentence-3' class='sentence'>Strongly happens before excludes consume operations<a class='hidden_link' href='#intro.races-12.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-13'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5943'>#</a></div><div class='texpara'><div id='intro.races-13.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:side_effects,visible' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:side_effects,visible'><i >visible side effect</i></span></a> <span class='math'><span class='mathalpha'>A</span></span> on a scalar object or bit-field <span class='math'><span class='mathalpha'>M</span></span>
with respect to a value computation <span class='math'><span class='mathalpha'>B</span></span> of <span class='math'><span class='mathalpha'>M</span></span> satisfies the
conditions:
<ul class='itemize'><li id='intro.races-13.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-13.1'>(13.1)</a></div><span class='math'><span class='mathalpha'>A</span></span> happens before <span class='math'><span class='mathalpha'>B</span></span> and</li><li id='intro.races-13.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-13.2'>(13.2)</a></div>there is no other
<a class='index' id=':side_effects_____'></a>side effect <span class='math'><span class='mathalpha'>X</span></span> to <span class='math'><span class='mathalpha'>M</span></span> such that <span class='math'><span class='mathalpha'>A</span></span>
happens before <span class='math'><span class='mathalpha'>X</span></span> and <span class='math'><span class='mathalpha'>X</span></span> happens before <span class='math'><span class='mathalpha'>B</span></span><a class='hidden_link' href='#intro.races-13.sentence-1'>.</a></li></ul></div></div><div class='texpara'><div id='intro.races-13.sentence-2' class='sentence'>The value of a non-atomic scalar object or bit-field <span class='math'><span class='mathalpha'>M</span></span>, as determined by
evaluation <span class='math'><span class='mathalpha'>B</span></span>, shall be the value stored by the
<a class='index' id=':side_effects,visible'></a>visible side effect <span class='math'><span class='mathalpha'>A</span></span><a class='hidden_link' href='#intro.races-13.sentence-2'>.</a></div> <div id='intro.races-note-12' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-12'>12</a></i>: <div id='intro.races-13.sentence-3' class='sentence'>If there is ambiguity about which side effect to a
non-atomic object or bit-field is visible, then the behavior is either
unspecified or undefined<a class='hidden_link' href='#intro.races-13.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.races-note-13' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-13'>13</a></i>: <div id='intro.races-13.sentence-4' class='sentence'>This states that operations on
ordinary objects are not visibly reordered<a class='hidden_link' href='#intro.races-13.sentence-4'>.</a></div> <div id='intro.races-13.sentence-5' class='sentence'>This is not actually detectable
without data races, but it is necessary to ensure that data races, as defined
below, and with suitable restrictions on the use of atomics, correspond to data
races in a simple interleaved (sequentially consistent) execution<a class='hidden_link' href='#intro.races-13.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-14'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5972'>#</a></div><div class='texpara'><div id='intro.races-14.sentence-1' class='sentence'>The value of an
atomic object <span class='math'><span class='mathalpha'>M</span></span>, as determined by evaluation <span class='math'><span class='mathalpha'>B</span></span>, shall be the value
stored by some
side effect <span class='math'><span class='mathalpha'>A</span></span> that modifies <span class='math'><span class='mathalpha'>M</span></span>, where <span class='math'><span class='mathalpha'>B</span></span> does not happen
before <span class='math'><span class='mathalpha'>A</span></span><a class='hidden_link' href='#intro.races-14.sentence-1'>.</a></div> <div id='intro.races-note-14' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-14'>14</a></i>: <div id='intro.races-14.sentence-2' class='sentence'>The set of such side effects is also restricted by the rest of the rules
described here, and in particular, by the coherence requirements below<a class='hidden_link' href='#intro.races-14.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-15'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5983'>#</a></div><div class='texpara'><div id='intro.races-15.sentence-1' class='sentence'><a class='index' id=':coherence,write-write'></a>If an operation <span class='math'><span class='mathalpha'>A</span></span> that modifies an atomic object <span class='math'><span class='mathalpha'>M</span></span> happens before
an operation <span class='math'><span class='mathalpha'>B</span></span> that modifies <span class='math'><span class='mathalpha'>M</span></span>, then <span class='math'><span class='mathalpha'>A</span></span> shall be earlier
than <span class='math'><span class='mathalpha'>B</span></span> in the modification order of <span class='math'><span class='mathalpha'>M</span></span><a class='hidden_link' href='#intro.races-15.sentence-1'>.</a></div> <div id='intro.races-note-15' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-15'>15</a></i>: <div id='intro.races-15.sentence-2' class='sentence'>This requirement is known as write-write coherence<a class='hidden_link' href='#intro.races-15.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-16'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L5992'>#</a></div><div class='texpara'><div id='intro.races-16.sentence-1' class='sentence'><a class='index' id=':coherence,read-read'></a>If a
<a class='index' id=':value_computation___'></a>value computation <span class='math'><span class='mathalpha'>A</span></span> of an atomic object <span class='math'><span class='mathalpha'>M</span></span> happens before a
value computation <span class='math'><span class='mathalpha'>B</span></span> of <span class='math'><span class='mathalpha'>M</span></span>, and <span class='math'><span class='mathalpha'>A</span></span> takes its value from a side
effect <span class='math'><span class='mathalpha'>X</span></span> on <span class='math'><span class='mathalpha'>M</span></span>, then the value computed by <span class='math'><span class='mathalpha'>B</span></span> shall either be
the value stored by <span class='math'><span class='mathalpha'>X</span></span> or the value stored by a
<a class='index' id=':side_effects______'></a>side effect <span class='math'><span class='mathalpha'>Y</span></span> on <span class='math'><span class='mathalpha'>M</span></span>,
where <span class='math'><span class='mathalpha'>Y</span></span> follows <span class='math'><span class='mathalpha'>X</span></span> in the modification order of <span class='math'><span class='mathalpha'>M</span></span><a class='hidden_link' href='#intro.races-16.sentence-1'>.</a></div> <div id='intro.races-note-16' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-16'>16</a></i>: <div id='intro.races-16.sentence-2' class='sentence'>This requirement is known as read-read coherence<a class='hidden_link' href='#intro.races-16.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-17'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6007'>#</a></div><div class='texpara'><div id='intro.races-17.sentence-1' class='sentence'><a class='index' id=':coherence,read-write'></a>If a
<a class='index' id=':value_computation____'></a>value computation <span class='math'><span class='mathalpha'>A</span></span> of an atomic object <span class='math'><span class='mathalpha'>M</span></span> happens before an
operation <span class='math'><span class='mathalpha'>B</span></span> that modifies <span class='math'><span class='mathalpha'>M</span></span>, then <span class='math'><span class='mathalpha'>A</span></span> shall take its value from a side
effect <span class='math'><span class='mathalpha'>X</span></span> on <span class='math'><span class='mathalpha'>M</span></span>, where <span class='math'><span class='mathalpha'>X</span></span> precedes <span class='math'><span class='mathalpha'>B</span></span> in the
modification order of <span class='math'><span class='mathalpha'>M</span></span><a class='hidden_link' href='#intro.races-17.sentence-1'>.</a></div> <div id='intro.races-note-17' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-17'>17</a></i>: <div id='intro.races-17.sentence-2' class='sentence'>This requirement is known as
read-write coherence<a class='hidden_link' href='#intro.races-17.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-18'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6020'>#</a></div><div class='texpara'><div id='intro.races-18.sentence-1' class='sentence'><a class='index' id=':coherence,write-read'></a>If a
<a class='index' id=':side_effects_______'></a>side effect <span class='math'><span class='mathalpha'>X</span></span> on an atomic object <span class='math'><span class='mathalpha'>M</span></span> happens before a value
computation <span class='math'><span class='mathalpha'>B</span></span> of <span class='math'><span class='mathalpha'>M</span></span>, then the evaluation <span class='math'><span class='mathalpha'>B</span></span> shall take its
value from <span class='math'><span class='mathalpha'>X</span></span> or from a
<a class='index' id=':side_effects________'></a>side effect <span class='math'><span class='mathalpha'>Y</span></span> that follows <span class='math'><span class='mathalpha'>X</span></span> in the modification order of <span class='math'><span class='mathalpha'>M</span></span><a class='hidden_link' href='#intro.races-18.sentence-1'>.</a></div> <div id='intro.races-note-18' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-18'>18</a></i>: <div id='intro.races-18.sentence-2' class='sentence'>This requirement is known as write-read coherence<a class='hidden_link' href='#intro.races-18.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='intro.races-19'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-19'>19</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6033'>#</a></div><div class='texpara'><div id='intro.races-note-19' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-19'>19</a></i>: <div id='intro.races-19.sentence-1' class='sentence'>The four preceding coherence requirements effectively disallow
compiler reordering of atomic operations to a single object, even if both
operations are relaxed loads<a class='hidden_link' href='#intro.races-19.sentence-1'>.</a></div> <div id='intro.races-19.sentence-2' class='sentence'>This effectively makes the cache coherence
guarantee provided by most hardware available to C++ atomic operations<a class='hidden_link' href='#intro.races-19.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='intro.races-20'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-20'>20</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6041'>#</a></div><div class='texpara'><div id='intro.races-note-20' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-20'>20</a></i>: <div id='intro.races-20.sentence-1' class='sentence'>The value observed by a load of an atomic depends on the “happens
before” relation, which depends on the values observed by loads of atomics<a class='hidden_link' href='#intro.races-20.sentence-1'>.</a></div> <div id='intro.races-20.sentence-2' class='sentence'>The intended reading is that there must exist an
association of atomic loads with modifications they observe that, together with
suitably chosen modification orders and the “happens before” relation derived
as described above, satisfy the resulting constraints as imposed here<a class='hidden_link' href='#intro.races-20.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-21'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-21'>21</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6051'>#</a></div><div class='texpara'><div id='intro.races-21.sentence-1' class='sentence'>Two actions are <a class='hidden_link' href='#def:potentially_concurrent' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:potentially_concurrent'><i >potentially concurrent</i></span></a> if
<ul class='itemize'><li id='intro.races-21.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-21.1'>(21.1)</a></div>they are performed by different threads, or</li><li id='intro.races-21.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.races-21.2'>(21.2)</a></div>they are unsequenced, at least one is performed by a signal handler, and
they are not both performed by the same signal handler invocation<a class='hidden_link' href='#intro.races-21.sentence-1'>.</a></li></ul></div> <div id='intro.races-21.sentence-2' class='sentence'>
The execution of a program contains a <a class='hidden_link' href='#def:data_race' title='6.9.2.2&emsp;Data races&emsp;[intro.races]'><span id='def:data_race'><i >data race</i></span></a> if it contains two
potentially concurrent conflicting actions, at least one of which is not atomic,
and neither happens before the other,
except for the special case for signal handlers described below<a class='hidden_link' href='#intro.races-21.sentence-2'>.</a></div> <div id='intro.races-21.sentence-3' class='sentence'>Any such data race results in undefined
behavior<a class='hidden_link' href='#intro.races-21.sentence-3'>.</a></div> <div id='intro.races-note-21' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-21'>21</a></i>: <div id='intro.races-21.sentence-4' class='sentence'>It can be shown that programs that correctly use mutexes
and <span class='texttt'>memory_&shy;order<span class='operator'>&#x200b;::&#x200b;</span>seq_&shy;cst</span> operations to prevent all data races and use no
other synchronization operations behave as if the operations executed by their
constituent threads were simply interleaved, with each
<a class='index' id=':value_computation_____'></a>value computation of an
object being taken from the last
<a class='index' id=':side_effects_________'></a>side effect on that object in that
interleaving<a class='hidden_link' href='#intro.races-21.sentence-4'>.</a></div> <div id='intro.races-21.sentence-5' class='sentence'>This is normally referred to as “sequential consistency”<a class='hidden_link' href='#intro.races-21.sentence-5'>.</a></div> <div id='intro.races-21.sentence-6' class='sentence'>However, this applies only to data-race-free programs, and data-race-free
programs cannot observe most program transformations that do not change
single-threaded program semantics<a class='hidden_link' href='#intro.races-21.sentence-6'>.</a></div> <div id='intro.races-21.sentence-7' class='sentence'>In fact, most single-threaded program
transformations continue to be allowed, since any program that behaves
differently as a result has undefined behavior<a class='hidden_link' href='#intro.races-21.sentence-7'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.races-22'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-22'>22</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6082'>#</a></div><div class='texpara'><div id='intro.races-22.sentence-1' class='sentence'>Two accesses to the same object of type <span class='texttt'><span class='keyword'>volatile</span> std<span class='operator'>&#x200b;::&#x200b;</span>sig_&shy;atomic_&shy;t</span> do not
result in a data race if both occur in the same thread, even if one or more
occurs in a signal handler<a class='hidden_link' href='#intro.races-22.sentence-1'>.</a></div> <div id='intro.races-22.sentence-2' class='sentence'>For each signal handler invocation, evaluations
performed by the thread invoking a signal handler can be divided into two
groups <span class='math'><span class='mathalpha'>A</span></span> and <span class='math'><span class='mathalpha'>B</span></span>, such that no evaluations in
<span class='math'><span class='mathalpha'>B</span></span> happen before evaluations in <span class='math'><span class='mathalpha'>A</span></span>, and the
evaluations of such <span class='texttt'><span class='keyword'>volatile</span> std<span class='operator'>&#x200b;::&#x200b;</span>sig_&shy;atomic_&shy;t</span> objects take values as though
all evaluations in <span class='math'><span class='mathalpha'>A</span></span> happened before the execution of the signal
handler and the execution of the signal handler happened before all evaluations
in <span class='math'><span class='mathalpha'>B</span></span><a class='hidden_link' href='#intro.races-22.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='intro.races-23'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-23'>23</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6094'>#</a></div><div class='texpara'><div id='intro.races-note-22' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-22'>22</a></i>: <div id='intro.races-23.sentence-1' class='sentence'>Compiler transformations that introduce assignments to a potentially
shared memory location that would not be modified by the abstract machine are
generally precluded by this document, since such an assignment might overwrite
another assignment by a different thread in cases in which an abstract machine
execution would not have encountered a data race<a class='hidden_link' href='#intro.races-23.sentence-1'>.</a></div> <div id='intro.races-23.sentence-2' class='sentence'>This includes implementations
of data member assignment that overwrite adjacent members in separate memory
locations<a class='hidden_link' href='#intro.races-23.sentence-2'>.</a></div> <div id='intro.races-23.sentence-3' class='sentence'>Reordering of atomic loads in cases in which the atomics in question
might alias is also generally precluded, since this could violate the coherence
rules<a class='hidden_link' href='#intro.races-23.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='intro.races-24'><div class='marginalizedparent'><a class='marginalized' href='#intro.races-24'>24</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6107'>#</a></div><div class='texpara'><div id='intro.races-note-23' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.races-note-23'>23</a></i>: <div id='intro.races-24.sentence-1' class='sentence'>Transformations that introduce a speculative read of a potentially
shared memory location might not preserve the semantics of the C++ program as
defined in this document, since they potentially introduce a data race<a class='hidden_link' href='#intro.races-24.sentence-1'>.</a></div> <div id='intro.races-24.sentence-2' class='sentence'>However,
they are typically valid in the context of an optimizing compiler that targets a
specific machine with well-defined semantics for data races<a class='hidden_link' href='#intro.races-24.sentence-2'>.</a></div> <div id='intro.races-24.sentence-3' class='sentence'>They would be
invalid for a hypothetical machine that is not tolerant of races or provides
hardware race detection<a class='hidden_link' href='#intro.races-24.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='intro.progress' class='section'><h4 ><a class='secnum' href='#intro.progress' style='min-width:95pt'>6.9.2.3</a> Forward progress <a class='abbr_ref' href='intro.progress'>[intro.progress]</a></h4><div class='para' id='intro.progress-1'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6120'>#</a></div><div class='texpara'><div id='intro.progress-1.sentence-1' class='sentence'>The implementation may assume that any thread will eventually do one of the
following:
<ul class='itemize'><li id='intro.progress-1.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-1.1'>(1.1)</a></div>terminate,</li><li id='intro.progress-1.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-1.2'>(1.2)</a></div>make a call to a library I/O function,</li><li id='intro.progress-1.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-1.3'>(1.3)</a></div>perform an access through a volatile glvalue, or</li><li id='intro.progress-1.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-1.4'>(1.4)</a></div>perform a synchronization operation or an atomic operation<a class='hidden_link' href='#intro.progress-1.sentence-1'>.</a></li></ul></div> <div id='intro.progress-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-1'>1</a></i>: <div id='intro.progress-1.sentence-2' class='sentence'>This is intended to allow compiler transformations such as removal of
empty loops, even when termination cannot be proven<a class='hidden_link' href='#intro.progress-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.progress-2'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6134'>#</a></div><div class='texpara'><div id='intro.progress-2.sentence-1' class='sentence'>Executions of atomic functions
that are either defined to be lock-free (<a href='atomics.flag' title='31.10&emsp;Flag type and operations'>[atomics.<span class='shy'></span>flag]</a>)
or indicated as lock-free (<a href='atomics.lockfree' title='31.5&emsp;Lock-free property'>[atomics.<span class='shy'></span>lockfree]</a>)
are <a class='hidden_link' href='#def:lock-free_execution' title='6.9.2.3&emsp;Forward progress&emsp;[intro.progress]'><span id='def:lock-free_execution'><i >lock-free executions</i></span></a><a class='hidden_link' href='#intro.progress-2.sentence-1'>.</a></div> <ul class='itemize'><li id='intro.progress-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-2.1'>(2.1)</a></div><div class='texpara'><div id='intro.progress-2.1.sentence-1' class='sentence'>If there is only one thread that is not blocked (<a href='defns.block' title='3.7&emsp;block'>[defns.<span class='shy'></span>block]</a>)
  in a standard library function,
  a lock-free execution in that thread shall complete<a class='hidden_link' href='#intro.progress-2.1.sentence-1'>.</a></div> <div id='intro.progress-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-2'>2</a></i>: <div id='intro.progress-2.1.sentence-2' class='sentence'>Concurrently executing threads
    might prevent progress of a lock-free execution<a class='hidden_link' href='#intro.progress-2.1.sentence-2'>.</a></div> <div id='intro.progress-2.1.sentence-3' class='sentence'>For example,
    this situation can occur
    with load-locked store-conditional implementations<a class='hidden_link' href='#intro.progress-2.1.sentence-3'>.</a></div> <div id='intro.progress-2.1.sentence-4' class='sentence'>This property is sometimes termed obstruction-free<a class='hidden_link' href='#intro.progress-2.1.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li><li id='intro.progress-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-2.2'>(2.2)</a></div><div class='texpara'><div id='intro.progress-2.2.sentence-1' class='sentence'>When one or more lock-free executions run concurrently,
  at least one should complete<a class='hidden_link' href='#intro.progress-2.2.sentence-1'>.</a></div> <div id='intro.progress-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-3'>3</a></i>: <div id='intro.progress-2.2.sentence-2' class='sentence'>It is difficult for some implementations
    to provide absolute guarantees to this effect,
    since repeated and particularly inopportune interference
    from other threads
    could prevent forward progress,
    e.g.,
    by repeatedly stealing a cache line
    for unrelated purposes
    between load-locked and store-conditional instructions<a class='hidden_link' href='#intro.progress-2.2.sentence-2'>.</a></div> <div id='intro.progress-2.2.sentence-3' class='sentence'>For implementations that follow this recommendation and
    ensure that such effects cannot indefinitely delay progress
    under expected operating conditions,
    such anomalies
    can therefore safely be ignored by programmers<a class='hidden_link' href='#intro.progress-2.2.sentence-3'>.</a></div> <div id='intro.progress-2.2.sentence-4' class='sentence'>Outside this document,
    this property is sometimes termed lock-free<a class='hidden_link' href='#intro.progress-2.2.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li></ul></div></div><div class='para' id='intro.progress-3'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6175'>#</a></div><div class='texpara'><div id='intro.progress-3.sentence-1' class='sentence'>During the execution of a thread of execution, each of the following is termed
an <a class='hidden_link' href='#def:execution_step' title='6.9.2.3&emsp;Forward progress&emsp;[intro.progress]'><span id='def:execution_step'><i >execution step</i></span></a>:
<ul class='itemize'><li id='intro.progress-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-3.1'>(3.1)</a></div>termination of the thread of execution,</li><li id='intro.progress-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-3.2'>(3.2)</a></div>performing an access through a volatile glvalue, or</li><li id='intro.progress-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#intro.progress-3.3'>(3.3)</a></div>completion of a call to a library I/O function, a
      synchronization operation, or an atomic operation<a class='hidden_link' href='#intro.progress-3.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='intro.progress-4'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6185'>#</a></div><div class='texpara'><div id='intro.progress-4.sentence-1' class='sentence'>An invocation of a standard library function that blocks (<a href='defns.block' title='3.7&emsp;block'>[defns.<span class='shy'></span>block]</a>)
is considered to continuously execute execution steps while waiting for the
condition that it blocks on to be satisfied<a class='hidden_link' href='#intro.progress-4.sentence-1'>.</a></div> <div id='intro.progress-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#intro.progress-example-1'>1</a></i>: <div id='intro.progress-4.sentence-2' class='sentence'>A library I/O function that blocks until the I/O operation is complete can
be considered to continuously check whether the operation is complete<a class='hidden_link' href='#intro.progress-4.sentence-2'>.</a></div> <div id='intro.progress-4.sentence-3' class='sentence'>Each
such check consists of one or more execution steps, for example using
observable behavior of the abstract machine<a class='hidden_link' href='#intro.progress-4.sentence-3'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para nonNormativeOnly' id='intro.progress-5'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6196'>#</a></div><div class='texpara'><div id='intro.progress-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-4'>4</a></i>: <div id='intro.progress-5.sentence-1' class='sentence'>Because of this and the preceding requirement regarding what threads of execution
have to perform eventually, it follows that no thread of execution can execute
forever without an execution step occurring<a class='hidden_link' href='#intro.progress-5.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.progress-6'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6203'>#</a></div><div class='texpara'><div id='intro.progress-6.sentence-1' class='sentence'>A thread of execution <a class='hidden_link' href='#def:make_progress,thread' title='6.9.2.3&emsp;Forward progress&emsp;[intro.progress]'><span id='def:make_progress,thread'><i >makes progress</i></span></a>
when an execution step occurs or a
lock-free execution does not complete because there are other concurrent threads
that are not blocked in a standard library function (see above)<a class='hidden_link' href='#intro.progress-6.sentence-1'>.</a></div></div></div><div class='para' id='intro.progress-7'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6209'>#</a></div><div class='texpara'><div id='intro.progress-7.sentence-1' class='sentence'><a class='index' id=':forward_progress_guarantees,concurrent'></a>For a thread of execution providing <a class='hidden_link' href='#def:concurrent_forward_progress_guarantees' title='6.9.2.3&emsp;Forward progress&emsp;[intro.progress]'><span id='def:concurrent_forward_progress_guarantees'><i >concurrent forward progress guarantees</i></span></a>,
the implementation ensures that the thread will eventually make progress for as
long as it has not terminated<a class='hidden_link' href='#intro.progress-7.sentence-1'>.</a></div> <div id='intro.progress-note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-5'>5</a></i>: <div id='intro.progress-7.sentence-2' class='sentence'>This is required regardless of whether or not other threads of executions (if any)
have been or are making progress<a class='hidden_link' href='#intro.progress-7.sentence-2'>.</a></div> <div id='intro.progress-7.sentence-3' class='sentence'>To eventually fulfill this requirement means that
this will happen in an unspecified but finite amount of time<a class='hidden_link' href='#intro.progress-7.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.progress-8'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6220'>#</a></div><div class='texpara'><div id='intro.progress-8.sentence-1' class='sentence'>It is <a class='index' id=':whether_the_thread_that_executes_main_and_the_threads_created_by_std::thread_or_std::jthread_provide_concurrent_forward_progress_guarantees'></a>implementation-defined whether the
implementation-created thread of execution that executes
<span class='texttt'>main</span> (<a href='#basic.start.main' title='6.9.3.1&emsp;main function'>[basic.<span class='shy'></span>start.<span class='shy'></span>main]</a>) and the threads of execution created by
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>thread</span> (<a href='thread.thread.class' title='32.4.3&emsp;Class thread'>[thread.<span class='shy'></span>thread.<span class='shy'></span>class]</a>)
or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>jthread</span> (<a href='thread.jthread.class' title='32.4.4&emsp;Class jthread'>[thread.<span class='shy'></span>jthread.<span class='shy'></span>class]</a>)
provide concurrent forward progress guarantees<a class='hidden_link' href='#intro.progress-8.sentence-1'>.</a></div> <div id='intro.progress-8.sentence-2' class='sentence'>General-purpose implementations should provide these guarantees<a class='hidden_link' href='#intro.progress-8.sentence-2'>.</a></div></div></div><div class='para' id='intro.progress-9'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6230'>#</a></div><div class='texpara'><div id='intro.progress-9.sentence-1' class='sentence'><a class='index' id=':forward_progress_guarantees,parallel'></a>For a thread of execution providing <a class='hidden_link' href='#def:parallel_forward_progress_guarantees' title='6.9.2.3&emsp;Forward progress&emsp;[intro.progress]'><span id='def:parallel_forward_progress_guarantees'><i >parallel forward progress guarantees</i></span></a>,
the implementation is not required to ensure that the thread will eventually make
progress if it has not yet executed any execution step; once this thread has
executed a step, it provides concurrent forward progress guarantees<a class='hidden_link' href='#intro.progress-9.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='intro.progress-10'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6237'>#</a></div><div class='texpara'><div id='intro.progress-note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-6'>6</a></i>: <div id='intro.progress-10.sentence-1' class='sentence'>This does not specify a requirement for when to start this thread of execution,
which will typically be specified by the entity that creates this thread of
execution<a class='hidden_link' href='#intro.progress-10.sentence-1'>.</a></div> <div id='intro.progress-10.sentence-2' class='sentence'>For example, a thread of execution that provides concurrent forward
progress guarantees and executes tasks from a set of tasks in an arbitrary order,
one after the other, satisfies the requirements of parallel forward progress for
these tasks<a class='hidden_link' href='#intro.progress-10.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.progress-11'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6247'>#</a></div><div class='texpara'><div id='intro.progress-11.sentence-1' class='sentence'><a class='index' id=':forward_progress_guarantees,weakly_parallel'></a>For a thread of execution providing <a class='hidden_link' href='#def:weakly_parallel_forward_progress_guarantees' title='6.9.2.3&emsp;Forward progress&emsp;[intro.progress]'><span id='def:weakly_parallel_forward_progress_guarantees'><i >weakly parallel forward progress
guarantees</i></span></a>, the implementation does not ensure that the thread will eventually
make progress<a class='hidden_link' href='#intro.progress-11.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='intro.progress-12'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6253'>#</a></div><div class='texpara'><div id='intro.progress-note-7' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-7'>7</a></i>: <div id='intro.progress-12.sentence-1' class='sentence'>Threads of execution providing weakly parallel forward progress guarantees cannot
be expected to make progress regardless of whether other threads make progress or
not; however, blocking with forward progress guarantee delegation, as defined below,
can be used to ensure that such threads of execution make progress eventually<a class='hidden_link' href='#intro.progress-12.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.progress-13'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6261'>#</a></div><div class='texpara'><div id='intro.progress-13.sentence-1' class='sentence'>Concurrent forward progress guarantees are stronger than parallel forward progress
guarantees, which in turn are stronger than weakly parallel forward progress
guarantees<a class='hidden_link' href='#intro.progress-13.sentence-1'>.</a></div> <div id='intro.progress-note-8' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-8'>8</a></i>: <div id='intro.progress-13.sentence-2' class='sentence'>For example, some kinds of synchronization between threads of execution might only
make progress if the respective threads of execution provide parallel forward progress
guarantees, but will fail to make progress under weakly parallel guarantees<a class='hidden_link' href='#intro.progress-13.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.progress-14'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6271'>#</a></div><div class='texpara'><div id='intro.progress-14.sentence-1' class='sentence'><a class='index' id=':forward_progress_guarantees,delegation_of'></a>When a thread of execution <span class='math'><span class='mathalpha'>P</span></span> is specified to
<a class='hidden_link' href='#def:block_(execution),with_forward_progress_guarantee_delegation' title='6.9.2.3&emsp;Forward progress&emsp;[intro.progress]'><span id='def:block_(execution),with_forward_progress_guarantee_delegation'><i >block with forward progress guarantee delegation</i></span></a>
on the completion of a set <span class='math'><span class='mathalpha'>S</span></span> of threads of execution,
then throughout the whole time of <span class='math'><span class='mathalpha'>P</span></span> being blocked on <span class='math'><span class='mathalpha'>S</span></span>,
the implementation shall ensure that the forward progress guarantees
provided by at least one thread of execution in <span class='math'><span class='mathalpha'>S</span></span>
is at least as strong as <span class='math'><span class='mathalpha'>P</span></span>'s forward progress guarantees<a class='hidden_link' href='#intro.progress-14.sentence-1'>.</a></div> <div id='intro.progress-note-9' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-9'>9</a></i>: <div id='intro.progress-14.sentence-2' class='sentence'>It is unspecified which thread or threads of execution in <span class='math'><span class='mathalpha'>S</span></span> are chosen
and for which number of execution steps<a class='hidden_link' href='#intro.progress-14.sentence-2'>.</a></div> <div id='intro.progress-14.sentence-3' class='sentence'>The strengthening is not permanent and
not necessarily in place for the rest of the lifetime of the affected thread of
execution<a class='hidden_link' href='#intro.progress-14.sentence-3'>.</a></div> <div id='intro.progress-14.sentence-4' class='sentence'>As long as <span class='math'><span class='mathalpha'>P</span></span> is blocked, the implementation has to eventually
select and potentially strengthen a thread of execution in <span class='math'><span class='mathalpha'>S</span></span><a class='hidden_link' href='#intro.progress-14.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='intro.progress-14.sentence-5' class='sentence'>
Once a thread of execution in <span class='math'><span class='mathalpha'>S</span></span> terminates, it is removed from <span class='math'><span class='mathalpha'>S</span></span><a class='hidden_link' href='#intro.progress-14.sentence-5'>.</a></div> <div id='intro.progress-14.sentence-6' class='sentence'>Once <span class='math'><span class='mathalpha'>S</span></span> is empty, <span class='math'><span class='mathalpha'>P</span></span> is unblocked<a class='hidden_link' href='#intro.progress-14.sentence-6'>.</a></div></div></div><div class='para nonNormativeOnly' id='intro.progress-15'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6291'>#</a></div><div class='texpara'><div id='intro.progress-note-10' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-10'>10</a></i>: <div id='intro.progress-15.sentence-1' class='sentence'>A thread of execution <span class='math'><span class='mathalpha'>B</span></span> thus can temporarily provide an effectively
stronger forward progress guarantee for a certain amount of time, due to a
second thread of execution <span class='math'><span class='mathalpha'>A</span></span> being blocked on it with forward
progress guarantee delegation<a class='hidden_link' href='#intro.progress-15.sentence-1'>.</a></div> <div id='intro.progress-15.sentence-2' class='sentence'>In turn, if <span class='math'><span class='mathalpha'>B</span></span> then blocks with
forward progress guarantee delegation on <span class='math'><span class='mathalpha'>C</span></span>, this can also temporarily
provide a stronger forward progress guarantee to <span class='math'><span class='mathalpha'>C</span></span><a class='hidden_link' href='#intro.progress-15.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='intro.progress-16'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6301'>#</a></div><div class='texpara'><div id='intro.progress-note-11' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-11'>11</a></i>: <div id='intro.progress-16.sentence-1' class='sentence'>If all threads of execution in <span class='math'><span class='mathalpha'>S</span></span> finish executing (e.g., they terminate
and do not use blocking synchronization incorrectly), then <span class='math'><span class='mathalpha'>P</span></span>'s execution
of the operation that blocks with forward progress guarantee delegation will not
result in <span class='math'><span class='mathalpha'>P</span></span>'s progress guarantee being effectively weakened<a class='hidden_link' href='#intro.progress-16.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='intro.progress-17'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6309'>#</a></div><div class='texpara'><div id='intro.progress-note-12' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#intro.progress-note-12'>12</a></i>: <div id='intro.progress-17.sentence-1' class='sentence'>This does not remove any constraints regarding blocking synchronization for
threads of execution providing parallel or weakly parallel forward progress
guarantees because the implementation is not required to strengthen a particular
thread of execution whose too-weak progress guarantee is preventing overall progress<a class='hidden_link' href='#intro.progress-17.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='intro.progress-18'><div class='marginalizedparent'><a class='marginalized' href='#intro.progress-18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6317'>#</a></div><div class='texpara'><div id='intro.progress-18.sentence-1' class='sentence'>An implementation should ensure that the last value (in modification order)
assigned by an atomic or synchronization operation will become visible to all
other threads in a finite period of time<a class='hidden_link' href='#intro.progress-18.sentence-1'>.</a></div> </div></div></div></div><div id='basic.start' class='section'><h3 ><a class='secnum' href='#basic.start' style='min-width:80pt'>6.9.3</a> Start and termination <a class='abbr_ref' href='basic.start'>[basic.start]</a></h3><div id='basic.start.main' class='section'><h4 ><a class='secnum' href='#basic.start.main' style='min-width:95pt'>6.9.3.1</a> <span class='texttt'>main</span> function <a class='abbr_ref' href='basic.start.main'>[basic.start.main]</a></h4><div class='texpara'><a class='index' id=':main_function'></a></div><div class='para' id='basic.start.main-1'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.main-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6329'>#</a></div><div class='texpara'><div id='basic.start.main-1.sentence-1' class='sentence'><a class='index' id=':program,startup'></a>A program shall contain exactly one function called <span class='texttt'>main</span>
that belongs to the global scope<a class='hidden_link' href='#basic.start.main-1.sentence-1'>.</a></div> <div id='basic.start.main-1.sentence-2' class='sentence'>Executing a program starts a main thread of execution (<a href='#intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>, <a href='thread.threads' title='32.4&emsp;Threads'>[thread.<span class='shy'></span>threads]</a>)
in which the <span class='texttt'>main</span> function is invoked<a class='hidden_link' href='#basic.start.main-1.sentence-2'>.</a></div> <div id='basic.start.main-1.sentence-3' class='sentence'><a class='index' id=':implementation,freestanding_'></a>It is <a class='index' id=':defining_main_in_freestanding_environment'></a>implementation-defined
whether a program in a freestanding environment is required to define a <span class='texttt'>main</span>
function<a class='hidden_link' href='#basic.start.main-1.sentence-3'>.</a></div> <div id='basic.start.main-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.main-note-1'>1</a></i>: <div id='basic.start.main-1.sentence-4' class='sentence'>In a freestanding environment, startup and termination is
<a class='index' id=':startup_and_termination_in_freestanding_environment'></a>implementation-defined; startup contains the
execution of constructors for non-local objects with static storage duration;
termination contains the execution of destructors for objects with static storage
duration<a class='hidden_link' href='#basic.start.main-1.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='basic.start.main-2'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.main-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6347'>#</a></div><div class='texpara'><div id='basic.start.main-2.sentence-1' class='sentence'>An implementation shall not predefine the <span class='texttt'>main</span> function<a class='hidden_link' href='#basic.start.main-2.sentence-1'>.</a></div> <div id='basic.start.main-2.sentence-2' class='sentence'>Its type shall have C++ language linkage
and it shall have a declared return type of type
<span class='texttt'><span class='keyword'>int</span></span>, but otherwise its type is <a class='index' id=':parameters_to_main'></a>implementation-defined<a class='hidden_link' href='#basic.start.main-2.sentence-2'>.</a></div> <div id='basic.start.main-2.sentence-3' class='sentence'><a class='index' id=':main_function,implementation-defined_parameters_to'></a>An implementation shall allow both
<ul class='itemize'><li id='basic.start.main-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.main-2.1'>(2.1)</a></div>a function of <span class='texttt'><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returning <span class='texttt'><span class='keyword'>int</span></span> and</li><li id='basic.start.main-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.main-2.2'>(2.2)</a></div>a function of <span class='texttt'><span class='parenthesis'>(</span><span class='keyword'>int</span></span>, pointer to pointer to <span class='texttt'><span class='keyword'>char</span><span class='parenthesis'>)</span></span> returning <span class='texttt'><span class='keyword'>int</span></span></li></ul>
<a class='index' id=':argc'></a><a class='index' id=':argv'></a>as the type of <span class='texttt'>main</span> (<a href='dcl.fct' title='9.3.4.6&emsp;Functions'>[dcl.<span class='shy'></span>fct]</a>)<a class='hidden_link' href='#basic.start.main-2.sentence-3'>.</a></div> <div id='basic.start.main-2.sentence-4' class='sentence'><a class='index' id=':main_function,parameters_to'></a><a class='index' id=':environment,program'></a>In the latter form, for purposes of exposition, the first function
parameter is called <span class='texttt'>argc</span> and the second function parameter is
called <span class='texttt'>argv</span>, where <span class='texttt'>argc</span> shall be the number of
arguments passed to the program from the environment in which the
program is run<a class='hidden_link' href='#basic.start.main-2.sentence-4'>.</a></div> <div id='basic.start.main-2.sentence-5' class='sentence'>If
<span class='texttt'>argc</span> is nonzero these arguments shall be supplied in
<span class='texttt'>argv<span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span></span> through <span class='texttt'>argv<span class='squarebracket'>[</span>argc<span class='operator'>-</span><span class='literal'>1</span><span class='squarebracket'>]</span></span> as pointers to the initial
characters of null-terminated multibyte strings (<span class='textsc'>ntmbs</span>s) (<a href='multibyte.strings' title='16.3.3.3.5.3&emsp;Multibyte strings'>[multibyte.<span class='shy'></span>strings]</a>)
and <span class='texttt'>argv<span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span></span> shall be the pointer to
the initial character of a <span class='textsc'>ntmbs</span> that represents the name used to
invoke the program or <span class='texttt'><span class='literal'>""</span></span><a class='hidden_link' href='#basic.start.main-2.sentence-5'>.</a></div> <div id='basic.start.main-2.sentence-6' class='sentence'>The value of <span class='texttt'>argc</span> shall be
non-negative<a class='hidden_link' href='#basic.start.main-2.sentence-6'>.</a></div> <div id='basic.start.main-2.sentence-7' class='sentence'>The value of <span class='texttt'>argv<span class='squarebracket'>[</span>argc<span class='squarebracket'>]</span></span> shall be 0<a class='hidden_link' href='#basic.start.main-2.sentence-7'>.</a></div> <div id='basic.start.main-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.main-note-2'>2</a></i>: <div id='basic.start.main-2.sentence-8' class='sentence'>It
is recommended that any further (optional) parameters be added after
<span class='texttt'>argv</span><a class='hidden_link' href='#basic.start.main-2.sentence-8'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='basic.start.main-3'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.main-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6381'>#</a></div><div class='texpara'><div id='basic.start.main-3.sentence-1' class='sentence'>The function <span class='texttt'>main</span> shall not be used within
a program<a class='hidden_link' href='#basic.start.main-3.sentence-1'>.</a></div> <div id='basic.start.main-3.sentence-2' class='sentence'><a class='index' id=':main_function,implementation-defined_linkage_of'></a>The linkage (<a href='basic.link' title='6.6&emsp;Program and linkage'>[basic.<span class='shy'></span>link]</a>) of <span class='texttt'>main</span> is
<a class='index' id=':linkage_of_main'></a>implementation-defined<a class='hidden_link' href='#basic.start.main-3.sentence-2'>.</a></div> <div id='basic.start.main-3.sentence-3' class='sentence'>A program that defines <span class='texttt'>main</span> as
deleted or that declares <span class='texttt'>main</span> to be
<span class='texttt'><span class='keyword'>inline</span></span>, <span class='texttt'><span class='keyword'>static</span></span>, or <span class='texttt'><span class='keyword'>constexpr</span></span> is ill-formed<a class='hidden_link' href='#basic.start.main-3.sentence-3'>.</a></div> <div id='basic.start.main-3.sentence-4' class='sentence'>The function <span class='texttt'>main</span> shall not be a coroutine (<a href='dcl.fct.def.coroutine' title='9.5.4&emsp;Coroutine definitions'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>def.<span class='shy'></span>coroutine]</a>)<a class='hidden_link' href='#basic.start.main-3.sentence-4'>.</a></div> <div id='basic.start.main-3.sentence-5' class='sentence'>The <span class='texttt'>main</span> function shall not be declared with a
<a href='dcl.link#nt:linkage-specification' title='9.11&emsp;Linkage specifications&emsp;[dcl.link]'><span id='ntref:linkage-specification'><span class='textsf'><i >linkage-specification</i></span></span></a> (<a href='dcl.link' title='9.11&emsp;Linkage specifications'>[dcl.<span class='shy'></span>link]</a>)<a class='hidden_link' href='#basic.start.main-3.sentence-5'>.</a></div> <div id='basic.start.main-3.sentence-6' class='sentence'>A program
that declares a variable <span class='texttt'>main</span> that belongs to the global scope, or
that declares a function <span class='texttt'>main</span> that belongs to the global scope and
is attached to a named module, or
that declares an entity named <span class='texttt'>main</span>
with C language linkage (in any namespace)
is ill-formed<a class='hidden_link' href='#basic.start.main-3.sentence-6'>.</a></div> <div id='basic.start.main-3.sentence-7' class='sentence'>The name <span class='texttt'>main</span> is
not otherwise reserved<a class='hidden_link' href='#basic.start.main-3.sentence-7'>.</a></div> <div id='basic.start.main-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#basic.start.main-example-1'>1</a></i>: <div id='basic.start.main-3.sentence-8' class='sentence'>Member functions, classes, and
enumerations can be called <span class='texttt'>main</span>, as can entities in other
namespaces<a class='hidden_link' href='#basic.start.main-3.sentence-8'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='basic.start.main-4'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.main-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6407'>#</a></div><div class='texpara'><div id='basic.start.main-4.sentence-1' class='sentence'><a class='index' id=':exit'></a><a class='index' id='lib:exit'></a><a class='index' id=':termination,program'></a>Terminating the program
without leaving the current block (e.g., by calling the function
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span></span> (<a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>)) does not destroy any
objects with automatic storage duration (<a href='class.dtor' title='11.4.7&emsp;Destructors'>[class.<span class='shy'></span>dtor]</a>)<a class='hidden_link' href='#basic.start.main-4.sentence-1'>.</a></div> <div id='basic.start.main-4.sentence-2' class='sentence'>If
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> is called to end a program during the destruction of
an object with static or thread storage duration, the program has undefined
behavior<a class='hidden_link' href='#basic.start.main-4.sentence-2'>.</a></div></div></div><div class='para' id='basic.start.main-5'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.main-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6419'>#</a></div><div class='texpara'><div id='basic.start.main-5.sentence-1' class='sentence'><a class='index' id=':termination,program_'></a><a class='index' id=':main_function,return_from'></a>A <span class='texttt'><span class='keyword'>return</span></span> statement (<a href='stmt.return' title='8.7.4&emsp;The return statement'>[stmt.<span class='shy'></span>return]</a>) in <span class='texttt'>main</span> has the effect of leaving the main
function (destroying any objects with automatic storage duration) and
calling <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> with the return value as the argument<a class='hidden_link' href='#basic.start.main-5.sentence-1'>.</a></div> <div id='basic.start.main-5.sentence-2' class='sentence'>If control flows off the end of
the <a href='stmt.block#nt:compound-statement' title='8.4&emsp;Compound statement or block&emsp;[stmt.block]'><span id='ntref:compound-statement_'><span class='textsf'><i >compound-statement</i></span></span></a> of <span class='texttt'>main</span>,
the effect is equivalent to a <span class='texttt'><span class='keyword'>return</span></span> with operand <span class='texttt'><span class='literal'>0</span></span>
(see also <a href='except.handle' title='14.4&emsp;Handling an exception'>[except.<span class='shy'></span>handle]</a>)<a class='hidden_link' href='#basic.start.main-5.sentence-2'>.</a></div> </div></div></div><div id='basic.start.static' class='section'><h4 ><a class='secnum' href='#basic.start.static' style='min-width:95pt'>6.9.3.2</a> Static initialization <a class='abbr_ref' href='basic.start.static'>[basic.start.static]</a></h4><div class='para' id='basic.start.static-1'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.static-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6433'>#</a></div><div class='texpara'><div id='basic.start.static-1.sentence-1' class='sentence'><a class='index' id=':initialization'></a><a class='index' id=':initialization,static_and_thread'></a>Variables with static storage duration
are initialized as a consequence of program initiation<a class='hidden_link' href='#basic.start.static-1.sentence-1'>.</a></div> <div id='basic.start.static-1.sentence-2' class='sentence'>Variables with
thread storage duration are initialized as a consequence of thread execution<a class='hidden_link' href='#basic.start.static-1.sentence-2'>.</a></div> <div id='basic.start.static-1.sentence-3' class='sentence'>Within each of these phases of initiation, initialization occurs as follows<a class='hidden_link' href='#basic.start.static-1.sentence-3'>.</a></div></div></div><div class='para' id='basic.start.static-2'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.static-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6441'>#</a></div><div class='texpara'><div id='basic.start.static-2.sentence-1' class='sentence'><a class='index' id=':initialization,constant'></a><a class='hidden_link' href='#def:constant_initialization' title='6.9.3.2&emsp;Static initialization&emsp;[basic.start.static]'><span id='def:constant_initialization'><i >Constant initialization</i></span></a> is performed
if a variable or temporary object with static or thread storage duration
is constant-initialized (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>)<a class='hidden_link' href='#basic.start.static-2.sentence-1'>.</a></div> <div id='basic.start.static-2.sentence-2' class='sentence'><a class='index' id=':initialization,zero-initialization'></a>If constant initialization is not performed, a variable with static
storage duration (<a href='basic.stc.static' title='6.7.5.2&emsp;Static storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>static]</a>) or thread storage
duration (<a href='basic.stc.thread' title='6.7.5.3&emsp;Thread storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>thread]</a>) is zero-initialized (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)<a class='hidden_link' href='#basic.start.static-2.sentence-2'>.</a></div> <div id='basic.start.static-2.sentence-3' class='sentence'>Together, zero-initialization and constant initialization are called
<a class='hidden_link' href='#def:initialization,static' title='6.9.3.2&emsp;Static initialization&emsp;[basic.start.static]'><span id='def:initialization,static'><i >static initialization</i></span></a>;
all other initialization is <a class='hidden_link' href='#def:initialization,dynamic' title='6.9.3.2&emsp;Static initialization&emsp;[basic.start.static]'><span id='def:initialization,dynamic'><i >dynamic initialization</i></span></a><a class='hidden_link' href='#basic.start.static-2.sentence-3'>.</a></div> <div id='basic.start.static-2.sentence-4' class='sentence'>All static initialization strongly happens before (<a href='#intro.races' title='6.9.2.2&emsp;Data races'>[intro.<span class='shy'></span>races]</a>)
any dynamic initialization<a class='hidden_link' href='#basic.start.static-2.sentence-4'>.</a></div> <div id='basic.start.static-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.static-note-1'>1</a></i>: <div id='basic.start.static-2.sentence-5' class='sentence'>The dynamic initialization of non-block variables is described
in <a href='#basic.start.dynamic' title='6.9.3.3&emsp;Dynamic initialization of non-block variables'>[basic.<span class='shy'></span>start.<span class='shy'></span>dynamic]</a>; that of static block variables is described
in <a href='stmt.dcl' title='8.8&emsp;Declaration statement'>[stmt.<span class='shy'></span>dcl]</a><a class='hidden_link' href='#basic.start.static-2.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='basic.start.static-3'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.static-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6461'>#</a></div><div class='texpara'><div id='basic.start.static-3.sentence-1' class='sentence'>An implementation is permitted to perform the initialization of a
variable with static or thread storage duration as a static
initialization even if such initialization is not required to be done
statically, provided that
<ul class='itemize'><li id='basic.start.static-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.static-3.1'>(3.1)</a></div>the dynamic version of the initialization does not change the
value of any other object of static or thread storage duration
prior to its initialization, and</li><li id='basic.start.static-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.static-3.2'>(3.2)</a></div>the static version of the initialization produces the same value
in the initialized variable as would be produced by the dynamic
initialization if all variables not required to be initialized statically
were initialized dynamically<a class='hidden_link' href='#basic.start.static-3.sentence-1'>.</a></li></ul></div> <div id='basic.start.static-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.static-note-2'>2</a></i>: <div id='basic.start.static-3.sentence-2' class='sentence'>As a consequence, if the initialization of an object <span class='texttt'>obj1</span> refers to an
object <span class='texttt'>obj2</span> potentially requiring dynamic initialization and defined
later in the same translation unit, it is unspecified whether the value of <span class='texttt'>obj2</span> used
will be the value of the fully initialized <span class='texttt'>obj2</span> (because <span class='texttt'>obj2</span> was statically
initialized) or will be the value of <span class='texttt'>obj2</span> merely zero-initialized<a class='hidden_link' href='#basic.start.static-3.sentence-2'>.</a></div> <div id='basic.start.static-3.sentence-3' class='sentence'>For example,
<span class='codeblock'><span class='keyword'>inline</span> <span class='keyword'>double</span> fd<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>1.0</span>; <span class='curlybracket'>}</span>
<span class='keyword'>extern</span> <span class='keyword'>double</span> d1;
<span class='keyword'>double</span> d2 <span class='operator'>=</span> d1;     <span class='comment'>// unspecified:</span>
                    <span class='comment'>// either statically initialized to <span class='tcode_in_codeblock'>0.0</span> or</span>
                    <span class='comment'>// dynamically initialized to <span class='tcode_in_codeblock'>0.0</span> if <span class='tcode_in_codeblock'>d1</span> is</span>
                    <span class='comment'>// dynamically initialized, or <span class='tcode_in_codeblock'>1.0</span> otherwise</span>
<span class='keyword'>double</span> d1 <span class='operator'>=</span> fd<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;   <span class='comment'>// either initialized statically or dynamically to <span class='tcode_in_codeblock'>1.0</span></span>
</span></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='basic.start.dynamic' class='section'><h4 ><a class='secnum' href='#basic.start.dynamic' style='min-width:95pt'>6.9.3.3</a> Dynamic initialization of non-block variables <a class='abbr_ref' href='basic.start.dynamic'>[basic.start.dynamic]</a></h4><div class='para' id='basic.start.dynamic-1'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.dynamic-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6497'>#</a></div><div class='texpara'><div id='basic.start.dynamic-1.sentence-1' class='sentence'><a class='index' id=':initialization,dynamic_non-block'></a><a class='index' id=':start,program'></a><a class='index' id=':initialization,order_of'></a>Dynamic initialization of a non-block variable with static storage duration is
unordered if the variable is an implicitly or explicitly instantiated
specialization, is partially-ordered if the variable
is an inline variable that is not an implicitly or explicitly instantiated
specialization, and otherwise is ordered<a class='hidden_link' href='#basic.start.dynamic-1.sentence-1'>.</a></div> <div id='basic.start.dynamic-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.dynamic-note-1'>1</a></i>: <div id='basic.start.dynamic-1.sentence-2' class='sentence'>An explicitly specialized non-inline static data member or
variable template specialization has ordered initialization<a class='hidden_link' href='#basic.start.dynamic-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='basic.start.dynamic-2'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.dynamic-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6511'>#</a></div><div class='texpara'><div id='basic.start.dynamic-2.sentence-1' class='sentence'>A declaration <span class='texttt'>D</span> is
<a class='hidden_link' href='#def:appearance-ordered' title='6.9.3.3&emsp;Dynamic initialization of non-block variables&emsp;[basic.start.dynamic]'><span id='def:appearance-ordered'><i >appearance-ordered</i></span></a> before a declaration <span class='texttt'>E</span> if
<ul class='itemize'><li id='basic.start.dynamic-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.dynamic-2.1'>(2.1)</a></div><span class='texttt'>D</span> appears in the same translation unit as <span class='texttt'>E</span>, or</li><li id='basic.start.dynamic-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.dynamic-2.2'>(2.2)</a></div>the translation unit containing <span class='texttt'>E</span>
has an interface dependency on the translation unit containing <span class='texttt'>D</span>,</li></ul>
in either case prior to <span class='texttt'>E</span><a class='hidden_link' href='#basic.start.dynamic-2.sentence-1'>.</a></div></div></div><div class='para' id='basic.start.dynamic-3'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.dynamic-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6521'>#</a></div><div class='texpara'><div id='basic.start.dynamic-3.sentence-1' class='sentence'>Dynamic initialization of non-block variables <span class='texttt'>V</span> and <span class='texttt'>W</span>
with static storage duration are ordered as follows:
<ul class='itemize'><li id='basic.start.dynamic-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.dynamic-3.1'>(3.1)</a></div><div class='texpara'><div id='basic.start.dynamic-3.1.sentence-1' class='sentence'>If <span class='texttt'>V</span> and <span class='texttt'>W</span> have ordered initialization and
the definition of <span class='texttt'>V</span>
is appearance-ordered before the definition of <span class='texttt'>W</span>, or
if <span class='texttt'>V</span> has partially-ordered initialization,
<span class='texttt'>W</span> does not have unordered initialization, and
for every definition <span class='texttt'>E</span> of <span class='texttt'>W</span>
there exists a definition <span class='texttt'>D</span> of <span class='texttt'>V</span>
such that <span class='texttt'>D</span> is appearance-ordered before <span class='texttt'>E</span>, then
<ul class='itemize'><li id='basic.start.dynamic-3.1.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#basic.start.dynamic-3.1.1'>(3.1.1)</a></div>if the program does not start a thread (<a href='#intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)
other than the main thread (<a href='#basic.start.main' title='6.9.3.1&emsp;main function'>[basic.<span class='shy'></span>start.<span class='shy'></span>main]</a>)
or <span class='texttt'>V</span> and <span class='texttt'>W</span> have ordered initialization and
they are defined in the same translation unit,
the initialization of <span class='texttt'>V</span>
is sequenced before
the initialization of <span class='texttt'>W</span>;</li><li id='basic.start.dynamic-3.1.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#basic.start.dynamic-3.1.2'>(3.1.2)</a></div>otherwise,
the initialization of <span class='texttt'>V</span>
strongly happens before
the initialization of <span class='texttt'>W</span><a class='hidden_link' href='#basic.start.dynamic-3.1.sentence-1'>.</a></li></ul></div></div></li><li id='basic.start.dynamic-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.dynamic-3.2'>(3.2)</a></div><div class='texpara'><div id='basic.start.dynamic-3.2.sentence-1' class='sentence'>Otherwise, if the program starts a thread
other than the main thread
before either <span class='texttt'>V</span> or <span class='texttt'>W</span> is initialized,
it is unspecified in which threads
the initializations of <span class='texttt'>V</span> and <span class='texttt'>W</span> occur;
the initializations are unsequenced if they occur in the same thread<a class='hidden_link' href='#basic.start.dynamic-3.2.sentence-1'>.</a></div></div></li><li id='basic.start.dynamic-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#basic.start.dynamic-3.3'>(3.3)</a></div><div class='texpara'><div id='basic.start.dynamic-3.3.sentence-1' class='sentence'>Otherwise, the initializations of <span class='texttt'>V</span> and <span class='texttt'>W</span> are indeterminately sequenced<a class='hidden_link' href='#basic.start.dynamic-3.3.sentence-1'>.</a></div></div></li></ul></div> <div id='basic.start.dynamic-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.dynamic-note-2'>2</a></i>: <div id='basic.start.dynamic-3.sentence-2' class='sentence'>This definition permits initialization of a sequence of
ordered variables concurrently with another sequence<a class='hidden_link' href='#basic.start.dynamic-3.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='basic.start.dynamic-4'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.dynamic-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6566'>#</a></div><div class='texpara'><div id='basic.start.dynamic-4.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:odr-use,non-initialization' title='6.9.3.3&emsp;Dynamic initialization of non-block variables&emsp;[basic.start.dynamic]'><span id='def:odr-use,non-initialization'><i >non-initialization odr-use</i></span></a>
is an odr-use (<a href='basic.def.odr' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>) not caused directly or indirectly by
the initialization of a non-block static or thread storage duration variable<a class='hidden_link' href='#basic.start.dynamic-4.sentence-1'>.</a></div></div></div><div class='para' id='basic.start.dynamic-5'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.dynamic-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6572'>#</a></div><div class='texpara'><div id='basic.start.dynamic-5.sentence-1' class='sentence'><a class='index' id=':evaluation,unspecified_order_of_'></a>It is <a class='index' id=':dynamic_initialization_of_static_variables_before_main'></a>implementation-defined
whether the dynamic initialization of a
non-block non-inline variable with static storage duration
is sequenced before the first statement of <span class='texttt'>main</span> or is deferred<a class='hidden_link' href='#basic.start.dynamic-5.sentence-1'>.</a></div> <div id='basic.start.dynamic-5.sentence-2' class='sentence'>If it is deferred, it strongly happens before
any non-initialization odr-use
of any non-inline function or non-inline variable
defined in the same translation unit as the variable to be initialized<a class='hidden_link' href='#basic.start.dynamic-5.sentence-2'>.</a><a class='footnoteref' href='#footnote-44' id='footnoteref-44' title='A non-block variable with static storage duration having initialization with side effects is initialized in this case, even if it is not itself odr-used ([basic.def.odr], [basic.stc.static]).'>44</a></div> <div id='basic.start.dynamic-5.sentence-3' class='sentence'>
It is <a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed'></a>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#basic.start.dynamic-5.sentence-3'>.</a></div></div><div class='texpara'><div id='basic.start.dynamic-5.sentence-4' class='sentence'><i >Recommended practice</i>: An implementation should choose such points in a way
that allows the programmer to avoid deadlocks<a class='hidden_link' href='#basic.start.dynamic-5.sentence-4'>.</a></div> <div id='basic.start.dynamic-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#basic.start.dynamic-example-1'>1</a></i>: <span class='codeblock'><span class='comment'>// - File 1 -</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"a.h"</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"b.h"</span>
B b;
A<span class='operator'>::</span>A<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  b<span class='operator'>.</span>Use<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='comment'>// - File 2 -</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"a.h"</span>
A a;

<span class='comment'>// - File 3 -</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"a.h"</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"b.h"</span>
<span class='keyword'>extern</span> A a;
<span class='keyword'>extern</span> B b;

<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  a<span class='operator'>.</span>Use<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  b<span class='operator'>.</span>Use<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span></div><div class='texpara'><div id='basic.start.dynamic-5.sentence-5' class='sentence'>It is <a class='index' id=':dynamic_initialization_of_static_variables_before_main_'></a>implementation-defined
whether either <span class='texttt'>a</span> or <span class='texttt'>b</span> is
initialized before <span class='texttt'>main</span> is entered or whether the
initializations are delayed until <span class='texttt'>a</span> is first odr-used in
<span class='texttt'>main</span><a class='hidden_link' href='#basic.start.dynamic-5.sentence-5'>.</a></div> <div id='basic.start.dynamic-5.sentence-6' class='sentence'>In particular, if <span class='texttt'>a</span> is initialized before
<span class='texttt'>main</span> is entered, it is not guaranteed that <span class='texttt'>b</span> will be
initialized before it is odr-used by the initialization of <span class='texttt'>a</span>, that
is, before <span class='texttt'>A<span class='operator'>&#x200b;::&#x200b;</span>A</span> is called<a class='hidden_link' href='#basic.start.dynamic-5.sentence-6'>.</a></div> <div id='basic.start.dynamic-5.sentence-7' class='sentence'>If, however, <span class='texttt'>a</span> is initialized
at some point after the first statement of <span class='texttt'>main</span>, <span class='texttt'>b</span> will
be initialized prior to its use in <span class='texttt'>A<span class='operator'>&#x200b;::&#x200b;</span>A</span><a class='hidden_link' href='#basic.start.dynamic-5.sentence-7'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='basic.start.dynamic-6'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.dynamic-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6632'>#</a></div><div class='texpara'><div id='basic.start.dynamic-6.sentence-1' class='sentence'>It is <a class='index' id=':dynamic_initialization_of_static_inline_variables_before_main'></a>implementation-defined
whether the dynamic initialization of a
non-block inline variable with static storage duration
is sequenced before the first statement of <span class='texttt'>main</span> or is deferred<a class='hidden_link' href='#basic.start.dynamic-6.sentence-1'>.</a></div> <div id='basic.start.dynamic-6.sentence-2' class='sentence'>If it is deferred, it strongly happens before
any non-initialization odr-use
of that variable<a class='hidden_link' href='#basic.start.dynamic-6.sentence-2'>.</a></div> <div id='basic.start.dynamic-6.sentence-3' class='sentence'>It is <a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed_'></a>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#basic.start.dynamic-6.sentence-3'>.</a></div></div></div><div class='para' id='basic.start.dynamic-7'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.dynamic-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6643'>#</a></div><div class='texpara'><div id='basic.start.dynamic-7.sentence-1' class='sentence'>It is <a class='index' id=':dynamic_initialization_of_thread-local_variables_before_entry'></a>implementation-defined
whether the dynamic initialization of a
non-block non-inline variable with thread storage duration
is sequenced before the first statement of the initial function of a thread or is deferred<a class='hidden_link' href='#basic.start.dynamic-7.sentence-1'>.</a></div> <div id='basic.start.dynamic-7.sentence-2' class='sentence'>If it is deferred,
the initialization associated with the entity for thread <i >t</i>
is sequenced before the first non-initialization odr-use by <i >t</i>
of any non-inline variable with thread storage duration
defined in the same translation unit as the variable to be initialized<a class='hidden_link' href='#basic.start.dynamic-7.sentence-2'>.</a></div> <div id='basic.start.dynamic-7.sentence-3' class='sentence'>It is <a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed__'></a>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#basic.start.dynamic-7.sentence-3'>.</a></div></div></div><div class='para' id='basic.start.dynamic-8'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.dynamic-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6656'>#</a></div><div class='texpara'><div id='basic.start.dynamic-8.sentence-1' class='sentence'>If the initialization of
a non-block variable with static or thread storage duration
exits via an exception,
the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> is called (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#basic.start.dynamic-8.sentence-1'>.</a></div> </div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-44'><div class='texpara'><a class='footnotenum' href='#footnote-44'>44)</a><a class='footnoteBacklink' href='#footnoteref-44'>44)</a> <div id='footnote-44.sentence-1' class='sentence'>A non-block variable with static storage duration
having initialization
with side effects is initialized in this case,
even if it is not itself odr-used (<a href='basic.def.odr' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>, <a href='basic.stc.static' title='6.7.5.2&emsp;Static storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>static]</a>)<a class='hidden_link' href='#footnote-44.sentence-1'>.</a></div></div></div></div><div id='basic.start.term' class='section'><h4 ><a class='secnum' href='#basic.start.term' style='min-width:95pt'>6.9.3.4</a> Termination <a class='abbr_ref' href='basic.start.term'>[basic.start.term]</a></h4><div class='para' id='basic.start.term-1'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.term-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6665'>#</a></div><div class='texpara'><div id='basic.start.term-1.sentence-1' class='sentence'><a class='index' id=':program,termination'></a><a class='index' id=':object,destructor_static'></a><a class='index' id=':main_function,return_from_'></a>Constructed objects (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)
with static storage duration are destroyed
and functions registered with <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span>
are called as part of a call to
<a class='index' id=':exit_'></a><a class='index' id='lib:exit_'></a><span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> (<a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>)<a class='hidden_link' href='#basic.start.term-1.sentence-1'>.</a></div> <div id='basic.start.term-1.sentence-2' class='sentence'>The call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> is sequenced before
the destructions and the registered functions<a class='hidden_link' href='#basic.start.term-1.sentence-2'>.</a></div> <div id='basic.start.term-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.term-note-1'>1</a></i>: <div id='basic.start.term-1.sentence-3' class='sentence'>Returning from <span class='texttt'>main</span> invokes <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> (<a href='#basic.start.main' title='6.9.3.1&emsp;main function'>[basic.<span class='shy'></span>start.<span class='shy'></span>main]</a>)<a class='hidden_link' href='#basic.start.term-1.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='basic.start.term-2'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.term-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6682'>#</a></div><div class='texpara'><div id='basic.start.term-2.sentence-1' class='sentence'>Constructed objects with thread storage duration within a given thread
are destroyed as a result of returning from the initial function of that thread and as a
result of that thread calling <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span><a class='hidden_link' href='#basic.start.term-2.sentence-1'>.</a></div> <div id='basic.start.term-2.sentence-2' class='sentence'>The destruction of all constructed objects with thread storage
duration within that thread strongly happens before destroying
any object with static storage duration<a class='hidden_link' href='#basic.start.term-2.sentence-2'>.</a></div></div></div><div class='para' id='basic.start.term-3'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.term-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6690'>#</a></div><div class='texpara'><div id='basic.start.term-3.sentence-1' class='sentence'>If the completion of the constructor or dynamic initialization of an object with static
storage duration strongly happens before that of another, the completion of the destructor
of the second is sequenced before the initiation of the destructor of the first<a class='hidden_link' href='#basic.start.term-3.sentence-1'>.</a></div> <div id='basic.start.term-3.sentence-2' class='sentence'>If the completion of the constructor or dynamic initialization of an object with thread
storage duration is sequenced before that of another, the completion of the destructor
of the second is sequenced before the initiation of the destructor of the first<a class='hidden_link' href='#basic.start.term-3.sentence-2'>.</a></div> <div id='basic.start.term-3.sentence-3' class='sentence'>If an object is
initialized statically, the object is destroyed in the same order as if
the object was dynamically initialized<a class='hidden_link' href='#basic.start.term-3.sentence-3'>.</a></div> <div id='basic.start.term-3.sentence-4' class='sentence'>For an object of array or class
type, all subobjects of that object are destroyed before any block
variable with static storage duration initialized during the construction
of the subobjects is destroyed<a class='hidden_link' href='#basic.start.term-3.sentence-4'>.</a></div> <div id='basic.start.term-3.sentence-5' class='sentence'>If the destruction of an object with static or thread storage duration
exits via an exception,
the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> is called (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#basic.start.term-3.sentence-5'>.</a></div></div></div><div class='para' id='basic.start.term-4'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.term-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6707'>#</a></div><div class='texpara'><div id='basic.start.term-4.sentence-1' class='sentence'>If a function contains a block variable of static or thread storage duration that has been
destroyed and the function is called during the destruction of an object with static or
thread storage duration, the program has undefined behavior if the flow of control
passes through the definition of the previously destroyed block variable<a class='hidden_link' href='#basic.start.term-4.sentence-1'>.</a></div> <div id='basic.start.term-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.term-note-2'>2</a></i>: <div id='basic.start.term-4.sentence-2' class='sentence'>Likewise, the behavior is undefined
if the block variable is used indirectly (e.g., through a pointer)
after its destruction<a class='hidden_link' href='#basic.start.term-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='basic.start.term-5'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.term-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6718'>#</a></div><div class='texpara'><div id='basic.start.term-5.sentence-1' class='sentence'><a class='index' id=':atexit'></a><a class='index' id='lib:atexit'></a>If the completion of the initialization of an object with static storage
duration strongly happens before a call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> (see
<a href='cstdlib.syn#header:%3ccstdlib%3e' title='17.2.2&emsp;Header &lt;cstdlib&gt; synopsis&emsp;[cstdlib.syn]'><span id='headerref:<cstdlib>'><span class='texttt'>&lt;cstdlib&gt;</span></span></a>, <a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>), the call to the function passed to
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> is sequenced before the call to the destructor for the object<a class='hidden_link' href='#basic.start.term-5.sentence-1'>.</a></div> <div id='basic.start.term-5.sentence-2' class='sentence'>If a
call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> strongly happens before the completion of the initialization of
an object with static storage duration, the call to the destructor for the
object is sequenced before the call to the function passed to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span><a class='hidden_link' href='#basic.start.term-5.sentence-2'>.</a></div> <div id='basic.start.term-5.sentence-3' class='sentence'>If a
call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> strongly happens before another call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span>, the
call to the function passed to the second <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> call is sequenced before
the call to the function passed to the first <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> call<a class='hidden_link' href='#basic.start.term-5.sentence-3'>.</a></div></div></div><div class='para' id='basic.start.term-6'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.term-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6732'>#</a></div><div class='texpara'><div id='basic.start.term-6.sentence-1' class='sentence'>If there is a use of a standard library object or function not permitted within signal
handlers (<a href='support.runtime' title='17.13&emsp;Other runtime support'>[support.<span class='shy'></span>runtime]</a>) that does not happen before (<a href='#intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)
completion of destruction of objects with static storage duration and execution of
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> registered functions (<a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>), the program has
undefined behavior<a class='hidden_link' href='#basic.start.term-6.sentence-1'>.</a></div> <div id='basic.start.term-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#basic.start.term-note-3'>3</a></i>: <div id='basic.start.term-6.sentence-2' class='sentence'>If there is a use of an object with static storage
duration that does not happen before the object's destruction, the program has undefined
behavior<a class='hidden_link' href='#basic.start.term-6.sentence-2'>.</a></div> <div id='basic.start.term-6.sentence-3' class='sentence'>Terminating every thread before a call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> or the exit from
<span class='texttt'>main</span> is sufficient, but not necessary, to satisfy these requirements<a class='hidden_link' href='#basic.start.term-6.sentence-3'>.</a></div> <div id='basic.start.term-6.sentence-4' class='sentence'>These
requirements permit thread managers as static-storage-duration objects<a class='hidden_link' href='#basic.start.term-6.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='basic.start.term-7'><div class='marginalizedparent'><a class='marginalized' href='#basic.start.term-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f8ac034ab30648da8e74427bdf6a8429ff6bf3fc/source/basic.tex#L6746'>#</a></div><div class='texpara'><div id='basic.start.term-7.sentence-1' class='sentence'><a class='index' id=':abort'></a><a class='index' id='lib:abort'></a><a class='index' id=':termination,program__'></a>Calling the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>abort<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> declared in
<a href='cstdlib.syn#header:%3ccstdlib%3e' title='17.2.2&emsp;Header &lt;cstdlib&gt; synopsis&emsp;[cstdlib.syn]'><span id='headerref:<cstdlib>_'><span class='texttt'>&lt;cstdlib&gt;</span></span></a> terminates the program without executing any destructors
and without calling
the functions passed to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>at_&shy;quick_&shy;exit<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#basic.start.term-7.sentence-1'>.</a></div> </div></div></div></div></div></body></html>