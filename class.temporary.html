<!DOCTYPE html><html lang='en'><head><title>[class.temporary]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>6.7</a> Memory and objects <a class='abbr_ref' href='basic.memobj#class.temporary'>[basic.memobj]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>6.7.7</a> Temporary objects <a class='abbr_ref'>[class.temporary]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d10a1132472f18bbfec269bdb3169a306d622caa/source/basic.tex#L4285'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':temporary'></a></span><span class='indexparent'><a class='index' id=':temporary,elimination_of'></a></span><span class='indexparent'><a class='index' id=':temporary,implementation-defined_generation_of'></a></span>Temporary objects are created
<ul class='itemize'><li id='1.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#1.1'>(1.1)</a></div>when a prvalue is converted to an xvalue (<a href='conv.rval' title='7.3.5&emsp;Temporary materialization conversion'>[conv.<span class='shy'></span>rval]</a>),</li><li id='1.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#1.2'>(1.2)</a></div>when needed by the implementation to pass or return an object of trivially copyable type (see below),
and</li><li id='1.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#1.3'>(1.3)</a></div>when throwing an exception (<a href='except.throw' title='14.2&emsp;Throwing an exception'>[except.<span class='shy'></span>throw]</a>)<a class='hidden_link' href='#1.sentence-1'>.</a> <div id='note-1' class='note'>[<a class='note_link' href='#note-1'><span class='textit'>Note&nbsp;1</span></a><span class='textit'>:</span> <div id='1.3.sentence-2' class='sentence'>The lifetime of exception objects is described in <a href='except.throw' title='14.2&emsp;Throwing an exception'>[except.<span class='shy'></span>throw]</a><a class='hidden_link' href='#1.3.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div> </li></ul></div> <div id='1.sentence-2' class='sentence'>
Even when the creation of the temporary object is
unevaluated (<a href='expr.prop' title='7.2&emsp;Properties of expressions'>[expr.<span class='shy'></span>prop]</a>),
all the semantic restrictions shall be respected as if the temporary object
had been created and later destroyed<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='note-2' class='note'>[<a class='note_link' href='#note-2'><span class='textit'>Note&nbsp;2</span></a><span class='textit'>:</span> <div id='1.sentence-3' class='sentence'>This includes accessibility (<a href='class.access' title='11.9&emsp;Member access control'>[class.<span class='shy'></span>access]</a>) and whether it is deleted,
for the constructor selected and for the destructor<a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'>However, in the special
case of the operand of a
<a href='dcl.type.decltype#nt:decltype-specifier' title='9.2.9.5&emsp;Decltype specifiers&emsp;[dcl.type.decltype]'><span id='ntref:decltype-specifier'><span class='textsf'><span class='textit'>decltype-specifier</span></span></span></a> (<a href='dcl.type.decltype' title='9.2.9.5&emsp;Decltype specifiers'>[dcl.<span class='shy'></span>type.<span class='shy'></span>decltype]</a>), no temporary is introduced,
so the foregoing does not apply to such a prvalue<a class='hidden_link' href='#1.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div> </div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d10a1132472f18bbfec269bdb3169a306d622caa/source/basic.tex#L4316'>#</a></div><div id='2.sentence-1' class='sentence'>The materialization of a temporary object is generally
delayed as long as possible
in order to avoid creating unnecessary temporary objects<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='note-3' class='note'>[<a class='note_link' href='#note-3'><span class='textit'>Note&nbsp;3</span></a><span class='textit'>:</span> <div id='2.sentence-2' class='sentence'>Temporary objects are materialized:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.1'>(2.1)</a></div>when binding a reference to a prvalue (<a href='dcl.init.ref' title='9.4.4&emsp;References'>[dcl.<span class='shy'></span>init.<span class='shy'></span>ref]</a>, <a href='expr.type.conv' title='7.6.1.4&emsp;Explicit type conversion (functional notation)'>[expr.<span class='shy'></span>type.<span class='shy'></span>conv]</a>,
<a href='expr.dynamic.cast' title='7.6.1.7&emsp;Dynamic cast'>[expr.<span class='shy'></span>dynamic.<span class='shy'></span>cast]</a>, <a href='expr.static.cast' title='7.6.1.9&emsp;Static cast'>[expr.<span class='shy'></span>static.<span class='shy'></span>cast]</a>, <a href='expr.const.cast' title='7.6.1.11&emsp;Const cast'>[expr.<span class='shy'></span>const.<span class='shy'></span>cast]</a>, <a href='expr.cast' title='7.6.3&emsp;Explicit type conversion (cast notation)'>[expr.<span class='shy'></span>cast]</a>),</li><li id='2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.2'>(2.2)</a></div>when performing member access on a class prvalue (<a href='expr.ref' title='7.6.1.5&emsp;Class member access'>[expr.<span class='shy'></span>ref]</a>, <a href='expr.mptr.oper' title='7.6.4&emsp;Pointer-to-member operators'>[expr.<span class='shy'></span>mptr.<span class='shy'></span>oper]</a>),</li><li id='2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.3'>(2.3)</a></div>when performing an array-to-pointer conversion or subscripting on an array prvalue (<a href='conv.array' title='7.3.3&emsp;Array-to-pointer conversion'>[conv.<span class='shy'></span>array]</a>, <a href='expr.sub' title='7.6.1.2&emsp;Subscripting'>[expr.<span class='shy'></span>sub]</a>),</li><li id='2.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.4'>(2.4)</a></div>when initializing an object of type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>initializer_&shy;list<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span></span> from a <a href='dcl.init.general#nt:braced-init-list' title='9.4.1&emsp;General&emsp;[dcl.init.general]'><span id='ntref:braced-init-list'><span class='textsf'><span class='textit'>braced-init-list</span></span></span></a> (<a href='dcl.init.list' title='9.4.5&emsp;List-initialization'>[dcl.<span class='shy'></span>init.<span class='shy'></span>list]</a>),</li><li id='2.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.5'>(2.5)</a></div>for certain unevaluated operands (<a href='expr.typeid' title='7.6.1.8&emsp;Type identification'>[expr.<span class='shy'></span>typeid]</a>, <a href='expr.sizeof' title='7.6.2.5&emsp;Sizeof'>[expr.<span class='shy'></span>sizeof]</a>), and</li><li id='2.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.6'>(2.6)</a></div>when a prvalue that has type other than <span class='mathit'>cv</span> <span class='texttt'><span class='keyword'>void</span></span> appears as a discarded-value expression (<a href='expr.prop' title='7.2&emsp;Properties of expressions'>[expr.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#2.sentence-2'>.</a></li></ul></div> —&nbsp;<i>end note</i>]</div>  <div id='example-1' class='example'>[<a class='example_link' href='#example-1'><span class='textit'>Example&nbsp;1</span></a><span class='textit'>:</span> <div id='2.sentence-3' class='sentence'>Consider the following code:
<span class='codeblock'><span class='keyword'>class</span> X <span class='curlybracket'>{</span>
<span class='keyword'>public</span><span class='operator'>:</span>
  X<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
  X<span class='parenthesis'>(</span><span class='keyword'>const</span> X<span class='operator'>&amp;</span><span class='parenthesis'>)</span>;
  X<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> X<span class='operator'>&amp;</span><span class='parenthesis'>)</span>;
  <span class='operator'>~</span>X<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>class</span> Y <span class='curlybracket'>{</span>
<span class='keyword'>public</span><span class='operator'>:</span>
  Y<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
  Y<span class='parenthesis'>(</span>Y<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span>;
  <span class='operator'>~</span>Y<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

X f<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span>;
Y g<span class='parenthesis'>(</span>Y<span class='parenthesis'>)</span>;

<span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  X a<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;
  X b <span class='operator'>=</span> f<span class='parenthesis'>(</span>X<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
  Y c <span class='operator'>=</span> g<span class='parenthesis'>(</span>Y<span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
  a <span class='operator'>=</span> f<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span></div><div id='2.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':constructor,copy'></a></span><span class='texttt'>X<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span></span> is constructed in the space used to hold <span class='texttt'>f<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>'s argument and
<span class='texttt'>Y<span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span></span> is constructed in the space used to hold <span class='texttt'>g<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>'s argument<a class='hidden_link' href='#2.sentence-4'>.</a></div> <div id='2.sentence-5' class='sentence'>Likewise,
<span class='texttt'>f<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>'s result is constructed directly in <span class='texttt'>b</span> and
<span class='texttt'>g<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>'s result is constructed directly in <span class='texttt'>c</span><a class='hidden_link' href='#2.sentence-5'>.</a></div> <div id='2.sentence-6' class='sentence'>On the other hand, the expression
<span class='texttt'>a <span class='operator'>=</span> f<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span></span>
requires a temporary for
the result of <span class='texttt'>f<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span></span>,
which is materialized so that the reference parameter
of <span class='texttt'>X<span class='operator'>&#x200b;::&#x200b;</span><span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> X<span class='operator'>&amp;</span><span class='parenthesis'>)</span></span> can bind to it<a class='hidden_link' href='#2.sentence-6'>.</a></div> —&nbsp;<i>end example</i>]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d10a1132472f18bbfec269bdb3169a306d622caa/source/basic.tex#L4382'>#</a></div><div id='3.sentence-1' class='sentence'>When an object of class type <span class='texttt'>X</span>
is passed to or returned from a function,
if <span class='texttt'>X</span> has at least one eligible copy or move constructor (<a href='special' title='11.4.4&emsp;Special member functions'>[special]</a>),
each such constructor is trivial,
and the destructor of <span class='texttt'>X</span> is either trivial or deleted,
implementations are permitted
to create a temporary object
to hold the function parameter or result object<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>The temporary object is constructed
from the function argument or return value, respectively,
and the function's parameter or return object
is initialized as if by
using the eligible trivial constructor to copy the temporary
(even if that constructor is inaccessible
or would not be selected by overload resolution
to perform a copy or move of the object)<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='note-4' class='note'>[<a class='note_link' href='#note-4'><span class='textit'>Note&nbsp;4</span></a><span class='textit'>:</span> <div id='3.sentence-3' class='sentence'>This latitude is granted to allow objects of class type to be passed to or returned from functions in registers<a class='hidden_link' href='#3.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d10a1132472f18bbfec269bdb3169a306d622caa/source/basic.tex#L4403'>#</a></div><div id='4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':temporary,constructor_for'></a></span><span class='indexparent'><a class='index' id=':temporary,destructor_for'></a></span><span class='indexparent'><a class='index' id=':temporary,destruction_of'></a></span>When an implementation introduces a temporary object of a class that has a
non-trivial constructor (<a href='class.default.ctor' title='11.4.5.2&emsp;Default constructors'>[class.<span class='shy'></span>default.<span class='shy'></span>ctor]</a>, <a href='class.copy.ctor' title='11.4.5.3&emsp;Copy/move constructors'>[class.<span class='shy'></span>copy.<span class='shy'></span>ctor]</a>),
it shall ensure that a constructor is called for the temporary object<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>Similarly, the destructor shall be called for a temporary with a non-trivial
destructor (<a href='class.dtor' title='11.4.7&emsp;Destructors'>[class.<span class='shy'></span>dtor]</a>)<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>Temporary objects are destroyed as the last step
in evaluating
the full-expression (<a href='intro.execution' title='6.9.1&emsp;Sequential execution'>[intro.<span class='shy'></span>execution]</a>)
that (lexically) contains the point where
they were created<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'>This is true even if that evaluation ends in throwing an exception<a class='hidden_link' href='#4.sentence-4'>.</a></div> <div id='4.sentence-5' class='sentence'>The
<span class='indexparent'><a class='index' id=':value_computation'></a></span>value computations and
<span class='indexparent'><a class='index' id=':side_effects'></a></span>side effects of destroying a temporary object
are associated only with the full-expression, not with any specific
subexpression<a class='hidden_link' href='#4.sentence-5'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d10a1132472f18bbfec269bdb3169a306d622caa/source/basic.tex#L4426'>#</a></div><div id='5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initializer,temporary_and_declarator'></a></span><span class='indexparent'><a class='index' id=':temporary,order_of_destruction_of'></a></span>There are three contexts in which temporaries are destroyed at a different
point than the end of the full-expression<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'>The first context is when a default constructor is called to initialize
an element of an array with no corresponding initializer (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>The second context is when a copy constructor is called to copy an element of
an array while the entire array is copied (<a href='expr.prim.lambda.capture' title='7.5.5.3&emsp;Captures'>[expr.<span class='shy'></span>prim.<span class='shy'></span>lambda.<span class='shy'></span>capture]</a>, <a href='class.copy.ctor' title='11.4.5.3&emsp;Copy/move constructors'>[class.<span class='shy'></span>copy.<span class='shy'></span>ctor]</a>)<a class='hidden_link' href='#5.sentence-3'>.</a></div> <div id='5.sentence-4' class='sentence'>In either case, if the constructor has one or more default arguments,
the destruction of every temporary created in a default argument is
sequenced before the construction of the next array element, if any<a class='hidden_link' href='#5.sentence-4'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d10a1132472f18bbfec269bdb3169a306d622caa/source/basic.tex#L4439'>#</a></div><div id='6.sentence-1' class='sentence'>The third context is when a reference is bound to a
temporary object<a class='hidden_link' href='#6.sentence-1'>.</a><a class='footnotenum' href='#footnote-38' id='footnoteref-38' title='The same rules apply to initialization of an initializer_&shy;list object ([dcl.init.list]) with its underlying temporary array.'>38</a></div> <div id='6.sentence-2' class='sentence'>
The temporary object to which the reference is bound or the temporary object
that is the complete object of a subobject to which the reference is bound
persists for the lifetime of the reference if the glvalue
to which the reference is bound
was obtained through one of the following:
<ul class='itemize'><li id='6.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.1'>(6.1)</a></div>a temporary materialization conversion (<a href='conv.rval' title='7.3.5&emsp;Temporary materialization conversion'>[conv.<span class='shy'></span>rval]</a>),</li><li id='6.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.2'>(6.2)</a></div><span class='texttt'><span class='parenthesis'>(</span></span> <a href='expr.comma#nt:expression' title='7.6.20&emsp;Comma operator&emsp;[expr.comma]'><span id='ntref:expression'><span class='textsf'><span class='textit'>expression</span></span></span></a> <span class='texttt'><span class='parenthesis'>)</span></span>,
  where <a href='expr.comma#nt:expression' title='7.6.20&emsp;Comma operator&emsp;[expr.comma]'><span id='ntref:expression_'><span class='textsf'><span class='textit'>expression</span></span></span></a> is one of these expressions,</li><li id='6.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.3'>(6.3)</a></div>subscripting (<a href='expr.sub' title='7.6.1.2&emsp;Subscripting'>[expr.<span class='shy'></span>sub]</a>) of an array operand,
  where that operand is one of these expressions,</li><li id='6.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.4'>(6.4)</a></div>a class member access (<a href='expr.ref' title='7.6.1.5&emsp;Class member access'>[expr.<span class='shy'></span>ref]</a>) using the <span class='texttt'><span class='operator'>.</span></span> operator
  where the left operand is one of these expressions and
  the right operand designates a non-static data member of non-reference type,</li><li id='6.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.5'>(6.5)</a></div>a pointer-to-member operation (<a href='expr.mptr.oper' title='7.6.4&emsp;Pointer-to-member operators'>[expr.<span class='shy'></span>mptr.<span class='shy'></span>oper]</a>) using the <span class='texttt'><span class='operator'>.</span><span class='operator'>*</span></span> operator
  where the left operand is one of these expressions and
  the right operand is a pointer to data member of non-reference type,</li><li id='6.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.6'>(6.6)</a></div>a
  <ul class='itemize'><li id='6.6.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#6.6.1'>(6.6.1)</a></div><span class='texttt'><span class='keyword'>const_&shy;cast</span></span> (<a href='expr.const.cast' title='7.6.1.11&emsp;Const cast'>[expr.<span class='shy'></span>const.<span class='shy'></span>cast]</a>),</li><li id='6.6.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#6.6.2'>(6.6.2)</a></div><span class='texttt'><span class='keyword'>static_&shy;cast</span></span> (<a href='expr.static.cast' title='7.6.1.9&emsp;Static cast'>[expr.<span class='shy'></span>static.<span class='shy'></span>cast]</a>),</li><li id='6.6.3'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#6.6.3'>(6.6.3)</a></div><span class='texttt'><span class='keyword'>dynamic_&shy;cast</span></span> (<a href='expr.dynamic.cast' title='7.6.1.7&emsp;Dynamic cast'>[expr.<span class='shy'></span>dynamic.<span class='shy'></span>cast]</a>), or</li><li id='6.6.4'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#6.6.4'>(6.6.4)</a></div><span class='texttt'><span class='keyword'>reinterpret_&shy;cast</span></span> (<a href='expr.reinterpret.cast' title='7.6.1.10&emsp;Reinterpret cast'>[expr.<span class='shy'></span>reinterpret.<span class='shy'></span>cast]</a>)</li></ul>
  converting, without a user-defined conversion,
  a glvalue operand that is one of these expressions
  to a glvalue that refers
  to the object designated by the operand, or
  to its complete object or a subobject thereof,</li><li id='6.7'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.7'>(6.7)</a></div>a conditional expression (<a href='expr.cond' title='7.6.16&emsp;Conditional operator'>[expr.<span class='shy'></span>cond]</a>) that is a glvalue
  where the second or third operand is one of these expressions, or</li><li id='6.8'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.8'>(6.8)</a></div>a comma expression (<a href='expr.comma' title='7.6.20&emsp;Comma operator'>[expr.<span class='shy'></span>comma]</a>) that is a glvalue
  where the right operand is one of these expressions<a class='hidden_link' href='#6.sentence-2'>.</a></li></ul></div> <div id='example-2' class='example'>[<a class='example_link' href='#example-2'><span class='textit'>Example&nbsp;2</span></a><span class='textit'>:</span> <span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>using</span> id <span class='operator'>=</span> T;

<span class='keyword'>int</span> i <span class='operator'>=</span> <span class='literal'>1</span>;
<span class='keyword'>int</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> a <span class='operator'>=</span> id<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span><span class='anglebracket'>&gt;</span><span class='curlybracket'>{</span><span class='literal'>1</span>, <span class='literal'>2</span>, <span class='literal'>3</span><span class='curlybracket'>}</span><span class='squarebracket'>[</span>i<span class='squarebracket'>]</span>;           <span class='comment'>// temporary array has same lifetime as <span class='tcode_in_codeblock'>a</span></span>
<span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> b <span class='operator'>=</span> <span class='keyword'>static_cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;  <span class='comment'>// temporary <span class='tcode_in_codeblock'>int</span> has same lifetime as <span class='tcode_in_codeblock'>b</span></span>
<span class='keyword'>int</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> c <span class='operator'>=</span> cond <span class='operator'>?</span> id<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span><span class='anglebracket'>&gt;</span><span class='curlybracket'>{</span><span class='literal'>1</span>, <span class='literal'>2</span>, <span class='literal'>3</span><span class='curlybracket'>}</span><span class='squarebracket'>[</span>i<span class='squarebracket'>]</span> <span class='operator'>:</span> <span class='keyword'>static_cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
                                            <span class='comment'>// exactly one of the two temporaries is lifetime-extended</span>
</span> —&nbsp;<i>end example</i>]</div>  <div id='note-5' class='note'>[<a class='note_link' href='#note-5'><span class='textit'>Note&nbsp;5</span></a><span class='textit'>:</span> <div id='6.sentence-3' class='sentence'>An explicit type conversion (<a href='expr.type.conv' title='7.6.1.4&emsp;Explicit type conversion (functional notation)'>[expr.<span class='shy'></span>type.<span class='shy'></span>conv]</a>, <a href='expr.cast' title='7.6.3&emsp;Explicit type conversion (cast notation)'>[expr.<span class='shy'></span>cast]</a>)
is interpreted as
a sequence of elementary casts,
covered above<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='example-3' class='example'>[<a class='example_link' href='#example-3'><span class='textit'>Example&nbsp;3</span></a><span class='textit'>:</span> <span class='codeblock'><span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> x <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span><span class='literal'>1</span>;   <span class='comment'>// temporary for value 1 has same lifetime as x</span>
</span> —&nbsp;<i>end example</i>]</div>  —&nbsp;<i>end note</i>]</div>  <div id='note-6' class='note'>[<a class='note_link' href='#note-6'><span class='textit'>Note&nbsp;6</span></a><span class='textit'>:</span> <div id='6.sentence-4' class='sentence'>If a temporary object has a reference member initialized by another temporary object,
lifetime extension applies recursively to such a member's initializer<a class='hidden_link' href='#6.sentence-4'>.</a></div> <div id='example-4' class='example'>[<a class='example_link' href='#example-4'><span class='textit'>Example&nbsp;4</span></a><span class='textit'>:</span> <span class='codeblock'><span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> m;
<span class='curlybracket'>}</span>;
<span class='keyword'>const</span> S<span class='operator'>&amp;</span> s <span class='operator'>=</span> S<span class='curlybracket'>{</span><span class='literal'>1</span><span class='curlybracket'>}</span>;              <span class='comment'>// both <span class='tcode_in_codeblock'>S</span> and <span class='tcode_in_codeblock'>int</span> temporaries have lifetime of <span class='tcode_in_codeblock'>s</span></span>
</span> —&nbsp;<i>end example</i>]</div>  —&nbsp;<i>end note</i>]</div> <div id='6.sentence-5' class='sentence'>The exceptions to this lifetime rule are:
<ul class='itemize'><li id='6.9'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.9'>(6.9)</a></div><div id='6.9.sentence-1' class='sentence'>A temporary object bound to a reference parameter in a function call (<a href='expr.call' title='7.6.1.3&emsp;Function call'>[expr.<span class='shy'></span>call]</a>)
persists until the completion of the full-expression containing the call<a class='hidden_link' href='#6.9.sentence-1'>.</a></div></li><li id='6.10'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.10'>(6.10)</a></div><div id='6.10.sentence-1' class='sentence'>A temporary object bound to a reference element of
an aggregate of class type initialized from
a parenthesized <a href='expr.post.general#nt:expression-list' title='7.6.1.1&emsp;General&emsp;[expr.post.general]'><span id='ntref:expression-list'><span class='textsf'><span class='textit'>expression-list</span></span></span></a> (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)
persists until the completion of the full-expression
containing the <a href='expr.post.general#nt:expression-list' title='7.6.1.1&emsp;General&emsp;[expr.post.general]'><span id='ntref:expression-list_'><span class='textsf'><span class='textit'>expression-list</span></span></span></a><a class='hidden_link' href='#6.10.sentence-1'>.</a></div></li><li id='6.11'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.11'>(6.11)</a></div><div id='6.11.sentence-1' class='sentence'>The lifetime of a temporary bound to the returned value in a function <span class='texttt'><span class='keyword'>return</span></span> statement (<a href='stmt.return' title='8.7.4&emsp;The return statement'>[stmt.<span class='shy'></span>return]</a>) is not extended; the temporary is destroyed at the end of the full-expression in the <span class='texttt'><span class='keyword'>return</span></span> statement<a class='hidden_link' href='#6.11.sentence-1'>.</a></div></li><li id='6.12'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.12'>(6.12)</a></div><div id='6.12.sentence-1' class='sentence'>A temporary bound to a reference in a <a href='expr.new#nt:new-initializer' title='7.6.2.8&emsp;New&emsp;[expr.new]'><span id='ntref:new-initializer'><span class='textsf'><span class='textit'>new-initializer</span></span></span></a> (<a href='expr.new' title='7.6.2.8&emsp;New'>[expr.<span class='shy'></span>new]</a>) persists until the completion of the full-expression containing the <a href='expr.new#nt:new-initializer' title='7.6.2.8&emsp;New&emsp;[expr.new]'><span id='ntref:new-initializer_'><span class='textsf'><span class='textit'>new-initializer</span></span></span></a><a class='hidden_link' href='#6.12.sentence-1'>.</a></div> <div id='note-7' class='note'>[<a class='note_link' href='#note-7'><span class='textit'>Note&nbsp;7</span></a><span class='textit'>:</span> <div id='6.12.sentence-2' class='sentence'>This may introduce a dangling reference<a class='hidden_link' href='#6.12.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div>  <div id='example-5' class='example'>[<a class='example_link' href='#example-5'><span class='textit'>Example&nbsp;5</span></a><span class='textit'>:</span> <span class='codeblock'><span class='keyword'>struct</span> S <span class='curlybracket'>{</span> <span class='keyword'>int</span> mi; <span class='keyword'>const</span> std<span class='operator'>::</span>pair<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>,<span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> mp; <span class='curlybracket'>}</span>;
S a <span class='curlybracket'>{</span> <span class='literal'>1</span>, <span class='curlybracket'>{</span><span class='literal'>2</span>,<span class='literal'>3</span><span class='curlybracket'>}</span> <span class='curlybracket'>}</span>;
S<span class='operator'>*</span> p <span class='operator'>=</span> <span class='keyword'>new</span> S<span class='curlybracket'>{</span> <span class='literal'>1</span>, <span class='curlybracket'>{</span><span class='literal'>2</span>,<span class='literal'>3</span><span class='curlybracket'>}</span> <span class='curlybracket'>}</span>;       <span class='comment'>// creates dangling reference</span>
</span> —&nbsp;<i>end example</i>]</div> </li></ul></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d10a1132472f18bbfec269bdb3169a306d622caa/source/basic.tex#L4547'>#</a></div><div id='7.sentence-1' class='sentence'>The destruction of a temporary whose lifetime is not extended by being
bound to a reference is sequenced before the destruction of every
temporary which is constructed earlier in the same full-expression<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>If the lifetime of two or more temporaries to which references are bound ends
at the same point,
these temporaries are destroyed at that point in the reverse order of the
completion of their construction<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>In addition, the destruction of temporaries bound to references shall
take into account the ordering of destruction of objects with static, thread, or
automatic storage duration (<a href='basic.stc.static' title='6.7.5.2&emsp;Static storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>static]</a>, <a href='basic.stc.thread' title='6.7.5.3&emsp;Thread storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>thread]</a>, <a href='basic.stc.auto' title='6.7.5.4&emsp;Automatic storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>auto]</a>);
that is, if
<span class='texttt'>obj1</span>
is an object with the same storage duration as the temporary and
created before the temporary is created
the temporary shall be destroyed before
<span class='texttt'>obj1</span>
is destroyed;
if
<span class='texttt'>obj2</span>
is an object with the same storage duration as the temporary and
created after the temporary is created
the temporary shall be destroyed after
<span class='texttt'>obj2</span>
is destroyed<a class='hidden_link' href='#7.sentence-3'>.</a></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d10a1132472f18bbfec269bdb3169a306d622caa/source/basic.tex#L4573'>#</a></div><div id='example-6' class='example'>[<a class='example_link' href='#example-6'><span class='textit'>Example&nbsp;6</span></a><span class='textit'>:</span> <span class='codeblock'><span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  S<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  S<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
  <span class='keyword'>friend</span> S <span class='keyword'>operator</span><span class='operator'>+</span><span class='parenthesis'>(</span><span class='keyword'>const</span> S<span class='operator'>&amp;</span>, <span class='keyword'>const</span> S<span class='operator'>&amp;</span><span class='parenthesis'>)</span>;
  <span class='operator'>~</span>S<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
S obj1;
<span class='keyword'>const</span> S<span class='operator'>&amp;</span> cr <span class='operator'>=</span> S<span class='parenthesis'>(</span><span class='literal'>16</span><span class='parenthesis'>)</span><span class='operator'>+</span>S<span class='parenthesis'>(</span><span class='literal'>23</span><span class='parenthesis'>)</span>;
S obj2;
</span><div id='8.sentence-1' class='sentence'>The expression
<span class='texttt'>S<span class='parenthesis'>(</span><span class='literal'>16</span><span class='parenthesis'>)</span> <span class='operator'>+</span> S<span class='parenthesis'>(</span><span class='literal'>23</span><span class='parenthesis'>)</span></span>
creates three temporaries:
a first temporary
<span class='texttt'>T1</span>
to hold the result of the expression
<span class='texttt'>S<span class='parenthesis'>(</span><span class='literal'>16</span><span class='parenthesis'>)</span></span>,
a second temporary
<span class='texttt'>T2</span>
to hold the result of the expression
<span class='texttt'>S<span class='parenthesis'>(</span><span class='literal'>23</span><span class='parenthesis'>)</span></span>,
and a third temporary
<span class='texttt'>T3</span>
to hold the result of the addition of these two expressions<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>The temporary
<span class='texttt'>T3</span>
is then bound to the reference
<span class='texttt'>cr</span><a class='hidden_link' href='#8.sentence-2'>.</a></div> <div id='8.sentence-3' class='sentence'>It is unspecified whether
<span class='texttt'>T1</span>
or
<span class='texttt'>T2</span>
is created first<a class='hidden_link' href='#8.sentence-3'>.</a></div> <div id='8.sentence-4' class='sentence'>On an implementation where
<span class='texttt'>T1</span>
is created before
<span class='texttt'>T2</span>,
<span class='texttt'>T2</span>
shall be destroyed before
<span class='texttt'>T1</span><a class='hidden_link' href='#8.sentence-4'>.</a></div> <div id='8.sentence-5' class='sentence'>The temporaries
<span class='texttt'>T1</span>
and
<span class='texttt'>T2</span>
are bound to the reference parameters of
<span class='texttt'><span class='keyword'>operator</span><span class='operator'>+</span></span>;
these temporaries are destroyed at the end of the full-expression
containing the call to
<span class='texttt'><span class='keyword'>operator</span><span class='operator'>+</span></span><a class='hidden_link' href='#8.sentence-5'>.</a></div> <div id='8.sentence-6' class='sentence'>The temporary
<span class='texttt'>T3</span>
bound to the reference
<span class='texttt'>cr</span>
is destroyed at the end of
<span class='texttt'>cr</span>'s
lifetime, that is, at the end of the program<a class='hidden_link' href='#8.sentence-6'>.</a></div> <div id='8.sentence-7' class='sentence'>In addition, the order in which
<span class='texttt'>T3</span>
is destroyed takes into account the destruction order of other objects with
static storage duration<a class='hidden_link' href='#8.sentence-7'>.</a></div> <div id='8.sentence-8' class='sentence'>That is, because
<span class='texttt'>obj1</span>
is constructed before
<span class='texttt'>T3</span>,
and
<span class='texttt'>T3</span>
is constructed before
<span class='texttt'>obj2</span>,
<span class='texttt'>obj2</span>
shall be destroyed before
<span class='texttt'>T3</span>,
and
<span class='texttt'>T3</span>
shall be destroyed before
<span class='texttt'>obj1</span><a class='hidden_link' href='#8.sentence-8'>.</a></div> —&nbsp;<i>end example</i>]</div> </div><div class='footnote' id='footnote-38'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-38'>38)</a></div><div id='footnote-38.sentence-1' class='sentence'>The same rules apply to initialization of an
  <span class='texttt'>initializer_&shy;list</span> object (<a href='dcl.init.list' title='9.4.5&emsp;List-initialization'>[dcl.<span class='shy'></span>init.<span class='shy'></span>list]</a>) with its
  underlying temporary array<a class='hidden_link' href='#footnote-38.sentence-1'>.</a></div>&nbsp;<a href='#footnoteref-38'>⮥</a></div></div></body></html>