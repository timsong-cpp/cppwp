<!DOCTYPE html><html lang='en'><head><title>[stmt.ranged]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>5</a> Statements <a class='abbr_ref' href='./#stmt'>[stmt]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>5.1</a> Iteration statements <a class='abbr_ref' href='stmt.iter#stmt.ranged'>[stmt.iter]</a></h2><div id='stmt.ranged'><h3 ><a class='secnum' style='min-width:103pt'>5.1.1</a> The range-based <span class='texttt'>for</span> statement <a class='abbr_ref'>[stmt.ranged]</a></h3><p ><span class='enote'>[Editor's note: Modify   ISO/IEC 14882:2014 &sect;<a href='../n4140/stmt.ranged'>[stmt.ranged]</a>/p1 to allow differently typed begin and end
iterators, like in C++17.]</span></p><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><p ><span class='removed'>For a range-based for statement of the form</span></p><pre class='bnf'><span class='removed'><span class='terminal'>for</span> <span class='terminal'>(</span> for-range-declaration <span class='terminal'>:</span> expression <span class='terminal'>)</span> statement</span></pre><p ><span class='removed'>let <span class='grammarterm'>range-init</span> be equivalent to the expression surrounded by parentheses</span></p><pre class='bnf'><span class='removed'><span class='terminal'>(</span> expression <span class='terminal'>)</span></span></pre><p ><span class='removed'>and for a range-based for statement of the form</span></p><pre class='bnf'><span class='removed'><span class='terminal'>for</span> <span class='terminal'>(</span> for-range-declaration <span class='terminal'>:</span> braced-init-list <span class='terminal'>)</span> statement</span></pre><p ><span class='removed'>let <span class='grammarterm'>range-init</span> be equivalent to the <span class='grammarterm'>braced-init-list</span>.</span>
<span class='removed'>In each case, a range-based for statement is equivalent to</span>
</p><pre class='codeblock'>
<span class='removed'>{</span>
  <span class='removed'>auto &amp;&amp; __range = <span class='grammerterm'>range-init</span>;</span>
  <span class='removed'>for ( auto __begin = <span class='grammarterm'>begin-expr</span>,</span>
             <span class='removed'>__end = <span class='grammarterm'>end-expr</span>;</span>
        <span class='removed'>__begin != __end;</span>
        <span class='removed'>++__begin ) {</span>
    <span class='removed'><span class='grammarterm'>for-range-declaration</span> = *__begin;</span>
    <span class='removed'><span class='grammarterm'>statement</span></span>
  <span class='removed'>}</span>
<span class='removed'>}</span>
</pre><p ><span class='added'>The range-based for statement</span></p><pre class='bnf'><span class='added'><span class='terminal'>for</span> <span class='terminal'>(</span> for-range-declaration <span class='terminal'>:</span> for-range-initializer <span class='terminal'>)</span> statement</span></pre><p ><span class='added'>is equivalent to</span>
</p><pre class='codeblock'>
<span class='added'>{</span>
  <span class='added'>auto &amp;&amp; __range = <span class='grammarterm'>for-range-initializer</span>;</span>
  <span class='added'>auto __begin = <span class='grammarterm'>begin-expr</span>;</span>
  <span class='added'>auto __end = <span class='grammarterm'>end-expr</span>;</span>
  <span class='added'>for ( ; __begin != __end; ++__begin ) {</span>
    <span class='added'><span class='grammarterm'>for-range-declaration</span> = *__begin;</span>
    <span class='added'><span class='grammarterm'>statement</span></span>
  <span class='added'>}</span>
<span class='added'>}</span>
</pre><p >where
</p><ul class='itemize'><li id='1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.1'>(1.1)</a></div><p ><span class='added'>if the <span class='grammarterm'>for-range-initializer</span> is an <span class='grammarterm'>expression</span>, it is
regarded as if it were surrounded by parentheses (so that a comma operator cannot
be reinterpreted as delimiting two <span class='grammarterm'>init-declarators</span>);</span></p></li><li id='1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.2'>(1.2)</a></div><p ><span class='texttt'>__range</span>, <span class='texttt'>__begin</span>, and <span class='texttt'>__end</span> are variables defined for
exposition only; and <span class='removed'><span class='texttt'>_RangeT</span> is the type of the
<span class='grammarterm'>expression</span>, and <i>begin-expr</i> and <i>end-expr</i> are
determined as follows:</span></p></li><li id='1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.3'>(1.3)</a></div><p ><span class='added'><span class='grammarterm'>begin-expr</span> and <span class='grammarterm'>end-expr</span> are determined as follows:</span></p><ul class='itemize'><li id='1.3.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#1.3.1'>(1.3.1)</a></div><p >if <span class='removed'><span class='texttt'>_RangeT</span></span><span class='added'>the <span class='grammarterm'>for-range-initializer</span></span> is an
<span class='added'>expression of</span> array type <span class='added'><span class='texttt'>R</span></span>, <i>begin-expr</i> and <i>end-expr</i> are
<span class='texttt'>__range</span> and <span class='texttt'>__range + __bound</span>, respectively, where <span class='texttt'>__bound</span> is
the array bound. If <span class='removed'><span class='texttt'>_RangeT</span></span><span class='added'><span class='texttt'>R</span></span> is an array of unknown
<span class='removed'>size</span><span class='added'>bound</span> or an array of incomplete type, the program is ill-formed;</p></li><li id='1.3.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#1.3.2'>(1.3.2)</a></div><p >if <span class='removed'><span class='texttt'>_RangeT</span></span><span class='added'>the <span class='grammarterm'>for-range-initializer</span></span> is
<span class='removed'>a</span><span class='added'>an expression of</span> class type <span class='added'><span class='texttt'>C</span></span>, the
<span class='grammarterm'>unqualified-ids</span> <span class='texttt'>begin</span> and <span class='texttt'>end</span> are looked up in
the scope of <span class='removed'>class <span class='texttt'><span class='mbox'>_RangeT</span></span></span><span class='added'><span class='texttt'>C</span></span> as if by class
member access lookup (<a href='../n4140/basic.lookup.classref'>[basic.lookup.classref]</a>), and if either
(or both) finds at least one declaration, <span class='grammarterm'>begin-expr</span> and
<span class='grammarterm'>end-expr</span> are <span class='texttt'>__range.begin()</span> and <span class='texttt'>__range.end()</span>,
respectively;</p></li><li id='1.3.3'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#1.3.3'>(1.3.3)</a></div><p >otherwise, <i>begin-expr</i> and <i>end-expr</i> are <span class='texttt'>begin(__range)</span>
and <span class='texttt'>end(__range)</span>, respectively, where <span class='texttt'>begin</span> and <span class='texttt'>end</span> are looked
up in the associated namespaces (<a href='../n4140/basic.lookup.argdep'>[basic.lookup.argdep]</a>).
[&nbsp;<i>Note:</i> Ordinary unqualified lookup (<a href='../n4140/basic.lookup.unqual'>[basic.lookup.unqual]</a>) is not
performed. <i>&nbsp;—&nbsp;end note</i>&nbsp;]
</p></li></ul></li></ul><p >[&nbsp;<i>Example:</i>
</p><pre class='codeblock'>
int array[5] = { 1, 2, 3, 4, 5 };
for (int&amp; x : array)
  x *= 2;
</pre><p ><i>&nbsp;—&nbsp;end example</i>&nbsp;]<span class='indexparent'><a class='index' id='statement,iteration'></a></span></p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><p >In the <span class='grammarterm'>decl-specifier-seq</span> of a <span class='grammarterm'>for-range-declaration</span>,
each <span class='grammarterm'>decl-specifier</span> shall be either a <span class='grammarterm'>type-specifier</span>
or <span class='texttt'>constexpr</span>. The <span class='grammarterm'>decl-specifier-seq</span> shall not define a
class or enumeration.
</p></div></div></div></body></html>