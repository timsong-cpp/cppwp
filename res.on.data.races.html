<!DOCTYPE html><html lang='en'><head><title>[res.on.data.races]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>16</a> Library introduction <a class='abbr_ref' href='./#library'>[library]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>16.4</a> Library-wide requirements <a class='abbr_ref' href='requirements#res.on.data.races'>[requirements]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>16.4.6</a> Conforming implementations <a class='abbr_ref' href='conforming#res.on.data.races'>[conforming]</a></h3><h4 ><a class='secnum' style='min-width:95pt'>16.4.6.10</a> Data race avoidance <a class='abbr_ref'>[res.on.data.races]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L2954'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>This subclause specifies requirements that implementations shall meet to prevent
<a href='intro.multithread#def:data_race' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>data races</a><a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>Every standard library function shall meet each requirement unless otherwise specified<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>Implementations may prevent data races in cases other than those specified below<a class='hidden_link' href='#1.sentence-3'>.</a></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L2960'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>A C++ standard library function shall not directly or indirectly access
objects (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>) accessible by threads other than the current thread
unless the objects are accessed directly or indirectly via the function's arguments,
including <span class='texttt'><span class='keyword'>this</span></span><a class='hidden_link' href='#2.sentence-1'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L2966'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>A C++ standard library function shall not directly or indirectly modify
objects (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>) accessible by threads other than the current thread
unless the objects are accessed directly or indirectly via the function's non-const
arguments, including <span class='texttt'><span class='keyword'>this</span></span><a class='hidden_link' href='#3.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L2972'>#</a></div><div class='texpara'><div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>: <div id='4.sentence-1' class='sentence'>This means, for example, that implementations can't use an object with static storage duration for
internal purposes without synchronization because doing so can cause a data race even in
programs that do not explicitly share objects between threads<a class='hidden_link' href='#4.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L2979'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>A C++ standard library function shall not access objects indirectly accessible via its
arguments or via elements of its container arguments except by invoking functions
required by its specification on those container elements<a class='hidden_link' href='#5.sentence-1'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L2984'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>Operations on iterators obtained by calling a standard library container or string
member function may access the underlying container, but shall not modify it<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>: <div id='6.sentence-2' class='sentence'>In particular, container operations that invalidate iterators conflict
with operations on iterators associated with that container<a class='hidden_link' href='#6.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L2992'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'>Implementations may share their own internal objects between threads if the objects are
not visible to users and are protected against data races<a class='hidden_link' href='#7.sentence-1'>.</a></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L2996'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'>Unless otherwise specified, C++ standard library functions shall perform all operations
solely within the current thread if those operations have effects that are
<a href='intro.multithread#def:side_effects,visible' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>visible</a> to users<a class='hidden_link' href='#8.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/5494117ea39b36ce3e590025943a8ff48e78b4d3/source/lib-intro.tex#L3001'>#</a></div><div class='texpara'><div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>: <div id='9.sentence-1' class='sentence'>This allows implementations to parallelize operations if there are no visible
<a class='index' id=':side_effects'></a>side effects<a class='hidden_link' href='#9.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div></body></html>