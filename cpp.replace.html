<!DOCTYPE html><html lang='en'><head><title>[cpp.replace]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>15</a> Preprocessing directives <a class='abbr_ref' href='./#cpp'>[cpp]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>15.6</a> Macro replacement <a class='abbr_ref'>[cpp.replace]</a></h2><div id='general' class='section'><h3 ><a class='secnum' href='#general' style='min-width:80pt'>15.6.1</a> General <a class='abbr_ref' href='cpp.replace.general'>[cpp.replace.general]</a></h3><div class='texpara'><a class='index' id=':macro,replacement'></a></div><div class='para' id='general-1'><div class='marginalizedparent'><a class='marginalized' href='#general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L951'>#</a></div><div class='texpara'><div id='general-1.sentence-1' class='sentence'><a class='index' id=':macro,replacement_list'></a>Two replacement lists are identical if and only if
the preprocessing tokens in both have
the same number, ordering, spelling, and whitespace separation,
where all whitespace separations are considered identical<a class='hidden_link' href='#general-1.sentence-1'>.</a></div></div></div><div class='para' id='general-2'><div class='marginalizedparent'><a class='marginalized' href='#general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L958'>#</a></div><div class='texpara'><div id='general-2.sentence-1' class='sentence'>An identifier currently defined as an
<a class='index' id=':macro,object-like'></a>object-like macro (see below) may be redefined by another
<span class='texttt'><span class='preprocessordirective'>#define</span></span>
preprocessing directive provided that the second definition is an
object-like macro definition and the two replacement lists
are identical, otherwise the program is ill-formed<a class='hidden_link' href='#general-2.sentence-1'>.</a></div> <div id='general-2.sentence-2' class='sentence'>Likewise, an identifier currently defined as a
<a class='index' id=':macro,function-like'></a>function-like macro (see below) may be redefined by another
<span class='texttt'><span class='preprocessordirective'>#define</span></span>
preprocessing directive provided that the second definition is a
function-like macro definition that has the same number and spelling
of parameters,
and the two replacement lists are identical,
otherwise the program is ill-formed<a class='hidden_link' href='#general-2.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='general-3'><div class='marginalizedparent'><a class='marginalized' href='#general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L976'>#</a></div><div class='texpara'><div id='general-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#general-example-1'>1</a></i>:&ensp;<div id='general-3.sentence-1' class='sentence'>The following sequence is valid:
<span class='codeblock'><span class='preprocessordirective'>#define</span> OBJ_LIKE      <span class='parenthesis'>(</span><span class='literal'>1</span><span class='operator'>-</span><span class='literal'>1</span><span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> OBJ_LIKE      <span class='comment'>/* whitespace */</span> <span class='parenthesis'>(</span><span class='literal'>1</span><span class='operator'>-</span><span class='literal'>1</span><span class='parenthesis'>)</span> <span class='comment'>/* other */</span>
<span class='preprocessordirective'>#define</span> FUNC_LIKE<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>   <span class='parenthesis'>(</span> a <span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> FUNC_LIKE<span class='parenthesis'>(</span> a <span class='parenthesis'>)</span><span class='parenthesis'>(</span>     <span class='comment'>/* note the whitespace */</span> \
                a <span class='comment'>/* other stuff on this line
                  */</span> <span class='parenthesis'>)</span>
</span></div> <div id='general-3.sentence-2' class='sentence'>
But the following redefinitions are invalid:
<span class='codeblock'><span class='preprocessordirective'>#define</span> OBJ_LIKE    <span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>         <span class='comment'>// different token sequence</span>
<span class='preprocessordirective'>#define</span> OBJ_LIKE    <span class='parenthesis'>(</span><span class='literal'>1</span> <span class='operator'>-</span> <span class='literal'>1</span><span class='parenthesis'>)</span>     <span class='comment'>// different whitespace</span>
<span class='preprocessordirective'>#define</span> FUNC_LIKE<span class='parenthesis'>(</span>b<span class='parenthesis'>)</span> <span class='parenthesis'>(</span> a <span class='parenthesis'>)</span>      <span class='comment'>// different parameter usage</span>
<span class='preprocessordirective'>#define</span> FUNC_LIKE<span class='parenthesis'>(</span>b<span class='parenthesis'>)</span> <span class='parenthesis'>(</span> b <span class='parenthesis'>)</span>      <span class='comment'>// different parameter spelling</span>
</span></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='general-4'><div class='marginalizedparent'><a class='marginalized' href='#general-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L996'>#</a></div><div class='texpara'><div id='general-4.sentence-1' class='sentence'><a class='index' id=':macro,replacement_list_'></a>There shall be whitespace between the identifier and the replacement list
in the definition of an object-like macro<a class='hidden_link' href='#general-4.sentence-1'>.</a></div></div></div><div class='para' id='general-5'><div class='marginalizedparent'><a class='marginalized' href='#general-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1001'>#</a></div><div class='texpara'><div id='general-5.sentence-1' class='sentence'>If the <a href='cpp.pre#nt:identifier-list' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:identifier-list'><span class='textsf'><i >identifier-list</i></span></span></a> in the macro definition does not end with
an ellipsis, the number of arguments (including those arguments consisting
of no preprocessing tokens)
in an invocation of a function-like macro shall
equal the number of parameters in the macro definition<a class='hidden_link' href='#general-5.sentence-1'>.</a></div> <div id='general-5.sentence-2' class='sentence'>Otherwise, there shall be at least as many arguments in the invocation as there are
parameters in the macro definition (excluding the <span class='texttt'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span>)<a class='hidden_link' href='#general-5.sentence-2'>.</a></div> <div id='general-5.sentence-3' class='sentence'>There
shall exist a
<span class='texttt'><span class='parenthesis'>)</span></span>
preprocessing token that terminates the invocation<a class='hidden_link' href='#general-5.sentence-3'>.</a></div></div></div><div class='para' id='general-6'><div class='marginalizedparent'><a class='marginalized' href='#general-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1013'>#</a></div><div class='texpara'><div id='general-6.sentence-1' class='sentence'><a class='index' id=':__VA_ARGS__'></a><a class='index' id=':__VA_OPT__'></a>The identifiers <span class='texttt'>__VA_<span class='shy'></span>ARGS__</span> and <span class='texttt'>__VA_<span class='shy'></span>OPT__</span>
shall occur only in the <a href='cpp.pre#nt:replacement-list' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:replacement-list'><span class='textsf'><i >replacement-list</i></span></span></a>
of a function-like macro that uses the ellipsis notation in the parameters<a class='hidden_link' href='#general-6.sentence-1'>.</a></div></div></div><div class='para' id='general-7'><div class='marginalizedparent'><a class='marginalized' href='#general-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1020'>#</a></div><div class='texpara'><div id='general-7.sentence-1' class='sentence'>A parameter identifier in a function-like macro
shall be uniquely declared within its scope<a class='hidden_link' href='#general-7.sentence-1'>.</a></div></div></div><div class='para' id='general-8'><div class='marginalizedparent'><a class='marginalized' href='#general-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1024'>#</a></div><div class='texpara'><div id='general-8.sentence-1' class='sentence'>The identifier immediately following the
<span class='texttt'>define</span>
is called the
<a class='hidden_link' href='#def:macro,name' title='15.6.1&emsp;General&emsp;[cpp.replace.general]'><span id='def:macro,name'><i >macro name</i></span></a><a class='hidden_link' href='#general-8.sentence-1'>.</a></div> <div id='general-8.sentence-2' class='sentence'>There is one name space for macro names<a class='hidden_link' href='#general-8.sentence-2'>.</a></div> <div id='general-8.sentence-3' class='sentence'>Any whitespace characters preceding or following the
replacement list of preprocessing tokens are not considered
part of the replacement list for either form of macro<a class='hidden_link' href='#general-8.sentence-3'>.</a></div></div></div><div class='para' id='general-9'><div class='marginalizedparent'><a class='marginalized' href='#general-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1035'>#</a></div><div class='texpara'><div id='general-9.sentence-1' class='sentence'>If a
<a class='index' id=':#_operator'></a>
<span class='texttt'><span class='preprocessordirective'>#</span></span>
preprocessing token,
followed by an identifier,
occurs lexically
at the point at which a preprocessing directive can begin,
the identifier is not subject to macro replacement<a class='hidden_link' href='#general-9.sentence-1'>.</a></div></div></div><div class='para' id='general-10'><div class='marginalizedparent'><a class='marginalized' href='#general-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1045'>#</a></div><div class='texpara'><div id='general-10.sentence-1' class='sentence'>A preprocessing directive of the form
<div class='simplebnf'>
<span class='terminal'><span class='preprocessordirective'># define</span></span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier'><span class='textsf'><i >identifier</i></span></span></a> <a href='cpp.pre#nt:replacement-list' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:replacement-list_'><span class='textsf'><i >replacement-list</i></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line'><span class='textsf'><i >new-line</i></span></span></a>
<a class='index' id=':#define'></a></div>
defines an
<a class='hidden_link' href='#def:macro,object-like' title='15.6.1&emsp;General&emsp;[cpp.replace.general]'><span id='def:macro,object-like'><i >object-like macro</i></span></a> that
causes each subsequent instance of the macro name<a class='footnoteref' href='#footnote-133' id='footnoteref-133' title='Since, by macro-replacement time, all character-literals and string-literals are preprocessing tokens, not sequences possibly containing identifier-like subsequences (see [lex.phases], translation phases), they are never scanned for macro names or parameters.'>133</a>
to be replaced by the replacement list of preprocessing tokens
that constitute the remainder of the directive<a class='hidden_link' href='#general-10.sentence-1'>.</a><a class='footnoteref' href='#footnote-134' id='footnoteref-134' title='An alternative token ([lex.digraph]) is not an identifier, even when its spelling consists entirely of letters and underscores. Therefore it is not possible to define a macro whose name is the same as that of an alternative token.'>134</a></div> <div id='general-10.sentence-2' class='sentence'>
The replacement list is then rescanned for more macro names as
specified below<a class='hidden_link' href='#general-10.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='general-11'><div class='marginalizedparent'><a class='marginalized' href='#general-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1072'>#</a></div><div class='texpara'><div id='general-example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#general-example-2'>2</a></i>:&ensp;<div id='general-11.sentence-1' class='sentence'>The simplest use of this facility is to define a “manifest constant”,
as in
<span class='codeblock'><span class='preprocessordirective'>#define</span> TABSIZE <span class='literal'>100</span>
<span class='keyword'>int</span> table<span class='squarebracket'>[</span>TABSIZE<span class='squarebracket'>]</span>;
</span></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='general-12'><div class='marginalizedparent'><a class='marginalized' href='#general-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1082'>#</a></div><div class='texpara'><div id='general-12.sentence-1' class='sentence'>A preprocessing directive of the form
<div class='simplebnf'>
<span class='terminal'><span class='preprocessordirective'># define</span></span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier_'><span class='textsf'><i >identifier</i></span></span></a> <a href='cpp.pre#nt:lparen' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:lparen'><span class='textsf'><i >lparen</i></span></span></a> <a href='cpp.pre#nt:identifier-list' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:identifier-list_'><span class='textsf'><i >identifier-list</i></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='parenthesis'>)</span></span> <a href='cpp.pre#nt:replacement-list' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:replacement-list__'><span class='textsf'><i >replacement-list</i></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line_'><span class='textsf'><i >new-line</i></span></span></a><br/><span class='terminal'><span class='preprocessordirective'># define</span></span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier__'><span class='textsf'><i >identifier</i></span></span></a> <a href='cpp.pre#nt:lparen' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:lparen_'><span class='textsf'><i >lparen</i></span></span></a> <span class='terminal'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> <span class='terminal'><span class='parenthesis'>)</span></span> <a href='cpp.pre#nt:replacement-list' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:replacement-list___'><span class='textsf'><i >replacement-list</i></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line__'><span class='textsf'><i >new-line</i></span></span></a><br/><span class='terminal'><span class='preprocessordirective'># define</span></span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier___'><span class='textsf'><i >identifier</i></span></span></a> <a href='cpp.pre#nt:lparen' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:lparen__'><span class='textsf'><i >lparen</i></span></span></a> <a href='cpp.pre#nt:identifier-list' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:identifier-list__'><span class='textsf'><i >identifier-list</i></span></span></a> <span class='terminal'>, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> <span class='terminal'><span class='parenthesis'>)</span></span> <a href='cpp.pre#nt:replacement-list' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:replacement-list____'><span class='textsf'><i >replacement-list</i></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line___'><span class='textsf'><i >new-line</i></span></span></a>
</div>
defines a <a class='hidden_link' href='#def:macro,function-like' title='15.6.1&emsp;General&emsp;[cpp.replace.general]'><span id='def:macro,function-like'><i >function-like macro</i></span></a>
with parameters, whose use is
similar syntactically to a function call<a class='hidden_link' href='#general-12.sentence-1'>.</a></div> <div id='general-12.sentence-2' class='sentence'>The parameters
<a class='index' id=':parameter,macro'></a>are specified by the optional list of identifiers<a class='hidden_link' href='#general-12.sentence-2'>.</a></div> <div id='general-12.sentence-3' class='sentence'>Each subsequent instance of the function-like macro name followed by a
<span class='texttt'><span class='parenthesis'>(</span></span>
as the next preprocessing token
introduces the sequence of preprocessing tokens that is replaced
by the replacement list in the definition
(an invocation of the macro)<a class='hidden_link' href='#general-12.sentence-3'>.</a></div> <div id='general-12.sentence-4' class='sentence'><a class='index' id=':invocation,macro'></a>The replaced sequence of preprocessing tokens is terminated by the matching
<span class='texttt'><span class='parenthesis'>)</span></span>
preprocessing token, skipping intervening matched pairs of left and
right parenthesis preprocessing tokens<a class='hidden_link' href='#general-12.sentence-4'>.</a></div> <div id='general-12.sentence-5' class='sentence'>Within the sequence of preprocessing tokens making up an invocation
of a function-like macro,
new-line is considered a normal whitespace character<a class='hidden_link' href='#general-12.sentence-5'>.</a></div></div></div><div class='para' id='general-13'><div class='marginalizedparent'><a class='marginalized' href='#general-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1110'>#</a></div><div class='texpara'><div id='general-13.sentence-1' class='sentence'><a class='index' id=':macro,function-like,arguments'></a>The sequence of preprocessing tokens
bounded by the outside-most matching parentheses
forms the list of arguments for the function-like macro<a class='hidden_link' href='#general-13.sentence-1'>.</a></div> <div id='general-13.sentence-2' class='sentence'>The individual arguments within the list
are separated by comma preprocessing tokens,
but comma preprocessing tokens between matching
inner parentheses do not separate arguments<a class='hidden_link' href='#general-13.sentence-2'>.</a></div> <div id='general-13.sentence-3' class='sentence'>If there are sequences of preprocessing tokens within the list of
arguments that would otherwise act as preprocessing directives,<a class='footnoteref' href='#footnote-135' id='footnoteref-135' title='A conditionally-supported-directive is a preprocessing directive regardless of whether the implementation supports it.'>135</a>
the behavior is undefined<a class='hidden_link' href='#general-13.sentence-3'>.</a></div></div></div><div class='para nonNormativeOnly' id='general-14'><div class='marginalizedparent'><a class='marginalized' href='#general-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1126'>#</a></div><div class='texpara'><div id='general-example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#general-example-3'>3</a></i>:&ensp;<div id='general-14.sentence-1' class='sentence'>The following defines a function-like
macro whose value is the maximum of its arguments<a class='hidden_link' href='#general-14.sentence-1'>.</a></div> <div id='general-14.sentence-2' class='sentence'>It has the disadvantages of evaluating one or the other of its arguments
a second time
(including
<a class='index' id=':side_effects'></a>side effects)
and generating more code than a function if invoked several times<a class='hidden_link' href='#general-14.sentence-2'>.</a></div> <div id='general-14.sentence-3' class='sentence'>It also cannot have its address taken,
as it has none<a class='hidden_link' href='#general-14.sentence-3'>.</a></div></div><div class='texpara'><span class='codeblock'><span class='preprocessordirective'>#define</span> max<span class='parenthesis'>(</span>a, b<span class='parenthesis'>)</span> <span class='parenthesis'>(</span><span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='anglebracket'>&gt;</span> <span class='parenthesis'>(</span>b<span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='operator'>:</span> <span class='parenthesis'>(</span>b<span class='parenthesis'>)</span><span class='parenthesis'>)</span>
</span></div><div class='texpara'><div id='general-14.sentence-4' class='sentence'>The parentheses ensure that the arguments and
the resulting expression are bound properly<a class='hidden_link' href='#general-14.sentence-4'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='general-15'><div class='marginalizedparent'><a class='marginalized' href='#general-15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1147'>#</a></div><div class='texpara'><div id='general-15.sentence-1' class='sentence'><a class='index' id=':macro,function-like,arguments_'></a>If there is a <span class='texttt'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> immediately preceding the <span class='texttt'><span class='parenthesis'>)</span></span> in the
function-like macro
definition, then the trailing arguments (if any), including any separating comma preprocessing
tokens, are merged to form a single item: the <a class='hidden_link' href='#def:variable_arguments' title='15.6.1&emsp;General&emsp;[cpp.replace.general]'><span id='def:variable_arguments'><i >variable arguments</i></span></a><a class='hidden_link' href='#general-15.sentence-1'>.</a></div> <div id='general-15.sentence-2' class='sentence'>The number of
arguments so combined is such that, following merger, the number of arguments is
either equal to or
one more than the number of parameters in the macro definition (excluding the
<span class='texttt'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span>)<a class='hidden_link' href='#general-15.sentence-2'>.</a></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-133'><div class='texpara'><a class='footnotenum' href='#footnote-133'>133)</a><a class='footnoteBacklink' href='#footnoteref-133'>133)</a> <div id='footnote-133.sentence-1' class='sentence'>Since, by macro-replacement time,
all <a href='lex.ccon#nt:character-literal' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:character-literal'><span class='textsf'><i >character-literal</i></span></span></a><i >s</i> and <a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal'><span class='textsf'><i >string-literal</i></span></span></a><i >s</i> are preprocessing tokens,
not sequences possibly containing identifier-like subsequences
(see <a href='lex.phases' title='5.2&emsp;Phases of translation'>[lex.<span class='shy'></span>phases]</a>, translation phases),
they are never scanned for macro names or parameters<a class='hidden_link' href='#footnote-133.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-134'><div class='texpara'><a class='footnotenum' href='#footnote-134'>134)</a><a class='footnoteBacklink' href='#footnoteref-134'>134)</a> <div id='footnote-134.sentence-1' class='sentence'>An alternative token (<a href='lex.digraph' title='5.5&emsp;Alternative tokens'>[lex.<span class='shy'></span>digraph]</a>) is not an identifier,
even when its spelling consists entirely of letters and underscores<a class='hidden_link' href='#footnote-134.sentence-1'>.</a></div> <div id='footnote-134.sentence-2' class='sentence'>Therefore it is not possible to define a macro
whose name is the same as that of an alternative token<a class='hidden_link' href='#footnote-134.sentence-2'>.</a></div></div></div><div class='footnote' id='footnote-135'><div class='texpara'><a class='footnotenum' href='#footnote-135'>135)</a><a class='footnoteBacklink' href='#footnoteref-135'>135)</a> <div id='footnote-135.sentence-1' class='sentence'>A <a href='cpp.pre#nt:conditionally-supported-directive' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:conditionally-supported-directive'><span class='textsf'><i >conditionally-supported-directive</i></span></span></a> is a preprocessing directive regardless of whether the implementation supports it<a class='hidden_link' href='#footnote-135.sentence-1'>.</a></div></div></div></div><div id='cpp.subst' class='section'><h3 ><a class='secnum' href='#cpp.subst' style='min-width:80pt'>15.6.2</a> Argument substitution <a class='abbr_ref' href='cpp.subst'>[cpp.subst]</a></h3><div class='texpara'><a class='index' id=':macro,argument_substitution'></a>
<a class='index' id=':__VA_OPT___'></a><div class='bnf' id='nt:va-opt-replacement'>
<a class='hidden_link' href='#nt:va-opt-replacement' title='15.6.2&emsp;Argument substitution&emsp;[cpp.subst]'><span id='nt:va-opt-replacement'><span id=':va-opt-replacement'>va-opt-replacement<span class='textnormal'>:</span></span></span></a><br/><span class='terminal'><span class='texttt'>__VA_<span class='shy'></span>OPT__</span> <span class='parenthesis'>(</span></span> <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens'><span class='textsf'><i >pp-tokens</i></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='parenthesis'>)</span></span>
</div></div><div class='para' id='cpp.subst-1'><div class='marginalizedparent'><a class='marginalized' href='#cpp.subst-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1168'>#</a></div><div class='texpara'><div id='cpp.subst-1.sentence-1' class='sentence'>After the arguments for the invocation of a function-like macro have
been identified, argument substitution takes place<a class='hidden_link' href='#cpp.subst-1.sentence-1'>.</a></div> <div id='cpp.subst-1.sentence-2' class='sentence'>For each parameter in the replacement list that is neither
preceded by a <span class='texttt'><span class='preprocessordirective'>#</span></span> or <span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span> preprocessing token nor
followed by a <span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span> preprocessing token, the preprocessing tokens
naming the parameter are replaced by a token sequence determined as follows:
<ul class='itemize'><li id='cpp.subst-1.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cpp.subst-1.1'>(1.1)</a></div><div class='texpara'><div id='cpp.subst-1.1.sentence-1' class='sentence'>If the parameter is of the form <a href='#nt:va-opt-replacement' title='15.6.2&emsp;Argument substitution&emsp;[cpp.subst]'><span id='ntref:va-opt-replacement'><span class='textsf'><i >va-opt-replacement</i></span></span></a>,
  the replacement preprocessing tokens are the
  preprocessing token sequence for the corresponding argument,
  as specified below<a class='hidden_link' href='#cpp.subst-1.1.sentence-1'>.</a></div></div></li><li id='cpp.subst-1.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cpp.subst-1.2'>(1.2)</a></div><div class='texpara'><div id='cpp.subst-1.2.sentence-1' class='sentence'>Otherwise, the replacement preprocessing tokens are the
  preprocessing tokens of corresponding argument after all
  macros contained therein have been expanded<a class='hidden_link' href='#cpp.subst-1.2.sentence-1'>.</a></div> <div id='cpp.subst-1.2.sentence-2' class='sentence'>The argument's
  preprocessing tokens are completely macro replaced before
  being substituted as if they formed the rest of the preprocessing
  file with no other preprocessing tokens being available<a class='hidden_link' href='#cpp.subst-1.2.sentence-2'>.</a></div></div></li></ul></div> <div id='cpp.subst-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cpp.subst-example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='preprocessordirective'>#define</span> LPAREN<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='parenthesis'>(</span>
<span class='preprocessordirective'>#define</span> G<span class='parenthesis'>(</span>Q<span class='parenthesis'>)</span> <span class='literal'>42</span>
<span class='preprocessordirective'>#define</span> F<span class='parenthesis'>(</span>R, X, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>  __VA_OPT__<span class='parenthesis'>(</span>G R X<span class='parenthesis'>)</span> <span class='parenthesis'>)</span>
<span class='keyword'>int</span> x <span class='operator'>=</span> F<span class='parenthesis'>(</span>LPAREN<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, <span class='literal'>0</span>, <span class='anglebracket'>&lt;</span><span class='operator'>:</span><span class='operator'>-</span><span class='parenthesis'>)</span>;    <span class='comment'>// replaced by <span class='tcode_in_codeblock'>int x = 42;</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='cpp.subst-2'><div class='marginalizedparent'><a class='marginalized' href='#cpp.subst-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1198'>#</a></div><div class='texpara'><div id='cpp.subst-2.sentence-1' class='sentence'><a class='index' id=':__VA_ARGS___'></a>An identifier <span class='texttt'>__VA_<span class='shy'></span>ARGS__</span> that occurs in the replacement list
shall be treated as if it were a parameter, and the variable arguments shall form
the preprocessing tokens used to replace it<a class='hidden_link' href='#cpp.subst-2.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='cpp.subst-3'><div class='marginalizedparent'><a class='marginalized' href='#cpp.subst-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1204'>#</a></div><div class='texpara'><div id='cpp.subst-example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cpp.subst-example-2'>2</a></i>:&ensp;<div id='cpp.subst-3.sentence-1' class='sentence'><span class='codeblock'><span class='preprocessordirective'>#define</span> debug<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> fprintf<span class='parenthesis'>(</span>stderr, __VA_ARGS__<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> showlist<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> puts<span class='parenthesis'>(</span><span class='preprocessordirective'>#</span>__VA_ARGS__<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> report<span class='parenthesis'>(</span>test, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> <span class='parenthesis'>(</span><span class='parenthesis'>(</span>test<span class='parenthesis'>)</span> <span class='operator'>?</span> puts<span class='parenthesis'>(</span><span class='preprocessordirective'>#</span>test<span class='parenthesis'>)</span> <span class='operator'>:</span> printf<span class='parenthesis'>(</span>__VA_ARGS__<span class='parenthesis'>)</span><span class='parenthesis'>)</span>
debug<span class='parenthesis'>(</span><span class='literal'>"Flag"</span><span class='parenthesis'>)</span>;
debug<span class='parenthesis'>(</span><span class='literal'>"X = %d\n"</span>, x<span class='parenthesis'>)</span>;
showlist<span class='parenthesis'>(</span>The first, second, and third items<span class='operator'>.</span><span class='parenthesis'>)</span>;
report<span class='parenthesis'>(</span>x<span class='anglebracket'>&gt;</span>y, <span class='literal'>"x is %d but y is %d"</span>, x, y<span class='parenthesis'>)</span>;
</span>
results in
<span class='codeblock'>fprintf<span class='parenthesis'>(</span>stderr, <span class='literal'>"Flag"</span><span class='parenthesis'>)</span>;
fprintf<span class='parenthesis'>(</span>stderr, <span class='literal'>"X = %d\n"</span>, x<span class='parenthesis'>)</span>;
puts<span class='parenthesis'>(</span><span class='literal'>"The first, second, and third items."</span><span class='parenthesis'>)</span>;
<span class='parenthesis'>(</span><span class='parenthesis'>(</span>x<span class='anglebracket'>&gt;</span>y<span class='parenthesis'>)</span> <span class='operator'>?</span> puts<span class='parenthesis'>(</span><span class='literal'>"x&gt;y"</span><span class='parenthesis'>)</span> <span class='operator'>:</span> printf<span class='parenthesis'>(</span><span class='literal'>"x is %d but y is %d"</span>, x, y<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='cpp.subst-4'><div class='marginalizedparent'><a class='marginalized' href='#cpp.subst-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1224'>#</a></div><div class='texpara'><div id='cpp.subst-4.sentence-1' class='sentence'><a class='index' id=':__VA_OPT____'></a>The identifier <span class='texttt'>__VA_<span class='shy'></span>OPT__</span>
shall always occur as part of the preprocessing token sequence
<a href='#nt:va-opt-replacement' title='15.6.2&emsp;Argument substitution&emsp;[cpp.subst]'><span id='ntref:va-opt-replacement_'><span class='textsf'><i >va-opt-replacement</i></span></span></a>;
its closing <span class='texttt'><span class='parenthesis'>)</span></span> is determined by skipping
intervening pairs of matching left and right parentheses
in its <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens_'><span class='textsf'><i >pp-tokens</i></span></span></a><a class='hidden_link' href='#cpp.subst-4.sentence-1'>.</a></div> <div id='cpp.subst-4.sentence-2' class='sentence'>The <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens__'><span class='textsf'><i >pp-tokens</i></span></span></a> of a <a href='#nt:va-opt-replacement' title='15.6.2&emsp;Argument substitution&emsp;[cpp.subst]'><span id='ntref:va-opt-replacement__'><span class='textsf'><i >va-opt-replacement</i></span></span></a>
shall not contain <span class='texttt'>__VA_<span class='shy'></span>OPT__</span><a class='hidden_link' href='#cpp.subst-4.sentence-2'>.</a></div> <div id='cpp.subst-4.sentence-3' class='sentence'>If the <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens___'><span class='textsf'><i >pp-tokens</i></span></span></a> would be ill-formed
as the replacement list of the current function-like macro,
the program is ill-formed<a class='hidden_link' href='#cpp.subst-4.sentence-3'>.</a></div> <div id='cpp.subst-4.sentence-4' class='sentence'>A <a href='#nt:va-opt-replacement' title='15.6.2&emsp;Argument substitution&emsp;[cpp.subst]'><span id='ntref:va-opt-replacement___'><span class='textsf'><i >va-opt-replacement</i></span></span></a> is treated as if it were a parameter,
and the preprocessing token sequence for the corresponding
argument is defined as follows<a class='hidden_link' href='#cpp.subst-4.sentence-4'>.</a></div> <div id='cpp.subst-4.sentence-5' class='sentence'>If the substitution of <span class='texttt'>__VA_<span class='shy'></span>ARGS__</span> as neither an operand
of <span class='texttt'><span class='preprocessordirective'>#</span></span> nor <span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span> consists of no preprocessing tokens,
the argument consists of
a single placemarker preprocessing token (<a href='#cpp.concat' title='15.6.4&emsp;The ## operator'>[cpp.<span class='shy'></span>concat]</a>, <a href='#cpp.rescan' title='15.6.5&emsp;Rescanning and further replacement'>[cpp.<span class='shy'></span>rescan]</a>)<a class='hidden_link' href='#cpp.subst-4.sentence-5'>.</a></div> <div id='cpp.subst-4.sentence-6' class='sentence'>Otherwise, the argument consists of
the results of the expansion of the contained <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens____'><span class='textsf'><i >pp-tokens</i></span></span></a>
as the replacement list of the current function-like macro
before removal of placemarker tokens, rescanning, and further replacement<a class='hidden_link' href='#cpp.subst-4.sentence-6'>.</a></div> <div id='cpp.subst-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#cpp.subst-note-1'>1</a></i>:&ensp;<div id='cpp.subst-4.sentence-7' class='sentence'>The placemarker tokens are removed before stringization (<a href='#cpp.stringize' title='15.6.3&emsp;The # operator'>[cpp.<span class='shy'></span>stringize]</a>),
and can be removed by rescanning and further replacement (<a href='#cpp.rescan' title='15.6.5&emsp;Rescanning and further replacement'>[cpp.<span class='shy'></span>rescan]</a>)<a class='hidden_link' href='#cpp.subst-4.sentence-7'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='cpp.subst-example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cpp.subst-example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='preprocessordirective'>#define</span> F<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>           f<span class='parenthesis'>(</span><span class='literal'>0</span> __VA_OPT__<span class='parenthesis'>(</span>,<span class='parenthesis'>)</span> __VA_ARGS__<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> G<span class='parenthesis'>(</span>X, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>        f<span class='parenthesis'>(</span><span class='literal'>0</span>, X __VA_OPT__<span class='parenthesis'>(</span>,<span class='parenthesis'>)</span> __VA_ARGS__<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> SDEF<span class='parenthesis'>(</span>sname, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> S sname __VA_OPT__<span class='parenthesis'>(</span><span class='operator'>=</span> <span class='curlybracket'>{</span> __VA_ARGS__ <span class='curlybracket'>}</span><span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> EMP

F<span class='parenthesis'>(</span>a, b, c<span class='parenthesis'>)</span>          <span class='comment'>// replaced by <span class='tcode_in_codeblock'>f(0, a, b, c)</span></span>
F<span class='parenthesis'>(</span><span class='parenthesis'>)</span>                 <span class='comment'>// replaced by <span class='tcode_in_codeblock'>f(0)</span></span>
F<span class='parenthesis'>(</span>EMP<span class='parenthesis'>)</span>              <span class='comment'>// replaced by <span class='tcode_in_codeblock'>f(0)</span></span>

G<span class='parenthesis'>(</span>a, b, c<span class='parenthesis'>)</span>          <span class='comment'>// replaced by <span class='tcode_in_codeblock'>f(0, a, b, c)</span></span>
G<span class='parenthesis'>(</span>a, <span class='parenthesis'>)</span>              <span class='comment'>// replaced by <span class='tcode_in_codeblock'>f(0, a)</span></span>
G<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>                <span class='comment'>// replaced by <span class='tcode_in_codeblock'>f(0, a)</span></span>

SDEF<span class='parenthesis'>(</span>foo<span class='parenthesis'>)</span>;          <span class='comment'>// replaced by <span class='tcode_in_codeblock'>S foo;</span></span>
SDEF<span class='parenthesis'>(</span>bar, <span class='literal'>1</span>, <span class='literal'>2</span><span class='parenthesis'>)</span>;    <span class='comment'>// replaced by <span class='tcode_in_codeblock'>S bar = { 1, 2 };</span></span>

<span class='preprocessordirective'>#define</span> H1<span class='parenthesis'>(</span>X, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> X __VA_OPT__<span class='parenthesis'>(</span><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span><span class='parenthesis'>)</span> __VA_ARGS__ <span class='comment'>// error: <span class='tcode_in_codeblock'>##</span> may not appear at</span>
                                                <span class='comment'>// the beginning of a replacement list (<a href='#cpp.concat' title='15.6.4&emsp;The ## operator'>[cpp.<span class='shy'></span>concat]</a>)</span>

<span class='preprocessordirective'>#define</span> H2<span class='parenthesis'>(</span>X, Y, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> __VA_OPT__<span class='parenthesis'>(</span>X <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> Y,<span class='parenthesis'>)</span> __VA_ARGS__
H2<span class='parenthesis'>(</span>a, b, c, d<span class='parenthesis'>)</span>      <span class='comment'>// replaced by <span class='tcode_in_codeblock'>ab, c, d</span></span>

<span class='preprocessordirective'>#define</span> H3<span class='parenthesis'>(</span>X, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> <span class='preprocessordirective'>#</span>__VA_OPT__<span class='parenthesis'>(</span>X<span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span>X X<span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span>X<span class='parenthesis'>)</span>
H3<span class='parenthesis'>(</span>, <span class='literal'>0</span><span class='parenthesis'>)</span>             <span class='comment'>// replaced by <span class='tcode_in_codeblock'>""</span></span>

<span class='preprocessordirective'>#define</span> H4<span class='parenthesis'>(</span>X, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> __VA_OPT__<span class='parenthesis'>(</span>a X <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> X<span class='parenthesis'>)</span> <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> b
H4<span class='parenthesis'>(</span>, <span class='literal'>1</span><span class='parenthesis'>)</span>             <span class='comment'>// replaced by <span class='tcode_in_codeblock'>a b</span></span>

<span class='preprocessordirective'>#define</span> H5A<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> __VA_OPT__<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='comment'>/**/</span>__VA_OPT__<span class='parenthesis'>(</span><span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> H5B<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span> a <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> X <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> b
<span class='preprocessordirective'>#define</span> H5C<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span> H5B<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span>
H5C<span class='parenthesis'>(</span>H5A<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>          <span class='comment'>// replaced by <span class='tcode_in_codeblock'>ab</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div></div><div id='cpp.stringize' class='section'><h3 ><a class='secnum' href='#cpp.stringize' style='min-width:80pt'>15.6.3</a> The <span class='texttt'>#</span> operator <a class='abbr_ref' href='cpp.stringize'>[cpp.stringize]</a></h3><div class='texpara'><a class='index' id=':#_operator_'></a></div><div class='para' id='cpp.stringize-1'><div class='marginalizedparent'><a class='marginalized' href='#cpp.stringize-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1293'>#</a></div><div class='texpara'><div id='cpp.stringize-1.sentence-1' class='sentence'>Each
<span class='texttt'><span class='preprocessordirective'>#</span></span>
preprocessing token in the replacement list for a function-like
macro shall be followed by a parameter as the next preprocessing
token in the replacement list<a class='hidden_link' href='#cpp.stringize-1.sentence-1'>.</a></div></div></div><div class='para' id='cpp.stringize-2'><div class='marginalizedparent'><a class='marginalized' href='#cpp.stringize-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1300'>#</a></div><div class='texpara'><div id='cpp.stringize-2.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:character_string_literal' title='15.6.3&emsp;The # operator&emsp;[cpp.stringize]'><span id='def:character_string_literal'><i >character string literal</i></span></a> is a <a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal_'><span class='textsf'><i >string-literal</i></span></span></a> with no prefix<a class='hidden_link' href='#cpp.stringize-2.sentence-1'>.</a></div> <div id='cpp.stringize-2.sentence-2' class='sentence'>If, in the replacement list, a parameter is immediately
preceded by a
<span class='texttt'><span class='preprocessordirective'>#</span></span>
preprocessing token,
both are replaced by a single character string literal preprocessing token that
contains the spelling of the preprocessing token sequence for the
corresponding argument (excluding placemarker tokens)<a class='hidden_link' href='#cpp.stringize-2.sentence-2'>.</a></div> <div id='cpp.stringize-2.sentence-3' class='sentence'>Let the <a class='hidden_link' href='#def:stringizing_argument' title='15.6.3&emsp;The # operator&emsp;[cpp.stringize]'><span id='def:stringizing_argument'><i >stringizing argument</i></span></a> be the preprocessing token sequence
for the corresponding argument with placemarker tokens removed<a class='hidden_link' href='#cpp.stringize-2.sentence-3'>.</a></div> <div id='cpp.stringize-2.sentence-4' class='sentence'>Each occurrence of whitespace between the stringizing argument's preprocessing
tokens becomes a single space character in the character string literal<a class='hidden_link' href='#cpp.stringize-2.sentence-4'>.</a></div> <div id='cpp.stringize-2.sentence-5' class='sentence'>Whitespace before the first preprocessing token and after the last
preprocessing token comprising the stringizing argument is deleted<a class='hidden_link' href='#cpp.stringize-2.sentence-5'>.</a></div> <div id='cpp.stringize-2.sentence-6' class='sentence'>Otherwise, the original spelling of each preprocessing token in the
stringizing argument is retained in the character string literal,
except for special handling for producing the spelling of
<a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal__'><span class='textsf'><i >string-literal</i></span></span></a><i >s</i> and <a href='lex.ccon#nt:character-literal' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:character-literal_'><span class='textsf'><i >character-literal</i></span></span></a><i >s</i>:
a
<span class='texttt'>\</span>
character is inserted before each
<span class='texttt'>"</span>
and
<span class='texttt'>\</span>
character of a <a href='lex.ccon#nt:character-literal' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:character-literal__'><span class='textsf'><i >character-literal</i></span></span></a> or <a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal___'><span class='textsf'><i >string-literal</i></span></span></a>
(including the delimiting
<span class='texttt'>"</span>
characters)<a class='hidden_link' href='#cpp.stringize-2.sentence-6'>.</a></div> <div id='cpp.stringize-2.sentence-7' class='sentence'>If the replacement that results is not a valid character string literal,
the behavior is undefined<a class='hidden_link' href='#cpp.stringize-2.sentence-7'>.</a></div> <div id='cpp.stringize-2.sentence-8' class='sentence'>The character string literal corresponding to
an empty stringizing argument is <span class='texttt'><span class='literal'>""</span></span><a class='hidden_link' href='#cpp.stringize-2.sentence-8'>.</a></div> <div id='cpp.stringize-2.sentence-9' class='sentence'>The order of evaluation of
<span class='texttt'><span class='preprocessordirective'>#</span></span>
and
<span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span>
operators is unspecified<a class='hidden_link' href='#cpp.stringize-2.sentence-9'>.</a></div></div></div></div><div id='cpp.concat' class='section'><h3 ><a class='secnum' href='#cpp.concat' style='min-width:80pt'>15.6.4</a> The <span class='texttt'>##</span> operator <a class='abbr_ref' href='cpp.concat'>[cpp.concat]</a></h3><div class='texpara'><a class='index' id=':##_operator'></a></div><div class='para' id='cpp.concat-1'><div class='marginalizedparent'><a class='marginalized' href='#cpp.concat-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1342'>#</a></div><div class='texpara'><div id='cpp.concat-1.sentence-1' class='sentence'>A
<span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span>
preprocessing token shall not occur at the beginning or
at the end of a replacement list for either form
of macro definition<a class='hidden_link' href='#cpp.concat-1.sentence-1'>.</a></div></div></div><div class='para' id='cpp.concat-2'><div class='marginalizedparent'><a class='marginalized' href='#cpp.concat-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1349'>#</a></div><div class='texpara'><div id='cpp.concat-2.sentence-1' class='sentence'>If, in the replacement list of a function-like macro, a parameter is
immediately preceded or followed by a
<span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span>
preprocessing token, the parameter is replaced by the
corresponding argument's preprocessing token sequence; however, if an argument consists of no preprocessing tokens, the parameter is
replaced by a placemarker preprocessing token instead<a class='hidden_link' href='#cpp.concat-2.sentence-1'>.</a><a class='footnoteref' href='#footnote-136' id='footnoteref-136' title='Placemarker preprocessing tokens do not appear in the syntax because they are temporary entities that exist only within translation phase 4.'>136</a></div></div></div><div class='para' id='cpp.concat-3'><div class='marginalizedparent'><a class='marginalized' href='#cpp.concat-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1361'>#</a></div><div class='texpara'><div id='cpp.concat-3.sentence-1' class='sentence'>For both object-like and function-like macro invocations, before the
replacement list is reexamined for more macro names to replace,
each instance of a
<span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span>
preprocessing token in the replacement list
(not from an argument) is deleted and the
preceding preprocessing token is concatenated
with the following preprocessing token<a class='hidden_link' href='#cpp.concat-3.sentence-1'>.</a></div> <div id='cpp.concat-3.sentence-2' class='sentence'>Placemarker preprocessing tokens are handled specially: concatenation
of two placemarkers results in a single placemarker preprocessing token, and
concatenation of a placemarker with a non-placemarker preprocessing token results
in the non-placemarker preprocessing token<a class='hidden_link' href='#cpp.concat-3.sentence-2'>.</a></div> <div id='cpp.concat-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#cpp.concat-note-1'>1</a></i>:&ensp;<div id='cpp.concat-3.sentence-3' class='sentence'>Concatenation can form
a <a href='lex.charset#nt:universal-character-name' title='5.3&emsp;Character sets&emsp;[lex.charset]'><span id='ntref:universal-character-name'><span class='textsf'><i >universal-character-name</i></span></span></a> (<a href='lex.charset' title='5.3&emsp;Character sets'>[lex.<span class='shy'></span>charset]</a>)<a class='hidden_link' href='#cpp.concat-3.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='cpp.concat-3.sentence-4' class='sentence'>
If the result is not a valid preprocessing token,
the behavior is undefined<a class='hidden_link' href='#cpp.concat-3.sentence-4'>.</a></div> <div id='cpp.concat-3.sentence-5' class='sentence'>The resulting token is available for further macro replacement<a class='hidden_link' href='#cpp.concat-3.sentence-5'>.</a></div> <div id='cpp.concat-3.sentence-6' class='sentence'>The order of evaluation of
<span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span>
operators is unspecified<a class='hidden_link' href='#cpp.concat-3.sentence-6'>.</a></div></div></div><div class='para nonNormativeOnly' id='cpp.concat-4'><div class='marginalizedparent'><a class='marginalized' href='#cpp.concat-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1385'>#</a></div><div class='texpara'><div id='cpp.concat-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cpp.concat-example-1'>1</a></i>:&ensp;<div id='cpp.concat-4.sentence-1' class='sentence'>The sequence
<span class='codeblock'><span class='preprocessordirective'>#define</span> str<span class='parenthesis'>(</span>s<span class='parenthesis'>)</span>      <span class='preprocessordirective'>#</span> s
<span class='preprocessordirective'>#define</span> xstr<span class='parenthesis'>(</span>s<span class='parenthesis'>)</span>     str<span class='parenthesis'>(</span>s<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> debug<span class='parenthesis'>(</span>s, t<span class='parenthesis'>)</span> printf<span class='parenthesis'>(</span><span class='literal'>"x"</span> <span class='preprocessordirective'>#</span> s <span class='literal'>"= %d, x"</span> <span class='preprocessordirective'>#</span> t <span class='literal'>"= %s"</span>, \
               x <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> s, x <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> t<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> INCFILE<span class='parenthesis'>(</span>n<span class='parenthesis'>)</span>  vers <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> n
<span class='preprocessordirective'>#define</span> glue<span class='parenthesis'>(</span>a, b<span class='parenthesis'>)</span>  a <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> b
<span class='preprocessordirective'>#define</span> xglue<span class='parenthesis'>(</span>a, b<span class='parenthesis'>)</span> glue<span class='parenthesis'>(</span>a, b<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> HIGHLOW     <span class='literal'>"hello"</span>
<span class='preprocessordirective'>#define</span> LOW         LOW <span class='literal'>", world"</span>

debug<span class='parenthesis'>(</span><span class='literal'>1</span>, <span class='literal'>2</span><span class='parenthesis'>)</span>;
fputs<span class='parenthesis'>(</span>str<span class='parenthesis'>(</span>strncmp<span class='parenthesis'>(</span><span class='literal'>"abc\0d"</span>, <span class='literal'>"abc"</span>, <span class='literal'>'\4'</span><span class='parenthesis'>)</span>        <span class='comment'>// this goes away</span>
    <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span> str<span class='parenthesis'>(</span><span class='operator'>:</span> @\n<span class='parenthesis'>)</span>, s<span class='parenthesis'>)</span>;
<span class='preprocessordirective'>#include</span> xstr<span class='parenthesis'>(</span>INCFILE<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span><span class='operator'>.</span>h<span class='parenthesis'>)</span>
glue<span class='parenthesis'>(</span>HIGH, LOW<span class='parenthesis'>)</span>;
xglue<span class='parenthesis'>(</span>HIGH, LOW<span class='parenthesis'>)</span>
</span>
results in
<span class='codeblock'>printf<span class='parenthesis'>(</span><span class='literal'>"x"</span> <span class='literal'>"1"</span> <span class='literal'>"= %d, x"</span> <span class='literal'>"2"</span> <span class='literal'>"= %s"</span>, x1, x2<span class='parenthesis'>)</span>;
fputs<span class='parenthesis'>(</span><span class='literal'>"strncmp(\"abc\\0d\", \"abc\", '\\4') == 0"</span> <span class='literal'>": @\n"</span>, s<span class='parenthesis'>)</span>;
<span class='preprocessordirective'>#include</span> <span class='literal'>"vers2.h"</span>      <span class='textrm'>(<i >after macro replacement, before file access</i>)</span>
<span class='literal'>"hello"</span>;
<span class='literal'>"hello"</span> <span class='literal'>", world"</span>
</span>
or, after concatenation of the character string literals,
<span class='codeblock'>printf<span class='parenthesis'>(</span><span class='literal'>"x1= %d, x2= %s"</span>, x1, x2<span class='parenthesis'>)</span>;
fputs<span class='parenthesis'>(</span><span class='literal'>"strncmp(\"abc\\0d\", \"abc\", '\\4') == 0: @\n"</span>, s<span class='parenthesis'>)</span>;
<span class='preprocessordirective'>#include</span> <span class='literal'>"vers2.h"</span>      <span class='textrm'>(<i >after macro replacement, before file access</i>)</span>
<span class='literal'>"hello"</span>;
<span class='literal'>"hello, world"</span>
</span></div></div><div class='texpara'><div id='cpp.concat-4.sentence-2' class='sentence'>Space around the <span class='texttt'><span class='preprocessordirective'>#</span></span> and <span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span> tokens in the macro definition
is optional<a class='hidden_link' href='#cpp.concat-4.sentence-2'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para nonNormativeOnly' id='cpp.concat-5'><div class='marginalizedparent'><a class='marginalized' href='#cpp.concat-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1427'>#</a></div><div class='texpara'><div id='cpp.concat-example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cpp.concat-example-2'>2</a></i>:&ensp;<div id='cpp.concat-5.sentence-1' class='sentence'>In the following fragment:
<span class='codeblock'><span class='preprocessordirective'>#define</span> hash_hash <span class='preprocessordirective'>#</span> <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> <span class='preprocessordirective'>#</span>
<span class='preprocessordirective'>#define</span> mkstr<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='preprocessordirective'>#</span> a
<span class='preprocessordirective'>#define</span> in_between<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> mkstr<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> join<span class='parenthesis'>(</span>c, d<span class='parenthesis'>)</span> in_between<span class='parenthesis'>(</span>c hash_hash d<span class='parenthesis'>)</span>
<span class='keyword'>char</span> p<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> join<span class='parenthesis'>(</span>x, y<span class='parenthesis'>)</span>;          <span class='comment'>// equivalent to <span class='tcode_in_codeblock'>char p[] = "x ## y";</span></span>
</span></div></div><div class='texpara'><div id='cpp.concat-5.sentence-2' class='sentence'>The expansion produces, at various stages:
<span class='codeblock'>join<span class='parenthesis'>(</span>x, y<span class='parenthesis'>)</span>
in_between<span class='parenthesis'>(</span>x hash_hash y<span class='parenthesis'>)</span>
in_between<span class='parenthesis'>(</span>x <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> y<span class='parenthesis'>)</span>
mkstr<span class='parenthesis'>(</span>x <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> y<span class='parenthesis'>)</span>
<span class='literal'>"x ## y"</span>
</span></div></div><div class='texpara'><div id='cpp.concat-5.sentence-3' class='sentence'>In other words, expanding <span class='texttt'>hash_<span class='shy'></span>hash</span> produces a new token,
consisting of two adjacent sharp signs, but this new token is not the
<span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span> operator<a class='hidden_link' href='#cpp.concat-5.sentence-3'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para nonNormativeOnly' id='cpp.concat-6'><div class='marginalizedparent'><a class='marginalized' href='#cpp.concat-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1452'>#</a></div><div class='texpara'><div id='cpp.concat-example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cpp.concat-example-3'>3</a></i>:&ensp;<div id='cpp.concat-6.sentence-1' class='sentence'>To illustrate the rules for placemarker preprocessing tokens, the sequence
<span class='codeblock'><span class='preprocessordirective'>#define</span> t<span class='parenthesis'>(</span>x,y,z<span class='parenthesis'>)</span> x <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> y <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> z
<span class='keyword'>int</span> j<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> t<span class='parenthesis'>(</span><span class='literal'>1</span>,<span class='literal'>2</span>,<span class='literal'>3</span><span class='parenthesis'>)</span>, t<span class='parenthesis'>(</span>,<span class='literal'>4</span>,<span class='literal'>5</span><span class='parenthesis'>)</span>, t<span class='parenthesis'>(</span><span class='literal'>6</span>,,<span class='literal'>7</span><span class='parenthesis'>)</span>, t<span class='parenthesis'>(</span><span class='literal'>8</span>,<span class='literal'>9</span>,<span class='parenthesis'>)</span>,
  t<span class='parenthesis'>(</span><span class='literal'>10</span>,,<span class='parenthesis'>)</span>, t<span class='parenthesis'>(</span>,<span class='literal'>11</span>,<span class='parenthesis'>)</span>, t<span class='parenthesis'>(</span>,,<span class='literal'>12</span><span class='parenthesis'>)</span>, t<span class='parenthesis'>(</span>,,<span class='parenthesis'>)</span> <span class='curlybracket'>}</span>;
</span>
results in
<span class='codeblock'><span class='keyword'>int</span> j<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='literal'>123</span>, <span class='literal'>45</span>, <span class='literal'>67</span>, <span class='literal'>89</span>,
  <span class='literal'>10</span>, <span class='literal'>11</span>, <span class='literal'>12</span>, <span class='curlybracket'>}</span>;
</span></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-136'><div class='texpara'><a class='footnotenum' href='#footnote-136'>136)</a><a class='footnoteBacklink' href='#footnoteref-136'>136)</a> <div id='footnote-136.sentence-1' class='sentence'>Placemarker preprocessing tokens do not appear in the syntax
because they are temporary entities that exist only within translation phase 4<a class='hidden_link' href='#footnote-136.sentence-1'>.</a></div></div></div></div><div id='cpp.rescan' class='section'><h3 ><a class='secnum' href='#cpp.rescan' style='min-width:80pt'>15.6.5</a> Rescanning and further replacement <a class='abbr_ref' href='cpp.rescan'>[cpp.rescan]</a></h3><div class='texpara'><a class='index' id=':macro,rescanning_and_replacement'></a></div><div class='para' id='cpp.rescan-1'><div class='marginalizedparent'><a class='marginalized' href='#cpp.rescan-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1471'>#</a></div><div class='texpara'><div id='cpp.rescan-1.sentence-1' class='sentence'>After all parameters in the replacement list have been substituted and <span class='texttt'><span class='preprocessordirective'>#</span></span> and <span class='texttt'><span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span></span> processing has taken
place, all placemarker preprocessing tokens are removed<a class='hidden_link' href='#cpp.rescan-1.sentence-1'>.</a></div> <div id='cpp.rescan-1.sentence-2' class='sentence'>Then
the resulting preprocessing token sequence is rescanned, along with all
subsequent preprocessing tokens of the source file, for more macro names
to replace<a class='hidden_link' href='#cpp.rescan-1.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='cpp.rescan-2'><div class='marginalizedparent'><a class='marginalized' href='#cpp.rescan-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1478'>#</a></div><div class='texpara'><div id='cpp.rescan-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cpp.rescan-example-1'>1</a></i>:&ensp;<div id='cpp.rescan-2.sentence-1' class='sentence'>The sequence
<span class='codeblock'><span class='preprocessordirective'>#define</span> x       <span class='literal'>3</span>
<span class='preprocessordirective'>#define</span> f<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>    f<span class='parenthesis'>(</span>x <span class='operator'>*</span> <span class='parenthesis'>(</span>a<span class='parenthesis'>)</span><span class='parenthesis'>)</span>
<span class='preprocessordirective'>#undef</span>  x
<span class='preprocessordirective'>#define</span> x       <span class='literal'>2</span>
<span class='preprocessordirective'>#define</span> g       f
<span class='preprocessordirective'>#define</span> z       z<span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span>
<span class='preprocessordirective'>#define</span> h       g<span class='parenthesis'>(</span><span class='operator'>~</span>
<span class='preprocessordirective'>#define</span> m<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>    a<span class='parenthesis'>(</span>w<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#define</span> w       <span class='literal'>0</span>,<span class='literal'>1</span>
<span class='preprocessordirective'>#define</span> t<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>    a
<span class='preprocessordirective'>#define</span> p<span class='parenthesis'>(</span><span class='parenthesis'>)</span>     <span class='keyword'>int</span>
<span class='preprocessordirective'>#define</span> q<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span>    x
<span class='preprocessordirective'>#define</span> r<span class='parenthesis'>(</span>x,y<span class='parenthesis'>)</span>  x <span class='preprocessordirective'>#</span><span class='preprocessordirective'>#</span> y
<span class='preprocessordirective'>#define</span> str<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span>  <span class='preprocessordirective'>#</span> x

f<span class='parenthesis'>(</span>y<span class='operator'>+</span><span class='literal'>1</span><span class='parenthesis'>)</span> <span class='operator'>+</span> f<span class='parenthesis'>(</span>f<span class='parenthesis'>(</span>z<span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>%</span> t<span class='parenthesis'>(</span>t<span class='parenthesis'>(</span>g<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span> <span class='operator'>+</span> t<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;
g<span class='parenthesis'>(</span>x<span class='operator'>+</span><span class='parenthesis'>(</span><span class='literal'>3</span>,<span class='literal'>4</span><span class='parenthesis'>)</span><span class='operator'>-</span>w<span class='parenthesis'>)</span> <span class='operator'>|</span> h <span class='literal'>5</span><span class='parenthesis'>)</span> <span class='operator'>&amp;</span> m
    <span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='operator'>^</span>m<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span>;
p<span class='parenthesis'>(</span><span class='parenthesis'>)</span> i<span class='squarebracket'>[</span>q<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> q<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>, r<span class='parenthesis'>(</span><span class='literal'>2</span>,<span class='literal'>3</span><span class='parenthesis'>)</span>, r<span class='parenthesis'>(</span><span class='literal'>4</span>,<span class='parenthesis'>)</span>, r<span class='parenthesis'>(</span>,<span class='literal'>5</span><span class='parenthesis'>)</span>, r<span class='parenthesis'>(</span>,<span class='parenthesis'>)</span> <span class='curlybracket'>}</span>;
<span class='keyword'>char</span> c<span class='squarebracket'>[</span><span class='literal'>2</span><span class='squarebracket'>]</span><span class='squarebracket'>[</span><span class='literal'>6</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> str<span class='parenthesis'>(</span>hello<span class='parenthesis'>)</span>, str<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>}</span>;
</span>
results in
<span class='codeblock'>f<span class='parenthesis'>(</span><span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span>y<span class='operator'>+</span><span class='literal'>1</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>+</span> f<span class='parenthesis'>(</span><span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span>f<span class='parenthesis'>(</span><span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span>z<span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>%</span> f<span class='parenthesis'>(</span><span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>+</span> t<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;
f<span class='parenthesis'>(</span><span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span><span class='literal'>2</span><span class='operator'>+</span><span class='parenthesis'>(</span><span class='literal'>3</span>,<span class='literal'>4</span><span class='parenthesis'>)</span><span class='operator'>-</span><span class='literal'>0</span>,<span class='literal'>1</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>|</span> f<span class='parenthesis'>(</span><span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span><span class='operator'>~</span> <span class='literal'>5</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>&amp;</span> f<span class='parenthesis'>(</span><span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span><span class='literal'>0</span>,<span class='literal'>1</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>^</span>m<span class='parenthesis'>(</span><span class='literal'>0</span>,<span class='literal'>1</span><span class='parenthesis'>)</span>;
<span class='keyword'>int</span> i<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='literal'>1</span>, <span class='literal'>23</span>, <span class='literal'>4</span>, <span class='literal'>5</span>, <span class='curlybracket'>}</span>;
<span class='keyword'>char</span> c<span class='squarebracket'>[</span><span class='literal'>2</span><span class='squarebracket'>]</span><span class='squarebracket'>[</span><span class='literal'>6</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='literal'>"hello"</span>, <span class='literal'>""</span> <span class='curlybracket'>}</span>;
</span></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='cpp.rescan-3'><div class='marginalizedparent'><a class='marginalized' href='#cpp.rescan-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1512'>#</a></div><div class='texpara'><div id='cpp.rescan-3.sentence-1' class='sentence'>If the name of the macro being replaced is found during this scan of
the replacement list
(not including the rest of the source file's preprocessing tokens),
it is not replaced<a class='hidden_link' href='#cpp.rescan-3.sentence-1'>.</a></div> <div id='cpp.rescan-3.sentence-2' class='sentence'>Furthermore,
if any nested replacements encounter the name of the macro being replaced,
it is not replaced<a class='hidden_link' href='#cpp.rescan-3.sentence-2'>.</a></div> <div id='cpp.rescan-3.sentence-3' class='sentence'>These nonreplaced macro name preprocessing tokens are no longer available
for further replacement even if they are later (re)examined in contexts
in which that macro name preprocessing token would otherwise have been
replaced<a class='hidden_link' href='#cpp.rescan-3.sentence-3'>.</a></div></div></div><div class='para' id='cpp.rescan-4'><div class='marginalizedparent'><a class='marginalized' href='#cpp.rescan-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1525'>#</a></div><div class='texpara'><div id='cpp.rescan-4.sentence-1' class='sentence'>The resulting completely macro-replaced preprocessing token sequence
is not processed as a preprocessing directive even if it resembles one,
but all pragma unary operator expressions within it are then processed as
specified in <a href='cpp.pragma.op' title='15.12&emsp;Pragma operator'>[cpp.<span class='shy'></span>pragma.<span class='shy'></span>op]</a> below<a class='hidden_link' href='#cpp.rescan-4.sentence-1'>.</a></div></div></div></div><div id='cpp.scope' class='section'><h3 ><a class='secnum' href='#cpp.scope' style='min-width:80pt'>15.6.6</a> Scope of macro definitions <a class='abbr_ref' href='cpp.scope'>[cpp.scope]</a></h3><div class='texpara'><a class='index' id=':macro,scope_of_definition'></a></div><div class='para' id='cpp.scope-1'><div class='marginalizedparent'><a class='marginalized' href='#cpp.scope-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1535'>#</a></div><div class='texpara'><div id='cpp.scope-1.sentence-1' class='sentence'>A macro definition lasts
(independent of block structure)
until a corresponding
<span class='texttt'><span class='preprocessordirective'>#undef</span></span>
directive is encountered or
(if none is encountered)
until the end of the translation unit<a class='hidden_link' href='#cpp.scope-1.sentence-1'>.</a></div> <div id='cpp.scope-1.sentence-2' class='sentence'>Macro definitions have no significance after translation phase 4<a class='hidden_link' href='#cpp.scope-1.sentence-2'>.</a></div></div></div><div class='para' id='cpp.scope-2'><div class='marginalizedparent'><a class='marginalized' href='#cpp.scope-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8238252bcec14f76e97133db32721beaec5c749b/source/preprocessor.tex#L1545'>#</a></div><div class='texpara'><div id='cpp.scope-2.sentence-1' class='sentence'>A preprocessing directive of the form
<div class='simplebnf'>
<span class='terminal'><span class='preprocessordirective'># undef</span></span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier____'><span class='textsf'><i >identifier</i></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line____'><span class='textsf'><i >new-line</i></span></span></a>
<a class='index' id=':#undef'></a></div>
causes the specified identifier no longer to be defined as a macro name<a class='hidden_link' href='#cpp.scope-2.sentence-1'>.</a></div> <div id='cpp.scope-2.sentence-2' class='sentence'>It is ignored if the specified identifier is not currently defined as
a macro name<a class='hidden_link' href='#cpp.scope-2.sentence-2'>.</a></div></div><div class='texpara'></div></div></div></div></body></html>