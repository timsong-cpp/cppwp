<!DOCTYPE html><html lang='en'><head><title>[basic.life]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>6.7</a> Memory and objects <a class='abbr_ref' href='basic.memobj#basic.life'>[basic.memobj]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>6.7.3</a> Lifetime <a class='abbr_ref'>[basic.life]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3359'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'><a class='index' id=':object_lifetime'></a>The <a class='hidden_link' href='#def:lifetime' title='6.7.3&emsp;Lifetime&emsp;[basic.life]'><span id='def:lifetime'><i >lifetime</i></span></a> of an object or reference is a runtime property of the
object or reference<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>A variable is said to have <a class='hidden_link' href='#def:initialization,vacuous' title='6.7.3&emsp;Lifetime&emsp;[basic.life]'><span id='def:initialization,vacuous'><i >vacuous initialization</i></span></a>
if it is default-initialized and,
if it is of class type or a (possibly multidimensional) array thereof,
that class type has a trivial default constructor<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>The lifetime of an object of type <span class='texttt'>T</span> begins when:
<ul class='itemize'><li id='1.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#1.1'>(1.1)</a></div>storage with the proper alignment and size
  for type <span class='texttt'>T</span> is obtained, and</li><li id='1.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#1.2'>(1.2)</a></div>its initialization (if any) is complete
  (including vacuous initialization) (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>),</li></ul>
except that if the object is a union member or subobject thereof,
its lifetime only begins if that union member is the
initialized member in the union (<a href='dcl.init.aggr' title='9.4.2&emsp;Aggregates'>[dcl.<span class='shy'></span>init.<span class='shy'></span>aggr]</a>, <a href='class.base.init' title='11.9.3&emsp;Initializing bases and members'>[class.<span class='shy'></span>base.<span class='shy'></span>init]</a>),
or as described in
<a href='class.union' title='11.5&emsp;Unions'>[class.<span class='shy'></span>union]</a>, <a href='class.copy.ctor' title='11.4.5.3&emsp;Copy/move constructors'>[class.<span class='shy'></span>copy.<span class='shy'></span>ctor]</a>, and <a href='class.copy.assign' title='11.4.6&emsp;Copy/move assignment operator'>[class.<span class='shy'></span>copy.<span class='shy'></span>assign]</a>,
and except as described in <a href='allocator.members' title='20.2.10.2&emsp;Members'>[allocator.<span class='shy'></span>members]</a><a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'>The lifetime of an object <i >o</i> of type <span class='texttt'>T</span> ends when:
<ul class='itemize'><li id='1.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#1.3'>(1.3)</a></div>if <span class='texttt'>T</span> is a non-class type, the object is destroyed, or</li><li id='1.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#1.4'>(1.4)</a></div>if <span class='texttt'>T</span> is a class type, the destructor call starts, or</li><li id='1.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#1.5'>(1.5)</a></div>the storage which the object occupies is released,
or is reused by an object that is not nested within <i >o</i> (<a href='intro.object' title='6.7.2&emsp;Object model'>[intro.<span class='shy'></span>object]</a>)<a class='hidden_link' href='#1.sentence-4'>.</a></li></ul></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3388'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'><a class='index' id=':reference_lifetime'></a>The lifetime of a reference begins when its initialization is complete<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>The lifetime of a reference ends as if it were a scalar object requiring storage<a class='hidden_link' href='#2.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3393'>#</a></div><div class='texpara'><div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='3.sentence-1' class='sentence'><a href='class.base.init' title='11.9.3&emsp;Initializing bases and members'>[class.<span class='shy'></span>base.<span class='shy'></span>init]</a>
describes the lifetime of base and member subobjects<a class='hidden_link' href='#3.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3399'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'>The properties ascribed to objects and references throughout this document
apply for a given object or reference only during its lifetime<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='4.sentence-2' class='sentence'>In particular, before the lifetime of an object starts and after its
lifetime ends there are significant restrictions on the use of the
object, as described below, in <a href='class.base.init' title='11.9.3&emsp;Initializing bases and members'>[class.<span class='shy'></span>base.<span class='shy'></span>init]</a>, and
in <a href='class.cdtor' title='11.9.5&emsp;Construction and destruction'>[class.<span class='shy'></span>cdtor]</a><a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>Also, the behavior of an object under construction
and destruction can differ from the behavior of an object whose
lifetime has started and not ended<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'><a href='class.base.init' title='11.9.3&emsp;Initializing bases and members'>[class.<span class='shy'></span>base.<span class='shy'></span>init]</a>
and <a href='class.cdtor' title='11.9.5&emsp;Construction and destruction'>[class.<span class='shy'></span>cdtor]</a> describe the behavior of an object during its periods
of construction and destruction<a class='hidden_link' href='#4.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3413'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>A program may end the lifetime of an object of class type without invoking the
destructor, by reusing or releasing the storage as described above<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>:&ensp;<div id='5.sentence-2' class='sentence'>A <a href='expr.delete#nt:delete-expression' title='7.6.2.9&emsp;Delete&emsp;[expr.delete]'><span id='ntref:delete-expression'><span class='textsf'><i >delete-expression</i></span></span></a> (<a href='expr.delete' title='7.6.2.9&emsp;Delete'>[expr.<span class='shy'></span>delete]</a>) invokes the destructor
prior to releasing the storage<a class='hidden_link' href='#5.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='5.sentence-3' class='sentence'>
In this case, the destructor is not implicitly invoked<a class='hidden_link' href='#5.sentence-3'>.</a></div> <div id='note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-4'>4</a></i>:&ensp;<div id='5.sentence-4' class='sentence'>The correct behavior of a program often depends on
the destructor being invoked for each object of class type<a class='hidden_link' href='#5.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3426'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>Before the lifetime of an object has started but after the storage which
the object will occupy has been allocated<a class='footnoteref' href='#footnote-22' id='footnoteref-22' title='For example, before the dynamic initialization of an object with static storage duration ([basic.start.dynamic]).'>22</a>
or, after the lifetime of an object has ended and before the storage
which the object occupied is reused or released, any pointer that represents the address of
the storage location where the object will be or was located may be
used but only in limited ways<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>For an object under construction or destruction, see <a href='class.cdtor' title='11.9.5&emsp;Construction and destruction'>[class.<span class='shy'></span>cdtor]</a><a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.sentence-3' class='sentence'>Otherwise, such
a pointer refers to allocated
storage (<a href='basic.stc.dynamic.allocation' title='6.7.5.5.2&emsp;Allocation functions'>[basic.<span class='shy'></span>stc.<span class='shy'></span>dynamic.<span class='shy'></span>allocation]</a>), and using the pointer as
if the pointer were of type <span class='texttt'><span id=':void'><span class='texttt'><span class='keyword'>void</span></span></span><span class='operator'>*</span></span> is
well-defined<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='6.sentence-4' class='sentence'>Indirection through such a pointer is permitted but the resulting lvalue may only be used in
limited ways, as described below<a class='hidden_link' href='#6.sentence-4'>.</a></div> <div id='6.sentence-5' class='sentence'>The
program has undefined behavior if:
<ul class='itemize'><li id='6.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.1'>(6.1)</a></div>the pointer is used as the operand of a <a href='expr.delete#nt:delete-expression' title='7.6.2.9&emsp;Delete&emsp;[expr.delete]'><span id='ntref:delete-expression_'><span class='textsf'><i >delete-expression</i></span></span></a>,</li><li id='6.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.2'>(6.2)</a></div>the pointer is used to access a non-static data member or call a
  non-static member function of the object, or</li><li id='6.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.3'>(6.3)</a></div>the pointer is implicitly converted (<a href='conv.ptr' title='7.3.12&emsp;Pointer conversions'>[conv.<span class='shy'></span>ptr]</a>) to a pointer
  to a virtual base class, or</li><li id='6.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.4'>(6.4)</a></div>the pointer is used as the operand of a
  <span id=':static_cast'><span class='texttt'><span class='keyword'>static_<span class='shy'></span>cast</span></span></span> (<a href='expr.static.cast' title='7.6.1.9&emsp;Static cast'>[expr.<span class='shy'></span>static.<span class='shy'></span>cast]</a>), except when the conversion
  is to pointer to <span class='mathit'>cv</span> <span id=':void_'><span class='texttt'><span class='keyword'>void</span></span></span>, or to pointer to <span class='mathit'>cv</span> <span id=':void__'><span class='texttt'><span class='keyword'>void</span></span></span>
  and subsequently to pointer to
  <span class='mathit'>cv</span> <span id=':char'><span class='texttt'><span class='keyword'>char</span></span></span>,
  <span class='mathit'>cv</span> <span class='texttt'><span id=':unsigned'><span class='texttt'><span class='keyword'>unsigned</span></span></span> <span id=':char_'><span class='texttt'><span class='keyword'>char</span></span></span></span>, or
  <span class='mathit'>cv</span> <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>byte</span> (<a href='cstddef.syn' title='17.2.1&emsp;Header &lt;cstddef&gt; synopsis'>[cstddef.<span class='shy'></span>syn]</a>), or</li><li id='6.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.5'>(6.5)</a></div>the pointer is used as the operand of a
  <span id=':dynamic_cast'><span class='texttt'><span class='keyword'>dynamic_<span class='shy'></span>cast</span></span></span> (<a href='expr.dynamic.cast' title='7.6.1.7&emsp;Dynamic cast'>[expr.<span class='shy'></span>dynamic.<span class='shy'></span>cast]</a>)<a class='hidden_link' href='#6.sentence-5'>.</a></li></ul></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>cstdlib<span class='anglebracket'>&gt;</span>

<span class='keyword'>struct</span> B <span class='curlybracket'>{</span>
  <span class='keyword'>virtual</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>void</span> mutate<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>virtual</span> <span class='operator'>~</span>B<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> D1 <span class='operator'>:</span> B <span class='curlybracket'>{</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> D2 <span class='operator'>:</span> B <span class='curlybracket'>{</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;

<span class='keyword'>void</span> B<span class='operator'>::</span>mutate<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>new</span> <span class='parenthesis'>(</span><span class='keyword'>this</span><span class='parenthesis'>)</span> D2;    <span class='comment'>// reuses storage --- ends the lifetime of <span class='tcode_in_codeblock'>*this</span></span>
  f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;              <span class='comment'>// undefined behavior</span>
  <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> <span class='operator'>=</span> <span class='keyword'>this</span>;       <span class='comment'>// OK, <span id=':this'><span class='tcode_in_codeblock'>this</span></span> points to valid memory</span>
<span class='curlybracket'>}</span>

<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>void</span><span class='operator'>*</span> p <span class='operator'>=</span> std<span class='operator'>::</span>malloc<span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>D1<span class='parenthesis'>)</span> <span class='operator'>+</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>D2<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
  B<span class='operator'>*</span> pb <span class='operator'>=</span> <span class='keyword'>new</span> <span class='parenthesis'>(</span>p<span class='parenthesis'>)</span> D1;
  pb<span class='operator'>-</span><span class='anglebracket'>&gt;</span>mutate<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='operator'>*</span>pb;              <span class='comment'>// OK, <span class='tcode_in_codeblock'>pb</span> points to valid memory</span>
  <span class='keyword'>void</span><span class='operator'>*</span> q <span class='operator'>=</span> pb;     <span class='comment'>// OK, <span class='tcode_in_codeblock'>pb</span> points to valid memory</span>
  pb<span class='operator'>-</span><span class='anglebracket'>&gt;</span>f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;          <span class='comment'>// undefined behavior: lifetime of <span class='tcode_in_codeblock'>*pb</span> has ended</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3497'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'>Similarly, before the lifetime of an object has started but after the
storage which the object will occupy has been allocated or, after the
lifetime of an object has ended and before the storage which the object
occupied is reused or released, any glvalue that refers to the original
object may be used but only in limited ways<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>For an object under construction or destruction, see <a href='class.cdtor' title='11.9.5&emsp;Construction and destruction'>[class.<span class='shy'></span>cdtor]</a><a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>Otherwise, such
a glvalue refers to
allocated storage (<a href='basic.stc.dynamic.allocation' title='6.7.5.5.2&emsp;Allocation functions'>[basic.<span class='shy'></span>stc.<span class='shy'></span>dynamic.<span class='shy'></span>allocation]</a>), and using the
properties of the glvalue that do not depend on its value is
well-defined<a class='hidden_link' href='#7.sentence-3'>.</a></div> <div id='7.sentence-4' class='sentence'>The program has undefined behavior if:
<ul class='itemize'><li id='7.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.1'>(7.1)</a></div>the glvalue is used to access the object, or</li><li id='7.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.2'>(7.2)</a></div>the glvalue is used to call a non-static member function of the object, or</li><li id='7.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.3'>(7.3)</a></div>the glvalue is bound to a reference to a virtual base class (<a href='dcl.init.ref' title='9.4.4&emsp;References'>[dcl.<span class='shy'></span>init.<span class='shy'></span>ref]</a>), or</li><li id='7.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.4'>(7.4)</a></div>the glvalue is used as the operand of a
<span id=':dynamic_cast_'><span class='texttt'><span class='keyword'>dynamic_<span class='shy'></span>cast</span></span></span> (<a href='expr.dynamic.cast' title='7.6.1.7&emsp;Dynamic cast'>[expr.<span class='shy'></span>dynamic.<span class='shy'></span>cast]</a>) or as the operand of
<span id=':typeid'><span class='texttt'><span class='keyword'>typeid</span></span></span><a class='hidden_link' href='#7.sentence-4'>.</a></li></ul></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3518'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'>If, after the lifetime of an object has ended and before the storage
which the object occupied is reused or released, a new object is created
at the storage location which the original object occupied, a pointer
that pointed to the original object, a reference that referred to the
original object, or the name of the original object will automatically
refer to the new object and, once the lifetime of the new object has
started, can be used to manipulate the new object, if
the original object is transparently replaceable (see below)
by the new object<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>An object <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> is <a class='hidden_link' href='#def:transparently_replaceable' title='6.7.3&emsp;Lifetime&emsp;[basic.life]'><span id='def:transparently_replaceable'><i >transparently replaceable</i></span></a>
by an object <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span> if:
<ul class='itemize'><li id='8.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#8.1'>(8.1)</a></div>the storage that <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span> occupies exactly overlays
the storage that <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> occupied, and</li><li id='8.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#8.2'>(8.2)</a></div><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> and <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span> are of the same type
(ignoring the top-level cv-qualifiers), and</li><li id='8.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#8.3'>(8.3)</a></div><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> is not a const, complete object, and</li><li id='8.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#8.4'>(8.4)</a></div>neither <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> nor <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>
is a potentially-overlapping subobject (<a href='intro.object' title='6.7.2&emsp;Object model'>[intro.<span class='shy'></span>object]</a>), and</li><li id='8.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#8.5'>(8.5)</a></div>either <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> and <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span> are both complete objects, or
<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> and <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span> are direct subobjects of objects <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> and <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, respectively,
and <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span> is transparently replaceable by <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span><a class='hidden_link' href='#8.sentence-2'>.</a></li></ul></div> <div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> C <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i;
  <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>const</span> C<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span> <span class='keyword'>const</span> C<span class='operator'>&amp;</span> <span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>const</span> C<span class='operator'>&amp;</span> C<span class='operator'>::</span><span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span> <span class='keyword'>const</span> C<span class='operator'>&amp;</span> other<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>if</span> <span class='parenthesis'>(</span> <span class='keyword'>this</span> <span class='operator'>!</span><span class='operator'>=</span> <span class='operator'>&amp;</span>other <span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>this</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span><span class='operator'>~</span>C<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                 <span class='comment'>// lifetime of <span class='tcode_in_codeblock'>*this</span> ends</span>
    <span class='keyword'>new</span> <span class='parenthesis'>(</span><span class='keyword'>this</span><span class='parenthesis'>)</span> C<span class='parenthesis'>(</span>other<span class='parenthesis'>)</span>;        <span class='comment'>// new object of type <span class='tcode_in_codeblock'>C</span> created</span>
    f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                        <span class='comment'>// well-defined</span>
  <span class='curlybracket'>}</span>
  <span class='keyword'>return</span> <span class='operator'>*</span><span class='keyword'>this</span>;
<span class='curlybracket'>}</span>

C c1;
C c2;
c1 <span class='operator'>=</span> c2;                        <span class='comment'>// well-defined</span>
c1<span class='operator'>.</span>f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// well-defined; <span class='tcode_in_codeblock'>c1</span> refers to a new object of type <span class='tcode_in_codeblock'>C</span></span>
</span> —&nbsp;<i>end example</i>]</div></div> <div id='note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-5'>5</a></i>:&ensp;<div id='8.sentence-3' class='sentence'>If these conditions are not met,
a pointer to the new object can be obtained from
a pointer that represents the address of its storage
by calling <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>launder</span> (<a href='ptr.launder' title='17.6.5&emsp;Pointer optimization barrier'>[ptr.<span class='shy'></span>launder]</a>)<a class='hidden_link' href='#8.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3576'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'>If a program ends the lifetime of an object of type <span class='texttt'>T</span> with
static (<a href='basic.stc.static' title='6.7.5.2&emsp;Static storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>static]</a>), thread (<a href='basic.stc.thread' title='6.7.5.3&emsp;Thread storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>thread]</a>),
or automatic (<a href='basic.stc.auto' title='6.7.5.4&emsp;Automatic storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>auto]</a>)
storage duration and if <span class='texttt'>T</span> has a non-trivial destructor,<a class='footnoteref' href='#footnote-23' id='footnoteref-23' title='That is, an object for which a destructor will be called implicitly—upon exit from the block for an object with automatic storage duration, upon exit from the thread for an object with thread storage duration, or upon exit from the program for an object with static storage duration.'>23</a>
and another object of the original type does not occupy
that same storage location when the implicit destructor call takes
place, the behavior of the program is undefined<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.sentence-2' class='sentence'>This is true
even if the block is exited with an exception<a class='hidden_link' href='#9.sentence-2'>.</a></div> <div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>class</span> T <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span>
   <span class='operator'>~</span>B<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
   B b;
   <span class='keyword'>new</span> <span class='parenthesis'>(</span><span class='operator'>&amp;</span>b<span class='parenthesis'>)</span> T;
<span class='curlybracket'>}</span>                               <span class='comment'>// undefined behavior at block exit</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3607'>#</a></div><div class='texpara'><div id='10.sentence-1' class='sentence'>Creating a new object within the storage that a const, complete
object with static, thread, or automatic storage duration occupies,
or within the storage that such a const object used to occupy before
its lifetime ended, results in undefined behavior<a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-4'>4</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> B <span class='curlybracket'>{</span>
  B<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='operator'>~</span>B<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>const</span> B b;

<span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  b<span class='operator'>.</span><span class='operator'>~</span>B<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>new</span> <span class='parenthesis'>(</span><span class='keyword'>const_cast</span><span class='anglebracket'>&lt;</span>B<span class='operator'>*</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='operator'>&amp;</span>b<span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> B;     <span class='comment'>// undefined behavior</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/dbd2450ef21216a8eff8e7c454db6c4e1683bbf5/source/basic.tex#L3628'>#</a></div><div class='texpara'><div id='11.sentence-1' class='sentence'>In this subclause, “before” and “after” refer to the “happens before”
relation (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-6'>6</a></i>:&ensp;<div id='11.sentence-2' class='sentence'>Therefore, undefined behavior results
if an object that is being constructed in one thread is referenced from another
thread without adequate synchronization<a class='hidden_link' href='#11.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> </div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-22'><div class='texpara'><a class='footnotenum' href='#footnote-22'>22)</a><a class='footnoteBacklink' href='#footnoteref-22'>22)</a> <div id='footnote-22.sentence-1' class='sentence'>For example, before the dynamic initialization of
an object with static storage duration (<a href='basic.start.dynamic' title='6.9.3.3&emsp;Dynamic initialization of non-block variables'>[basic.<span class='shy'></span>start.<span class='shy'></span>dynamic]</a>)<a class='hidden_link' href='#footnote-22.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-23'><div class='texpara'><a class='footnotenum' href='#footnote-23'>23)</a><a class='footnoteBacklink' href='#footnoteref-23'>23)</a> <div id='footnote-23.sentence-1' class='sentence'>That
is, an object for which a destructor will be called
implicitly—upon exit from the block for an object with
automatic storage duration, upon exit from the thread for an object with
thread storage duration, or upon exit from the program for an object
with static storage duration<a class='hidden_link' href='#footnote-23.sentence-1'>.</a></div></div></div></div></body></html>