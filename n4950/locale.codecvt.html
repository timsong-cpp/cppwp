<!DOCTYPE html><html lang='en'><head><title>[locale.codecvt]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>30</a> Localization library <a class='abbr_ref' href='./#localization'>[localization]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>30.4</a> Standard <span class='texttt'>locale</span> categories <a class='abbr_ref' href='locale.categories#locale.codecvt'>[locale.categories]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>30.4.2</a> The <span class='texttt'>ctype</span> category <a class='abbr_ref' href='category.ctype#locale.codecvt'>[category.ctype]</a></h3><h4 ><a class='secnum' style='min-width:95pt'>30.4.2.5</a> Class template <span class='texttt'>codecvt</span> <a class='abbr_ref'>[locale.codecvt]</a></h4><div id='general' class='section'><h4 ><a class='secnum' href='#general' style='min-width:110pt'>30.4.2.5.1</a> General <a class='abbr_ref' href='locale.codecvt.general'>[locale.codecvt.general]</a></h4><div class='texpara'><span id='lib:codecvt'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt'>ðŸ”—</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> codecvt_base <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>enum</span> result <span class='curlybracket'>{</span> ok, partial, error, noconv <span class='curlybracket'>}</span>;
  <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> internT, <span class='keyword'>class</span> externT, <span class='keyword'>class</span> stateT<span class='anglebracket'>&gt;</span>
    <span class='keyword'>class</span> codecvt <span class='operator'>:</span> <span class='keyword'>public</span> locale<span class='operator'>::</span>facet, <span class='keyword'>public</span> codecvt_base <span class='curlybracket'>{</span>
    <span class='keyword'>public</span><span class='operator'>:</span>
      <span class='keyword'>using</span> intern_type <span class='operator'>=</span> internT;
      <span class='keyword'>using</span> extern_type <span class='operator'>=</span> externT;
      <span class='keyword'>using</span> state_type  <span class='operator'>=</span> stateT;

      <span class='keyword'>explicit</span> codecvt<span class='parenthesis'>(</span>size_t refs <span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;

      result out<span class='parenthesis'>(</span>
        stateT<span class='operator'>&amp;</span> state,
        <span class='keyword'>const</span> internT<span class='operator'>*</span> from, <span class='keyword'>const</span> internT<span class='operator'>*</span> from_end, <span class='keyword'>const</span> internT<span class='operator'>*</span><span class='operator'>&amp;</span> from_next,
              externT<span class='operator'>*</span>   to,       externT<span class='operator'>*</span>   to_end,       externT<span class='operator'>*</span><span class='operator'>&amp;</span>   to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;

      result unshift<span class='parenthesis'>(</span>
        stateT<span class='operator'>&amp;</span> state,
              externT<span class='operator'>*</span>    to,      externT<span class='operator'>*</span>   to_end,       externT<span class='operator'>*</span><span class='operator'>&amp;</span>   to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;

      result in<span class='parenthesis'>(</span>
        stateT<span class='operator'>&amp;</span> state,
        <span class='keyword'>const</span> externT<span class='operator'>*</span> from, <span class='keyword'>const</span> externT<span class='operator'>*</span> from_end, <span class='keyword'>const</span> externT<span class='operator'>*</span><span class='operator'>&amp;</span> from_next,
              internT<span class='operator'>*</span>   to,       internT<span class='operator'>*</span>   to_end,       internT<span class='operator'>*</span><span class='operator'>&amp;</span>   to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;

      <span class='keyword'>int</span> encoding<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>bool</span> always_noconv<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>int</span> length<span class='parenthesis'>(</span>stateT<span class='operator'>&amp;</span>, <span class='keyword'>const</span> externT<span class='operator'>*</span> from, <span class='keyword'>const</span> externT<span class='operator'>*</span> end, size_t max<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
      <span class='keyword'>int</span> max_length<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

      <span class='keyword'>static</span> locale<span class='operator'>::</span>id id;

    <span class='keyword'>protected</span><span class='operator'>:</span>
      <span class='operator'>~</span>codecvt<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
      <span class='keyword'>virtual</span> result do_out<span class='parenthesis'>(</span>
        stateT<span class='operator'>&amp;</span> state,
        <span class='keyword'>const</span> internT<span class='operator'>*</span> from, <span class='keyword'>const</span> internT<span class='operator'>*</span> from_end, <span class='keyword'>const</span> internT<span class='operator'>*</span><span class='operator'>&amp;</span> from_next,
              externT<span class='operator'>*</span> to,         externT<span class='operator'>*</span>   to_end,       externT<span class='operator'>*</span><span class='operator'>&amp;</span>   to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
      <span class='keyword'>virtual</span> result do_in<span class='parenthesis'>(</span>
        stateT<span class='operator'>&amp;</span> state,
        <span class='keyword'>const</span> externT<span class='operator'>*</span> from, <span class='keyword'>const</span> externT<span class='operator'>*</span> from_end, <span class='keyword'>const</span> externT<span class='operator'>*</span><span class='operator'>&amp;</span> from_next,
              internT<span class='operator'>*</span> to,         internT<span class='operator'>*</span>   to_end,       internT<span class='operator'>*</span><span class='operator'>&amp;</span>   to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
      <span class='keyword'>virtual</span> result do_unshift<span class='parenthesis'>(</span>
        stateT<span class='operator'>&amp;</span> state,
              externT<span class='operator'>*</span> to,         externT<span class='operator'>*</span>   to_end,       externT<span class='operator'>*</span><span class='operator'>&amp;</span>   to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;

      <span class='keyword'>virtual</span> <span class='keyword'>int</span> do_encoding<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>virtual</span> <span class='keyword'>bool</span> do_always_noconv<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>virtual</span> <span class='keyword'>int</span> do_length<span class='parenthesis'>(</span>stateT<span class='operator'>&amp;</span>, <span class='keyword'>const</span> externT<span class='operator'>*</span> from, <span class='keyword'>const</span> externT<span class='operator'>*</span> end, size_t max<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
      <span class='keyword'>virtual</span> <span class='keyword'>int</span> do_max_length<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='general-1'><div class='marginalizedparent'><a class='marginalized' href='#general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1646'>#</a></div><div class='texpara'><div id='general-1.sentence-1' class='sentence'>The class <span class='texttt'>codecvt<span class='anglebracket'>&lt;</span>internT, externT, stateT<span class='anglebracket'>&gt;</span></span> is for use
when converting from one character encoding to another,
such as from wide characters to multibyte characters or
between wide character encodings such as UTF-32 and EUC<a class='hidden_link' href='#general-1.sentence-1'>.</a></div></div></div><div class='para' id='general-2'><div class='marginalizedparent'><a class='marginalized' href='#general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1652'>#</a></div><div class='texpara'><div id='general-2.sentence-1' class='sentence'>The <span class='texttt'>stateT</span> argument selects
the pair of character encodings being mapped between<a class='hidden_link' href='#general-2.sentence-1'>.</a></div></div></div><div class='para' id='general-3'><div class='marginalizedparent'><a class='marginalized' href='#general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1656'>#</a></div><div class='texpara'><div id='general-3.sentence-1' class='sentence'>The specializations required
in Table <a href='locale.category#tab:locale.category.facets' title='Table 104: Locale category facets'>104</a> (<a href='locale.category' title='30.3.1.2.1&emsp;Type locale&#x200b;::&#x200b;category'>[locale.<span class='shy'></span>category]</a>)
convert the implementation-defined native character set<a class='hidden_link' href='#general-3.sentence-1'>.</a></div> <div id='general-3.sentence-2' class='sentence'><span class='texttt'>codecvt<span class='anglebracket'>&lt;</span><span class='keyword'>char</span>, <span class='keyword'>char</span>, mbstate_<span class='shy'></span>t<span class='anglebracket'>&gt;</span></span> implements a degenerate conversion;
it does not convert at all<a class='hidden_link' href='#general-3.sentence-2'>.</a></div> <div id='general-3.sentence-3' class='sentence'><a class='index' id=':UTF-8'></a><a class='index' id=':UTF-16'></a><a class='index' id=':UTF-32'></a>The specialization <span class='texttt'>codecvt<span class='anglebracket'>&lt;</span><span class='keyword'>char16_<span class='shy'></span>t</span>, <span class='keyword'>char8_<span class='shy'></span>t</span>, mbstate_<span class='shy'></span>t<span class='anglebracket'>&gt;</span></span>
converts between the UTF-16 and UTF-8 encoding forms, and
the specialization <span class='texttt'>codecvt<span class='anglebracket'>&lt;</span><span class='keyword'>char32_<span class='shy'></span>t</span>, <span class='keyword'>char8_<span class='shy'></span>t</span>, mbstate_<span class='shy'></span>t<span class='anglebracket'>&gt;</span></span>
converts between the UTF-32 and UTF-8 encoding forms<a class='hidden_link' href='#general-3.sentence-3'>.</a></div> <div id='general-3.sentence-4' class='sentence'><span class='texttt'>codecvt<span class='anglebracket'>&lt;</span><span class='keyword'>wchar_<span class='shy'></span>t</span>, <span class='keyword'>char</span>, mbstate_<span class='shy'></span>t<span class='anglebracket'>&gt;</span></span>
converts between the native character sets for ordinary and wide characters<a class='hidden_link' href='#general-3.sentence-4'>.</a></div> <div id='general-3.sentence-5' class='sentence'>Specializations on <span class='texttt'>mbstate_<span class='shy'></span>t</span>
perform conversion between encodings known to the library implementer<a class='hidden_link' href='#general-3.sentence-5'>.</a></div> <div id='general-3.sentence-6' class='sentence'>Other encodings can be converted by specializing on
a program-defined <span class='texttt'>stateT</span> type<a class='hidden_link' href='#general-3.sentence-6'>.</a></div> <div id='general-3.sentence-7' class='sentence'>Objects of type <span class='texttt'>stateT</span> can contain any state
that is useful to communicate to or from
the specialized <span class='texttt'>do_<span class='shy'></span>in</span> or <span class='texttt'>do_<span class='shy'></span>out</span> members<a class='hidden_link' href='#general-3.sentence-7'>.</a></div></div></div></div><div id='members' class='section'><h4 ><a class='secnum' href='#members' style='min-width:110pt'>30.4.2.5.2</a> Members <a class='abbr_ref' href='locale.codecvt.members'>[locale.codecvt.members]</a></h4><div class='texpara'><div id='lib:out,codecvt'><div id='lib:codecvt,out'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,out'>ðŸ”—</a></div><code class='itemdeclcode'>result out<span class='parenthesis'>(</span>
  stateT<span class='operator'>&amp;</span> state,
  <span class='keyword'>const</span> internT<span class='operator'>*</span> from, <span class='keyword'>const</span> internT<span class='operator'>*</span> from_end, <span class='keyword'>const</span> internT<span class='operator'>*</span><span class='operator'>&amp;</span> from_next,
  externT<span class='operator'>*</span> to, externT<span class='operator'>*</span> to_end, externT<span class='operator'>*</span><span class='operator'>&amp;</span> to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='members-1'><div class='marginalizedparent'><a class='marginalized' href='#members-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1690'>#</a></div><div class='texpara'><div id='members-1.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>do_<span class='shy'></span>out<span class='parenthesis'>(</span>state, from, from_<span class='shy'></span>end, from_<span class='shy'></span>next, to, to_<span class='shy'></span>end, to_<span class='shy'></span>next<span class='parenthesis'>)</span></span><a class='hidden_link' href='#members-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unshift,codecvt'><div id='lib:codecvt,unshift'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,unshift'>ðŸ”—</a></div><code class='itemdeclcode'>result unshift<span class='parenthesis'>(</span>stateT<span class='operator'>&amp;</span> state, externT<span class='operator'>*</span> to, externT<span class='operator'>*</span> to_end, externT<span class='operator'>*</span><span class='operator'>&amp;</span> to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='members-2'><div class='marginalizedparent'><a class='marginalized' href='#members-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1701'>#</a></div><div class='texpara'><div id='members-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>do_<span class='shy'></span>unshift<span class='parenthesis'>(</span>state, to, to_<span class='shy'></span>end, to_<span class='shy'></span>next<span class='parenthesis'>)</span></span><a class='hidden_link' href='#members-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:in,codecvt'><div id='lib:codecvt,in'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,in'>ðŸ”—</a></div><code class='itemdeclcode'>result in<span class='parenthesis'>(</span>
  stateT<span class='operator'>&amp;</span> state,
  <span class='keyword'>const</span> externT<span class='operator'>*</span> from, <span class='keyword'>const</span> externT<span class='operator'>*</span> from_end, <span class='keyword'>const</span> externT<span class='operator'>*</span><span class='operator'>&amp;</span> from_next,
  internT<span class='operator'>*</span> to, internT<span class='operator'>*</span> to_end, internT<span class='operator'>*</span><span class='operator'>&amp;</span> to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='members-3'><div class='marginalizedparent'><a class='marginalized' href='#members-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1715'>#</a></div><div class='texpara'><div id='members-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>do_<span class='shy'></span>in<span class='parenthesis'>(</span>state, from, from_<span class='shy'></span>end, from_<span class='shy'></span>next, to, to_<span class='shy'></span>end, to_<span class='shy'></span>next<span class='parenthesis'>)</span></span><a class='hidden_link' href='#members-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:encoding,codecvt'><div id='lib:codecvt,encoding'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,encoding'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>int</span> encoding<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='members-4'><div class='marginalizedparent'><a class='marginalized' href='#members-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1726'>#</a></div><div class='texpara'><div id='members-4.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>do_<span class='shy'></span>encoding<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#members-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:always_noconv,codecvt'><div id='lib:codecvt,always_noconv'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,always_noconv'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> always_noconv<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='members-5'><div class='marginalizedparent'><a class='marginalized' href='#members-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1737'>#</a></div><div class='texpara'><div id='members-5.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>do_<span class='shy'></span>always_<span class='shy'></span>noconv<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#members-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:length,codecvt'><div id='lib:codecvt,length'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,length'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>int</span> length<span class='parenthesis'>(</span>stateT<span class='operator'>&amp;</span> state, <span class='keyword'>const</span> externT<span class='operator'>*</span> from, <span class='keyword'>const</span> externT<span class='operator'>*</span> from_end, size_t max<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='members-6'><div class='marginalizedparent'><a class='marginalized' href='#members-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1748'>#</a></div><div class='texpara'><div id='members-6.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>do_<span class='shy'></span>length<span class='parenthesis'>(</span>state, from, from_<span class='shy'></span>end, max<span class='parenthesis'>)</span></span><a class='hidden_link' href='#members-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:max_length,codecvt'><div id='lib:codecvt,max_length'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,max_length'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>int</span> max_length<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='members-7'><div class='marginalizedparent'><a class='marginalized' href='#members-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1759'>#</a></div><div class='texpara'><div id='members-7.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>do_<span class='shy'></span>max_<span class='shy'></span>length<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#members-7.sentence-1'>.</a></div></div></div></div></div><div id='virtuals' class='section'><h4 ><a class='secnum' href='#virtuals' style='min-width:110pt'>30.4.2.5.3</a> Virtual functions <a class='abbr_ref' href='locale.codecvt.virtuals'>[locale.codecvt.virtuals]</a></h4><div class='texpara'><div id='lib:do_in,codecvt'><div id='lib:codecvt,do_in'><div id='lib:do_out,codecvt'><div id='lib:codecvt,do_out'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,do_out'>ðŸ”—</a></div><code class='itemdeclcode'>result do_out<span class='parenthesis'>(</span>
  stateT<span class='operator'>&amp;</span> state,
  <span class='keyword'>const</span> internT<span class='operator'>*</span> from, <span class='keyword'>const</span> internT<span class='operator'>*</span> from_end, <span class='keyword'>const</span> internT<span class='operator'>*</span><span class='operator'>&amp;</span> from_next,
  externT<span class='operator'>*</span> to, externT<span class='operator'>*</span> to_end, externT<span class='operator'>*</span><span class='operator'>&amp;</span> to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;

result do_in<span class='parenthesis'>(</span>
  stateT<span class='operator'>&amp;</span> state,
  <span class='keyword'>const</span> externT<span class='operator'>*</span> from, <span class='keyword'>const</span> externT<span class='operator'>*</span> from_end, <span class='keyword'>const</span> externT<span class='operator'>*</span><span class='operator'>&amp;</span> from_next,
  internT<span class='operator'>*</span> to, internT<span class='operator'>*</span> to_end, internT<span class='operator'>*</span><span class='operator'>&amp;</span> to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div></div></div><div class='para' id='virtuals-1'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1781'>#</a></div><div class='texpara'><div id='virtuals-1.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'><span class='parenthesis'>(</span>from <span class='anglebracket'>&lt;</span><span class='operator'>=</span> from_<span class='shy'></span>end <span class='operator'>&amp;</span><span class='operator'>&amp;</span> to <span class='anglebracket'>&lt;</span><span class='operator'>=</span> to_<span class='shy'></span>end<span class='parenthesis'>)</span></span> is well-defined and <span class='texttt'><span class='literal'>true</span></span>;
<span class='texttt'>state</span> is initialized, if at the beginning of a sequence,
or else is equal to the result of converting
the preceding characters in the sequence<a class='hidden_link' href='#virtuals-1.sentence-1'>.</a></div></div></div></div><div class='para' id='virtuals-2'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1788'>#</a></div><div class='texpara'><div id='virtuals-2.sentence-1' class='sentence'><i >Effects</i>: Translates characters in the source range [<span class='texttt'>from, from_<span class='shy'></span>end</span>),
placing the results in sequential positions starting at destination <span class='texttt'>to</span><a class='hidden_link' href='#virtuals-2.sentence-1'>.</a></div> <div id='virtuals-2.sentence-2' class='sentence'>Converts no more than <span class='texttt'><span class='parenthesis'>(</span>from_<span class='shy'></span>end <span class='operator'>-</span> from<span class='parenthesis'>)</span></span> source elements, and
stores no more than <span class='texttt'><span class='parenthesis'>(</span>to_<span class='shy'></span>end <span class='operator'>-</span> to<span class='parenthesis'>)</span></span> destination elements<a class='hidden_link' href='#virtuals-2.sentence-2'>.</a></div></div></div></div><div class='para' id='virtuals-3'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1795'>#</a></div><div class='texpara'><div id='virtuals-3.sentence-1' class='sentence'>Stops if it encounters a character it cannot convert<a class='hidden_link' href='#virtuals-3.sentence-1'>.</a></div> <div id='virtuals-3.sentence-2' class='sentence'>It always leaves the <span class='texttt'>from_<span class='shy'></span>next</span> and <span class='texttt'>to_<span class='shy'></span>next</span> pointers
pointing one beyond the last element successfully converted<a class='hidden_link' href='#virtuals-3.sentence-2'>.</a></div> <div id='virtuals-3.sentence-3' class='sentence'>If returns <span class='texttt'>noconv</span>,
<span class='texttt'>internT</span> and <span class='texttt'>externT</span> are the same type and
the converted sequence is identical to
the input sequence [<span class='texttt'>from, from_<span class='shy'></span>next</span>)<a class='hidden_link' href='#virtuals-3.sentence-3'>.</a></div> <div id='virtuals-3.sentence-4' class='sentence'><span class='texttt'>to_<span class='shy'></span>next</span> is set equal to <span class='texttt'>to</span>,
the value of <span class='texttt'>state</span> is unchanged, and
there are no changes to the values in [<span class='texttt'>to, to_<span class='shy'></span>end</span>)<a class='hidden_link' href='#virtuals-3.sentence-4'>.</a></div></div></div></div><div class='para' id='virtuals-4'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1807'>#</a></div><div class='texpara'><div id='virtuals-4.sentence-1' class='sentence'>A <span class='texttt'>codecvt</span> facet
that is used by <span class='texttt'>basic_<span class='shy'></span>filebuf</span> (<a href='file.streams' title='31.10&emsp;File-based streams'>[file.<span class='shy'></span>streams]</a>)
shall have the property that if
<span class='codeblock'>do_out<span class='parenthesis'>(</span>state, from, from_end, from_next, to, to_end, to_next<span class='parenthesis'>)</span>
</span>
would return <span class='texttt'>ok</span>,
where <span class='texttt'>from <span class='operator'>!</span><span class='operator'>=</span> from_<span class='shy'></span>end</span>,
then
<span class='codeblock'>do_out<span class='parenthesis'>(</span>state, from, from <span class='operator'>+</span> <span class='literal'>1</span>, from_next, to, to_end, to_next<span class='parenthesis'>)</span>
</span>
shall also return <span class='texttt'>ok</span>,
and that if
<span class='codeblock'>do_in<span class='parenthesis'>(</span>state, from, from_end, from_next, to, to_end, to_next<span class='parenthesis'>)</span>
</span>
would return <span class='texttt'>ok</span>,
where <span class='texttt'>to <span class='operator'>!</span><span class='operator'>=</span> to_<span class='shy'></span>end</span>,
then
<span class='codeblock'>do_in<span class='parenthesis'>(</span>state, from, from_end, from_next, to, to <span class='operator'>+</span> <span class='literal'>1</span>, to_next<span class='parenthesis'>)</span>
</span>
shall also return <span class='texttt'>ok</span><a class='hidden_link' href='#virtuals-4.sentence-1'>.</a><a class='footnoteref' href='#footnote-247' id='footnoteref-247' title='Informally, this means that basic_&shy;filebuf assumes that the mappings from internal to external characters is 1 to N: that a codecvt facet that is used by basic_&shy;filebuf can translate characters one internal character at a time.'>247</a></div> <div id='virtuals-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#virtuals-note-1'>1</a></i>:&ensp;<div id='virtuals-4.sentence-2' class='sentence'>As a result of operations on <span class='texttt'>state</span>,
it can return <span class='texttt'>ok</span> or <span class='texttt'>partial</span> and
set <span class='texttt'>from_<span class='shy'></span>next <span class='operator'>=</span><span class='operator'>=</span> from</span> and <span class='texttt'>to_<span class='shy'></span>next <span class='operator'>!</span><span class='operator'>=</span> to</span><a class='hidden_link' href='#virtuals-4.sentence-2'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='virtuals-5'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1844'>#</a></div><div class='texpara'><div id='virtuals-5.sentence-1' class='sentence'><i >Returns</i>: An enumeration value, as summarized in Table <a href='#tab:locale.codecvt.inout' title='Table 106: do_&shy;in/do_&shy;out result values'>106</a><a class='hidden_link' href='#virtuals-5.sentence-1'>.</a></div></div><div class='texpara'><div class='numberedTable' id='tab:locale.codecvt.inout'>Table <a href='#tab:locale.codecvt.inout'>106</a>: <span class='texttt'>do_<span class='shy'></span>in<span class='operator'>/</span>do_<span class='shy'></span>out</span> result values&emsp;<a href='./tab:locale.codecvt.inout'>[tab:locale.codecvt.inout]</a><br><table ><tr id='tab:locale.codecvt.inout-row-1' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.inout-row-1'>ðŸ”—</a></div></td><td class='center'><div class='texpara'><div id='tab:locale.codecvt.inout-row-1-column-1-sentence-1' class='sentence'><b>Value</b></div></div></td><td class='center'><div class='texpara'><div id='tab:locale.codecvt.inout-row-1-column-2-sentence-1' class='sentence'><b>Meaning</b></div></div></td></tr><tr id='tab:locale.codecvt.inout-row-2' class='capsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.inout-row-2'>ðŸ”—</a></div></td><td class='left'><div class='texpara'><div id='tab:locale.codecvt.inout-row-2-column-1-sentence-1' class='sentence'><span class='texttt'>ok</span></div></div></td><td class='justify' style='width:3in'><div class='texpara'><div id='tab:locale.codecvt.inout-row-2-column-2-sentence-1' class='sentence'>completed the conversion</div></div></td></tr><tr id='tab:locale.codecvt.inout-row-3'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.inout-row-3'>ðŸ”—</a></div></td><td class='left'><div class='texpara'><div id='tab:locale.codecvt.inout-row-3-column-1-sentence-1' class='sentence'><span class='texttt'>partial</span></div></div></td><td class='justify' style='width:3in'><div class='texpara'><div id='tab:locale.codecvt.inout-row-3-column-2-sentence-1' class='sentence'>not all source characters converted</div></div></td></tr><tr id='tab:locale.codecvt.inout-row-4'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.inout-row-4'>ðŸ”—</a></div></td><td class='left'><div class='texpara'><div id='tab:locale.codecvt.inout-row-4-column-1-sentence-1' class='sentence'><span class='texttt'>error</span></div></div></td><td class='justify' style='width:3in'><div class='texpara'><div id='tab:locale.codecvt.inout-row-4-column-2-sentence-1' class='sentence'>encountered a character in [<span class='texttt'>from, from_<span class='shy'></span>end</span>)
that cannot be converted</div></div></td></tr><tr id='tab:locale.codecvt.inout-row-5'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.inout-row-5'>ðŸ”—</a></div></td><td class='left'><div class='texpara'><div id='tab:locale.codecvt.inout-row-5-column-1-sentence-1' class='sentence'><span class='texttt'>noconv</span></div></div></td><td class='justify' style='width:3in'><div class='texpara'><div id='tab:locale.codecvt.inout-row-5-column-2-sentence-1' class='sentence'><span class='texttt'>internT</span> and <span class='texttt'>externT</span> are the same type, and input
sequence is identical to converted sequence</div></div></td></tr></table></div>
 </div><div class='texpara'><div id='virtuals-5.sentence-2' class='sentence'>A return value of <span class='texttt'>partial</span>,
if <span class='texttt'><span class='parenthesis'>(</span>from_<span class='shy'></span>next <span class='operator'>=</span><span class='operator'>=</span> from_<span class='shy'></span>end<span class='parenthesis'>)</span></span>,
indicates
that either the destination sequence has not absorbed
all the available destination elements, or
that additional source elements are needed
before another destination element can be produced<a class='hidden_link' href='#virtuals-5.sentence-2'>.</a></div></div></div></div><div class='para' id='virtuals-6'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1870'>#</a></div><div class='texpara'><div id='virtuals-6.sentence-1' class='sentence'><i >Remarks</i>: Its operations on <span class='texttt'>state</span> are unspecified<a class='hidden_link' href='#virtuals-6.sentence-1'>.</a></div> <div id='virtuals-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#virtuals-note-2'>2</a></i>:&ensp;<div id='virtuals-6.sentence-2' class='sentence'>This argument can be used, for example,
to maintain shift state,
to specify conversion options (such as count only), or
to identify a cache of seek offsets<a class='hidden_link' href='#virtuals-6.sentence-2'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:do_unshift,codecvt'><div id='lib:codecvt,do_unshift'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,do_unshift'>ðŸ”—</a></div><code class='itemdeclcode'>result do_unshift<span class='parenthesis'>(</span>stateT<span class='operator'>&amp;</span> state, externT<span class='operator'>*</span> to, externT<span class='operator'>*</span> to_end, externT<span class='operator'>*</span><span class='operator'>&amp;</span> to_next<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='virtuals-7'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1887'>#</a></div><div class='texpara'><div id='virtuals-7.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'><span class='parenthesis'>(</span>to <span class='anglebracket'>&lt;</span><span class='operator'>=</span> to_<span class='shy'></span>end<span class='parenthesis'>)</span></span> is well-defined and <span class='texttt'><span class='literal'>true</span></span>;
<span class='texttt'>state</span> is initialized, if at the beginning of a sequence,
or else is equal to the result of converting
the preceding characters in the sequence<a class='hidden_link' href='#virtuals-7.sentence-1'>.</a></div></div></div></div><div class='para' id='virtuals-8'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1894'>#</a></div><div class='texpara'><div id='virtuals-8.sentence-1' class='sentence'><i >Effects</i>: Places characters starting at <span class='texttt'>to</span>
that should be appended to terminate a sequence
when the current <span class='texttt'>stateT</span> is given by <span class='texttt'>state</span><a class='hidden_link' href='#virtuals-8.sentence-1'>.</a><a class='footnoteref' href='#footnote-248' id='footnoteref-248' title='Typically these will be characters to return the state to stateT().'>248</a></div> <div id='virtuals-8.sentence-2' class='sentence'>
Stores no more than <span class='texttt'><span class='parenthesis'>(</span>to_<span class='shy'></span>end <span class='operator'>-</span> to<span class='parenthesis'>)</span></span> destination elements, and
leaves the <span class='texttt'>to_<span class='shy'></span>next</span> pointer
pointing one beyond the last element successfully stored<a class='hidden_link' href='#virtuals-8.sentence-2'>.</a></div></div></div></div><div class='para' id='virtuals-9'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1906'>#</a></div><div class='texpara'><div id='virtuals-9.sentence-1' class='sentence'><i >Returns</i>: An enumeration value, as summarized in Table <a href='#tab:locale.codecvt.unshift' title='Table 107: do_&shy;unshift result values'>107</a><a class='hidden_link' href='#virtuals-9.sentence-1'>.</a></div></div><div class='texpara'><div class='numberedTable' id='tab:locale.codecvt.unshift'>Table <a href='#tab:locale.codecvt.unshift'>107</a>: <span class='texttt'>do_<span class='shy'></span>unshift</span> result values&emsp;<a href='./tab:locale.codecvt.unshift'>[tab:locale.codecvt.unshift]</a><br><table ><tr id='tab:locale.codecvt.unshift-row-1' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.unshift-row-1'>ðŸ”—</a></div></td><td class='center'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-1-column-1-sentence-1' class='sentence'><b>Value</b></div></div></td><td class='center'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-1-column-2-sentence-1' class='sentence'><b>Meaning</b></div></div></td></tr><tr id='tab:locale.codecvt.unshift-row-2' class='capsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.unshift-row-2'>ðŸ”—</a></div></td><td class='left'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-2-column-1-sentence-1' class='sentence'><span class='texttt'>ok</span></div></div></td><td class='justify' style='width:50%'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-2-column-2-sentence-1' class='sentence'>completed the sequence</div></div></td></tr><tr id='tab:locale.codecvt.unshift-row-3'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.unshift-row-3'>ðŸ”—</a></div></td><td class='left'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-3-column-1-sentence-1' class='sentence'><span class='texttt'>partial</span></div></div></td><td class='justify' style='width:50%'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-3-column-2-sentence-1' class='sentence'>space for more than <span class='texttt'>to_<span class='shy'></span>end <span class='operator'>-</span> to</span> destination elements was needed
to terminate a sequence given the value of <span class='texttt'>state</span></div></div></td></tr><tr id='tab:locale.codecvt.unshift-row-4'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.unshift-row-4'>ðŸ”—</a></div></td><td class='left'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-4-column-1-sentence-1' class='sentence'><span class='texttt'>error</span></div></div></td><td class='justify' style='width:50%'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-4-column-2-sentence-1' class='sentence'>an unspecified error has occurred</div></div></td></tr><tr id='tab:locale.codecvt.unshift-row-5'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:locale.codecvt.unshift-row-5'>ðŸ”—</a></div></td><td class='left'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-5-column-1-sentence-1' class='sentence'><span class='texttt'>noconv</span></div></div></td><td class='justify' style='width:50%'><div class='texpara'><div id='tab:locale.codecvt.unshift-row-5-column-2-sentence-1' class='sentence'>no termination is needed for this <span class='texttt'>state_<span class='shy'></span>type</span></div></div></td></tr></table></div></div></div></div><div class='texpara'><div id='lib:do_encoding,codecvt'><div id='lib:codecvt,do_encoding'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,do_encoding'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>int</span> do_encoding<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='virtuals-10'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1929'>#</a></div><div class='texpara'><div id='virtuals-10.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>-</span><span class='literal'>1</span></span> if the encoding of the <span class='texttt'>externT</span> sequence is state-dependent;
else the constant number of <span class='texttt'>externT</span> characters
needed to produce an internal character;
or <span class='texttt'><span class='literal'>0</span></span> if this number is not a constant<a class='hidden_link' href='#virtuals-10.sentence-1'>.</a><a class='footnoteref' href='#footnote-249' id='footnoteref-249' title='If encoding() yields -1, then more than max_&shy;length() externT elements can be consumed when producing a single internT character, and additional externT elements can appear at the end of a sequence after those that yield the final internT character.'>249</a></div></div></div></div><div class='texpara'><div id='lib:do_always_noconv,codecvt'><div id='lib:codecvt,do_always_noconv'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,do_always_noconv'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> do_always_noconv<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='virtuals-11'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1950'>#</a></div><div class='texpara'><div id='virtuals-11.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if <span class='texttt'>do_<span class='shy'></span>in<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and <span class='texttt'>do_<span class='shy'></span>out<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> return <span class='texttt'>noconv</span>
for all valid argument values<a class='hidden_link' href='#virtuals-11.sentence-1'>.</a></div> <div id='virtuals-11.sentence-2' class='sentence'><span class='texttt'>codecvt<span class='anglebracket'>&lt;</span><span class='keyword'>char</span>, <span class='keyword'>char</span>, mbstate_<span class='shy'></span>t<span class='anglebracket'>&gt;</span></span> returns <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#virtuals-11.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:do_length,codecvt'><div id='lib:codecvt,do_length'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,do_length'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>int</span> do_length<span class='parenthesis'>(</span>stateT<span class='operator'>&amp;</span> state, <span class='keyword'>const</span> externT<span class='operator'>*</span> from, <span class='keyword'>const</span> externT<span class='operator'>*</span> from_end, size_t max<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='virtuals-12'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1963'>#</a></div><div class='texpara'><div id='virtuals-12.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'><span class='parenthesis'>(</span>from <span class='anglebracket'>&lt;</span><span class='operator'>=</span> from_<span class='shy'></span>end<span class='parenthesis'>)</span></span> is well-defined and <span class='texttt'><span class='literal'>true</span></span>;
<span class='texttt'>state</span> is initialized, if at the beginning of a sequence,
or else is equal to the result of converting
the preceding characters in the sequence<a class='hidden_link' href='#virtuals-12.sentence-1'>.</a></div></div></div></div><div class='para' id='virtuals-13'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1970'>#</a></div><div class='texpara'><div id='virtuals-13.sentence-1' class='sentence'><i >Effects</i>: The effect on the <span class='texttt'>state</span> argument is as if
it called <span class='texttt'>do_<span class='shy'></span>in<span class='parenthesis'>(</span>state, from, from_<span class='shy'></span>end, from, to, to<span class='operator'>+</span>max, to<span class='parenthesis'>)</span></span>
for <span class='texttt'>to</span> pointing to a buffer of at least <span class='texttt'>max</span> elements<a class='hidden_link' href='#virtuals-13.sentence-1'>.</a></div></div></div></div><div class='para' id='virtuals-14'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1976'>#</a></div><div class='texpara'><div id='virtuals-14.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='parenthesis'>(</span>from_<span class='shy'></span>next<span class='operator'>-</span>from<span class='parenthesis'>)</span></span> where
<span class='texttt'>from_<span class='shy'></span>next</span> is the largest value in the range [<span class='texttt'>from, from_<span class='shy'></span>end</span>]
such that the sequence of values in the range [<span class='texttt'>from, from_<span class='shy'></span>next</span>)
represents
<span class='texttt'>max</span> or fewer valid complete characters of type <span class='texttt'>internT</span><a class='hidden_link' href='#virtuals-14.sentence-1'>.</a></div> <div id='virtuals-14.sentence-2' class='sentence'>The specialization <span class='texttt'>codecvt<span class='anglebracket'>&lt;</span><span class='keyword'>char</span>, <span class='keyword'>char</span>, mbstate_<span class='shy'></span>t<span class='anglebracket'>&gt;</span></span>,
returns the lesser of <span class='texttt'>max</span> and <span class='texttt'><span class='parenthesis'>(</span>from_<span class='shy'></span>end<span class='operator'>-</span>from<span class='parenthesis'>)</span></span><a class='hidden_link' href='#virtuals-14.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:do_max_length,codecvt'><div id='lib:codecvt,do_max_length'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:codecvt,do_max_length'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>int</span> do_max_length<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='virtuals-15'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/locales.tex#L1993'>#</a></div><div class='texpara'><div id='virtuals-15.sentence-1' class='sentence'><i >Returns</i>: The maximum value that <span class='texttt'>do_<span class='shy'></span>length<span class='parenthesis'>(</span>state, from, from_<span class='shy'></span>end, <span class='literal'>1</span><span class='parenthesis'>)</span></span> can return
for any valid range [<span class='texttt'>from, from_<span class='shy'></span>end</span>)
and <span class='texttt'>stateT</span> value <span class='texttt'>state</span><a class='hidden_link' href='#virtuals-15.sentence-1'>.</a></div> <div id='virtuals-15.sentence-2' class='sentence'>The specialization <span class='texttt'>codecvt<span class='anglebracket'>&lt;</span><span class='keyword'>char</span>, <span class='keyword'>char</span>, mbstate_<span class='shy'></span>t<span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>do_<span class='shy'></span>max_<span class='shy'></span>length<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
returns 1<a class='hidden_link' href='#virtuals-15.sentence-2'>.</a></div></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-247'><div class='texpara'><a class='footnotenum' href='#footnote-247'>247)</a><a class='footnoteBacklink' href='#footnoteref-247'>247)</a> <div id='footnote-247.sentence-1' class='sentence'>Informally, this means that <span class='texttt'>basic_<span class='shy'></span>filebuf</span>
assumes that the mappings from internal to external characters is 1 to N:
that a <span class='texttt'>codecvt</span> facet that is used by <span class='texttt'>basic_<span class='shy'></span>filebuf</span>
can translate characters one internal character at a time<a class='hidden_link' href='#footnote-247.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-248'><div class='texpara'><a class='footnotenum' href='#footnote-248'>248)</a><a class='footnoteBacklink' href='#footnoteref-248'>248)</a> <div id='footnote-248.sentence-1' class='sentence'>Typically these will be characters to return the state to <span class='texttt'>stateT<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#footnote-248.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-249'><div class='texpara'><a class='footnotenum' href='#footnote-249'>249)</a><a class='footnoteBacklink' href='#footnoteref-249'>249)</a> <div id='footnote-249.sentence-1' class='sentence'>If <span class='texttt'>encoding<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> yields <span class='texttt'><span class='operator'>-</span><span class='literal'>1</span></span>,
then more than <span class='texttt'>max_<span class='shy'></span>length<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> <span class='texttt'>externT</span> elements
can be consumed when producing a single <span class='texttt'>internT</span> character, and
additional <span class='texttt'>externT</span> elements can appear at the end of a sequence
after those that yield the final <span class='texttt'>internT</span> character<a class='hidden_link' href='#footnote-249.sentence-1'>.</a></div></div></div></div></div></body></html>