<!DOCTYPE html><html lang='en'><head><title>[except.spec]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>14</a> Exception handling <a class='abbr_ref' href='./#except'>[except]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>14.5</a> Exception specifications <a class='abbr_ref'>[except.spec]</a></h2><div class='texpara'><a class='index' id=':exception_specification'></a></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L706'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>The predicate indicating whether a function cannot exit via an exception
is called the <a class='hidden_link' href='#def:exception_specification' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='def:exception_specification'><i >exception specification</i></span></a> of the function<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>If the predicate is false,
the function has a
<a class='index' id=':exception_specification,potentially-throwing'></a><a class='hidden_link' href='#def:potentially-throwing,exception_specification' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='def:potentially-throwing,exception_specification'><i >potentially-throwing exception specification</i></span></a>,
otherwise it has a
<a class='index' id=':exception_specification,non-throwing'></a><a class='hidden_link' href='#def:non-throwing_exception_specification' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='def:non-throwing_exception_specification'><i >non-throwing exception specification</i></span></a><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>The exception specification is either defined implicitly,
or defined explicitly
by using a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier'><span class='textsf'><i >noexcept-specifier</i></span></span></a>
as a suffix of a <a href='dcl.fct' title='9.3.4.6&emsp;Functions&emsp;[dcl.fct]'>function declarator</a><a class='hidden_link' href='#1.sentence-3'>.</a></div></div><div class='texpara'><div class='bnf' id='nt:noexcept-specifier'>
<a class='hidden_link' href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='nt:noexcept-specifier'><span id=':noexcept-specifier'>noexcept-specifier<span class='textnormal'>:</span></span></span></a><br/><span id=':noexcept'><span class='texttt'><span class='keyword'>noexcept</span></span></span> <span class='terminal'><span class='parenthesis'>(</span></span> <a href='expr.const#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='ntref:constant-expression'><span class='textsf'><i >constant-expression</i></span></span></a> <span class='terminal'><span class='parenthesis'>)</span></span><br/><span id=':noexcept_'><span class='texttt'><span class='keyword'>noexcept</span></span></span><br/></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L728'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'><a class='index' id=':exception_specification,noexcept,constant_expression_and'></a>In a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier_'><span class='textsf'><i >noexcept-specifier</i></span></span></a>, the <a href='expr.const#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='ntref:constant-expression_'><span class='textsf'><i >constant-expression</i></span></span></a>,
if supplied, shall be a contextually converted constant expression
of type <span id=':bool'><span class='texttt'><span class='keyword'>bool</span></span></span> (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>);
that constant expression is the exception specification of
the function type in which the <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier__'><span class='textsf'><i >noexcept-specifier</i></span></span></a> appears<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>A <span class='texttt'><span class='parenthesis'>(</span></span> token that follows <span id=':noexcept__'><span class='texttt'><span class='keyword'>noexcept</span></span></span> is part of the
<a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier___'><span class='textsf'><i >noexcept-specifier</i></span></span></a> and does not commence an
initializer (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>The <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier____'><span class='textsf'><i >noexcept-specifier</i></span></span></a> <span id=':noexcept___'><span class='texttt'><span class='keyword'>noexcept</span></span></span>
without a <a href='expr.const#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='ntref:constant-expression__'><span class='textsf'><i >constant-expression</i></span></span></a>
is
equivalent to the <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier_____'><span class='textsf'><i >noexcept-specifier</i></span></span></a>
<span class='texttt'><span id=':noexcept____'><span class='texttt'><span class='keyword'>noexcept</span></span></span><span class='parenthesis'>(</span><span id=':true'><span class='texttt'><span class='literal'>true</span></span></span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='keyword'>char</span><span class='squarebracket'>[</span><span class='literal'>2</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>; <span class='comment'>// error: narrowing conversion of value 2 to type <span id=':bool_'><span class='tcode_in_codeblock'>bool</span></span></span>
<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='keyword'>char</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;    <span class='comment'>// OK, conversion of value 1 to type <span id=':bool__'><span class='tcode_in_codeblock'>bool</span></span> is non-narrowing</span>
</span> â€”&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L750'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>If a declaration of a function
does not have a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier______'><span class='textsf'><i >noexcept-specifier</i></span></span></a>,
the declaration has a potentially throwing exception specification
unless it is a destructor or a deallocation function
or is defaulted on its first declaration,
in which cases the exception specification
is as specified below
and no other declaration for that function
shall have a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier_______'><span class='textsf'><i >noexcept-specifier</i></span></span></a><a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>In an <a href='temp.explicit' title='13.9.3&emsp;Explicit instantiation&emsp;[temp.explicit]'>explicit instantiation</a>
a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier________'><span class='textsf'><i >noexcept-specifier</i></span></span></a> may be specified,
but is not required<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.sentence-3' class='sentence'>If a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier_________'><span class='textsf'><i >noexcept-specifier</i></span></span></a> is specified
in an explicit instantiation,
the exception specification shall be the same as
the exception specification of all other declarations of that function<a class='hidden_link' href='#3.sentence-3'>.</a></div> <div id='3.sentence-4' class='sentence'>A diagnostic is required only if the
exception specifications are not the same
within a single translation unit<a class='hidden_link' href='#3.sentence-4'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L771'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'><a class='index' id=':exception_specification,virtual_function_and'></a>If a virtual function has a
non-throwing exception specification,
all declarations, including the definition, of any function
that overrides that virtual function in any derived class
shall have a non-throwing
exception specification,
unless the overriding function is defined as deleted<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> B <span class='curlybracket'>{</span>
  <span class='keyword'>virtual</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  <span class='keyword'>virtual</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>virtual</span> <span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> D<span class='operator'>:</span> B <span class='curlybracket'>{</span>
  <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                     <span class='comment'>// error</span>
  <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;            <span class='comment'>// OK</span>
  <span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;            <span class='comment'>// OK</span>
<span class='curlybracket'>}</span>;
</span></div><div class='texpara'><div id='4.sentence-2' class='sentence'>The declaration of
<span class='texttt'>D<span class='operator'>&#x200b;::&#x200b;</span>f</span>
is ill-formed because it
has a potentially-throwing exception specification,
whereas
<span class='texttt'>B<span class='operator'>&#x200b;::&#x200b;</span>f</span>
has a non-throwing exception specification<a class='hidden_link' href='#4.sentence-2'>.</a></div> â€”&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L804'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'><a class='index' id=':exception_handling,terminate_called'></a><a class='index' id=':terminate,called'></a>Whenever an exception is thrown
and the search for a handler (<a href='except.handle' title='14.4&emsp;Handling an exception'>[except.<span class='shy'></span>handle]</a>)
encounters the outermost block of a function with a
non-throwing exception specification,
the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='5.sentence-2' class='sentence'>An implementation is not permitted to reject an expression merely because, when
executed, it throws or might
throw an exception from a function with a non-throwing exception specification<a class='hidden_link' href='#5.sentence-2'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div> <div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>extern</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                <span class='comment'>// potentially-throwing</span>

<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span> <span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                          <span class='comment'>// valid, even if <span class='tcode_in_codeblock'>f</span> throws</span>
  <span class='keyword'>throw</span> <span class='literal'>42</span>;                     <span class='comment'>// valid, effectively a call to <span class='tcode_in_codeblock'>std&#x200b;::&#x200b;terminate</span></span>
<span class='curlybracket'>}</span>
</span> <div id='5.sentence-3' class='sentence'>
The call to
<span class='texttt'>f</span>
is well-formed despite the possibility for it to throw an exception<a class='hidden_link' href='#5.sentence-3'>.</a></div> â€”&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L831'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>An expression <span class='math'><span class='mathalpha'>E</span></span> is
<a class='hidden_link' href='#def:potentially-throwing,expression' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='def:potentially-throwing,expression'><i >potentially-throwing</i></span></a> if
<ul class='itemize'><li id='6.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.1'>(6.1)</a></div><span class='math'><span class='mathalpha'>E</span></span> is a <a href='expr.call' title='7.6.1.3&emsp;Function call&emsp;[expr.call]'>function call</a>
whose <a href='expr.post.general#nt:postfix-expression' title='7.6.1.1&emsp;General&emsp;[expr.post.general]'><span id='ntref:postfix-expression'><span class='textsf'><i >postfix-expression</i></span></span></a>
has a function type,
or a pointer-to-function type,
with a potentially-throwing exception specification,
or</li><li id='6.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.2'>(6.2)</a></div><span class='math'><span class='mathalpha'>E</span></span> implicitly invokes a function
(such as an overloaded operator,
an allocation function in a <a href='expr.new#nt:new-expression' title='7.6.2.8&emsp;New&emsp;[expr.new]'><span id='ntref:new-expression'><span class='textsf'><i >new-expression</i></span></span></a>,
a constructor for a function argument,
or a destructor if <span class='math'><span class='mathalpha'>E</span></span> is a <a href='intro.execution#def:full-expression' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'>full-expression</a>)
that has a potentially-throwing exception specification,
or</li><li id='6.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.3'>(6.3)</a></div><span class='math'><span class='mathalpha'>E</span></span> is a <a href='expr.throw#nt:throw-expression' title='7.6.18&emsp;Throwing an exception&emsp;[expr.throw]'><span id='ntref:throw-expression'><span class='textsf'><i >throw-expression</i></span></span></a> (<a href='expr.throw' title='7.6.18&emsp;Throwing an exception'>[expr.<span class='shy'></span>throw]</a>),
or</li><li id='6.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.4'>(6.4)</a></div><span class='math'><span class='mathalpha'>E</span></span> is a <span id=':dynamic_cast'><span class='texttt'><span class='keyword'>dynamic_<span class='shy'></span>cast</span></span></span> expression that casts to a reference type and
requires a runtime check (<a href='expr.dynamic.cast' title='7.6.1.7&emsp;Dynamic cast'>[expr.<span class='shy'></span>dynamic.<span class='shy'></span>cast]</a>),
or</li><li id='6.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.5'>(6.5)</a></div><span class='math'><span class='mathalpha'>E</span></span> is a <span id=':typeid'><span class='texttt'><span class='keyword'>typeid</span></span></span> expression applied to a
(possibly parenthesized) built-in unary <span class='texttt'><span class='operator'>*</span></span> operator
applied to a pointer to a
polymorphic class type (<a href='expr.typeid' title='7.6.1.8&emsp;Type identification'>[expr.<span class='shy'></span>typeid]</a>),
or</li><li id='6.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#6.6'>(6.6)</a></div>any of the <a href='intro.execution#def:immediate_subexpression' title='6.9.1&emsp;Sequential execution&emsp;[intro.execution]'>immediate subexpressions</a>
of <span class='math'><span class='mathalpha'>E</span></span> is potentially-throwing<a class='hidden_link' href='#6.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L868'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'>An implicitly-declared constructor for a class <span class='texttt'>X</span>,
or a constructor without a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier__________'><span class='textsf'><i >noexcept-specifier</i></span></span></a>
that is defaulted on its first declaration,
has a potentially-throwing exception specification
if and only if
any of the following constructs is potentially-throwing:
<ul class='itemize'><li id='7.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.1'>(7.1)</a></div>the invocation of a constructor selected by overload resolution
in the implicit definition of the constructor
for class <span class='texttt'>X</span>
to initialize a potentially constructed subobject, or</li><li id='7.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.2'>(7.2)</a></div>a subexpression of such an initialization,
such as a default argument expression, or,</li><li id='7.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.3'>(7.3)</a></div>for a default constructor, a default member initializer<a class='hidden_link' href='#7.sentence-1'>.</a></li></ul></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='7.sentence-2' class='sentence'>Even though destructors for fully-constructed subobjects
are invoked when an exception is thrown
during the execution of a constructor (<a href='except.ctor' title='14.3&emsp;Constructors and destructors'>[except.<span class='shy'></span>ctor]</a>),
their exception specifications do not contribute
to the exception specification of the constructor,
because an exception thrown from such a destructor
would call the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span>
rather than escape the constructor (<a href='except.throw' title='14.2&emsp;Throwing an exception'>[except.<span class='shy'></span>throw]</a>, <a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#7.sentence-2'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L898'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'>The exception specification for an implicitly-declared destructor,
or a destructor without a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier___________'><span class='textsf'><i >noexcept-specifier</i></span></span></a>,
is potentially-throwing if and only if
any of the destructors
for any of its potentially constructed subobjects
has a potentially-throwing exception specification or
the destructor is virtual and the destructor of any virtual base class
has a potentially-throwing exception specification<a class='hidden_link' href='#8.sentence-1'>.</a></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L908'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'>The exception specification for an implicitly-declared assignment operator,
or an assignment-operator without a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier____________'><span class='textsf'><i >noexcept-specifier</i></span></span></a>
that is defaulted on its first declaration,
is potentially-throwing if and only if
the invocation of any assignment operator
in the implicit definition is potentially-throwing<a class='hidden_link' href='#9.sentence-1'>.</a></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L916'>#</a></div><div class='texpara'><div id='10.sentence-1' class='sentence'>A <a href='basic.stc.dynamic.deallocation' title='6.7.5.5.3&emsp;Deallocation functions&emsp;[basic.stc.dynamic.deallocation]'>deallocation function</a>
with no explicit <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier_____________'><span class='textsf'><i >noexcept-specifier</i></span></span></a>
has a non-throwing exception specification<a class='hidden_link' href='#10.sentence-1'>.</a></div></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L921'>#</a></div><div class='texpara'><div id='11.sentence-1' class='sentence'>The exception specification for a comparison operator function (<a href='over.binary' title='12.4.3&emsp;Binary operators'>[over.<span class='shy'></span>binary]</a>)
without a <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier______________'><span class='textsf'><i >noexcept-specifier</i></span></span></a>
that is defaulted on its first declaration
is potentially-throwing if and only if
any expression
in the implicit definition is potentially-throwing<a class='hidden_link' href='#11.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L929'>#</a></div><div class='texpara'><div id='example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-4'>4</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  A<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span>A<span class='parenthesis'>(</span><span class='literal'>5</span><span class='parenthesis'>)</span>, <span class='literal'>0</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  A<span class='parenthesis'>(</span><span class='keyword'>const</span> A<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  A<span class='parenthesis'>(</span>A<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  <span class='operator'>~</span>A<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span>
  B<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  B<span class='parenthesis'>(</span><span class='keyword'>const</span> B<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>;        <span class='comment'>// implicit exception specification is <span class='tcode_in_codeblock'><span id=':noexcept_____'><span class='tcode_in_codeblock'>noexcept</span></span>(<span id=':true_'><span class='tcode_in_codeblock'>true</span></span>)</span></span>
  B<span class='parenthesis'>(</span>B<span class='operator'>&amp;</span><span class='operator'>&amp;</span>, <span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='keyword'>throw</span> <span class='literal'>42</span>, <span class='literal'>0</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  <span class='operator'>~</span>B<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><span class='literal'>false</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
<span class='keyword'>int</span> n <span class='operator'>=</span> <span class='literal'>7</span>;
<span class='keyword'>struct</span> D <span class='operator'>:</span> <span class='keyword'>public</span> A, <span class='keyword'>public</span> B <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> <span class='operator'>*</span> p <span class='operator'>=</span> <span class='keyword'>new</span> <span class='keyword'>int</span><span class='squarebracket'>[</span>n<span class='squarebracket'>]</span>;
    <span class='comment'>// <span class='tcode_in_codeblock'>D&#x200b;::&#x200b;D()</span> potentially-throwing, as the <span id=':new'><span class='tcode_in_codeblock'>new</span></span> operator may throw <span class='tcode_in_codeblock'>bad_<span class='shy'></span>alloc</span> or <span class='tcode_in_codeblock'>bad_<span class='shy'></span>array_<span class='shy'></span>new_<span class='shy'></span>length</span></span>
    <span class='comment'>// <span class='tcode_in_codeblock'>D&#x200b;::&#x200b;D(const D&amp;)</span> non-throwing</span>
    <span class='comment'>// <span class='tcode_in_codeblock'>D&#x200b;::&#x200b;D(D&amp;&amp;)</span> potentially-throwing, as the default argument for <span class='tcode_in_codeblock'>B</span>'s constructor may throw</span>
    <span class='comment'>// <span class='tcode_in_codeblock'>D&#x200b;::&#x200b;~D()</span> potentially-throwing</span>
<span class='curlybracket'>}</span>;
</span> <div id='12.sentence-1' class='sentence'>
Furthermore, if
<span class='texttt'>A<span class='operator'>&#x200b;::&#x200b;</span><span class='operator'>~</span>A<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
were virtual,
the program would be ill-formed since a function that overrides a virtual
function from a base class
shall not have a potentially-throwing exception specification
if the base class function has a non-throwing exception specification<a class='hidden_link' href='#12.sentence-1'>.</a></div> â€”&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='http://github.com/timsong-cpp/draft/tree/df2e6ff582d09a4100b459399f5f76ad3db5f88f/source/exceptions.tex#L962'>#</a></div><div class='texpara'><div id='13.sentence-1' class='sentence'>An exception specification is considered to be <a class='hidden_link' href='#def:needed,exception_specification' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='def:needed,exception_specification'><i >needed</i></span></a> when:
<ul class='itemize'><li id='13.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#13.1'>(13.1)</a></div>in an expression, the function is selected by
overload resolution (<a href='over.match' title='12.2&emsp;Overload resolution'>[over.<span class='shy'></span>match]</a>, <a href='over.over' title='12.3&emsp;Address of an overload set'>[over.<span class='shy'></span>over]</a>);</li><li id='13.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#13.2'>(13.2)</a></div>the function is odr-used (<a href='basic.def.odr#term.odr.use' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>) or, if it appears in an
unevaluated operand, would be odr-used if the expression were
potentially-evaluated;</li><li id='13.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#13.3'>(13.3)</a></div>the exception specification is compared to that of another
declaration (e.g., an explicit specialization or an overriding virtual
function);</li><li id='13.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#13.4'>(13.4)</a></div>the function is defined; or</li><li id='13.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#13.5'>(13.5)</a></div>the exception specification is needed for a defaulted
function that calls the function<a class='hidden_link' href='#13.sentence-1'>.</a> <div class='texpara'><div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>:&ensp;<div id='13.5.sentence-2' class='sentence'>A defaulted declaration does not require the
exception specification of a base member function to be evaluated
until the implicit exception specification of the derived
function is needed, but an explicit <a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier_______________'><span class='textsf'><i >noexcept-specifier</i></span></span></a> needs
the implicit exception specification to compare against<a class='hidden_link' href='#13.5.sentence-2'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div></div></li></ul></div> <div id='13.sentence-2' class='sentence'>
The exception specification of a defaulted
function is evaluated as described above only when needed; similarly, the
<a href='#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier________________'><span class='textsf'><i >noexcept-specifier</i></span></span></a> of a specialization of a function
template or member function of a class template is instantiated only when
needed<a class='hidden_link' href='#13.sentence-2'>.</a></div> </div></div></div></body></html>