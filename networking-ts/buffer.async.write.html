<!DOCTYPE html><html lang='en'><head><title>[buffer.async.write]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>17</a> Buffer-oriented streams <a class='abbr_ref' href='./#buffer.stream'>[buffer.stream]</a></h1><div id='buffer.async.write'><h2 ><a class='secnum' style='min-width:88pt'>17.8</a> Asynchronous write operations <a class='abbr_ref'>[buffer.async.write]</a></h2><p ><span class='indexparent'><a class='index' id='async_write'></a></span><code class='itemdecl'>
template&lt;class AsyncWriteStream, class ConstBufferSequence, class CompletionToken&gt;
    <span class='DEDUCED'></span> async_write(AsyncWriteStream&amp; stream,
                        const ConstBufferSequence&amp; buffers,
                        CompletionToken&amp;&amp; token);
template&lt;class AsyncWriteStream, class ConstBufferSequence, class CompletionCondition,
         class CompletionToken&gt;
    <span class='DEDUCED'></span> async_write(AsyncWriteStream&amp; stream,
                        const ConstBufferSequence&amp; buffers,
                        CompletionCondition completion_condition,
                        CompletionToken&amp;&amp; token);
</code></p><div class='itemdescr'></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='itemdescr'><p >A composed asynchronous write operation (<a href='async.reqmts.async.composed'>[async.reqmts.async.composed]</a>, <a href='buffer.reqmts.read.write'>[buffer.reqmts.read.write]</a>).</p></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><p ><span class='completionsig'></span> <span class='texttt'>void(error_code ec, size_t n)</span>.</p></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><p ><i>Effects:</i> Initiates an asynchronous operation to write data to the buffer-oriented asynchronous write stream (<a href='buffer.stream.reqmts.asyncwritestream'>[buffer.stream.reqmts.asyncwritestream]</a>) object <span class='texttt'>stream</span> by performing zero or more asynchronous operations on the stream using the stream's <span class='texttt'>async_write_some</span> member function (henceforth referred to as asynchronous write_some operations).</p></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><p >The <span class='texttt'>completion_condition</span> parameter specifies a completion condition to be called prior to each asynchronous write_some operation. The completion condition is passed the <span class='texttt'>error_code</span> value from the most recent asynchronous write_some operation, and the total number of bytes transferred in the asynchronous write operation so far. The completion condition return value specifies the maximum number of bytes to be written on the subsequent asynchronous write_some operation. Overloads where a completion condition is not specified behave as if called with an object of class <span class='texttt'>transfer_all</span>.</p></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><p >The asynchronous write operation continues until:</p><ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.1'>(5.1)</a></div><p >the total number of bytes transferred is equal to <span class='texttt'>buffer_size(buffers)</span>; or
</p></li><li id='5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.2'>(5.2)</a></div><p >the completion condition returns <span class='texttt'>0</span>.
</p></li></ul></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><p >The program shall ensure the <span class='texttt'>AsyncWriteStream</span> object <span class='texttt'>stream</span> is valid until the completion handler for the asynchronous operation is invoked.</p></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><p >On completion of the asynchronous operation, <span class='texttt'>ec</span> is the <span class='texttt'>error_code</span> value from the most recent asynchronous write_some operation, and <span class='texttt'>n</span> is the total number of bytes transferred.</p></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><p ><i>Remarks:</i> This function shall not participate in overload resolution unless <span class='texttt'>is_const_buffer_sequence&lt;ConstBufferSequence&gt;::value</span> is <span class='texttt'>true</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='async_write'></a></span><code class='itemdecl'>
template&lt;class AsyncWriteStream, class DynamicBuffer, class CompletionToken&gt;
  <span class='DEDUCED'></span> async_write(AsyncWriteStream&amp; stream,
                      DynamicBuffer&amp;&amp; b, CompletionToken&amp;&amp; token);
template&lt;class AsyncWriteStream, class DynamicBuffer, class CompletionCondition,
         class CompletionToken&gt;
    <span class='DEDUCED'></span> async_write(AsyncWriteStream&amp; stream,
                        DynamicBuffer&amp;&amp; b,
                        CompletionCondition completion_condition,
                        CompletionToken&amp;&amp; token);
</code></p><div class='itemdescr'></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><p ><span class='completionsig'></span> <span class='texttt'>void(error_code ec, size_t n)</span>.</p></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><p ><i>Effects:</i> Initiates an asynchronous operation to write data to the buffer-oriented asynchronous write stream (<a href='buffer.stream.reqmts.asyncwritestream'>[buffer.stream.reqmts.asyncwritestream]</a>) object <span class='texttt'>stream</span> by performing zero or more asynchronous write_some operations on the stream.</p></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='itemdescr'><p >Data is written from the dynamic buffer (<a href='buffer.reqmts.dynamicbuffer'>[buffer.reqmts.dynamicbuffer]</a>) object <span class='texttt'>b</span>. A constant buffer sequence (<a href='buffer.reqmts.constbuffersequence'>[buffer.reqmts.constbuffersequence]</a>) is obtained using <span class='texttt'>b.data()</span>. After the data has been written to the stream, the implementation performs <span class='texttt'>b.consume(n)</span>, where <span class='texttt'>n</span> is the number of bytes successfully written.</p></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='itemdescr'><p >The <span class='texttt'>completion_condition</span> parameter specifies a completion condition to be called prior to each asynchronous write_some operation. The completion condition is passed the <span class='texttt'>error_code</span> value from the most recent asynchronous write_some operation, and the total number of bytes transferred in the asynchronous write operation so far. The completion condition return value specifies the maximum number of bytes to be written on the subsequent asynchronous write_some operation. Overloads where a completion condition is not specified behave as if called with an object of class <span class='texttt'>transfer_all</span>.</p></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='itemdescr'><p >The asynchronous write operation continues until:</p><ul class='itemize'><li id='13.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#13.1'>(13.1)</a></div><p ><span class='texttt'>b.size() == 0</span>; or
</p></li><li id='13.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#13.2'>(13.2)</a></div><p >the completion condition returns <span class='texttt'>0</span>.
</p></li></ul></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='itemdescr'><p >The program shall ensure both the <span class='texttt'>AsyncWriteStream</span> object <span class='texttt'>stream</span> and the memory associated with the dynamic buffer <span class='texttt'>b</span> are valid until the completion handler for the asynchronous operation is invoked.</p></div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='itemdescr'><p >On completion of the asynchronous operation, <span class='texttt'>ec</span> is the <span class='texttt'>error_code</span> value from the most recent asynchronous write_some operation, and <span class='texttt'>n</span> is the total number of bytes transferred.</p></div></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='itemdescr'><p ><i>Remarks:</i> This function shall not participate in overload resolution unless <span class='texttt'>is_dynamic_buffer_v&lt;DynamicBuffer&gt;</span> is <span class='texttt'>true</span>.
</p></div></div></div></div></body></html>