<!DOCTYPE html><html lang='en'><head><title>[err.report]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><div id='err.report'><h1 ><a class='secnum' style='min-width:73pt'>9</a> Error reporting <a class='abbr_ref' href='./#err.report'>[err.report]</a></h1><div id='sync'><h2 ><a class='secnum' href='#sync' style='min-width:88pt'>9.1</a> Synchronous operations <a class='abbr_ref' href='err.report.sync'>[err.report.sync]</a></h2><div class='para' id='sync-1'><div class='marginalizedparent'><a class='marginalized' href='#sync-1'>1</a></div><p >Most synchronous network library functions provide two overloads, one that throws an exception to report system errors, and another that sets an <span class='texttt'>error_code</span> (C++Std &sect;<a href='../n4140/syserr'>[syserr]</a>).</p><p >[&nbsp;<i>Note:</i> This supports two common use cases:
</p><ul class='itemize'><li id='sync-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sync-1.1'>(1.1)</a></div><p >Uses where system errors are truly exceptional and indicate a serious failure. Throwing an exception is the most appropriate response.
</p></li><li id='sync-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sync-1.2'>(1.2)</a></div><p >Uses where system errors are routine and do not necessarily represent failure. Returning an error code is the most appropriate response. This allows application specific error handling, including simply ignoring the error.
</p></li></ul><p ><i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></div><div class='para' id='sync-2'><div class='marginalizedparent'><a class='marginalized' href='#sync-2'>2</a></div><p >Functions not having an argument of type <span class='texttt'>error_code&amp;</span> report errors as follows, unless otherwise specified:</p><ul class='itemize'><li id='sync-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sync-2.1'>(2.1)</a></div><p >When a call by the implementation to an operating system or other underlying API results in an error that prevents the function from meeting its specifications, the function exits via an exception of a type that would match a handler of type <span class='texttt'>system_error</span>.</p></li><li id='sync-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sync-2.2'>(2.2)</a></div><p >Destructors throw nothing.
</p></li></ul></div><div class='para' id='sync-3'><div class='marginalizedparent'><a class='marginalized' href='#sync-3'>3</a></div><p >Functions having an argument of type <span class='texttt'>error_code&amp;</span> report errors as follows, unless otherwise specified:</p><ul class='itemize'><li id='sync-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sync-3.1'>(3.1)</a></div><p >If a call by the implementation to an operating system or other underlying API results in an error that prevents the function from meeting its specifications, the <span class='texttt'>error_code&amp;</span> argument <span class='texttt'>ec</span> is set as appropriate for the specific error. Otherwise, the <span class='texttt'>ec</span> argument is set such that <span class='texttt'>!ec</span> is <span class='texttt'>true</span>.
</p></li></ul></div><div class='para' id='sync-4'><div class='marginalizedparent'><a class='marginalized' href='#sync-4'>4</a></div><p >Where a function is specified as two overloads, with and without an argument of type <span class='texttt'>error_code&amp;</span>:</p><pre class='codeblock'>
<i>R f</i>(<i>A1</i> a1, <i>A2</i> a2, ..., <i>AN</i> aN);
<i>R f</i>(<i>A1</i> a1, <i>A2</i> a2, ..., <i>AN</i> aN, error_code&amp; ec);
</pre></div><div class='para' id='sync-5'><div class='marginalizedparent'><a class='marginalized' href='#sync-5'>5</a></div><p >then, when R is non-<span class='texttt'>void</span>, the effects of the first overload are as if:</p><pre class='codeblock'>
error_code ec;
<i>R</i> r(<i>f</i>(a1, a2, ..., aN, ec));
if (ec) throw system_error(ec, S);
return r;
</pre></div><div class='para' id='sync-6'><div class='marginalizedparent'><a class='marginalized' href='#sync-6'>6</a></div><p >otherwise, when R is <span class='texttt'>void</span>, the effects of the first overload are as if:</p><pre class='codeblock'>
error_code ec;
<i>f</i>(a1, a2, ..., aN, ec);
if (ec) throw system_error(ec, S);
</pre></div><div class='para' id='sync-7'><div class='marginalizedparent'><a class='marginalized' href='#sync-7'>7</a></div><p >except that the type thrown may differ as specified above. <span class='texttt'>S</span> is an <span class='textsc'>ntbs</span> indicating where the exception was thrown. [&nbsp;<i>Note:</i> A possible value for <span class='texttt'>S</span> is <span class='texttt'>__func__</span>. <i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></div><div class='para' id='sync-8'><div class='marginalizedparent'><a class='marginalized' href='#sync-8'>8</a></div><p >For both overloads, failure to allocate storage is reported by throwing an exception as described in the C++ standard (C++Std &sect;<a href='../n4140/res.on.exception.handling'>[res.on.exception.handling]</a>).</p></div><div class='para' id='sync-9'><div class='marginalizedparent'><a class='marginalized' href='#sync-9'>9</a></div><p >In this Technical Specification, when a type requirement is specified using two function call expressions <i>f</i>, with and without an argument <span class='texttt'>ec</span> of type <span class='texttt'>error_code</span>:</p><pre class='codeblock'>
<i>f</i>(a1, a2, ..., aN)
<i>f</i>(a1, a2, ..., aN, ec)
</pre><p >then the effects of the first call expression of <i>f</i> shall be as described for the first overload above.</p></div></div><div id='async'><h2 ><a class='secnum' href='#async' style='min-width:88pt'>9.2</a> Asynchronous operations <a class='abbr_ref' href='err.report.async'>[err.report.async]</a></h2><div class='para' id='async-1'><div class='marginalizedparent'><a class='marginalized' href='#async-1'>1</a></div><p >Asynchronous network library functions in this Technical Specification are identified by having the prefix <span class='texttt'>async_</span> and take a completion handler <a href='async.reqmts.async.token'>[async.reqmts.async.token]</a>. These asynchronous operations report errors as follows:</p><ul class='itemize'><li id='async-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#async-1.1'>(1.1)</a></div><p >If a call by the implementation to an operating system or other underlying API results in an error that prevents the asynchronous operation from meeting its specifications, the completion handler is invoked with an <span class='texttt'>error_code</span> value <span class='texttt'>ec</span> that is set as appropriate for the specific error. Otherwise, the <span class='texttt'>error_code</span> value <span class='texttt'>ec</span> is set such that <span class='texttt'>!ec</span> is <span class='texttt'>true</span>.</p></li><li id='async-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#async-1.2'>(1.2)</a></div><p >Asynchronous operations shall not fail with an error condition that indicates interruption of an operating system or underlying API by a signal. [&nbsp;<i>Note:</i> Such as POSIX error number <span class='texttt'>EINTR</span> <i>&nbsp;—&nbsp;end note</i>&nbsp;] Asynchronous operations shall not fail with any error condition associated with non-blocking operations. [&nbsp;<i>Note:</i> Such as POSIX error numbers <span class='texttt'>EWOULDBLOCK</span>, <span class='texttt'>EAGAIN</span>, or <span class='texttt'>EINPROGRESS</span>; Windows error numbers <span class='texttt'>WSAEWOULDBLOCK</span> or <span class='texttt'>WSAEINPROGRESS</span> <i>&nbsp;—&nbsp;end note</i>&nbsp;]
</p></li></ul></div><div class='para' id='async-2'><div class='marginalizedparent'><a class='marginalized' href='#async-2'>2</a></div><p >In this Technical Specification, when a type requirement is specified as a call to a function or member function having the prefix <span class='texttt'>async_</span>, then the function shall satisfy the error reporting requirements described above.</p></div></div><div id='conditions'><h2 ><a class='secnum' href='#conditions' style='min-width:88pt'>9.3</a> Error conditions <a class='abbr_ref' href='err.report.conditions'>[err.report.conditions]</a></h2><div class='para' id='conditions-1'><div class='marginalizedparent'><a class='marginalized' href='#conditions-1'>1</a></div><p >Unless otherwise specified, when the behavior of a synchronous or asynchronous operation is defined “as if” implemented by a POSIX function, the <span class='texttt'>error_code</span> produced by the function shall meet the following requirements:</p><ul class='itemize'><li id='conditions-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#conditions-1.1'>(1.1)</a></div><p >If the failure condition is one that is listed by POSIX for that function, the <span class='texttt'>error_code</span> shall compare equal to the error's corresponding <span class='texttt'>enum class errc</span> (C++Std &sect;<a href='../n4140/syserr'>[syserr]</a>) or <span class='texttt'>enum class resolver_errc</span> (<a href='internet.resolver.err'>[internet.resolver.err]</a>) constant.</p></li><li id='conditions-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#conditions-1.2'>(1.2)</a></div><p >Otherwise, the <span class='texttt'>error_code</span> shall be set to an implementation-defined value that reflects the underlying operating system error.
</p></li></ul></div><div class='para' id='conditions-2'><div class='marginalizedparent'><a class='marginalized' href='#conditions-2'>2</a></div><p >[&nbsp;<i>Example:</i> The POSIX specification for <span class='texttt'>shutdown</span> lists <span class='texttt'>EBADF</span> as one of its possible errors. If a function that is specified “as if” implemented by <span class='texttt'>shutdown</span> fails with <span class='texttt'>EBADF</span> then the following condition holds for the <span class='texttt'>error_code</span> value <span class='texttt'>ec</span>: <span class='texttt'>ec == errc::bad_file_descriptor</span> <i>&nbsp;—&nbsp;end example</i>&nbsp;]</p></div><div class='para' id='conditions-3'><div class='marginalizedparent'><a class='marginalized' href='#conditions-3'>3</a></div><p >When the description of a function contains the element Error conditions, this lists conditions where the operation may fail. The conditions are listed, together with a suitable explanation, as <span class='texttt'>enum class</span> constants. Unless otherwise specified, this list is a subset of the failure conditions associated with the function.</p></div></div><div id='signal'><h2 ><a class='secnum' href='#signal' style='min-width:88pt'>9.4</a> Suppression of signals <a class='abbr_ref' href='err.report.signal'>[err.report.signal]</a></h2><div class='para' id='signal-1'><div class='marginalizedparent'><a class='marginalized' href='#signal-1'>1</a></div><p >Some POSIX functions referred to in this Technical Specification may report errors by raising a <span class='texttt'>SIGPIPE</span> signal. Where a synchronous or asynchronous operation is specified in terms of these POSIX functions, the generation of <span class='texttt'>SIGPIPE</span> is suppressed and an error condition corresponding to POSIX <span class='texttt'>EPIPE</span> is produced instead.</p></div></div></div></div></body></html>