<!DOCTYPE html><html lang='en'><head><title>[temp.class.spec.match]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>14</a> Templates <a class='abbr_ref' href='./#temp'>[temp]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>14.5</a> Template declarations <a class='abbr_ref' href='temp.decls#temp.class.spec.match'>[temp.decls]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>14.5.5</a> Class template partial specializations <a class='abbr_ref' href='temp.class.spec#match'>[temp.class.spec]</a></h3><div id='temp.class.spec.match'><h4 ><a class='secnum' style='min-width:118pt'>14.5.5.1</a> Matching of class template partial specializations <a class='abbr_ref'>[temp.class.spec.match]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/08fda7e637d27fa331a8fcfc64db98d52ae3b6fd/source/templates.tex#L2343'>#</a></div><p >When a class template is used in a context that requires an instantiation of
the class,
it is necessary to determine whether the instantiation is to be generated
using the primary template or one of the partial specializations.
This is done by matching the template arguments of the class template
specialization with the template argument lists of the partial
specializations.</p><ul class='itemize'><li id='1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.1'>(1.1)</a></div><p >If exactly one matching specialization is found, the instantiation is
generated from that specialization.
</p></li><li id='1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.2'>(1.2)</a></div><p >If more than one matching specialization is found,
the partial order rules (<a href='temp.class.order'>[temp.class.order]</a>) are used to determine
whether one of the specializations is more specialized than the
others.
If none of the specializations is more specialized than all of the
other matching specializations, then the use of the class template
is ambiguous and the program is ill-formed.
</p></li><li id='1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.3'>(1.3)</a></div><p >If no matches are found, the instantiation is generated from the
primary template.
</p></li></ul></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/08fda7e637d27fa331a8fcfc64db98d52ae3b6fd/source/templates.tex#L2369'>#</a></div><p >A partial specialization matches a given actual template argument
list if the template arguments of the partial specialization can be
deduced from the actual template argument list (<a href='temp.deduct'>[temp.deduct]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><i>Example:</i></p><pre class='codeblock'>
template&lt;class T1, class T2, int I&gt; class A             { };    <span class='comment'>// #1
</span>template&lt;class T, int I&gt;            class A&lt;T, T*, I&gt;   { };    <span class='comment'>// #2
</span>template&lt;class T1, class T2, int I&gt; class A&lt;T1*, T2, I&gt; { };    <span class='comment'>// #3
</span>template&lt;class T&gt;                   class A&lt;int, T*, 5&gt; { };    <span class='comment'>// #4
</span>template&lt;class T1, class T2, int I&gt; class A&lt;T1, T2*, I&gt; { };    <span class='comment'>// #5
</span>
A&lt;int, int, 1&gt;   a1;            <span class='comment'>// uses #1
</span>A&lt;int, int*, 1&gt;  a2;            <span class='comment'>// uses #2, <span class='texttt'>T</span> is <span class='texttt'>int</span>, <span class='texttt'>I</span> is <span class='texttt'>1</span>
</span>A&lt;int, char*, 5&gt; a3;            <span class='comment'>// uses #4, <span class='texttt'>T</span> is <span class='texttt'>char</span>
</span>A&lt;int, char*, 1&gt; a4;            <span class='comment'>// uses #5, <span class='texttt'>T1</span> is <span class='texttt'>int</span>, <span class='texttt'>T2</span> is <span class='texttt'>char</span>, <span class='texttt'>I</span> is <span class='texttt'>1</span>
</span>A&lt;int*, int*, 2&gt; a5;            <span class='comment'>// ambiguous: matches #3 and #5
</span></pre><p ><i><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</i><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/08fda7e637d27fa331a8fcfc64db98d52ae3b6fd/source/templates.tex#L2390'>#</a></div><p >If the template arguments of a partial specialization cannot be deduced
because of the structure of its <i ><a href='temp#nt:template-parameter-list'>template-parameter-list</a></i>
and the <i ><a href='temp.names#nt:template-id'>template-id</a></i>,
the program is ill-formed.
[<span style='white-space:nowrap'>&thinsp;</span><i>Example:</i>
</p><pre class='codeblock'>
template &lt;int I, int J&gt; struct A {};
template &lt;int I&gt; struct A&lt;I+5, I*2&gt; {};     <span class='comment'>// error
</span>
template &lt;int I&gt; struct A&lt;I, I&gt; {};         <span class='comment'>// OK
</span>
template &lt;int I, int J, int K&gt; struct B {};
template &lt;int I&gt; struct B&lt;I, I*2, 2&gt; {};    <span class='comment'>// OK
</span></pre><p ><i><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</i><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/08fda7e637d27fa331a8fcfc64db98d52ae3b6fd/source/templates.tex#L2407'>#</a></div><p >In a type name that refers to a class template specialization, (e.g.,
<span class='texttt'>A&lt;int, int, 1&gt;</span>)
the argument list shall match the template parameter list of the primary
template.
The template arguments of a specialization are deduced from the arguments
of the primary template.</p></div></div></div></body></html>