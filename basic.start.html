<!DOCTYPE html><html lang='en'><head><title>[basic.start]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>6.10</a> Program execution <a class='abbr_ref' href='basic.exec#basic.start'>[basic.exec]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>6.10.3</a> Start and termination <a class='abbr_ref'>[basic.start]</a></h3><hr><h4 ><a class='secnum' style='min-width:95pt'>6.10.3.1</a> <span class='texttt'>main</span> function <a class='abbr_ref' href='#main'>[basic.<span class='shy'></span>start.<span class='shy'></span>main]</a><div style='clear:right'></div></h4><h4 ><a class='secnum' style='min-width:95pt'>6.10.3.2</a> Static initialization <a class='abbr_ref' href='#static'>[basic.<span class='shy'></span>start.<span class='shy'></span>static]</a><div style='clear:right'></div></h4><h4 ><a class='secnum' style='min-width:95pt'>6.10.3.3</a> Dynamic initialization of non-block variables <a class='abbr_ref' href='#dynamic'>[basic.<span class='shy'></span>start.<span class='shy'></span>dynamic]</a><div style='clear:right'></div></h4><h4 ><a class='secnum' style='min-width:95pt'>6.10.3.4</a> Termination <a class='abbr_ref' href='#term'>[basic.<span class='shy'></span>start.<span class='shy'></span>term]</a><div style='clear:right'></div></h4><hr><div id='main' class='section'><h4 ><a class='secnum' href='#main' style='min-width:50pt'>6.10.3.1</a> <span class='texttt'>main</span> function <a class='abbr_ref' href='basic.start.main'>[basic.start.main]</a></h4></div><div class='texpara'><a class='index' id=':main_function'></a></div><div class='para' id='main-1'><div class='marginalizedparent'><a class='marginalized' href='#main-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7184'>#</a></div><div class='texpara'><div id='main-1.sentence-1' class='sentence'><a class='index' id=':program,startup'></a>A program shall contain exactly one function called <span class='texttt'>main</span>
that belongs to the global scope<a class='hidden_link' href='#main-1.sentence-1'>.</a></div> <div id='main-1.sentence-2' class='sentence'>Executing a program starts a main thread of execution (<a href='intro.multithread' title='6.10.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>, <a href='thread.threads' title='32.4&emsp;Threads'>[thread.<span class='shy'></span>threads]</a>)
in which the <span class='texttt'>main</span> function is invoked<a class='hidden_link' href='#main-1.sentence-2'>.</a></div> <div id='main-1.sentence-3' class='sentence'><a class='index' id=':implementation,freestanding'></a>It is <a class='index' id=':defining_main_in_freestanding_environment'></a>implementation-defined
whether a program in a freestanding environment is required to define a <span class='texttt'>main</span>
function<a class='hidden_link' href='#main-1.sentence-3'>.</a></div> <div id='main-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#main-note-1'>1</a></i>:&ensp;<div id='main-1.sentence-4' class='sentence'>In a freestanding environment, startup and termination is
<a class='index' id=':startup_and_termination_in_freestanding_environment'></a>implementation-defined; startup contains the
execution of constructors for non-local objects with static storage duration;
termination contains the execution of destructors for objects with static storage
duration<a class='hidden_link' href='#main-1.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='main-2'><div class='marginalizedparent'><a class='marginalized' href='#main-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7202'>#</a></div><div class='texpara'><div id='main-2.sentence-1' class='sentence'>An implementation shall not predefine the <span class='texttt'>main</span> function<a class='hidden_link' href='#main-2.sentence-1'>.</a></div> <div id='main-2.sentence-2' class='sentence'>Its type shall have C++ language linkage
and it shall have a declared return type of type
<span id=':int'><span class='texttt'><span class='keyword'>int</span></span></span>, but otherwise its type is <a class='index' id=':parameters_to_main'></a>implementation-defined<a class='hidden_link' href='#main-2.sentence-2'>.</a></div> <div id='main-2.sentence-3' class='sentence'><a class='index' id=':main_function,implementation-defined_parameters_to'></a>An implementation shall allow both
<ul class='itemize'><li id='main-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#main-2.1'>(2.1)</a></div>an “optionally <span class='texttt'><span class='keyword'>noexcept</span></span> function of
<span class='texttt'><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returning <span id=':int_'><span class='texttt'><span class='keyword'>int</span></span></span>” and</li><li id='main-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#main-2.2'>(2.2)</a></div>an “optionally <span class='texttt'><span class='keyword'>noexcept</span></span> function of
<span class='texttt'><span class='parenthesis'>(</span><span id=':int__'><span class='texttt'><span class='keyword'>int</span></span></span></span>, pointer to pointer to <span class='texttt'><span id=':char'><span class='texttt'><span class='keyword'>char</span></span></span><span class='parenthesis'>)</span></span>
returning <span id=':int___'><span class='texttt'><span class='keyword'>int</span></span></span>”</li></ul>
<a class='index' id=':argc'></a><a class='index' id=':argv'></a>as the type of <span class='texttt'>main</span> (<a href='dcl.fct' title='9.3.4.6&emsp;Functions'>[dcl.<span class='shy'></span>fct]</a>)<a class='hidden_link' href='#main-2.sentence-3'>.</a></div> <div id='main-2.sentence-4' class='sentence'><a class='index' id=':main_function,parameters_to'></a><a class='index' id=':environment,program'></a>In the latter form, for purposes of exposition, the first function
parameter is called <span class='texttt'>argc</span> and the second function parameter is
called <span class='texttt'>argv</span>, where <span class='texttt'>argc</span> shall be the number of
arguments passed to the program from the environment in which the
program is run<a class='hidden_link' href='#main-2.sentence-4'>.</a></div> <div id='main-2.sentence-5' class='sentence'>If
<span class='texttt'>argc</span> is nonzero these arguments shall be supplied in
<span class='texttt'>argv<span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span></span> through <span class='texttt'>argv<span class='squarebracket'>[</span>argc <span class='operator'>-</span> <span class='literal'>1</span><span class='squarebracket'>]</span></span> as pointers to the initial
characters of null-terminated multibyte strings (<span class='textsc'>ntmbs</span>s) (<a href='multibyte.strings' title='16.3.3.3.4.3&emsp;Multibyte strings'>[multibyte.<span class='shy'></span>strings]</a>)
and <span class='texttt'>argv<span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span></span> shall be the pointer to
the initial character of an <span class='textsc'>ntmbs</span> that represents the name used to
invoke the program or <span class='texttt'><span class='literal'>""</span></span><a class='hidden_link' href='#main-2.sentence-5'>.</a></div> <div id='main-2.sentence-6' class='sentence'>The value of <span class='texttt'>argc</span> shall be
non-negative<a class='hidden_link' href='#main-2.sentence-6'>.</a></div> <div id='main-2.sentence-7' class='sentence'>The value of <span class='texttt'>argv<span class='squarebracket'>[</span>argc<span class='squarebracket'>]</span></span> shall be 0<a class='hidden_link' href='#main-2.sentence-7'>.</a></div></div><div class='texpara'><div id='main-2.sentence-8' class='sentence'><i >Recommended practice</i>: Any further (optional) parameters should be added after <span class='texttt'>argv</span><a class='hidden_link' href='#main-2.sentence-8'>.</a></div></div></div><div class='para' id='main-3'><div class='marginalizedparent'><a class='marginalized' href='#main-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7239'>#</a></div><div class='texpara'><div id='main-3.sentence-1' class='sentence'>The function <span class='texttt'>main</span> shall not be named by an expression<a class='hidden_link' href='#main-3.sentence-1'>.</a></div> <div id='main-3.sentence-2' class='sentence'><a class='index' id=':main_function,implementation-defined_linkage_of'></a>The linkage (<a href='basic.link' title='6.7&emsp;Program and linkage'>[basic.<span class='shy'></span>link]</a>) of <span class='texttt'>main</span> is
<a class='index' id=':linkage_of_main'></a>implementation-defined<a class='hidden_link' href='#main-3.sentence-2'>.</a></div> <div id='main-3.sentence-3' class='sentence'>A program that defines <span class='texttt'>main</span> as
deleted or that declares <span class='texttt'>main</span> to be
<span id=':inline'><span class='texttt'><span class='keyword'>inline</span></span></span>, <span id=':static'><span class='texttt'><span class='keyword'>static</span></span></span>, <span id=':constexpr'><span class='texttt'><span class='keyword'>constexpr</span></span></span>, or <span id=':consteval'><span class='texttt'><span class='keyword'>consteval</span></span></span> is ill-formed<a class='hidden_link' href='#main-3.sentence-3'>.</a></div> <div id='main-3.sentence-4' class='sentence'>The function <span class='texttt'>main</span> shall not be a coroutine (<a href='dcl.fct.def.coroutine' title='9.6.4&emsp;Coroutine definitions'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>def.<span class='shy'></span>coroutine]</a>)<a class='hidden_link' href='#main-3.sentence-4'>.</a></div> <div id='main-3.sentence-5' class='sentence'>The <span class='texttt'>main</span> function shall not be declared with a
<a href='dcl.link#nt:linkage-specification' title='9.12&emsp;Linkage specifications&emsp;[dcl.link]'><span id='ntref:linkage-specification'><span class='textsf'><i >linkage-specification</i></span></span></a> (<a href='dcl.link' title='9.12&emsp;Linkage specifications'>[dcl.<span class='shy'></span>link]</a>) other than <span class='texttt'><span class='literal'>"C++"</span></span><a class='hidden_link' href='#main-3.sentence-5'>.</a></div> <div id='main-3.sentence-6' class='sentence'>A program that declares
<ul class='itemize'><li id='main-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#main-3.1'>(3.1)</a></div>a variable <span class='texttt'>main</span> that belongs to the global scope, or</li><li id='main-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#main-3.2'>(3.2)</a></div>a function <span class='texttt'>main</span> that belongs to the global scope and
is attached to a named module, or</li><li id='main-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#main-3.3'>(3.3)</a></div>a function template <span class='texttt'>main</span> that belongs to the global scope, or</li><li id='main-3.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#main-3.4'>(3.4)</a></div>an entity named <span class='texttt'>main</span>
with C language linkage (in any namespace)</li></ul>
is ill-formed<a class='hidden_link' href='#main-3.sentence-6'>.</a></div> <div id='main-3.sentence-7' class='sentence'>The name <span class='texttt'>main</span> is
not otherwise reserved<a class='hidden_link' href='#main-3.sentence-7'>.</a></div> <div id='main-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#main-example-1'>1</a></i>:&ensp;<div id='main-3.sentence-8' class='sentence'>Member functions, classes, and
enumerations can be called <span class='texttt'>main</span>, as can entities in other
namespaces<a class='hidden_link' href='#main-3.sentence-8'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='main-4'><div class='marginalizedparent'><a class='marginalized' href='#main-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7271'>#</a></div><div class='texpara'><div id='main-4.sentence-1' class='sentence'><a class='index' id=':exit'></a><a class='index' id='lib:exit'></a><a class='index' id=':termination,program'></a>Terminating the program
without leaving the current block (e.g., by calling the function
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span></span> (<a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>)) does not destroy any
objects with automatic storage duration (<a href='class.dtor' title='11.4.7&emsp;Destructors'>[class.<span class='shy'></span>dtor]</a>)<a class='hidden_link' href='#main-4.sentence-1'>.</a></div> <div id='main-4.sentence-2' class='sentence'>If
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> is invoked during the destruction of
an object with static or thread storage duration, the program has undefined
behavior<a class='hidden_link' href='#main-4.sentence-2'>.</a></div></div></div><div class='para' id='main-5'><div class='marginalizedparent'><a class='marginalized' href='#main-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7283'>#</a></div><div class='texpara'><div id='main-5.sentence-1' class='sentence'><a class='index' id=':termination,program_'></a><a class='index' id=':main_function,return_from'></a>A <span id=':return'><span class='texttt'><span class='keyword'>return</span></span></span> statement (<a href='stmt.return' title='8.8.4&emsp;The return statement'>[stmt.<span class='shy'></span>return]</a>) in <span class='texttt'>main</span> has the effect of leaving the <span class='texttt'>main</span>
function (destroying any objects with automatic storage duration
and evaluating any postcondition assertions of <span class='texttt'>main</span>)
and calling <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> with the return value as the argument<a class='hidden_link' href='#main-5.sentence-1'>.</a></div> <div id='main-5.sentence-2' class='sentence'>If control flows off the end of
the <a href='stmt.block#nt:compound-statement' title='8.4&emsp;Compound statement or block&emsp;[stmt.block]'><span id='ntref:compound-statement'><span class='textsf'><i >compound-statement</i></span></span></a> of <span class='texttt'>main</span>,
the effect is equivalent to a <span id=':return_'><span class='texttt'><span class='keyword'>return</span></span></span> with operand <span class='texttt'><span class='literal'>0</span></span>
(see also <a href='except.handle' title='14.4&emsp;Handling an exception'>[except.<span class='shy'></span>handle]</a>)<a class='hidden_link' href='#main-5.sentence-2'>.</a></div> </div></div><div id='static' class='section'><h4 ><a class='secnum' href='#static' style='min-width:50pt'>6.10.3.2</a> Static initialization <a class='abbr_ref' href='basic.start.static'>[basic.start.static]</a></h4></div><div class='para' id='static-1'><div class='marginalizedparent'><a class='marginalized' href='#static-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7298'>#</a></div><div class='texpara'><div id='static-1.sentence-1' class='sentence'><a class='index' id=':initialization'></a><a class='index' id=':initialization,static_and_thread'></a>Variables with static storage duration
are initialized as a consequence of program initiation<a class='hidden_link' href='#static-1.sentence-1'>.</a></div> <div id='static-1.sentence-2' class='sentence'>Variables with
thread storage duration are initialized as a consequence of thread execution<a class='hidden_link' href='#static-1.sentence-2'>.</a></div> <div id='static-1.sentence-3' class='sentence'>Within each of these phases of initiation, initialization occurs as follows<a class='hidden_link' href='#static-1.sentence-3'>.</a></div></div></div><div class='para' id='static-2'><div class='marginalizedparent'><a class='marginalized' href='#static-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7306'>#</a></div><div class='texpara'><div id='static-2.sentence-1' class='sentence'><a class='index' id=':initialization,constant'></a><a class='hidden_link' href='#def:constant_initialization' title='6.10.3.2&emsp;Static initialization&emsp;[basic.start.static]'><span id='def:constant_initialization'><i >Constant initialization</i></span></a> is performed
if a variable with static or thread storage duration
is constant-initialized (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>)<a class='hidden_link' href='#static-2.sentence-1'>.</a></div> <div id='static-2.sentence-2' class='sentence'><a class='index' id=':initialization,zero-initialization'></a>If constant initialization is not performed, a variable with static
storage duration (<a href='basic.stc.static' title='6.8.6.2&emsp;Static storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>static]</a>) or thread storage
duration (<a href='basic.stc.thread' title='6.8.6.3&emsp;Thread storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>thread]</a>) is zero-initialized (<a href='dcl.init' title='9.5&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)<a class='hidden_link' href='#static-2.sentence-2'>.</a></div> <div id='static-2.sentence-3' class='sentence'>Together, zero-initialization and constant initialization are called
<a class='hidden_link' href='#def:initialization,static' title='6.10.3.2&emsp;Static initialization&emsp;[basic.start.static]'><span id='def:initialization,static'><i >static initialization</i></span></a>;
all other initialization is <a class='hidden_link' href='#def:initialization,dynamic' title='6.10.3.2&emsp;Static initialization&emsp;[basic.start.static]'><span id='def:initialization,dynamic'><i >dynamic initialization</i></span></a><a class='hidden_link' href='#static-2.sentence-3'>.</a></div> <div id='static-2.sentence-4' class='sentence'>All static initialization strongly happens before (<a href='intro.races' title='6.10.2.2&emsp;Data races'>[intro.<span class='shy'></span>races]</a>)
any dynamic initialization<a class='hidden_link' href='#static-2.sentence-4'>.</a></div> <div id='static-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#static-note-1'>1</a></i>:&ensp;<div id='static-2.sentence-5' class='sentence'>The dynamic initialization of non-block variables is described
in <a href='#dynamic' title='6.10.3.3&emsp;Dynamic initialization of non-block variables'>[basic.<span class='shy'></span>start.<span class='shy'></span>dynamic]</a>; that of static block variables is described
in <a href='stmt.dcl' title='8.10&emsp;Declaration statement'>[stmt.<span class='shy'></span>dcl]</a><a class='hidden_link' href='#static-2.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='static-3'><div class='marginalizedparent'><a class='marginalized' href='#static-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7326'>#</a></div><div class='texpara'><div id='static-3.sentence-1' class='sentence'>An implementation is permitted to perform the initialization of a
variable with static or thread storage duration as a static
initialization even if such initialization is not required to be done
statically, provided that
<ul class='itemize'><li id='static-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#static-3.1'>(3.1)</a></div>the dynamic version of the initialization does not change the
value of any other object of static or thread storage duration
prior to its initialization, and</li><li id='static-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#static-3.2'>(3.2)</a></div>the static version of the initialization produces the same value
in the initialized variable as would be produced by the dynamic
initialization if all variables not required to be initialized statically
were initialized dynamically<a class='hidden_link' href='#static-3.sentence-1'>.</a></li></ul></div> <div id='static-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#static-note-2'>2</a></i>:&ensp;<div id='static-3.sentence-2' class='sentence'>As a consequence, if the initialization of an object <span class='texttt'>obj1</span> refers to an
object <span class='texttt'>obj2</span> potentially requiring dynamic initialization and defined
later in the same translation unit, it is unspecified whether the value of <span class='texttt'>obj2</span> used
will be the value of the fully initialized <span class='texttt'>obj2</span> (because <span class='texttt'>obj2</span> was statically
initialized) or will be the value of <span class='texttt'>obj2</span> merely zero-initialized<a class='hidden_link' href='#static-3.sentence-2'>.</a></div> <div id='static-3.sentence-3' class='sentence'>For example,
<span class='codeblock'><span class='keyword'>inline</span> <span class='keyword'>double</span> fd<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>1.0</span>; <span class='curlybracket'>}</span>
<span class='keyword'>extern</span> <span class='keyword'>double</span> d1;
<span class='keyword'>double</span> d2 <span class='operator'>=</span> d1;     <span class='comment'>// unspecified:</span>
                    <span class='comment'>// either statically initialized to <span class='tcode_in_codeblock'>0.0</span> or</span>
                    <span class='comment'>// dynamically initialized to <span class='tcode_in_codeblock'>0.0</span> if <span class='tcode_in_codeblock'>d1</span> is</span>
                    <span class='comment'>// dynamically initialized, or <span class='tcode_in_codeblock'>1.0</span> otherwise</span>
<span class='keyword'>double</span> d1 <span class='operator'>=</span> fd<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;   <span class='comment'>// either initialized statically or dynamically to <span class='tcode_in_codeblock'>1.0</span></span>
</span></div> —&nbsp;<i>end note</i>]</div></div></div></div><div id='dynamic' class='section'><h4 ><a class='secnum' href='#dynamic' style='min-width:50pt'>6.10.3.3</a> Dynamic initialization of non-block variables <a class='abbr_ref' href='basic.start.dynamic'>[basic.start.dynamic]</a></h4></div><div class='para' id='dynamic-1'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7362'>#</a></div><div class='texpara'><div id='dynamic-1.sentence-1' class='sentence'><a class='index' id=':initialization,dynamic_non-block'></a><a class='index' id=':start,program'></a><a class='index' id=':initialization,order_of'></a>Dynamic initialization of a non-block variable with static storage duration is
unordered if the variable is an implicitly or explicitly instantiated
specialization, is partially-ordered if the variable
is an inline variable that is not an implicitly or explicitly instantiated
specialization, and otherwise is ordered<a class='hidden_link' href='#dynamic-1.sentence-1'>.</a></div> <div id='dynamic-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#dynamic-note-1'>1</a></i>:&ensp;<div id='dynamic-1.sentence-2' class='sentence'>A non-inline explicit specialization of a templated variable
has ordered initialization<a class='hidden_link' href='#dynamic-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='dynamic-2'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7376'>#</a></div><div class='texpara'><div id='dynamic-2.sentence-1' class='sentence'>A declaration <span class='texttt'>D</span> is
<a class='hidden_link' href='#def:appearance-ordered' title='6.10.3.3&emsp;Dynamic initialization of non-block variables&emsp;[basic.start.dynamic]'><span id='def:appearance-ordered'><i >appearance-ordered</i></span></a> before a declaration <span class='texttt'>E</span> if
<ul class='itemize'><li id='dynamic-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#dynamic-2.1'>(2.1)</a></div><span class='texttt'>D</span> appears in the same translation unit as <span class='texttt'>E</span>, or</li><li id='dynamic-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#dynamic-2.2'>(2.2)</a></div>the translation unit containing <span class='texttt'>E</span>
has an interface dependency on the translation unit containing <span class='texttt'>D</span>,</li></ul>
in either case prior to <span class='texttt'>E</span><a class='hidden_link' href='#dynamic-2.sentence-1'>.</a></div></div></div><div class='para' id='dynamic-3'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7386'>#</a></div><div class='texpara'><div id='dynamic-3.sentence-1' class='sentence'>Dynamic initialization of non-block variables <span class='texttt'>V</span> and <span class='texttt'>W</span>
with static storage duration is ordered as follows:
<ul class='itemize'><li id='dynamic-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#dynamic-3.1'>(3.1)</a></div><div class='texpara'><div id='dynamic-3.1.sentence-1' class='sentence'>If <span class='texttt'>V</span> and <span class='texttt'>W</span> have ordered initialization and
the definition of <span class='texttt'>V</span>
is appearance-ordered before the definition of <span class='texttt'>W</span>, or
if <span class='texttt'>V</span> has partially-ordered initialization,
<span class='texttt'>W</span> does not have unordered initialization, and
for every definition <span class='texttt'>E</span> of <span class='texttt'>W</span>
there exists a definition <span class='texttt'>D</span> of <span class='texttt'>V</span>
such that <span class='texttt'>D</span> is appearance-ordered before <span class='texttt'>E</span>, then
<ul class='itemize'><li id='dynamic-3.1.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#dynamic-3.1.1'>(3.1.1)</a></div>if the program does not start a thread (<a href='intro.multithread' title='6.10.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)
other than the main thread (<a href='#main' title='6.10.3.1&emsp;main function'>[basic.<span class='shy'></span>start.<span class='shy'></span>main]</a>)
or <span class='texttt'>V</span> and <span class='texttt'>W</span> have ordered initialization and
they are defined in the same translation unit,
the initialization of <span class='texttt'>V</span>
is sequenced before
the initialization of <span class='texttt'>W</span>;</li><li id='dynamic-3.1.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#dynamic-3.1.2'>(3.1.2)</a></div>otherwise,
the initialization of <span class='texttt'>V</span>
strongly happens before
the initialization of <span class='texttt'>W</span><a class='hidden_link' href='#dynamic-3.1.sentence-1'>.</a></li></ul></div></div></li><li id='dynamic-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#dynamic-3.2'>(3.2)</a></div><div class='texpara'><div id='dynamic-3.2.sentence-1' class='sentence'>Otherwise, if the program starts a thread
other than the main thread
before either <span class='texttt'>V</span> or <span class='texttt'>W</span> is initialized,
it is unspecified in which threads
the initializations of <span class='texttt'>V</span> and <span class='texttt'>W</span> occur;
the initializations are unsequenced if they occur in the same thread<a class='hidden_link' href='#dynamic-3.2.sentence-1'>.</a></div></div></li><li id='dynamic-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#dynamic-3.3'>(3.3)</a></div><div class='texpara'><div id='dynamic-3.3.sentence-1' class='sentence'>Otherwise, the initializations of <span class='texttt'>V</span> and <span class='texttt'>W</span> are indeterminately sequenced<a class='hidden_link' href='#dynamic-3.3.sentence-1'>.</a></div></div></li></ul></div> <div id='dynamic-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#dynamic-note-2'>2</a></i>:&ensp;<div id='dynamic-3.sentence-2' class='sentence'>This definition permits initialization of a sequence of
ordered variables concurrently with another sequence<a class='hidden_link' href='#dynamic-3.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='dynamic-4'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7431'>#</a></div><div class='texpara'><div id='dynamic-4.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:odr-use,non-initialization' title='6.10.3.3&emsp;Dynamic initialization of non-block variables&emsp;[basic.start.dynamic]'><span id='def:odr-use,non-initialization'><i >non-initialization odr-use</i></span></a>
is an odr-use (<a href='basic.def.odr#term.odr.use' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>) not caused directly or indirectly by
the initialization of a non-block static or thread storage duration variable<a class='hidden_link' href='#dynamic-4.sentence-1'>.</a></div></div></div><div class='para' id='dynamic-5'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7437'>#</a></div><div class='texpara'><div id='dynamic-5.sentence-1' class='sentence'><a class='index' id=':evaluation,unspecified_order_of'></a>It is <a class='index' id=':dynamic_initialization_of_static_variables_before_main'></a>implementation-defined
whether the dynamic initialization of a
non-block non-inline variable with static storage duration
is sequenced before the first statement of <span class='texttt'>main</span> or is deferred<a class='hidden_link' href='#dynamic-5.sentence-1'>.</a></div> <div id='dynamic-5.sentence-2' class='sentence'>If it is deferred, it strongly happens before
any non-initialization odr-use
of any non-inline function or non-inline variable
defined in the same translation unit as the variable to be initialized<a class='hidden_link' href='#dynamic-5.sentence-2'>.</a><a class='footnoteref' href='#footnote-34' id='footnoteref-34' title='A non-block variable with static storage duration having initialization with side effects is initialized in this case, even if it is not itself odr-used ([term.odr.use], [basic.stc.static]).'>34</a></div> <div id='dynamic-5.sentence-3' class='sentence'>
It is <a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed'></a>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#dynamic-5.sentence-3'>.</a></div></div><div class='texpara'><div id='dynamic-5.sentence-4' class='sentence'><i >Recommended practice</i>: An implementation should choose such points in a way
that allows the programmer to avoid deadlocks<a class='hidden_link' href='#dynamic-5.sentence-4'>.</a></div> <div id='dynamic-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#dynamic-example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='comment'>// - File 1 -</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"a.h"</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"b.h"</span>
B b;
A<span class='operator'>::</span>A<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  b<span class='operator'>.</span>Use<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='comment'>// - File 2 -</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"a.h"</span>
A a;

<span class='comment'>// - File 3 -</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"a.h"</span>
<span class='preprocessordirective'>#include</span> <span class='literal'>"b.h"</span>
<span class='keyword'>extern</span> A a;
<span class='keyword'>extern</span> B b;

<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  a<span class='operator'>.</span>Use<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  b<span class='operator'>.</span>Use<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span></div><div class='texpara'><div id='dynamic-5.sentence-5' class='sentence'>It is <a class='index' id=':dynamic_initialization_of_static_variables_before_main_'></a>implementation-defined
whether either <span class='texttt'>a</span> or <span class='texttt'>b</span> is
initialized before <span class='texttt'>main</span> is entered or whether the
initializations are delayed until <span class='texttt'>a</span> is first odr-used in
<span class='texttt'>main</span><a class='hidden_link' href='#dynamic-5.sentence-5'>.</a></div> <div id='dynamic-5.sentence-6' class='sentence'>In particular, if <span class='texttt'>a</span> is initialized before
<span class='texttt'>main</span> is entered, it is not guaranteed that <span class='texttt'>b</span> will be
initialized before it is odr-used by the initialization of <span class='texttt'>a</span>, that
is, before <span class='texttt'>A<span class='operator'>&#x200b;::&#x200b;</span>A</span> is called<a class='hidden_link' href='#dynamic-5.sentence-6'>.</a></div> <div id='dynamic-5.sentence-7' class='sentence'>If, however, <span class='texttt'>a</span> is initialized
at some point after the first statement of <span class='texttt'>main</span>, <span class='texttt'>b</span> will
be initialized prior to its use in <span class='texttt'>A<span class='operator'>&#x200b;::&#x200b;</span>A</span><a class='hidden_link' href='#dynamic-5.sentence-7'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='dynamic-6'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7497'>#</a></div><div class='texpara'><div id='dynamic-6.sentence-1' class='sentence'>It is <a class='index' id=':dynamic_initialization_of_static_inline_variables_before_main'></a>implementation-defined
whether the dynamic initialization of a
non-block inline variable with static storage duration
is sequenced before the first statement of <span class='texttt'>main</span> or is deferred<a class='hidden_link' href='#dynamic-6.sentence-1'>.</a></div> <div id='dynamic-6.sentence-2' class='sentence'>If it is deferred, it strongly happens before
any non-initialization odr-use
of that variable<a class='hidden_link' href='#dynamic-6.sentence-2'>.</a></div> <div id='dynamic-6.sentence-3' class='sentence'>It is <a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed_'></a>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#dynamic-6.sentence-3'>.</a></div></div></div><div class='para' id='dynamic-7'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7508'>#</a></div><div class='texpara'><div id='dynamic-7.sentence-1' class='sentence'>It is <a class='index' id=':dynamic_initialization_of_thread-local_variables_before_entry'></a>implementation-defined
whether the dynamic initialization of a
non-block non-inline variable with thread storage duration
is sequenced before the first statement of the initial function of a thread or is deferred<a class='hidden_link' href='#dynamic-7.sentence-1'>.</a></div> <div id='dynamic-7.sentence-2' class='sentence'>If it is deferred,
the initialization associated with the entity for thread <i >t</i>
is sequenced before the first non-initialization odr-use by <i >t</i>
of any non-inline variable with thread storage duration
defined in the same translation unit as the variable to be initialized<a class='hidden_link' href='#dynamic-7.sentence-2'>.</a></div> <div id='dynamic-7.sentence-3' class='sentence'>It is <a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed__'></a>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#dynamic-7.sentence-3'>.</a></div></div></div><div class='para' id='dynamic-8'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7521'>#</a></div><div class='texpara'><div id='dynamic-8.sentence-1' class='sentence'>If the initialization of
a non-block variable with static or thread storage duration
exits via an exception,
the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> is called (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#dynamic-8.sentence-1'>.</a></div> </div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-34'><div class='texpara'><a class='footnotenum' href='#footnote-34'>34)</a><a class='footnoteBacklink' href='#footnoteref-34'>34)</a> <div id='footnote-34.sentence-1' class='sentence'>A non-block variable with static storage duration
having initialization
with side effects is initialized in this case,
even if it is not itself odr-used (<a href='basic.def.odr#term.odr.use' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>, <a href='basic.stc.static' title='6.8.6.2&emsp;Static storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>static]</a>)<a class='hidden_link' href='#footnote-34.sentence-1'>.</a></div></div></div><div id='term' class='section'><h4 ><a class='secnum' href='#term' style='min-width:50pt'>6.10.3.4</a> Termination <a class='abbr_ref' href='basic.start.term'>[basic.start.term]</a></h4></div><div class='para' id='term-1'><div class='marginalizedparent'><a class='marginalized' href='#term-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7530'>#</a></div><div class='texpara'><div id='term-1.sentence-1' class='sentence'><a class='index' id=':program,termination'></a><a class='index' id=':object,destructor_static'></a><a class='index' id=':main_function,return_from_'></a>Constructed complete objects (<a href='dcl.init' title='9.5&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)
with static storage duration are destroyed
and functions registered with <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span>
are called as part of a call to
<a class='index' id=':exit_'></a><a class='index' id='lib:exit_'></a><span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> (<a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>)<a class='hidden_link' href='#term-1.sentence-1'>.</a></div> <div id='term-1.sentence-2' class='sentence'>The call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> is sequenced before
the destructions and the registered functions<a class='hidden_link' href='#term-1.sentence-2'>.</a></div> <div id='term-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#term-note-1'>1</a></i>:&ensp;<div id='term-1.sentence-3' class='sentence'>Returning from <span class='texttt'>main</span> invokes <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> (<a href='#main' title='6.10.3.1&emsp;main function'>[basic.<span class='shy'></span>start.<span class='shy'></span>main]</a>)<a class='hidden_link' href='#term-1.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='term-2'><div class='marginalizedparent'><a class='marginalized' href='#term-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7547'>#</a></div><div class='texpara'><div id='term-2.sentence-1' class='sentence'>Constructed complete objects with thread storage duration within a given thread
are destroyed as a result of returning from the initial function of that thread and as a
result of that thread calling <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span><a class='hidden_link' href='#term-2.sentence-1'>.</a></div> <div id='term-2.sentence-2' class='sentence'>The destruction of those constructed objects
is sequenced before releasing the storage for
any object with thread storage duration within that thread (<a href='basic.stc.thread' title='6.8.6.3&emsp;Thread storage duration'>[basic.<span class='shy'></span>stc.<span class='shy'></span>thread]</a>)<a class='hidden_link' href='#term-2.sentence-2'>.</a></div> <div id='term-2.sentence-3' class='sentence'>The destruction of those constructed objects
strongly happens before destroying
any object with static storage duration<a class='hidden_link' href='#term-2.sentence-3'>.</a></div></div></div><div class='para' id='term-3'><div class='marginalizedparent'><a class='marginalized' href='#term-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7558'>#</a></div><div class='texpara'><div id='term-3.sentence-1' class='sentence'>The destruction of a complete object with thread storage duration within a given thread
and having constant destruction (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>)
is sequenced after the destruction of any other complete object
with thread storage duration within the thread<a class='hidden_link' href='#term-3.sentence-1'>.</a></div> <div id='term-3.sentence-2' class='sentence'>The destruction of a complete object with static storage duration
and having constant destruction
is sequenced after the destruction of any other complete object
with static storage duration
and after any call to a function passed to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span><a class='hidden_link' href='#term-3.sentence-2'>.</a></div> <div id='term-3.sentence-3' class='sentence'>The sequencing rules in the remainder of this subclause
apply only to complete objects not having constant destruction<a class='hidden_link' href='#term-3.sentence-3'>.</a></div></div></div><div class='para' id='term-4'><div class='marginalizedparent'><a class='marginalized' href='#term-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7571'>#</a></div><div class='texpara'><div id='term-4.sentence-1' class='sentence'>If the deemed construction (<a href='dcl.init.general' title='9.5.1&emsp;General'>[dcl.<span class='shy'></span>init.<span class='shy'></span>general]</a>) of a complete object with static
storage duration strongly happens before that of another, the completion of the destruction
of the second is sequenced before the initiation of the destruction of the first<a class='hidden_link' href='#term-4.sentence-1'>.</a></div> <div id='term-4.sentence-2' class='sentence'>If the deemed construction of a complete object with thread
storage duration is sequenced before that of another, the completion of the destruction
of the second is sequenced before the initiation of the destruction of the first<a class='hidden_link' href='#term-4.sentence-2'>.</a></div> <div id='term-4.sentence-3' class='sentence'>If an object is
initialized statically, the object is destroyed in the same order as if
the object was dynamically initialized<a class='hidden_link' href='#term-4.sentence-3'>.</a></div> <div id='term-4.sentence-4' class='sentence'>If the destruction of an object with static or thread storage duration
exits via an exception,
the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> is called (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#term-4.sentence-4'>.</a></div> <div id='term-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#term-example-1'>1</a></i>:&ensp;<div id='term-4.sentence-5' class='sentence'>In the following program,
the elements of <span class='texttt'>a</span> are destroyed,
followed by <span class='texttt'>dt</span>, and
finally by the two <span class='texttt'>Btemp</span> objects:
<span class='codeblock'><span class='keyword'>struct</span> DTemp <span class='curlybracket'>{</span> <span class='operator'>~</span>DTemp<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> Temp <span class='curlybracket'>{</span>
  <span class='operator'>~</span>Temp<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>static</span> DTemp dt;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> BTemp <span class='curlybracket'>{</span>
  <span class='operator'>~</span>BTemp<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> BTemp <span class='operator'>&amp;</span>tb;
  <span class='operator'>~</span>A<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
A a<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='parenthesis'>(</span>Temp<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, BTemp<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>, BTemp<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>}</span>;

<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
</span></div> <div id='term-4.sentence-6' class='sentence'>
If the array <span class='texttt'>a</span> were an object with automatic storage duration,
the <span class='texttt'>Btemp</span> temporaries would be destroyed
as each element of the array is destroyed (<a href='class.temporary' title='6.8.7&emsp;Temporary objects'>[class.<span class='shy'></span>temporary]</a>)<a class='hidden_link' href='#term-4.sentence-6'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='term-5'><div class='marginalizedparent'><a class='marginalized' href='#term-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7612'>#</a></div><div class='texpara'><div id='term-5.sentence-1' class='sentence'>If a function contains a block variable of static or thread storage duration that has been
destroyed and the function is called during the destruction of an object with static or
thread storage duration, the program has undefined behavior if the flow of control
passes through the definition of the previously destroyed block variable<a class='hidden_link' href='#term-5.sentence-1'>.</a></div> <div id='term-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#term-note-2'>2</a></i>:&ensp;<div id='term-5.sentence-2' class='sentence'>Likewise, the behavior is undefined
if the block variable is used indirectly (e.g., through a pointer)
after its destruction<a class='hidden_link' href='#term-5.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='term-6'><div class='marginalizedparent'><a class='marginalized' href='#term-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7623'>#</a></div><div class='texpara'><div id='term-6.sentence-1' class='sentence'><a class='index' id=':atexit'></a><a class='index' id='lib:atexit'></a>If the deemed construction of a complete object with static storage
duration strongly happens before a call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> (see
<a href='cstdlib.syn#header:%3ccstdlib%3e' title='17.2.2&emsp;Header &lt;cstdlib&gt; synopsis&emsp;[cstdlib.syn]'><span id='headerref:<cstdlib>'><span class='texttt'>&lt;cstdlib&gt;</span></span></a>, <a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>), the call to the function passed to
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> is sequenced before the initiation of the destruction of the object<a class='hidden_link' href='#term-6.sentence-1'>.</a></div> <div id='term-6.sentence-2' class='sentence'>If a call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> strongly happens before the deemed construction of
a complete object with static storage duration,
the completion of the destruction of the
object is sequenced before the call to the function passed to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span><a class='hidden_link' href='#term-6.sentence-2'>.</a></div> <div id='term-6.sentence-3' class='sentence'>If a
call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> strongly happens before another call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span>, the
call to the function passed to the second <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> call is sequenced before
the call to the function passed to the first <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> call<a class='hidden_link' href='#term-6.sentence-3'>.</a></div></div></div><div class='para' id='term-7'><div class='marginalizedparent'><a class='marginalized' href='#term-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7638'>#</a></div><div class='texpara'><div id='term-7.sentence-1' class='sentence'>If there is a use of a standard library object or function not permitted within signal
handlers (<a href='support.runtime' title='17.14&emsp;Other runtime support'>[support.<span class='shy'></span>runtime]</a>) that does not happen before (<a href='intro.multithread' title='6.10.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)
completion of destruction of objects with static storage duration and execution of
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit</span> registered functions (<a href='support.start.term' title='17.5&emsp;Startup and termination'>[support.<span class='shy'></span>start.<span class='shy'></span>term]</a>), the program has
undefined behavior<a class='hidden_link' href='#term-7.sentence-1'>.</a></div> <div id='term-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#term-note-3'>3</a></i>:&ensp;<div id='term-7.sentence-2' class='sentence'>If there is a use of an object with static storage
duration that does not happen before the object's destruction, the program has undefined
behavior<a class='hidden_link' href='#term-7.sentence-2'>.</a></div> <div id='term-7.sentence-3' class='sentence'>Terminating every thread before a call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>exit</span> or the exit from
<span class='texttt'>main</span> is sufficient, but not necessary, to satisfy these requirements<a class='hidden_link' href='#term-7.sentence-3'>.</a></div> <div id='term-7.sentence-4' class='sentence'>These
requirements permit thread managers as static-storage-duration objects<a class='hidden_link' href='#term-7.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='term-8'><div class='marginalizedparent'><a class='marginalized' href='#term-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1d9fdb066e95b7be58881f24977a20a51359097c/source/basic.tex#L7652'>#</a></div><div class='texpara'><div id='term-8.sentence-1' class='sentence'><a class='index' id=':abort'></a><a class='index' id='lib:abort'></a><a class='index' id=':termination,program__'></a>Calling the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>abort<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> declared in
<a href='cstdlib.syn#header:%3ccstdlib%3e' title='17.2.2&emsp;Header &lt;cstdlib&gt; synopsis&emsp;[cstdlib.syn]'><span id='headerref:<cstdlib>_'><span class='texttt'>&lt;cstdlib&gt;</span></span></a> terminates the program without executing any destructors
and without calling
the functions passed to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>atexit<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>at_<span class='shy'></span>quick_<span class='shy'></span>exit<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#term-8.sentence-1'>.</a></div> 
</div></div></div></body></html>