<!DOCTYPE html><html lang='en'><head><title>[meta.reflection.result]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>21</a> Metaprogramming library <a class='abbr_ref' href='./#meta'>[meta]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>21.4</a> Reflection <a class='abbr_ref' href='meta.reflection#result'>[meta.reflection]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>21.4.14</a> Expression result reflection <a class='abbr_ref'>[meta.reflection.result]</a></h3><div class='texpara'><div id='lib:reflect_constant'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:reflect_constant'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>consteval</span> info reflect_constant<span class='parenthesis'>(</span>T expr<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6080'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>is_<span class='shy'></span>copy_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span>
and <span class='texttt'>T</span> is a cv-unqualified structural type (<a href='temp.param' title='13.2&emsp;Template parameters'>[temp.<span class='shy'></span>param]</a>)
that is not a reference type<a class='hidden_link' href='#1.sentence-1'>.</a></div></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6086'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>Let <span class='math'><span class='mathalpha'>V</span></span> be:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#2.1'>(2.1)</a></div>if <span class='texttt'>T</span> is a class type,
  then an object that is template-argument-equivalent to the value of <span class='texttt'>expr</span>;</li><li id='2.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#2.2'>(2.2)</a></div>otherwise, the value of <span class='texttt'>expr</span><a class='hidden_link' href='#2.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6096'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>template_<span class='shy'></span>arguments_<span class='shy'></span>of<span class='parenthesis'>(</span><span class='operator'>^</span><span class='operator'>^</span>TCls<span class='anglebracket'>&lt;</span><span class='math'><span class='mathalpha'>V</span></span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span><span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span></span><a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='3.sentence-2' class='sentence'>This is a reflection of an object for class types,
and a reflection of a value otherwise<a class='hidden_link' href='#3.sentence-2'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>auto</span> D<span class='anglebracket'>&gt;</span>
  <span class='keyword'>struct</span> A <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> N <span class='curlybracket'>{</span> <span class='keyword'>int</span> x; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> K <span class='curlybracket'>{</span> <span class='keyword'>char</span> <span class='keyword'>const</span><span class='operator'>*</span> p; <span class='curlybracket'>}</span>;

<span class='keyword'>constexpr</span> info r1 <span class='operator'>=</span> reflect_constant<span class='parenthesis'>(</span><span class='literal'>42</span><span class='parenthesis'>)</span>;
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>is_value<span class='parenthesis'>(</span>r1<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>r1 <span class='operator'>=</span><span class='operator'>=</span> template_arguments_of<span class='parenthesis'>(</span><span class='operator'>^</span><span class='operator'>^</span>A<span class='anglebracket'>&lt;</span><span class='literal'>42</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span><span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span>;

<span class='keyword'>constexpr</span> info r2 <span class='operator'>=</span> reflect_constant<span class='parenthesis'>(</span>N<span class='curlybracket'>{</span><span class='literal'>42</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span>;
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>is_object<span class='parenthesis'>(</span>r2<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>r2 <span class='operator'>=</span><span class='operator'>=</span> template_arguments_of<span class='parenthesis'>(</span><span class='operator'>^</span><span class='operator'>^</span>A<span class='anglebracket'>&lt;</span>N<span class='curlybracket'>{</span><span class='literal'>42</span><span class='curlybracket'>}</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span><span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span>;

<span class='keyword'>constexpr</span> info r3 <span class='operator'>=</span> reflect_constant<span class='parenthesis'>(</span>K<span class='curlybracket'>{</span><span class='literal'>nullptr</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span>;   <span class='comment'>// OK</span>
<span class='keyword'>constexpr</span> info r4 <span class='operator'>=</span> reflect_constant<span class='parenthesis'>(</span>K<span class='curlybracket'>{</span><span class='literal'>"ebab"</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span>;    <span class='comment'>// error: constituent pointer</span>
                                                    <span class='comment'>// points to string literal</span>
</span> â€”&nbsp;<i>end example</i>]</div></div></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6125'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>meta<span class='operator'>&#x200b;::&#x200b;</span>exception</span> unless
the <a href='temp.names#nt:template-id' title='13.3&emsp;Names of template specializations&emsp;[temp.names]'><span id='ntref:template-id'><span class='textsf'><i >template-id</i></span></span></a> <span class='texttt'>TCls<span class='anglebracket'>&lt;</span><span class='math'><span class='mathalpha'>V</span></span><span class='anglebracket'>&gt;</span></span> would be valid
given the invented variable
<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span>T P<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> TCls;
</span></div></div></div></div><div class='texpara'><div id='lib:reflect_object'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:reflect_object'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>consteval</span> info reflect_object<span class='parenthesis'>(</span>T<span class='operator'>&amp;</span> expr<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6142'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>T</span> is an object type<a class='hidden_link' href='#5.sentence-1'>.</a></div></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6146'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'><i >Returns</i>: A reflection of the object designated by <span class='texttt'>expr</span><a class='hidden_link' href='#6.sentence-1'>.</a></div></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6150'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>meta<span class='operator'>&#x200b;::&#x200b;</span>exception</span> unless
<span class='texttt'>expr</span> is suitable for use as a constant template argument
for a constant template parameter of type <span class='texttt'>T<span class='operator'>&amp;</span></span> (<a href='temp.arg.nontype' title='13.4.3&emsp;Constant template arguments'>[temp.<span class='shy'></span>arg.<span class='shy'></span>nontype]</a>)<a class='hidden_link' href='#7.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:reflect_function'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:reflect_function'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>consteval</span> info reflect_function<span class='parenthesis'>(</span>T<span class='operator'>&amp;</span> expr<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6164'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>T</span> is a function type<a class='hidden_link' href='#8.sentence-1'>.</a></div></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6168'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'><i >Returns</i>: A reflection of the function designated by <span class='texttt'>fn</span><a class='hidden_link' href='#9.sentence-1'>.</a></div></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/meta.tex#L6172'>#</a></div><div class='texpara'><div id='10.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>meta<span class='operator'>&#x200b;::&#x200b;</span>exception</span> unless
<span class='texttt'>expr</span> is suitable for use as a constant template argument
for a constant template parameter of type <span class='texttt'>T<span class='operator'>&amp;</span></span> (<a href='temp.arg.nontype' title='13.4.3&emsp;Constant template arguments'>[temp.<span class='shy'></span>arg.<span class='shy'></span>nontype]</a>)<a class='hidden_link' href='#10.sentence-1'>.</a></div></div></div></div></div></body></html>