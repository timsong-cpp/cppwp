<!DOCTYPE html><html lang='en'><head><title>[fs.op.copy]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>29</a> Input/output library <a class='abbr_ref' href='./#input.output'>[input.output]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>29.11</a> File systems <a class='abbr_ref' href='filesystems#fs.op.copy'>[filesystems]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>29.11.14</a> Filesystem operation functions <a class='abbr_ref' href='fs.op.funcs#fs.op.copy'>[fs.op.funcs]</a></h3><h4 ><a class='secnum' style='min-width:118pt'>29.11.14.3</a> Copy <a class='abbr_ref'>[fs.op.copy]</a></h4><span class='indexparent'><a class='index' id='lib:copy,path'></a></span><div class='itemdecl' id='itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:1'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>void</span> copy<span class='parenthesis'>(</span><span class='keyword'>const</span> path<span class='operator'>&amp;</span> from, <span class='keyword'>const</span> path<span class='operator'>&amp;</span> to<span class='parenthesis'>)</span>;
</code></div><div class='itemdescr'></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/63928eee09bc0b1adddd10b1781d139eb60628c0/source/iostreams.tex#L15154'>#</a></div><div id='1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to
<span class='texttt'>copy<span class='parenthesis'>(</span>from, to, copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>none<span class='parenthesis'>)</span></span><a class='hidden_link' href='#1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:copy,path_'></a></span><div class='itemdecl' id='itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:2'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>void</span> copy<span class='parenthesis'>(</span><span class='keyword'>const</span> path<span class='operator'>&amp;</span> from, <span class='keyword'>const</span> path<span class='operator'>&amp;</span> to, error_code<span class='operator'>&amp;</span> ec<span class='parenthesis'>)</span>;
</code></div><div class='itemdescr'></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/63928eee09bc0b1adddd10b1781d139eb60628c0/source/iostreams.tex#L15165'>#</a></div><div id='2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to
<span class='texttt'>copy<span class='parenthesis'>(</span>from, to, copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>none, ec<span class='parenthesis'>)</span></span><a class='hidden_link' href='#2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:copy,path__'></a></span><div class='itemdecl' id='itemdecl:3'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:3'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>void</span> copy<span class='parenthesis'>(</span><span class='keyword'>const</span> path<span class='operator'>&amp;</span> from, <span class='keyword'>const</span> path<span class='operator'>&amp;</span> to, copy_options options<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> copy<span class='parenthesis'>(</span><span class='keyword'>const</span> path<span class='operator'>&amp;</span> from, <span class='keyword'>const</span> path<span class='operator'>&amp;</span> to, copy_options options,
          error_code<span class='operator'>&amp;</span> ec<span class='parenthesis'>)</span>;
</code></div><div class='itemdescr'></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/63928eee09bc0b1adddd10b1781d139eb60628c0/source/iostreams.tex#L15178'>#</a></div><div id='3.sentence-1' class='sentence'><span class='textit'>Requires:</span> At most one element from each option group (<a href='fs.enum.copy.opts'>[fs.enum.copy.opts]</a>)
  is set in <span class='texttt'>options</span><a class='hidden_link' href='#3.sentence-1'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/63928eee09bc0b1adddd10b1781d139eb60628c0/source/iostreams.tex#L15182'>#</a></div><div id='4.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
Before the first use of <span class='texttt'>f</span> and <span class='texttt'>t</span>:
<ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.1'>(4.1)</a></div>If
<pre class='codeblock'>
<span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_options<span class='operator'>::</span>create_symlinks<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_options<span class='operator'>::</span>none <span class='operator'>|</span><span class='operator'>|</span>
<span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_options<span class='operator'>::</span>skip_symlinks<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_options<span class='operator'>::</span>none
</pre>
then <span class='texttt'><span class='keyword'>auto</span> f <span class='operator'>=</span> symlink_&shy;status<span class='parenthesis'>(</span>from<span class='parenthesis'>)</span></span> and if needed <span class='texttt'><span class='keyword'>auto</span> t <span class='operator'>=</span> symlink_&shy;status<span class='parenthesis'>(</span>to<span class='parenthesis'>)</span></span>.</li><li id='4.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.2'>(4.2)</a></div>Otherwise, if
<pre class='codeblock'>
<span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_options<span class='operator'>::</span>copy_symlinks<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_options<span class='operator'>::</span>none
</pre>
then <span class='texttt'><span class='keyword'>auto</span> f <span class='operator'>=</span> symlink_&shy;status<span class='parenthesis'>(</span>from<span class='parenthesis'>)</span></span> and if needed <span class='texttt'><span class='keyword'>auto</span> t <span class='operator'>=</span> status<span class='parenthesis'>(</span>to<span class='parenthesis'>)</span></span>.</li><li id='4.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.3'>(4.3)</a></div>Otherwise, <span class='texttt'><span class='keyword'>auto</span> f <span class='operator'>=</span> status<span class='parenthesis'>(</span>from<span class='parenthesis'>)</span></span> and if needed <span class='texttt'><span class='keyword'>auto</span> t <span class='operator'>=</span> status<span class='parenthesis'>(</span>to<span class='parenthesis'>)</span></span>.</li></ul></div><div id='4.sentence-2' class='sentence'>Effects are then as follows:
<ul class='itemize'><li id='4.4'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.4'>(4.4)</a></div>If <span class='texttt'>f<span class='operator'>.</span>type<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>t<span class='operator'>.</span>type<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is an implementation-defined
file type (<a href='fs.enum.file.type'>[fs.enum.file.type]</a>), then the effects are
<span class='indexparent'><a class='index' id=':effect_of_filesystem::copy'></a></span>implementation-defined.</li><li id='4.5'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.5'>(4.5)</a></div>Otherwise, an error is reported as specified in <a href='fs.err.report'>[fs.err.report]</a> if:
<ul class='itemize'><li id='4.5.1'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.5.1'>(4.5.1)</a></div><span class='texttt'>exists<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span>, or</li><li id='4.5.2'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.5.2'>(4.5.2)</a></div><span class='texttt'>equivalent<span class='parenthesis'>(</span>from, to<span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>, or</li><li id='4.5.3'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.5.3'>(4.5.3)</a></div><span class='texttt'>is_&shy;other<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span> <span class='operator'>|</span><span class='operator'>|</span> is_&shy;other<span class='parenthesis'>(</span>t<span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>, or</li><li id='4.5.4'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.5.4'>(4.5.4)</a></div><span class='texttt'>is_&shy;directory<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span> is_&shy;regular_&shy;file<span class='parenthesis'>(</span>t<span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>.</li></ul></li><li id='4.6'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.6'>(4.6)</a></div>Otherwise, if <span class='texttt'>is_&shy;symlink<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span></span>, then:
<ul class='itemize'><li id='4.6.1'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.6.1'>(4.6.1)</a></div>If
<span class='texttt'><span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>skip_&shy;symlinks<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>none</span>
then return.</li><li id='4.6.2'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.6.2'>(4.6.2)</a></div>Otherwise if
<pre class='codeblock'>
<span class='operator'>!</span>exists<span class='parenthesis'>(</span>t<span class='parenthesis'>)</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span> <span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_options<span class='operator'>::</span>copy_symlinks<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_options<span class='operator'>::</span>none
</pre>
then <span class='texttt'>copy_&shy;symlink<span class='parenthesis'>(</span>from, to<span class='parenthesis'>)</span></span>.</li><li id='4.6.3'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.6.3'>(4.6.3)</a></div>Otherwise report an error as specified in <a href='fs.err.report'>[fs.err.report]</a>.</li></ul></li><li id='4.7'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.7'>(4.7)</a></div>Otherwise, if <span class='texttt'>is_&shy;regular_&shy;file<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span></span>, then:
<ul class='itemize'><li id='4.7.1'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.7.1'>(4.7.1)</a></div>If <span class='texttt'><span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>directories_&shy;only<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>none</span>, then return.</li><li id='4.7.2'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.7.2'>(4.7.2)</a></div>Otherwise, if <span class='texttt'><span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>create_&shy;symlinks<span class='parenthesis'>)</span> <span class=':'></span> <span class='operator'>!</span><span class='operator'>=</span> copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>none</span>, then create a symbolic link to the
      source file.</li><li id='4.7.3'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.7.3'>(4.7.3)</a></div>Otherwise, if <span class='texttt'><span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>create_&shy;hard_&shy;links<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>none</span>,
      then create a hard link to the source file.</li><li id='4.7.4'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.7.4'>(4.7.4)</a></div>Otherwise, if <span class='texttt'>is_&shy;directory<span class='parenthesis'>(</span>t<span class='parenthesis'>)</span></span>, then <span class='texttt'>copy_&shy;file<span class='parenthesis'>(</span>from, to<span class='operator'>/</span>from<span class='operator'>.</span>filename<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, options<span class='parenthesis'>)</span></span>.</li><li id='4.7.5'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.7.5'>(4.7.5)</a></div>Otherwise, <span class='texttt'>copy_&shy;file<span class='parenthesis'>(</span>from, to, options<span class='parenthesis'>)</span></span>.</li></ul></li><li id='4.8'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.8'>(4.8)</a></div>Otherwise, if
<pre class='codeblock'>
is_directory<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span>
<span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_options<span class='operator'>::</span>create_symlinks<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_options<span class='operator'>::</span>none
</pre>
then report an error with an <span class='texttt'>error_&shy;code</span> argument
equal to <span class='texttt'>make_&shy;error_&shy;code<span class='parenthesis'>(</span>errc<span class='operator'>&#x200b;::&#x200b;</span>is_&shy;a_&shy;directory<span class='parenthesis'>)</span></span>.</li><li id='4.9'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.9'>(4.9)</a></div>Otherwise, if
<pre class='codeblock'>
is_directory<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span>
<span class='parenthesis'>(</span><span class='parenthesis'>(</span>options <span class='operator'>&amp;</span> copy_options<span class='operator'>::</span>recursive<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> copy_options<span class='operator'>::</span>none <span class='operator'>|</span><span class='operator'>|</span>
 options <span class='operator'>=</span><span class='operator'>=</span> copy_options<span class='operator'>::</span>none<span class='parenthesis'>)</span>
</pre>
then:
<ul class='itemize'><li id='4.9.1'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.9.1'>(4.9.1)</a></div>If <span class='texttt'>exists<span class='parenthesis'>(</span>t<span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span>, then <span class='texttt'>create_&shy;directory<span class='parenthesis'>(</span>to, from<span class='parenthesis'>)</span></span>.</li><li id='4.9.2'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#4.9.2'>(4.9.2)</a></div>Then, iterate over the files in <span class='texttt'>from</span>, as if by
<pre class='codeblock'>
<span class='keyword'>for</span> <span class='parenthesis'>(</span><span class='keyword'>const</span> directory_entry<span class='operator'>&amp;</span> x <span class='operator'>:</span> directory_iterator<span class='parenthesis'>(</span>from<span class='parenthesis'>)</span><span class='parenthesis'>)</span>
  copy<span class='parenthesis'>(</span>x<span class='operator'>.</span>path<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, to<span class='operator'>/</span>x<span class='operator'>.</span>path<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='operator'>.</span>filename<span class='parenthesis'>(</span><span class='parenthesis'>)</span>,
       options <span class='operator'>|</span> copy_options<span class='operator'>::</span><span class='textit'>in-recursive-copy</span><span class='parenthesis'>)</span>;
</pre>
  where <span class='texttt'><span class='textit'>in-recursive-copy</span></span>
  is a bitmask element of <span class='texttt'>copy_&shy;options</span>
  that is not one of the elements in <a href='fs.enum.copy.opts'>[fs.enum.copy.opts]</a>.</li></ul></li><li id='4.10'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.10'>(4.10)</a></div>Otherwise, for the signature with argument <span class='texttt'>ec</span>, <span class='texttt'>ec<span class='operator'>.</span>clear<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>.</li><li id='4.11'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.11'>(4.11)</a></div>Otherwise, no effects.</li></ul></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/63928eee09bc0b1adddd10b1781d139eb60628c0/source/iostreams.tex#L15279'>#</a></div><div id='5.sentence-1' class='sentence'><span class='textit'>Throws:</span> As specified in <a href='fs.err.report'>[fs.err.report]</a><a class='hidden_link' href='#5.sentence-1'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/63928eee09bc0b1adddd10b1781d139eb60628c0/source/iostreams.tex#L15282'>#</a></div><div id='6.sentence-1' class='sentence'><span class='textit'>Remarks:</span> For the signature with argument <span class='texttt'>ec</span>, any
library functions called by the implementation shall have an <span class='texttt'>error_&shy;code</span> argument if applicable<a class='hidden_link' href='#6.sentence-1'>.</a></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/63928eee09bc0b1adddd10b1781d139eb60628c0/source/iostreams.tex#L15286'>#</a></div><div id='7.example-1' class='example'>[&nbsp;<a class='example_link' href='#7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='7.sentence-1' class='sentence'>Given this directory structure:
<pre class='outputblock'>
/dir1
  file1
  file2
  dir2
    file3
</pre></div><div style='height:0.6em;display:block'></div><div id='7.sentence-2' class='sentence'>Calling <span class='texttt'>copy<span class='parenthesis'>(</span><span class='literal'>"/dir1"</span>, <span class='literal'>"/dir3"</span><span class='parenthesis'>)</span></span> would result in:
<pre class='outputblock'>
/dir1
  file1
  file2
  dir2
    file3
/dir3
  file1
  file2
</pre></div><div style='height:0.6em;display:block'></div><div id='7.sentence-3' class='sentence'>Alternatively, calling <span class='texttt'>copy<span class='parenthesis'>(</span><span class='literal'>"/dir1"</span>, <span class='literal'>"/dir3"</span>, copy_&shy;options<span class='operator'>&#x200b;::&#x200b;</span>recursive<span class='parenthesis'>)</span></span> would result in:
<pre class='outputblock'>
/dir1
  file1
  file2
  dir2
    file3
/dir3
  file1
  file2
  dir2
    file3
</pre></div> â€”&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div></div></body></html>