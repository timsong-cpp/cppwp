<!DOCTYPE html><html lang='en'><head><title>[optional.optional.ref]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>22</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>22.5</a> Optional objects <a class='abbr_ref' href='optional#optional.ref'>[optional]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>22.5.4</a> Partial specialization of <span class='texttt'>optional</span> for reference types <a class='abbr_ref'>[optional.optional.ref]</a></h3><div id='general' class='section'><h4 ><a class='secnum' href='#general' style='min-width:95pt'>22.5.4.1</a> General <a class='abbr_ref' href='optional.optional.ref.general'>[optional.optional.ref.general]</a></h4><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> optional<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
    <span class='keyword'>public</span><span class='operator'>:</span>
      <span class='keyword'>using</span> value_type     <span class='operator'>=</span> T;
      <span class='keyword'>using</span> iterator       <span class='operator'>=</span> <i >implementation-defined</i>;            <span class='comment'>// see <a href='#optional.ref.iterators' title='22.5.4.5&emsp;Iterator support'>[optional.<span class='shy'></span>ref.<span class='shy'></span>iterators]</a></span>

    <span class='keyword'>public</span><span class='operator'>:</span>
      <span class='comment'>// <a href='#optional.ref.ctor' title='22.5.4.2&emsp;Constructors'>[optional.<span class='shy'></span>ref.<span class='shy'></span>ctor]</a>, constructors</span>
      <span class='keyword'>constexpr</span> optional<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span> <span class='operator'>=</span> <span class='keyword'>default</span>;
      <span class='keyword'>constexpr</span> optional<span class='parenthesis'>(</span>nullopt_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span> <span class='operator'>:</span> optional<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
      <span class='keyword'>constexpr</span> optional<span class='parenthesis'>(</span><span class='keyword'>const</span> optional<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span> <span class='operator'>=</span> <span class='keyword'>default</span>;

      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Arg<span class='anglebracket'>&gt;</span>
        <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> optional<span class='parenthesis'>(</span>in_place_t, Arg<span class='operator'>&amp;</span><span class='operator'>&amp;</span> arg<span class='parenthesis'>)</span>;
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
        <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span> optional<span class='parenthesis'>(</span>U<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span>;
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
        <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span> optional<span class='parenthesis'>(</span>optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span>;
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
        <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span> optional<span class='parenthesis'>(</span><span class='keyword'>const</span> optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span>;
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
        <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span> optional<span class='parenthesis'>(</span>optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span>;
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
        <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span> optional<span class='parenthesis'>(</span><span class='keyword'>const</span> optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span>;

      <span class='keyword'>constexpr</span> <span class='operator'>~</span>optional<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>;

      <span class='comment'>// <a href='#optional.ref.assign' title='22.5.4.3&emsp;Assignment'>[optional.<span class='shy'></span>ref.<span class='shy'></span>assign]</a>, assignment</span>
      <span class='keyword'>constexpr</span> optional<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>nullopt_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>constexpr</span> optional<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> optional<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span> <span class='operator'>=</span> <span class='keyword'>default</span>;

      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span> <span class='keyword'>constexpr</span> T<span class='operator'>&amp;</span> emplace<span class='parenthesis'>(</span>U<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span>;

      <span class='comment'>// <a href='#optional.ref.swap' title='22.5.4.4&emsp;Swap'>[optional.<span class='shy'></span>ref.<span class='shy'></span>swap]</a>, swap</span>
      <span class='keyword'>constexpr</span> <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>optional<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

      <span class='comment'>// <a href='optional.iterators' title='22.5.3.6&emsp;Iterator support'>[optional.<span class='shy'></span>iterators]</a>, iterator support</span>
      <span class='keyword'>constexpr</span> iterator begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>constexpr</span> iterator end<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

      <span class='comment'>// <a href='#optional.ref.observe' title='22.5.4.6&emsp;Observers'>[optional.<span class='shy'></span>ref.<span class='shy'></span>observe]</a>, observers</span>
      <span class='keyword'>constexpr</span> T<span class='operator'>*</span>       <span class='keyword'>operator</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>constexpr</span> T<span class='operator'>&amp;</span>       <span class='keyword'>operator</span><span class='operator'>*</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> <span class='keyword'>operator</span> <span class='keyword'>bool</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>constexpr</span> <span class='keyword'>bool</span>     has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
      <span class='keyword'>constexpr</span> T<span class='operator'>&amp;</span>       value<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;                         <span class='comment'>// freestanding-deleted</span>
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U <span class='operator'>=</span> remove_cv_t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>
        <span class='keyword'>constexpr</span> remove_cv_t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span> value_or<span class='parenthesis'>(</span>U<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>const</span>;

      <span class='comment'>// <a href='#optional.ref.monadic' title='22.5.4.7&emsp;Monadic operations'>[optional.<span class='shy'></span>ref.<span class='shy'></span>monadic]</a>, monadic operations</span>
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span> <span class='keyword'>constexpr</span> <span class='keyword'>auto</span> and_then<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span> <span class='keyword'>constexpr</span> optional<span class='anglebracket'>&lt;</span>invoke_result_t<span class='anglebracket'>&lt;</span>F, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> transform<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span> <span class='keyword'>constexpr</span> optional or_else<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f<span class='parenthesis'>)</span> <span class='keyword'>const</span>;

      <span class='comment'>// <a href='#optional.ref.mod' title='22.5.4.8&emsp;Modifiers'>[optional.<span class='shy'></span>ref.<span class='shy'></span>mod]</a>, modifiers</span>
      <span class='keyword'>constexpr</span> <span class='keyword'>void</span> reset<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='keyword'>private</span><span class='operator'>:</span>
      T<span class='operator'>*</span> <i >val</i> <span class='operator'>=</span> <span class='literal'>nullptr</span>;                                         <span class='comment'>// <i >exposition only</i></span>

      <span class='comment'>// <a href='#optional.ref.expos' title='22.5.4.9&emsp;Exposition only helper functions'>[optional.<span class='shy'></span>ref.<span class='shy'></span>expos]</a>, exposition only helper functions</span>
      <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
        <span class='keyword'>constexpr</span> <span class='keyword'>void</span> <i >convert-ref-init-val</i><span class='parenthesis'>(</span>U<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span>;             <span class='comment'>// <i >exposition only</i></span>
    <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></div><div class='para' id='general-1'><div class='marginalizedparent'><a class='marginalized' href='#general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4516'>#</a></div><div class='texpara'><div id='general-1.sentence-1' class='sentence'>An object of <span class='texttt'>optional<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span>
<a class='hidden_link' href='#def:contains_a_value,optional.ref' title='22.5.4.1&emsp;General&emsp;[optional.optional.ref.general]'><span id='def:contains_a_value,optional.ref'><i >contains a value</i></span></a>
if and only if <span class='texttt'><span class='texttt'><i >val</i></span> <span class='operator'>!</span><span class='operator'>=</span> <span class='literal'>nullptr</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#general-1.sentence-1'>.</a></div> <div id='general-1.sentence-2' class='sentence'>When an <span class='texttt'>optional<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span> contains a value,
the <a class='hidden_link' href='#def:contained_value,optional.ref' title='22.5.4.1&emsp;General&emsp;[optional.optional.ref.general]'><span id='def:contained_value,optional.ref'><i >contained value</i></span></a>
is a reference to <span class='texttt'><span class='operator'>*</span><span class='texttt'><i >val</i></span></span><a class='hidden_link' href='#general-1.sentence-2'>.</a></div></div></div></div><div id='optional.ref.ctor' class='section'><h4 ><a class='secnum' href='#optional.ref.ctor' style='min-width:95pt'>22.5.4.2</a> Constructors <a class='abbr_ref' href='optional.ref.ctor'>[optional.ref.ctor]</a></h4><div class='texpara'><div class='itemdecl' id='optional.ref.ctor-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.ctor-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Arg<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> optional<span class='parenthesis'>(</span>in_place_t, Arg<span class='operator'>&amp;</span><span class='operator'>&amp;</span> arg<span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='optional.ref.ctor-1'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4532'>#</a></div><div class='texpara'><div id='optional.ref.ctor-1.sentence-1' class='sentence'><i >Constraints</i>: <ul class='itemize'><li id='optional.ref.ctor-1.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-1.1'>(1.1)</a></div><span class='texttt'>is_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, Arg<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span>, and</li><li id='optional.ref.ctor-1.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-1.2'>(1.2)</a></div><span class='texttt'>reference_<span class='shy'></span>constructs_<span class='shy'></span>from_<span class='shy'></span>temporary_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, Arg<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#optional.ref.ctor-1.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='optional.ref.ctor-2'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4539'>#</a></div><div class='texpara'><div id='optional.ref.ctor-2.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'><span class='texttt'><i >convert-ref-init-val</i></span><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Arg<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>arg<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#optional.ref.ctor-2.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.ctor-3'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4543'>#</a></div><div class='texpara'><div id='optional.ref.ctor-3.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> contains a value<a class='hidden_link' href='#optional.ref.ctor-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.ctor-itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.ctor-itemdecl:2'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><span class='operator'>!</span>is_convertible_v<span class='anglebracket'>&lt;</span>U, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>
  optional<span class='parenthesis'>(</span>U<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='optional.ref.ctor-4'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4555'>#</a></div><div class='texpara'><div id='optional.ref.ctor-4.sentence-1' class='sentence'><i >Constraints</i>: <ul class='itemize'><li id='optional.ref.ctor-4.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-4.1'>(4.1)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>remove_<span class='shy'></span>cvref_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span>, optional<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>,</li><li id='optional.ref.ctor-4.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-4.2'>(4.2)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>remove_<span class='shy'></span>cvref_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span>, in_<span class='shy'></span>place_<span class='shy'></span>t<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>, and</li><li id='optional.ref.ctor-4.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-4.3'>(4.3)</a></div><span class='texttt'>is_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-4.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='optional.ref.ctor-5'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4563'>#</a></div><div class='texpara'><div id='optional.ref.ctor-5.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'><span class='texttt'><i >convert-ref-init-val</i></span><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>u<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#optional.ref.ctor-5.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.ctor-6'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4567'>#</a></div><div class='texpara'><div id='optional.ref.ctor-6.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> contains a value<a class='hidden_link' href='#optional.ref.ctor-6.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.ctor-7'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4571'>#</a></div><div class='texpara'><div id='optional.ref.ctor-7.sentence-1' class='sentence'><i >Remarks</i>: This constructor is defined as deleted if
<span class='codeblock'>reference_constructs_from_temporary_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span>
</span>
 is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-7.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.ctor-itemdecl:3'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.ctor-itemdecl:3'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><span class='operator'>!</span>is_convertible_v<span class='anglebracket'>&lt;</span>U<span class='operator'>&amp;</span>, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>
  optional<span class='parenthesis'>(</span>optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='optional.ref.ctor-8'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4587'>#</a></div><div class='texpara'><div id='optional.ref.ctor-8.sentence-1' class='sentence'><i >Constraints</i>: <ul class='itemize'><li id='optional.ref.ctor-8.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-8.1'>(8.1)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>remove_<span class='shy'></span>cv_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span>, optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>,</li><li id='optional.ref.ctor-8.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-8.2'>(8.2)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>, and</li><li id='optional.ref.ctor-8.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-8.3'>(8.3)</a></div><span class='texttt'>is_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-8.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='optional.ref.ctor-9'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4595'>#</a></div><div class='texpara'><div id='optional.ref.ctor-9.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>if</span> <span class='parenthesis'>(</span>rhs<span class='operator'>.</span>has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <i >convert-ref-init-val</i><span class='parenthesis'>(</span><span class='operator'>*</span>rhs<span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para' id='optional.ref.ctor-10'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4602'>#</a></div><div class='texpara'><div id='optional.ref.ctor-10.sentence-1' class='sentence'><i >Remarks</i>: This constructor is defined as deleted if
<span class='codeblock'>reference_constructs_from_temporary_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span>
</span>
is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-10.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.ctor-itemdecl:4'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.ctor-itemdecl:4'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><span class='operator'>!</span>is_convertible_v<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> U<span class='operator'>&amp;</span>, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>
  optional<span class='parenthesis'>(</span><span class='keyword'>const</span> optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, <span class='keyword'>const</span> U<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='optional.ref.ctor-11'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4618'>#</a></div><div class='texpara'><div id='optional.ref.ctor-11.sentence-1' class='sentence'><i >Constraints</i>: <ul class='itemize'><li id='optional.ref.ctor-11.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-11.1'>(11.1)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>remove_<span class='shy'></span>cv_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span>, optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>,</li><li id='optional.ref.ctor-11.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-11.2'>(11.2)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>, and</li><li id='optional.ref.ctor-11.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-11.3'>(11.3)</a></div><span class='texttt'>is_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, <span class='keyword'>const</span> U<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-11.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='optional.ref.ctor-12'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4626'>#</a></div><div class='texpara'><div id='optional.ref.ctor-12.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>if</span> <span class='parenthesis'>(</span>rhs<span class='operator'>.</span>has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <i >convert-ref-init-val</i><span class='parenthesis'>(</span><span class='operator'>*</span>rhs<span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para' id='optional.ref.ctor-13'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4633'>#</a></div><div class='texpara'><div id='optional.ref.ctor-13.sentence-1' class='sentence'><i >Remarks</i>: This constructor is defined as deleted if
<span class='codeblock'>reference_constructs_from_temporary_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, <span class='keyword'>const</span> U<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span>
</span>
is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-13.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.ctor-itemdecl:5'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.ctor-itemdecl:5'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><span class='operator'>!</span>is_convertible_v<span class='anglebracket'>&lt;</span>U, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>
  optional<span class='parenthesis'>(</span>optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='optional.ref.ctor-14'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4649'>#</a></div><div class='texpara'><div id='optional.ref.ctor-14.sentence-1' class='sentence'><i >Constraints</i>: <ul class='itemize'><li id='optional.ref.ctor-14.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-14.1'>(14.1)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>remove_<span class='shy'></span>cv_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span>, optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>,</li><li id='optional.ref.ctor-14.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-14.2'>(14.2)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>, and</li><li id='optional.ref.ctor-14.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-14.3'>(14.3)</a></div><span class='texttt'>is_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-14.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='optional.ref.ctor-15'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4657'>#</a></div><div class='texpara'><div id='optional.ref.ctor-15.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>if</span> <span class='parenthesis'>(</span>rhs<span class='operator'>.</span>has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <i >convert-ref-init-val</i><span class='parenthesis'>(</span><span class='operator'>*</span>std<span class='operator'>::</span>move<span class='parenthesis'>(</span>rhs<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para' id='optional.ref.ctor-16'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4664'>#</a></div><div class='texpara'><div id='optional.ref.ctor-16.sentence-1' class='sentence'><i >Remarks</i>: This constructor is defined as deleted if
<span class='codeblock'>reference_constructs_from_temporary_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span>
</span>
is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-16.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.ctor-itemdecl:6'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.ctor-itemdecl:6'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span><span class='parenthesis'>(</span><span class='operator'>!</span>is_convertible_v<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> U, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>
  optional<span class='parenthesis'>(</span><span class='keyword'>const</span> optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, <span class='keyword'>const</span> U<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='optional.ref.ctor-17'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4680'>#</a></div><div class='texpara'><div id='optional.ref.ctor-17.sentence-1' class='sentence'><i >Constraints</i>: <ul class='itemize'><li id='optional.ref.ctor-17.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-17.1'>(17.1)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>remove_<span class='shy'></span>cv_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span>, optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>,</li><li id='optional.ref.ctor-17.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-17.2'>(17.2)</a></div><span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span>, and</li><li id='optional.ref.ctor-17.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.ctor-17.3'>(17.3)</a></div><span class='texttt'>is_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, <span class='keyword'>const</span> U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-17.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='optional.ref.ctor-18'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4688'>#</a></div><div class='texpara'><div id='optional.ref.ctor-18.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>if</span> <span class='parenthesis'>(</span>rhs<span class='operator'>.</span>has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <i >convert-ref-init-val</i><span class='parenthesis'>(</span><span class='operator'>*</span>std<span class='operator'>::</span>move<span class='parenthesis'>(</span>rhs<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para' id='optional.ref.ctor-19'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.ctor-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4695'>#</a></div><div class='texpara'><div id='optional.ref.ctor-19.sentence-1' class='sentence'><i >Remarks</i>: This constructor is defined as deleted if
<span class='codeblock'>reference_constructs_from_temporary_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, <span class='keyword'>const</span> U<span class='anglebracket'>&gt;</span>
</span>
is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.ctor-19.sentence-1'>.</a></div></div></div></div></div><div id='optional.ref.assign' class='section'><h4 ><a class='secnum' href='#optional.ref.assign' style='min-width:95pt'>22.5.4.3</a> Assignment <a class='abbr_ref' href='optional.ref.assign'>[optional.ref.assign]</a></h4><div class='texpara'><div class='itemdecl' id='optional.ref.assign-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.assign-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> optional<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>nullopt_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.assign-1'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.assign-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4711'>#</a></div><div class='texpara'><div id='optional.ref.assign-1.sentence-1' class='sentence'><i >Effects</i>: Assigns <span class='texttt'><span class='literal'>nullptr</span></span> to <span class='texttt'><i >val</i></span><a class='hidden_link' href='#optional.ref.assign-1.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.assign-2'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.assign-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4715'>#</a></div><div class='texpara'><div id='optional.ref.assign-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> does not contain a value<a class='hidden_link' href='#optional.ref.assign-2.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.assign-3'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.assign-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4719'>#</a></div><div class='texpara'><div id='optional.ref.assign-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#optional.ref.assign-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.assign-itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.assign-itemdecl:2'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> T<span class='operator'>&amp;</span> emplace<span class='parenthesis'>(</span>U<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='optional.ref.assign-4'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.assign-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4730'>#</a></div><div class='texpara'><div id='optional.ref.assign-4.sentence-1' class='sentence'><i >Constraints</i>: <ul class='itemize'><li id='optional.ref.assign-4.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.assign-4.1'>(4.1)</a></div><span class='texttt'>is_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span>, and</li><li id='optional.ref.assign-4.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#optional.ref.assign-4.2'>(4.2)</a></div><span class='texttt'>reference_<span class='shy'></span>constructs_<span class='shy'></span>from_<span class='shy'></span>temporary_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>T<span class='operator'>&amp;</span>, U<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#optional.ref.assign-4.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='optional.ref.assign-5'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.assign-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4737'>#</a></div><div class='texpara'><div id='optional.ref.assign-5.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'><span class='texttt'><i >convert-ref-init-val</i></span><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>u<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#optional.ref.assign-5.sentence-1'>.</a></div></div></div></div></div><div id='optional.ref.swap' class='section'><h4 ><a class='secnum' href='#optional.ref.swap' style='min-width:95pt'>22.5.4.4</a> Swap <a class='abbr_ref' href='optional.ref.swap'>[optional.ref.swap]</a></h4><div class='texpara'><div class='itemdecl' id='optional.ref.swap-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.swap-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>optional<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.swap-1'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.swap-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4749'>#</a></div><div class='texpara'><div id='optional.ref.swap-1.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>swap<span class='parenthesis'>(</span><span class='texttt'><i >val</i></span>, rhs<span class='operator'>.</span><span class='texttt'><i >val</i></span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#optional.ref.swap-1.sentence-1'>.</a></div></div></div></div></div><div id='optional.ref.iterators' class='section'><h4 ><a class='secnum' href='#optional.ref.iterators' style='min-width:95pt'>22.5.4.5</a> Iterator support <a class='abbr_ref' href='optional.ref.iterators'>[optional.ref.iterators]</a></h4><div class='texpara'><div class='itemdecl' id='optional.ref.iterators-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.iterators-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>using</span> iterator <span class='operator'>=</span> <i >implementation-defined</i>;
</code></div></div><div class='para' id='optional.ref.iterators-1'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.iterators-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4761'>#</a></div><div class='texpara'><div id='optional.ref.iterators-1.sentence-1' class='sentence'>This type
models <a href='iterator.concept.contiguous#concept:contiguous_iterator' title='24.3.4.14&emsp;Concept contiguous_&shy;iterator&emsp;[iterator.concept.contiguous]'><span id='conceptref:contiguous_iterator'><span class='texttt'>contiguous_<span class='shy'></span>iterator</span></span></a> (<a href='iterator.concept.contiguous' title='24.3.4.14&emsp;Concept contiguous_&shy;iterator'>[iterator.<span class='shy'></span>concept.<span class='shy'></span>contiguous]</a>),
meets the <i >Cpp17RandomAccessIterator</i> requirements (<a href='random.access.iterators' title='24.3.5.7&emsp;Random access iterators'>[random.<span class='shy'></span>access.<span class='shy'></span>iterators]</a>),
and meets the requirements for constexpr iterators (<a href='iterator.requirements.general' title='24.3.1&emsp;General'>[iterator.<span class='shy'></span>requirements.<span class='shy'></span>general]</a>),
with value type <span class='texttt'>remove_<span class='shy'></span>cv_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#optional.ref.iterators-1.sentence-1'>.</a></div> <div id='optional.ref.iterators-1.sentence-2' class='sentence'>The reference type is <span class='texttt'>T<span class='operator'>&amp;</span></span> for <span class='texttt'>iterator</span><a class='hidden_link' href='#optional.ref.iterators-1.sentence-2'>.</a></div></div></div></div><div class='para' id='optional.ref.iterators-2'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.iterators-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4769'>#</a></div><div class='texpara'><div id='optional.ref.iterators-2.sentence-1' class='sentence'>All requirements on container iterators (<a href='container.reqmts' title='23.2.2.2&emsp;Container requirements'>[container.<span class='shy'></span>reqmts]</a>) apply to
<span class='texttt'>optional<span class='operator'>&#x200b;::&#x200b;</span>iterator</span><a class='hidden_link' href='#optional.ref.iterators-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.iterators-itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.iterators-itemdecl:2'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> iterator begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.iterators-3'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.iterators-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4779'>#</a></div><div class='texpara'><div id='optional.ref.iterators-3.sentence-1' class='sentence'><i >Returns</i>: If <span class='texttt'>has_<span class='shy'></span>value<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>,
  an iterator referring to <span class='texttt'><span class='operator'>*</span><span class='texttt'><i >val</i></span></span><a class='hidden_link' href='#optional.ref.iterators-3.sentence-1'>.</a></div> <div id='optional.ref.iterators-3.sentence-2' class='sentence'>Otherwise, a past-the-end iterator value<a class='hidden_link' href='#optional.ref.iterators-3.sentence-2'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.iterators-itemdecl:3'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.iterators-itemdecl:3'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> iterator end<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.iterators-4'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.iterators-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4791'>#</a></div><div class='texpara'><div id='optional.ref.iterators-4.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>+</span> has_<span class='shy'></span>value<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#optional.ref.iterators-4.sentence-1'>.</a></div></div></div></div></div><div id='optional.ref.observe' class='section'><h4 ><a class='secnum' href='#optional.ref.observe' style='min-width:95pt'>22.5.4.6</a> Observers <a class='abbr_ref' href='optional.ref.observe'>[optional.ref.observe]</a></h4><div class='texpara'><div class='itemdecl' id='optional.ref.observe-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.observe-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> T<span class='operator'>*</span> <span class='keyword'>operator</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.observe-1'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4803'>#</a></div><div class='texpara'><div id='optional.ref.observe-1.sentence-1' class='sentence'><i >Hardened preconditions</i>: <span class='texttt'>has_<span class='shy'></span>value<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.observe-1.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.observe-2'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4807'>#</a></div><div class='texpara'><div id='optional.ref.observe-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><i >val</i></span><a class='hidden_link' href='#optional.ref.observe-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.observe-itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.observe-itemdecl:2'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> T<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>*</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.observe-3'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4818'>#</a></div><div class='texpara'><div id='optional.ref.observe-3.sentence-1' class='sentence'><i >Hardened preconditions</i>: <span class='texttt'>has_<span class='shy'></span>value<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.observe-3.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.observe-4'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4822'>#</a></div><div class='texpara'><div id='optional.ref.observe-4.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='texttt'><i >val</i></span></span><a class='hidden_link' href='#optional.ref.observe-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.observe-itemdecl:3'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.observe-itemdecl:3'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> <span class='keyword'>operator</span> <span class='keyword'>bool</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.observe-5'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4832'>#</a></div><div class='texpara'><div id='optional.ref.observe-5.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='texttt'><i >val</i></span> <span class='operator'>!</span><span class='operator'>=</span> <span class='literal'>nullptr</span></span><a class='hidden_link' href='#optional.ref.observe-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.observe-itemdecl:4'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.observe-itemdecl:4'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>bool</span> has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.observe-6'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4842'>#</a></div><div class='texpara'><div id='optional.ref.observe-6.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='texttt'><i >val</i></span> <span class='operator'>!</span><span class='operator'>=</span> <span class='literal'>nullptr</span></span><a class='hidden_link' href='#optional.ref.observe-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.observe-itemdecl:5'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.observe-itemdecl:5'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> T<span class='operator'>&amp;</span> value<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div><div class='para' id='optional.ref.observe-7'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4852'>#</a></div><div class='texpara'><div id='optional.ref.observe-7.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>return</span> has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='operator'>*</span><i >val</i> <span class='operator'>:</span> <span class='keyword'>throw</span> bad_optional_access<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.observe-itemdecl:6'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.observe-itemdecl:6'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U <span class='operator'>=</span> remove_cv_t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>constexpr</span> remove_cv_t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span> value_or<span class='parenthesis'>(</span>U<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div><div class='para' id='optional.ref.observe-8'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4865'>#</a></div><div class='texpara'><div id='optional.ref.observe-8.sentence-1' class='sentence'>Let <span class='texttt'>X</span> be <span class='texttt'>remove_<span class='shy'></span>cv_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#optional.ref.observe-8.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.observe-9'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4868'>#</a></div><div class='texpara'><div id='optional.ref.observe-9.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>is_<span class='shy'></span>constructible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>X, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span> is_<span class='shy'></span>convertible_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>U, X<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.observe-9.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.observe-10'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.observe-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4872'>#</a></div><div class='texpara'><div id='optional.ref.observe-10.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>return</span> has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='operator'>*</span><i >val</i> <span class='operator'>:</span> <span class='keyword'>static_cast</span><span class='anglebracket'>&lt;</span>X<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>u<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span></div></div></div></div></div><div id='optional.ref.monadic' class='section'><h4 ><a class='secnum' href='#optional.ref.monadic' style='min-width:95pt'>22.5.4.7</a> Monadic operations <a class='abbr_ref' href='optional.ref.monadic'>[optional.ref.monadic]</a></h4><div class='texpara'><div class='itemdecl' id='optional.ref.monadic-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.monadic-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span> <span class='keyword'>constexpr</span> <span class='keyword'>auto</span> and_then<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div><div class='para' id='optional.ref.monadic-1'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4887'>#</a></div><div class='texpara'><div id='optional.ref.monadic-1.sentence-1' class='sentence'>Let <span class='texttt'>U</span> be <span class='texttt'>invoke_<span class='shy'></span>result_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>F, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#optional.ref.monadic-1.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.monadic-2'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4890'>#</a></div><div class='texpara'><div id='optional.ref.monadic-2.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>remove_<span class='shy'></span>cvref_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span></span> is a specialization of <span class='texttt'>optional</span><a class='hidden_link' href='#optional.ref.monadic-2.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.monadic-3'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4894'>#</a></div><div class='texpara'><div id='optional.ref.monadic-3.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>if</span> <span class='parenthesis'>(</span>has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> invoke<span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span>, <span class='operator'>*</span><i >val</i><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span> <span class='keyword'>else</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> remove_cvref_t<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.monadic-itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.monadic-itemdecl:2'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> optional<span class='anglebracket'>&lt;</span>remove_cv_t<span class='anglebracket'>&lt;</span>invoke_result_t<span class='anglebracket'>&lt;</span>F, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> transform<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div><div class='para' id='optional.ref.monadic-4'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4912'>#</a></div><div class='texpara'><div id='optional.ref.monadic-4.sentence-1' class='sentence'>Let <span class='texttt'>U</span> be <span class='texttt'>remove_<span class='shy'></span>cv_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>invoke_<span class='shy'></span>result_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>F, T<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#optional.ref.monadic-4.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.monadic-5'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4915'>#</a></div><div class='texpara'><div id='optional.ref.monadic-5.sentence-1' class='sentence'><i >Mandates</i>: The declaration
<span class='codeblock'>U u<span class='parenthesis'>(</span>invoke<span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span>, <span class='operator'>*</span><i >val</i><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span>
is well-formed for some invented variable <span class='texttt'>u</span><a class='hidden_link' href='#optional.ref.monadic-5.sentence-1'>.</a></div> <div id='optional.ref.monadic-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#optional.ref.monadic-note-1'>1</a></i>:&ensp;<div id='optional.ref.monadic-5.sentence-2' class='sentence'>There is no requirement that <span class='texttt'>U</span> is movable (<a href='dcl.init.general' title='9.5.1&emsp;General'>[dcl.<span class='shy'></span>init.<span class='shy'></span>general]</a>)<a class='hidden_link' href='#optional.ref.monadic-5.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='optional.ref.monadic-6'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4926'>#</a></div><div class='texpara'><div id='optional.ref.monadic-6.sentence-1' class='sentence'><i >Returns</i>: If <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> contains a value, an <span class='texttt'>optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span></span> object
whose contained value is direct-non-list-initialized with
<span class='texttt'>invoke<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span>, <span class='operator'>*</span><span class='texttt'><i >val</i></span><span class='parenthesis'>)</span></span>;
otherwise, <span class='texttt'>optional<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#optional.ref.monadic-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='optional.ref.monadic-itemdecl:3'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.monadic-itemdecl:3'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span> <span class='keyword'>constexpr</span> optional or_else<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div><div class='para' id='optional.ref.monadic-7'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4939'>#</a></div><div class='texpara'><div id='optional.ref.monadic-7.sentence-1' class='sentence'><i >Constraints</i>: <span class='texttt'>F</span> models <span class='texttt'><a href='concept.invocable#concept:invocable' title='18.7.2&emsp;Concept invocable&emsp;[concept.invocable]'><span id='conceptref:invocable'><span class='texttt'>invocable</span></span></a></span><a class='hidden_link' href='#optional.ref.monadic-7.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.monadic-8'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4943'>#</a></div><div class='texpara'><div id='optional.ref.monadic-8.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>is_<span class='shy'></span>same_<span class='shy'></span>v<span class='anglebracket'>&lt;</span>remove_<span class='shy'></span>cvref_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>invoke_<span class='shy'></span>result_<span class='shy'></span>t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>, optional<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#optional.ref.monadic-8.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.monadic-9'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.monadic-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4947'>#</a></div><div class='texpara'><div id='optional.ref.monadic-9.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>if</span> <span class='parenthesis'>(</span>has_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='operator'>*</span><i >val</i>;
<span class='curlybracket'>}</span> <span class='keyword'>else</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span></div></div></div></div></div><div id='optional.ref.mod' class='section'><h4 ><a class='secnum' href='#optional.ref.mod' style='min-width:95pt'>22.5.4.8</a> Modifiers <a class='abbr_ref' href='optional.ref.mod'>[optional.ref.mod]</a></h4><div class='texpara'><div class='itemdecl' id='optional.ref.mod-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.mod-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>void</span> reset<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div><div class='para' id='optional.ref.mod-1'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.mod-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4966'>#</a></div><div class='texpara'><div id='optional.ref.mod-1.sentence-1' class='sentence'><i >Effects</i>: Assigns <span class='texttt'><span class='literal'>nullptr</span></span> to <span class='texttt'><i >val</i></span><a class='hidden_link' href='#optional.ref.mod-1.sentence-1'>.</a></div></div></div></div><div class='para' id='optional.ref.mod-2'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.mod-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4970'>#</a></div><div class='texpara'><div id='optional.ref.mod-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> does not contain a value<a class='hidden_link' href='#optional.ref.mod-2.sentence-1'>.</a></div></div></div></div></div><div id='optional.ref.expos' class='section'><h4 ><a class='secnum' href='#optional.ref.expos' style='min-width:95pt'>22.5.4.9</a> Exposition only helper functions <a class='abbr_ref' href='optional.ref.expos'>[optional.ref.expos]</a></h4><div class='texpara'><div class='itemdecl' id='optional.ref.expos-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#optional.ref.expos-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>void</span> <span class='texttt'><i >convert-ref-init-val</i></span><span class='parenthesis'>(</span>U<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span>;  <span class='comment'>// <i >exposition only</i></span>
</code></div></div><div class='para' id='optional.ref.expos-1'><div class='marginalizedparent'><a class='marginalized' href='#optional.ref.expos-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/454ba171cb14531639e641cb1200617fbf8d943f/source/utilities.tex#L4983'>#</a></div><div class='texpara'><div id='optional.ref.expos-1.sentence-1' class='sentence'><i >Effects</i>: Creates a variable <span class='texttt'>r</span> as if by <span class='texttt'>T<span class='operator'>&amp;</span> r<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>U<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>u<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;</span>
and then initializes <span class='texttt'><i >val</i></span> with <span class='texttt'>addressof<span class='parenthesis'>(</span>r<span class='parenthesis'>)</span></span><a class='hidden_link' href='#optional.ref.expos-1.sentence-1'>.</a></div></div></div></div></div></div></body></html>