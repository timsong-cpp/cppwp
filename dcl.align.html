<!DOCTYPE html><html lang='en'><head><title>[dcl.align]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>9</a> Declarations <a class='abbr_ref' href='./#dcl.dcl'>[dcl.dcl]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>9.11</a> Attributes <a class='abbr_ref' href='dcl.attr#dcl.align'>[dcl.attr]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>9.11.2</a> Alignment specifier <a class='abbr_ref'>[dcl.align]</a></h3><span class='indexparent'><a class='index' id=':attribute,alignment'></a></span>
<span class='indexparent'><a class='index' id=':alignas'></a></span><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/99fac6b19fd2dd2044240f2dc9f600ea408afb7b/source/declarations.tex#L8467'>#</a></div><div id='1.sentence-1' class='sentence'>An <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i>
may be applied to a variable
or to a class data member, but it shall not be applied to a bit-field, a function
parameter, or an <i ><a href='except#nt:exception-declaration'>exception-declaration</a></i> (<a href='except.handle'>[except.handle]</a>)<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>An <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i> may also be applied to the declaration
of a class (in an
<i ><a href='dcl.type.elab#nt:elaborated-type-specifier'>elaborated-type-specifier</a></i> (<a href='dcl.type.elab'>[dcl.type.elab]</a>) or
<i ><a href='class#nt:class-head'>class-head</a></i> (<a href='class'>[class]</a>), respectively)<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>An <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i> with an ellipsis is a pack expansion (<a href='temp.variadic'>[temp.variadic]</a>)<a class='hidden_link' href='#1.sentence-3'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/99fac6b19fd2dd2044240f2dc9f600ea408afb7b/source/declarations.tex#L8478'>#</a></div><div id='2.sentence-1' class='sentence'>When the <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i> is of the form
<span class='texttt'><span class='keyword'>alignas</span><span class='parenthesis'>(</span></span> <i ><a href='expr.const#nt:constant-expression'>constant-expression</a></i> <span class='texttt'><span class='parenthesis'>)</span></span>:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.1'>(2.1)</a></div>the <i ><a href='expr.const#nt:constant-expression'>constant-expression</a></i> shall be an integral constant expression</li><li id='2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.2'>(2.2)</a></div>if the constant expression does not evaluate to an alignment
value (<a href='basic.align'>[basic.align]</a>), or evaluates to an extended alignment and
the implementation does not support that alignment in the context of the
declaration, the program is ill-formed<a class='hidden_link' href='#2.sentence-1'>.</a></li></ul></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/99fac6b19fd2dd2044240f2dc9f600ea408afb7b/source/declarations.tex#L8490'>#</a></div><div id='3.sentence-1' class='sentence'>An <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i> of the form
<span class='texttt'><span class='keyword'>alignas</span><span class='parenthesis'>(</span></span> <i ><a href='dcl.name#nt:type-id'>type-id</a></i> <span class='texttt'><span class='parenthesis'>)</span></span> has the same
effect as <span class='texttt'><span class='keyword'>alignas</span><span class='parenthesis'>(</span>&#x200b;<a href='expr.alignof'>alignof</a><span class='parenthesis'>(</span></span> <i ><a href='dcl.name#nt:type-id'>type-id</a></i> <span class='texttt'><span class='parenthesis'>)</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#3.sentence-1'>.</a></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/99fac6b19fd2dd2044240f2dc9f600ea408afb7b/source/declarations.tex#L8495'>#</a></div><div id='4.sentence-1' class='sentence'>The alignment requirement of an entity is the strictest nonzero alignment
specified by its <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i><span class='textit'>s</span>, if any;
otherwise, the <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i><span class='textit'>s</span> have no effect<a class='hidden_link' href='#4.sentence-1'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/99fac6b19fd2dd2044240f2dc9f600ea408afb7b/source/declarations.tex#L8500'>#</a></div><div id='5.sentence-1' class='sentence'>The combined effect of all <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i><span class='textit'>s</span> in a declaration shall not
specify an alignment that is less strict than the alignment that would
be required for the entity being declared if all <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i><span class='textit'>s</span>
appertaining to that entity
were omitted<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.example-1' class='example'>[&nbsp;<a class='example_link' href='#5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> <span class='keyword'>alignas</span><span class='parenthesis'>(</span><span class='literal'>8</span><span class='parenthesis'>)</span> S <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> <span class='keyword'>alignas</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span> U <span class='curlybracket'>{</span>
  S s;
<span class='curlybracket'>}</span>;  <span class='comment'>// error: <span class='tcode_in_codeblock'>U</span> specifies an alignment that is less strict than if the <span class='tcode_in_codeblock'>alignas(1)</span> were omitted.</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/99fac6b19fd2dd2044240f2dc9f600ea408afb7b/source/declarations.tex#L8515'>#</a></div><div id='6.sentence-1' class='sentence'>If the defining declaration of an entity has an
<i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i>, any non-defining
declaration of that entity shall either specify equivalent alignment or have no
<i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i><a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>Conversely, if any declaration of an entity has an
<i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i>,
every defining
declaration of that entity shall specify an equivalent alignment<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.sentence-3' class='sentence'>No diagnostic is required if declarations of an entity have
different <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i><span class='textit'>s</span>
in different translation units<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='6.example-1' class='example'>[&nbsp;<a class='example_link' href='#6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='comment'>// Translation unit #1:</span>
<span class='keyword'>struct</span> S <span class='curlybracket'>{</span> <span class='keyword'>int</span> x; <span class='curlybracket'>}</span> s, <span class='operator'>*</span>p <span class='operator'>=</span> <span class='operator'>&amp;</span>s;

<span class='comment'>// Translation unit #2:</span>
<span class='keyword'>struct</span> <span class='keyword'>alignas</span><span class='parenthesis'>(</span><span class='literal'>16</span><span class='parenthesis'>)</span> S;           <span class='comment'>// error: definition of <span class='tcode_in_codeblock'>S</span> lacks alignment, no diagnostic required</span>
<span class='keyword'>extern</span> S<span class='operator'>*</span> p;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/99fac6b19fd2dd2044240f2dc9f600ea408afb7b/source/declarations.tex#L8538'>#</a></div><div id='7.example-1' class='example'>[&nbsp;<a class='example_link' href='#7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='7.sentence-1' class='sentence'>An aligned buffer with an alignment requirement
of <span class='texttt'>A</span> and holding <span class='texttt'>N</span> elements of type <span class='texttt'>T</span>
can be declared as:
<pre class='codeblock'>
<span class='keyword'>alignas</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='keyword'>alignas</span><span class='parenthesis'>(</span>A<span class='parenthesis'>)</span> T buffer<span class='squarebracket'>[</span>N<span class='squarebracket'>]</span>;
</pre></div> <div id='7.sentence-2' class='sentence'>
Specifying <span class='texttt'><span class='keyword'>alignas</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span></span> ensures
that the final requested alignment will not be weaker than <span class='texttt'><span class='keyword'>alignof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span></span>,
and therefore the program will not be ill-formed<a class='hidden_link' href='#7.sentence-2'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/99fac6b19fd2dd2044240f2dc9f600ea408afb7b/source/declarations.tex#L8550'>#</a></div><div id='8.example-1' class='example'>[&nbsp;<a class='example_link' href='#8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>alignas</span><span class='parenthesis'>(</span><span class='keyword'>double</span><span class='parenthesis'>)</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                           <span class='comment'>// error: alignment applied to function</span>
<span class='keyword'>alignas</span><span class='parenthesis'>(</span><span class='keyword'>double</span><span class='parenthesis'>)</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> c<span class='squarebracket'>[</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='keyword'>double</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;    <span class='comment'>// array of characters, suitably aligned for a <span class='tcode_in_codeblock'>double</span></span>
<span class='keyword'>extern</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> c<span class='squarebracket'>[</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='keyword'>double</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;             <span class='comment'>// no <span class='tcode_in_codeblock'>alignas</span> necessary</span>
<span class='keyword'>alignas</span><span class='parenthesis'>(</span><span class='keyword'>float</span><span class='parenthesis'>)</span>
  <span class='keyword'>extern</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> c<span class='squarebracket'>[</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='keyword'>double</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;           <span class='comment'>// error: different alignment in declaration</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div></body></html>