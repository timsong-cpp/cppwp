<!DOCTYPE html><html lang='en'><head><title>[exec.util.cmplsig.trans]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>34</a> Execution control library <a class='abbr_ref' href='./#exec'>[exec]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>34.10</a> Sender/receiver utilities <a class='abbr_ref' href='exec.util#cmplsig.trans'>[exec.util]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>34.10.2</a> execution::transform_completion_signatures <a class='abbr_ref'>[exec.util.cmplsig.trans]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4844'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'><span class='texttt'>transform_<span class='shy'></span>completion_<span class='shy'></span>signatures</span> is an alias template
used to transform one set of completion signatures into another<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>It takes a set of completion signatures and
several other template arguments
that apply modifications to each completion signature in the set
to generate a new specialization of <span class='texttt'>completion_<span class='shy'></span>signature</span>s<a class='hidden_link' href='#1.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4851'>#</a></div><div class='texpara'><div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<div id='2.sentence-1' class='sentence'>Given a sender <span class='texttt'>Sndr</span> and an environment <span class='texttt'>Env</span>,
adapt the completion signatures of <span class='texttt'>Sndr</span> by
lvalue-ref qualifying the values,
adding an additional <span class='texttt'>exception_<span class='shy'></span>ptr</span> error completion
if its not already there, and
leaving the other completion signatures alone<a class='hidden_link' href='#2.sentence-1'>.</a></div> <span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> my_set_value_t <span class='operator'>=</span>
    completion_signatures<span class='anglebracket'>&lt;</span>
      set_value_t<span class='parenthesis'>(</span>add_lvalue_reference_t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;

<span class='keyword'>using</span> my_completion_signatures <span class='operator'>=</span>
  transform_completion_signatures<span class='anglebracket'>&lt;</span>
    completion_signatures_of_t<span class='anglebracket'>&lt;</span>Sndr, Env<span class='anglebracket'>&gt;</span>,
    completion_signatures<span class='anglebracket'>&lt;</span>set_error_t<span class='parenthesis'>(</span>exception_ptr<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>,
    my_set_value_t<span class='anglebracket'>&gt;</span>;
</span> â€”&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4873'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>This subclause makes use of the following exposition-only entities:
<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> As<span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> <i >default-set-value</i> <span class='operator'>=</span>
    completion_signatures<span class='anglebracket'>&lt;</span>set_value_t<span class='parenthesis'>(</span>As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Err<span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> <i >default-set-error</i> <span class='operator'>=</span>
    completion_signatures<span class='anglebracket'>&lt;</span>set_error_t<span class='parenthesis'>(</span>Err<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;
</span></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4885'>#</a></div><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std<span class='operator'>::</span>execution <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><a href='exec.snd.concepts#concept:valid-completion-signatures' title='34.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures'><span class='tcode_in_codeblock'><i >valid-completion-signatures</i></span></span></a> InputSignatures,
           <a href='exec.snd.concepts#concept:valid-completion-signatures' title='34.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures_'><span class='tcode_in_codeblock'><i >valid-completion-signatures</i></span></span></a> AdditionalSignatures <span class='operator'>=</span> completion_signatures<span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span>,
           <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> SetValue <span class='operator'>=</span> <i >default-set-value</i>,
           <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> SetError <span class='operator'>=</span> <i >default-set-error</i>,
           <a href='exec.snd.concepts#concept:valid-completion-signatures' title='34.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures__'><span class='tcode_in_codeblock'><i >valid-completion-signatures</i></span></span></a> SetStopped <span class='operator'>=</span> completion_signatures<span class='anglebracket'>&lt;</span>set_stopped_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> transform_completion_signatures <span class='operator'>=</span> completion_signatures<span class='anglebracket'>&lt;</span><i ><span class='texttt'>see below</span></i><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>
</span></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4897'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'><span class='texttt'>SetValue</span> shall name an alias template
such that for any pack of types <span class='texttt'>As</span>,
the type <span class='texttt'>SetValue<span class='anglebracket'>&lt;</span>As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span> is either ill-formed or else
<span class='texttt'><a href='exec.snd.concepts#concept:valid-completion-signatures' title='34.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures___'><span class='texttt'><i >valid-completion-signatures</i></span></span></a><span class='anglebracket'>&lt;</span>SetValue<span class='anglebracket'>&lt;</span>As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> is satisfied<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'><span class='texttt'>SetError</span> shall name an alias template
such that for any type <span class='texttt'>Err</span>,
<span class='texttt'>SetError<span class='anglebracket'>&lt;</span>Err<span class='anglebracket'>&gt;</span></span> is either ill-formed or else
<span class='texttt'><a href='exec.snd.concepts#concept:valid-completion-signatures' title='34.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures____'><span class='texttt'><i >valid-completion-signatures</i></span></span></a><span class='anglebracket'>&lt;</span>SetError<span class='anglebracket'>&lt;</span>Err<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> is satisfied<a class='hidden_link' href='#5.sentence-2'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4907'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>Let <span class='texttt'>Vs</span> be a pack of the types in the <span class='texttt'><i >type-list</i></span> named by
<span class='texttt'><span class='texttt'><i >gather-signatures</i></span><span class='anglebracket'>&lt;</span>set_<span class='shy'></span>value_<span class='shy'></span>t, InputSignatures, SetValue, <span class='texttt'><i >type-list</i></span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#6.sentence-1'>.</a></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4911'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'>Let <span class='texttt'>Es</span> be a pack of the types in the <span class='texttt'><i >type-list</i></span> named by
<span class='texttt'><span class='texttt'><i >gather-signatures</i></span><span class='anglebracket'>&lt;</span>set_<span class='shy'></span>error_<span class='shy'></span>t, InputSignatures, type_<span class='shy'></span>identity_<span class='shy'></span>t, <span class='texttt'><i >error-list</i></span><span class='anglebracket'>&gt;</span></span>,
where <span class='texttt'><i >error-list</i></span> is an alias template
such that <span class='texttt'><span class='texttt'><i >error-list</i></span><span class='anglebracket'>&lt;</span><br/>Ts<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span> is
<span class='texttt'><span class='texttt'><i >type-list</i></span><span class='anglebracket'>&lt;</span>SetError<span class='anglebracket'>&lt;</span>Ts<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#7.sentence-1'>.</a></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4918'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'>Let <span class='texttt'>Ss</span> name the type <span class='texttt'>completion_<span class='shy'></span>signatures<span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span></span> if
<span class='texttt'><span class='texttt'><i >gather-signatures</i></span><span class='anglebracket'>&lt;</span>set_<span class='shy'></span>stopped_<span class='shy'></span>t, InputSignatures, <span class='texttt'><i >type-list</i></span>, <span class='texttt'><i >type-list</i></span><span class='anglebracket'>&gt;</span></span>
is an alias for the type <span class='texttt'><span class='texttt'><i >type-list</i></span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span></span>;
otherwise, <span class='texttt'>SetStopped</span><a class='hidden_link' href='#8.sentence-1'>.</a></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/fa211bcab0c7576e345e93c5940bdd329450a5df/source/exec.tex#L4924'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'>If any of the above types are ill-formed,
then
<span class='codeblock'>transform_completion_signatures<span class='anglebracket'>&lt;</span>InputSignatures, AdditionalSignatures,
                                SetValue, SetError, SetStopped<span class='anglebracket'>&gt;</span>
</span>
is ill-formed<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.sentence-2' class='sentence'>Otherwise,
<span class='codeblock'>transform_completion_signatures<span class='anglebracket'>&lt;</span>InputSignatures, AdditionalSignatures,
                                SetValue, SetError, SetStopped<span class='anglebracket'>&gt;</span>
</span>
is the type <span class='texttt'>completion_<span class='shy'></span>signatures<span class='anglebracket'>&lt;</span>Sigs<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span>
where <span class='texttt'>Sigs<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> is the unique set of types in all the template arguments
of all the <span class='texttt'>completion_<span class='shy'></span>signatures</span> specializations in the set
<span class='texttt'>AdditionalSignatures</span>, <span class='texttt'>Vs<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span>, <span class='texttt'>Es<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span>, <span class='texttt'>Ss</span><a class='hidden_link' href='#9.sentence-2'>.</a></div></div></div></div></body></html>