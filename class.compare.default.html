<!DOCTYPE html><html lang='en'><head><title>[class.compare.default]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>11</a> Classes <a class='abbr_ref' href='./#class'>[class]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>11.11</a> Comparisons <a class='abbr_ref' href='class.compare#default'>[class.compare]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>11.11.1</a> Defaulted comparison operator functions <a class='abbr_ref'>[class.compare.default]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L6663'>#</a></div><div id='1.sentence-1' class='sentence'>A defaulted comparison operator function (<a href='over.binary' title='12.6.2&emsp;Binary operators'>[over.<span class='shy'></span>binary]</a>)
for some class <span class='texttt'>C</span>
shall be a non-template function
that is
<ul class='itemize'><li id='1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.1'>(1.1)</a></div>a non-static const non-volatile member of <span class='texttt'>C</span> having
one parameter of type <span class='texttt'><span class='keyword'>const</span> C<span class='operator'>&amp;</span></span> and either
no <a href='dcl.decl#nt:ref-qualifier' title='9.3&emsp;Declarators&emsp;[dcl.decl]'><span id='ntref:ref-qualifier'><span class='textsf'><span class='textit'>ref-qualifier</span></span></span></a> or
the <a href='dcl.decl#nt:ref-qualifier' title='9.3&emsp;Declarators&emsp;[dcl.decl]'><span id='ntref:ref-qualifier_'><span class='textsf'><span class='textit'>ref-qualifier</span></span></span></a> <span class='texttt'><span class='operator'>&amp;</span></span>, or</li><li id='1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.2'>(1.2)</a></div>a friend of <span class='texttt'>C</span> having either
two parameters of type <span class='texttt'><span class='keyword'>const</span> C<span class='operator'>&amp;</span></span> or
two parameters of type <span class='texttt'>C</span><a class='hidden_link' href='#1.sentence-1'>.</a></li></ul></div> <div id='1.sentence-2' class='sentence'>
A comparison operator function for class <span class='texttt'>C</span> that
is defaulted on its first declaration and
is not defined as deleted is
<a class='hidden_link' href='#def:operator,comparison,implicitly_defined' title='11.11.1&emsp;Defaulted comparison operator functions&emsp;[class.compare.default]'><span id='def:operator,comparison,implicitly_defined'><span class='textit'>implicitly defined</span></span></a>
when it is odr-used or needed for constant evaluation<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>Name lookups in the defaulted definition
of a comparison operator function
are performed from a context equivalent to
its <a href='dcl.fct.def.general#nt:function-body' title='9.5.1&emsp;In general&emsp;[dcl.fct.def.general]'><span id='ntref:function-body'><span class='textsf'><span class='textit'>function-body</span></span></span></a><a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'>A definition of a comparison operator as
defaulted that appears in a class shall be the first declaration
of that function<a class='hidden_link' href='#1.sentence-4'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L6693'>#</a></div><div id='2.sentence-1' class='sentence'>A defaulted <span class='texttt'><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span></span> or <span class='texttt'><span class='operator'>=</span><span class='operator'>=</span></span> operator function for class <span class='texttt'>C</span>
<span class='indexparent'><a class='index' id=':operator,three-way_comparison,deleted'></a></span><span class='indexparent'><a class='index' id=':operator,equality,deleted'></a></span>is defined as deleted if
any non-static data member of <span class='texttt'>C</span> is of reference type or
<span class='texttt'>C</span> has variant members (<a href='class.union.anon' title='11.5.1&emsp;Anonymous unions'>[class.<span class='shy'></span>union.<span class='shy'></span>anon]</a>)<a class='hidden_link' href='#2.sentence-1'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L6701'>#</a></div><div id='3.sentence-1' class='sentence'>A binary operator expression <span class='texttt'>a @ b</span> is
<a class='hidden_link' href='#def:usable,binary_operator_expression' title='11.11.1&emsp;Defaulted comparison operator functions&emsp;[class.compare.default]'><span id='def:usable,binary_operator_expression'><span class='textit'>usable</span></span></a>
if either
<ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div><span class='texttt'>a</span> or <span class='texttt'>b</span> is of class or enumeration type and
overload resolution (<a href='over.match' title='12.4&emsp;Overload resolution'>[over.<span class='shy'></span>match]</a>) as applied to <span class='texttt'>a @ b</span>
results in a usable candidate, or</li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div>neither <span class='texttt'>a</span> nor <span class='texttt'>b</span> is of class or enumeration type and
<span class='texttt'>a @ b</span> is a valid expression<a class='hidden_link' href='#3.sentence-1'>.</a></li></ul></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L6716'>#</a></div><div id='4.sentence-1' class='sentence'>A defaulted comparison function is
<span class='indexparent'><a class='index' id=':operator,comparison,constexpr-compatible'></a></span><a class='hidden_link' href='#def:constexpr-compatible,defaulted_comparison_operator' title='11.11.1&emsp;Defaulted comparison operator functions&emsp;[class.compare.default]'><span id='def:constexpr-compatible,defaulted_comparison_operator'><span class='textit'>constexpr-compatible</span></span></a>
if it
satisfies the requirements for a constexpr function (<a href='dcl.constexpr' title='9.2.5&emsp;The constexpr and consteval specifiers'>[dcl.<span class='shy'></span>constexpr]</a>) and
no overload resolution
performed when determining whether to delete the function
results in a usable candidate that is a non-constexpr function<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.note-1' class='note'>[<a class='note_link' href='#4.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='4.sentence-2' class='sentence'>This includes the overload resolutions performed:
<ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div>for an <span class='texttt'><span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span></span> whose return type is not <span class='texttt'><span class='keyword'>auto</span></span>,
when determining whether a synthesized three-way comparison is defined,</li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div>for an <span class='texttt'><span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span></span> whose return type is <span class='texttt'><span class='keyword'>auto</span></span> or
for an <span class='texttt'><span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span></span>,
for a comparison between an element of the expanded list of
subobjects and itself, or</li><li id='4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.3'>(4.3)</a></div>for a secondary comparison operator <span class='texttt'>@</span>,
for the expression <span class='texttt'>x @ y</span><a class='hidden_link' href='#4.sentence-2'>.</a></li></ul></div> —&nbsp;<i>end note</i>]</div> </div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L6744'>#</a></div><div id='5.sentence-1' class='sentence'>If the <a href='class.mem#nt:member-specification' title='11.4&emsp;Class members&emsp;[class.mem]'><span id='ntref:member-specification'><span class='textsf'><span class='textit'>member-specification</span></span></span></a>
does not explicitly declare
any member or friend named <span class='texttt'><span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span></span>,
an <span class='texttt'><span class='operator'>=</span><span class='operator'>=</span></span> operator function is declared implicitly
for each three-way comparison operator function
defined as defaulted in the <a href='class.mem#nt:member-specification' title='11.4&emsp;Class members&emsp;[class.mem]'><span id='ntref:member-specification_'><span class='textsf'><span class='textit'>member-specification</span></span></span></a>,
with the same access and <a href='dcl.fct.def.general#nt:function-definition' title='9.5.1&emsp;In general&emsp;[dcl.fct.def.general]'><span id='ntref:function-definition'><span class='textsf'><span class='textit'>function-definition</span></span></span></a> and
in the same class scope as
the respective three-way comparison operator function,
except that the return type is replaced with <span class='texttt'><span class='keyword'>bool</span></span> and
the <a href='dcl.decl#nt:declarator-id' title='9.3&emsp;Declarators&emsp;[dcl.decl]'><span id='ntref:declarator-id'><span class='textsf'><span class='textit'>declarator-id</span></span></span></a> is replaced with <span class='texttt'><span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span></span><a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.note-1' class='note'>[<a class='note_link' href='#5.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='5.sentence-2' class='sentence'>Such an implicitly-declared <span class='texttt'><span class='operator'>=</span><span class='operator'>=</span></span> operator for a class <span class='texttt'>X</span>
is defined as defaulted
in the definition of <span class='texttt'>X</span> and
has the same <a href='dcl.fct#nt:parameter-declaration-clause' title='9.3.3.5&emsp;Functions&emsp;[dcl.fct]'><span id='ntref:parameter-declaration-clause'><span class='textsf'><span class='textit'>parameter-declaration-clause</span></span></span></a> and
trailing <a href='temp.pre#nt:requires-clause' title='13.1&emsp;Preamble&emsp;[temp.pre]'><span id='ntref:requires-clause'><span class='textsf'><span class='textit'>requires-clause</span></span></span></a> as
the respective three-way comparison operator<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>It is declared with <span class='texttt'><span class='keyword'>friend</span></span>, <span class='texttt'><span class='keyword'>virtual</span></span>, <span class='texttt'><span class='keyword'>constexpr</span></span>,
or <span class='texttt'><span class='keyword'>consteval</span></span> if
the three-way comparison operator function is so declared<a class='hidden_link' href='#5.sentence-3'>.</a></div> <div id='5.sentence-4' class='sentence'>If the three-way comparison operator function
has no <a href='except.spec#nt:noexcept-specifier' title='14.5&emsp;Exception specifications&emsp;[except.spec]'><span id='ntref:noexcept-specifier'><span class='textsf'><span class='textit'>noexcept-specifier</span></span></span></a>,
the implicitly-declared <span class='texttt'><span class='operator'>=</span><span class='operator'>=</span></span> operator function
has an implicit exception specification (<a href='except.spec' title='14.5&emsp;Exception specifications'>[except.<span class='shy'></span>spec]</a>) that
may differ from the implicit exception specification of
the three-way comparison operator function<a class='hidden_link' href='#5.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div>  <div id='5.example-1' class='example'>[<a class='example_link' href='#5.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> X <span class='curlybracket'>{</span>
  <span class='keyword'>friend</span> <span class='keyword'>constexpr</span> std<span class='operator'>::</span>partial_ordering <span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>X, X<span class='parenthesis'>)</span> <span class='keyword'>requires</span> <span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>;
  <span class='comment'>// implicitly declares: <span class='tcode_in_codeblock'>friend constexpr bool operator==(X, X) requires (sizeof(T) != 1) = default;</span></span>

  <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>virtual</span> std<span class='operator'>::</span>strong_ordering <span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='keyword'>const</span> X<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='operator'>=</span> <span class='keyword'>default</span>;
  <span class='comment'>// implicitly declares: <span class='tcode_in_codeblock'>[[nodiscard]] virtual bool operator==(const X&amp;) const = default;</span></span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i>]</div>  <div id='5.note-2' class='note'>[<a class='note_link' href='#5.note-2'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='5.sentence-5' class='sentence'>The <span class='texttt'><span class='operator'>=</span><span class='operator'>=</span></span> operator function is declared implicitly even if
the defaulted three-way comparison operator function
is defined as deleted<a class='hidden_link' href='#5.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div> </div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L6790'>#</a></div><div id='6.sentence-1' class='sentence'>The direct base class subobjects of <span class='texttt'>C</span>,
in the order of their declaration in the <a href='class.derived#nt:base-specifier-list' title='11.7&emsp;Derived classes&emsp;[class.derived]'><span id='ntref:base-specifier-list'><span class='textsf'><span class='textit'>base-specifier-list</span></span></span></a> of <span class='texttt'>C</span>,
followed by the non-static data members of <span class='texttt'>C</span>,
in the order of their declaration in the <a href='class.mem#nt:member-specification' title='11.4&emsp;Class members&emsp;[class.mem]'><span id='ntref:member-specification__'><span class='textsf'><span class='textit'>member-specification</span></span></span></a> of <span class='texttt'>C</span>,
form a list of subobjects<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>In that list, any subobject of array type is recursively expanded
to the sequence of its elements, in the order of increasing subscript<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.sentence-3' class='sentence'>Let <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.225em;">x</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> be an lvalue denoting the <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">th</span></span></span></span></span></span></span> element
in the expanded list of subobjects for an object <span class='texttt'>x</span>
(of length <span class='math'><span class='mathalpha'>n</span></span>),
where <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.225em;">x</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is
formed by a sequence of
derived-to-base conversions (<a href='over.best.ics' title='12.4.3.1&emsp;Implicit conversion sequences'>[over.<span class='shy'></span>best.<span class='shy'></span>ics]</a>),
class member access expressions (<a href='expr.ref' title='7.6.1.4&emsp;Class member access'>[expr.<span class='shy'></span>ref]</a>), and
array subscript expressions (<a href='expr.sub' title='7.6.1.1&emsp;Subscripting'>[expr.<span class='shy'></span>sub]</a>) applied to <span class='texttt'>x</span><a class='hidden_link' href='#6.sentence-3'>.</a></div></div></div></body></html>