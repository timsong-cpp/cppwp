<!DOCTYPE html><html lang='en'><head><title>[locale.codecvt]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>22</a> Localization library <a class='abbr_ref' href='./#localization'>[localization]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>22.4</a> Standard <span class='texttt'>locale</span> categories <a class='abbr_ref' href='locale.categories#locale.codecvt'>[locale.categories]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>22.4.1</a> The <span class='texttt'>ctype</span> category <a class='abbr_ref' href='category.ctype#locale.codecvt'>[category.ctype]</a></h3><div id='locale.codecvt'><h4 ><a class='secnum' style='min-width:118pt'>22.4.1.4</a> Class template <span class='texttt'>codecvt</span> <a class='abbr_ref'>[locale.codecvt]</a></h4><p ><span class='indexparent'><a class='index' id='codecvt'></a></span></p><pre class='codeblock'>
namespace std {
  class codecvt_base {
  public:
    enum result { ok, partial, error, noconv };
  };

  template &lt;class internT, class externT, class stateT&gt;
    class codecvt : public locale::facet, public codecvt_base {
    public:
      using intern_type = internT;
      using extern_type = externT;
      using state_type  = stateT;

      explicit codecvt(size_t refs = 0);

      result out(
          stateT&amp; state,
          const internT* from, const internT* from_end, const internT*&amp; from_next,
                externT*   to,       externT*   to_end,       externT*&amp;   to_next) const;

      result unshift(
          stateT&amp; state,
                externT*    to,      externT*   to_end,       externT*&amp;   to_next) const;

      result in(
          stateT&amp; state,
          const externT* from, const externT* from_end, const externT*&amp; from_next,
                internT*   to,       internT*   to_end,       internT*&amp;   to_next) const;

      int encoding() const noexcept;
      bool always_noconv() const noexcept;
      int length(stateT&amp;, const externT* from, const externT* end, size_t max) const;
      int max_length() const noexcept;

      static locale::id id;

    protected:
      ~codecvt();
      virtual result do_out(
          stateT&amp; state,
          const internT* from, const internT* from_end, const internT*&amp; from_next,
                externT* to,         externT*   to_end,       externT*&amp;   to_next) const;
      virtual result do_in(
          stateT&amp; state,
          const externT* from, const externT* from_end, const externT*&amp; from_next,
                internT* to,         internT*   to_end,       internT*&amp;   to_next) const;
      virtual result do_unshift(
          stateT&amp; state,
                externT* to,         externT*   to_end,       externT*&amp;   to_next) const;

      virtual int do_encoding() const noexcept;
      virtual bool do_always_noconv() const noexcept;
      virtual int do_length(stateT&amp;, const externT* from, const externT* end, size_t max) const;
      virtual int do_max_length() const noexcept;
    };
}</pre><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2308'>#</a></div><p >The class
<span class='texttt'>codecvt&lt;internT, externT, stateT&gt;</span>
is for use when
converting from one character encoding to another, such as from wide characters
to multibyte  characters or between wide character encodings such as
Unicode and EUC.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2316'>#</a></div><p >The
<span class='texttt'>stateT</span>
argument selects the pair of character encodings being mapped between.</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2321'>#</a></div><p >The specializations required in Table <a href='locale.category#tab:localization.category.facets'>[tab:localization.category.facets]</a> (<a href='locale.category'>[locale.category]</a>)
convert the implementation-defined native character set.
<span class='texttt'>codecvt&lt;char, char, mbstate_t&gt;</span>
implements a degenerate conversion;
it does not convert at all.
The specialization <span class='texttt'>codecvt&lt;char16_t, char, mbstate_t&gt;</span>
converts between the UTF-16 and UTF-8 encoding forms, and
the specialization <span class='texttt'>codecvt</span> <span class='texttt'>&lt;char32_t, char, mbstate_t&gt;</span>
converts between the UTF-32 and UTF-8 encoding forms.
<span class='texttt'>codecvt&lt;wchar_t, char, mbstate_t&gt;</span>
converts between the native character sets for narrow and wide characters.
Specializations on
<span class='texttt'>mbstate_t</span>
perform conversion between encodings known to the library implementer.
Other encodings can be converted by specializing on a user-defined
<span class='texttt'>stateT</span>
type.
Objects of type
<span class='texttt'>stateT</span>
can contain any state that is useful to communicate to or from
the specialized
<span class='texttt'>do_in</span>
or
<span class='texttt'>do_out</span>
members.</p></div><div id='members'><h4 ><a class='secnum' href='#members' style='min-width:133pt'>22.4.1.4.1</a> <span class='texttt'>codecvt</span> members <a class='abbr_ref' href='locale.codecvt.members'>[locale.codecvt.members]</a></h4><p ><span class='indexparent'><a class='index' id='codecvt,out'></a></span><span class='indexparent'><a class='index' id='out,codecvt'></a></span><code class='itemdecl'>
result out(
    stateT&amp; state,
    const internT* from, const internT* from_end, const internT*&amp; from_next,
    externT* to, externT* to_end, externT*&amp; to_next) const;
</code></p><div class='itemdescr'></div><div class='para' id='members-1'><div class='marginalizedparent'><a class='marginalized' href='#members-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2359'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>do_out(state, from, from_end, from_next, to, to_end, to_next)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,unshift'></a></span><span class='indexparent'><a class='index' id='unshift,codecvt'></a></span><code class='itemdecl'>
result unshift(stateT&amp; state, externT* to, externT* to_end, externT*&amp; to_next) const;
</code></p><div class='itemdescr'></div><div class='para' id='members-2'><div class='marginalizedparent'><a class='marginalized' href='#members-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2370'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>do_unshift(state, to, to_end, to_next)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,in'></a></span><span class='indexparent'><a class='index' id='in,codecvt'></a></span><code class='itemdecl'>
result in(
    stateT&amp; state,
    const externT* from, const externT* from_end, const externT*&amp; from_next,
    internT* to, internT* to_end, internT*&amp; to_next) const;
</code></p><div class='itemdescr'></div><div class='para' id='members-3'><div class='marginalizedparent'><a class='marginalized' href='#members-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2384'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>do_in(state, from, from_end, from_next, to, to_end, to_next)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,encoding'></a></span><span class='indexparent'><a class='index' id='encoding,codecvt'></a></span><code class='itemdecl'>
int encoding() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='members-4'><div class='marginalizedparent'><a class='marginalized' href='#members-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2395'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>do_encoding()</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,always_noconv'></a></span><span class='indexparent'><a class='index' id='always_noconv,codecvt'></a></span><code class='itemdecl'>
bool always_noconv() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='members-5'><div class='marginalizedparent'><a class='marginalized' href='#members-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2406'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>do_always_noconv()</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,length'></a></span><span class='indexparent'><a class='index' id='length,codecvt'></a></span><code class='itemdecl'>
int length(stateT&amp; state, const externT* from, const externT* from_end, size_t max) const;
</code></p><div class='itemdescr'></div><div class='para' id='members-6'><div class='marginalizedparent'><a class='marginalized' href='#members-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2417'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>do_length(state, from, from_end, max)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,max_length'></a></span><span class='indexparent'><a class='index' id='max_length,codecvt'></a></span><code class='itemdecl'>
int max_length() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='members-7'><div class='marginalizedparent'><a class='marginalized' href='#members-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2428'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>do_max_length()</span>.
</p></div></div></div><div id='virtuals'><h4 ><a class='secnum' href='#virtuals' style='min-width:133pt'>22.4.1.4.2</a> <span class='texttt'>codecvt</span> virtual functions <a class='abbr_ref' href='locale.codecvt.virtuals'>[locale.codecvt.virtuals]</a></h4><p ><span class='indexparent'><a class='index' id='codecvt,do_out'></a></span><span class='indexparent'><a class='index' id='do_out,codecvt'></a></span><span class='indexparent'><a class='index' id='codecvt,do_in'></a></span><span class='indexparent'><a class='index' id='do_in,codecvt'></a></span><code class='itemdecl'>
result do_out(
    stateT&amp; state,
    const internT* from, const internT* from_end, const internT*&amp; from_next,
    externT* to, externT* to_end, externT*&amp; to_next) const;

result do_in(
    stateT&amp; state,
    const externT* from, const externT* from_end, const externT*&amp; from_next,
    internT* to, internT* to_end, internT*&amp; to_next) const;
</code></p><div class='itemdescr'></div><div class='para' id='virtuals-1'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2450'>#</a></div><p ><i>Requires:</i>
<span class='texttt'>(from &lt;= from_end &amp;&amp; to &lt;= to_end)</span>
well-defined and
<span class='texttt'>true</span>;
<span class='texttt'>state</span> initialized, if at the beginning of a sequence, or else equal to
the result of converting the preceding characters in the sequence.</p></div></div><div class='para' id='virtuals-2'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2458'>#</a></div><p ><i>Effects:</i>
Translates characters in the source range
<span class='texttt'>[from, from_end)</span>,
placing the results in sequential positions starting at destination <span class='texttt'>to</span>.
Converts no more than
<span class='texttt'>(from_end - from)</span>
source elements, and
stores no more than
<span class='texttt'>(to_end - to)</span>
destination elements.</p><p >Stops if it encounters a character it cannot convert.
It always leaves the <span class='texttt'>from_next</span> and <span class='texttt'>to_next</span> pointers
pointing one beyond the last element successfully converted.
If returns
<span class='texttt'>noconv</span>,
<span class='texttt'>internT</span>
and
<span class='texttt'>externT</span>
are the same type and the converted sequence is
identical to the input sequence
<span class='texttt'>[from, from_<span class='nobreak'></span>next)</span>.
<span class='texttt'>to_next</span> is set equal to <span class='texttt'>to</span>, the value of <span class='texttt'>state</span> is
unchanged, and there are no changes to the values in
<span class='texttt'>[to, to_end)</span>.</p></div></div><div class='para' id='virtuals-3'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2485'>#</a></div><p >A
<span class='texttt'>codecvt</span>
facet that is used by
<span class='texttt'>basic_filebuf</span> (<a href='file.streams'>[file.streams]</a>) shall have the property that if
</p><pre class='codeblock'>
do_out(state, from, from_end, from_next, to, to_end, to_next)</pre><p >would return
<span class='texttt'>ok</span>,
where
<span class='texttt'>from != from_end</span>,
then
</p><pre class='codeblock'>
do_out(state, from, from + 1, from_next, to, to_end, to_next)</pre><p >shall also return
<span class='texttt'>ok</span>,
and that if
</p><pre class='codeblock'>
do_in(state, from, from_end, from_next, to, to_end, to_next)</pre><p >would return
<span class='texttt'>ok</span>,
where
<span class='texttt'>to != to_end</span>,
then
</p><pre class='codeblock'>
do_in(state, from, from_end, from_next, to, to + 1, to_next)</pre><p >shall also return
<span class='texttt'>ok</span>.<a class='footnotenum' href='#footnote-236'>236</a>
[<span style='white-space:nowrap'>&thinsp;</span><i>Note:</i> As a result of operations on <span class='texttt'>state</span>, it can return <span class='texttt'>ok</span> or <span class='texttt'>partial</span> and set <span class='texttt'>from_next == from</span> and <span class='texttt'>to_next != to</span>. <i><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</i><span style='white-space:nowrap'>&thinsp;</span>]</p></div></div><div class='para' id='virtuals-4'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2527'>#</a></div><p ><i>Remarks:</i>
Its operations on <span class='texttt'>state</span> are unspecified.
[<span style='white-space:nowrap'>&thinsp;</span><i>Note:</i>
This argument can be used, for example, to maintain
shift state, to specify conversion options (such as count only), or to
identify a cache of seek offsets.
<i><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</i><span style='white-space:nowrap'>&thinsp;</span>]</p></div></div><div class='para' id='virtuals-5'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2536'>#</a></div><p ><i>Returns:</i>
An enumeration value, as summarized in Table <a href='#tab:localization.convert.result.values.out.in'>[tab:localization.convert.result.values.out.in]</a>.</p><div class='numberedTable' id='tab:localization.convert.result.values.out.in'>Table <a href='#tab:localization.convert.result.values.out.in'>71</a> — <span class='texttt'>do_in/do_out</span> result values<br><table ><tr class='rowsep'><td colspan='1' class='center'><b>Value</b></td><td colspan='1' class='center'><b>Meaning</b></td></tr><tr class='capsep'><td class='left'> 
<span class='texttt'>ok</span>                  </td><td class='justify'>   completed the conversion            </td></tr><tr ><td class='left'>
<span class='texttt'>partial</span>             </td><td class='justify'>   not all source characters converted </td></tr><tr ><td class='left'>
<span class='texttt'>error</span>               </td><td class='justify'>
encountered a character in <span class='texttt'>[from, from_end)</span>
that it could not convert                                           </td></tr><tr ><td class='left'>
<span class='texttt'>noconv</span>              </td><td class='justify'>
<span class='texttt'>internT</span> and <span class='texttt'>externT</span> are the same type, and input
sequence is identical to converted sequence                         </td></tr></table></div><p >A return value of
<span class='texttt'>partial</span>,
if
<span class='texttt'>(from_next == from_end)</span>,
indicates that either the destination sequence has not absorbed all the
available destination elements, or that additional source elements are
needed before another destination element can be produced.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,do_unshift'></a></span><span class='indexparent'><a class='index' id='do_unshift,codecvt'></a></span><code class='itemdecl'>
result do_unshift(stateT&amp; state, externT* to, externT* to_end, externT*&amp; to_next) const;
</code></p><div class='itemdescr'></div><div class='para' id='virtuals-6'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2569'>#</a></div><p ><i>Requires:</i>
<span class='texttt'>(to &lt;= to_end)</span>
well defined and <span class='texttt'>true</span>; state initialized, if at the beginning of a sequence,
or else equal to the result of converting the preceding characters in the
sequence.</p></div></div><div class='para' id='virtuals-7'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2576'>#</a></div><p ><i>Effects:</i>
Places characters starting at <span class='texttt'>to</span> that should be appended
to terminate a sequence when the current
<span class='texttt'>stateT</span>
is given by <span class='texttt'>state</span>.<a class='footnotenum' href='#footnote-237'>237</a>
Stores no more than
<span class='texttt'>(to_end - to)</span>
destination elements, and leaves the <span class='texttt'>to_next</span> pointer
pointing one beyond the last element successfully stored.</p></div></div><div class='para' id='virtuals-8'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2588'>#</a></div><p ><i>Returns:</i>
An enumeration value, as summarized in Table <a href='#tab:localization.convert.result.values.unshift'>[tab:localization.convert.result.values.unshift]</a>.</p><div class='numberedTable' id='tab:localization.convert.result.values.unshift'>Table <a href='#tab:localization.convert.result.values.unshift'>72</a> — <span class='texttt'>do_unshift</span> result values<br><table ><tr class='rowsep'><td colspan='1' class='center'><b>Value</b></td><td colspan='1' class='center'><b>Meaning</b></td></tr><tr class='capsep'><td class='left'> 
<span class='texttt'>ok</span>                  </td><td class='justify'>   completed the sequence                                  </td></tr><tr ><td class='left'>
<span class='texttt'>partial</span>             </td><td class='justify'>
space for more than <span class='texttt'>to_end - to</span> destination elements was needed
to terminate a sequence given the value of <span class='texttt'>state</span></td></tr><tr ><td class='left'>
<span class='texttt'>error</span>               </td><td class='justify'>   an unspecified error has occurred </td></tr><tr ><td class='left'>
<span class='texttt'>noconv</span>              </td><td class='justify'>   no termination is needed for this <span class='texttt'>state_type</span>    </td></tr></table></div></div></div><p ><span class='indexparent'><a class='index' id='codecvt,do_encoding'></a></span><span class='indexparent'><a class='index' id='do_encoding,codecvt'></a></span><code class='itemdecl'>
int do_encoding() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='virtuals-9'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2611'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>-1</span> if the encoding of the <span class='texttt'>externT</span> sequence is state-dependent; else the
constant number of <span class='texttt'>externT</span> characters needed to produce an internal
character; or <span class='texttt'>0</span> if this number is not a constant.<a class='footnotenum' href='#footnote-238'>238</a>
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,do_always_noconv'></a></span><span class='indexparent'><a class='index' id='do_always_noconv,codecvt'></a></span><code class='itemdecl'>
bool do_always_noconv() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='virtuals-10'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2628'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>true</span>
if
<span class='texttt'>do_in()</span>
and
<span class='texttt'>do_out()</span>
return
<span class='texttt'>noconv</span>
for all valid argument values.
<span class='texttt'>codecvt&lt;char, char, mbstate_t&gt;</span>
returns
<span class='texttt'>true</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,do_length'></a></span><span class='indexparent'><a class='index' id='do_length,codecvt'></a></span><code class='itemdecl'>
int do_length(stateT&amp; state, const externT* from, const externT* from_end, size_t max) const;
</code></p><div class='itemdescr'></div><div class='para' id='virtuals-11'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2649'>#</a></div><p ><i>Requires:</i>
<span class='texttt'>(from &lt;= from_end)</span>
well-defined and
<span class='texttt'>true</span>;
<span class='texttt'>state</span> initialized, if at the beginning of a sequence, or else equal to
the result of converting the preceding characters in the sequence.</p></div></div><div class='para' id='virtuals-12'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2657'>#</a></div><p ><i>Effects:</i>
The effect on the <span class='texttt'>state</span> argument is “as if” it called
<span class='texttt'>do_in(state, from, from_end, from, to, to+max, to)</span>
for <span class='texttt'>to</span> pointing to a buffer of at least <span class='texttt'>max</span> elements.</p></div></div><div class='para' id='virtuals-13'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2663'>#</a></div><p ><i>Returns:</i>
<span class='texttt'>(from_next-from)</span>
where
<span class='texttt'>from_next</span>
is the largest value in the range
<span class='texttt'>[from, from_end]</span>
such that the sequence of values in the range
<span class='texttt'>[from, from_next)</span>
represents
<span class='texttt'>max</span>
or fewer valid complete characters of type
<span class='texttt'>internT</span>.
The specialization
<span class='texttt'>codecvt&lt;char, char, mbstate_t&gt;</span>,
returns the lesser of
<span class='texttt'>max</span>
and
<span class='texttt'>(from_end-from)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='codecvt,do_max_length'></a></span><span class='indexparent'><a class='index' id='do_max_length,codecvt'></a></span><code class='itemdecl'>
int do_max_length() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='virtuals-14'><div class='marginalizedparent'><a class='marginalized' href='#virtuals-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/locales.tex#L2690'>#</a></div><p ><i>Returns:</i>
The maximum value that
<span class='texttt'>do_length(state, from, from_end, 1)</span>
can return for any valid range
<span class='texttt'>[from, from_end)</span>
and
<span class='texttt'>stateT</span>
value
<span class='texttt'>state</span>.
The specialization
<span class='texttt'>codecvt&lt;char, char, mbstate_t&gt;::do_max_length()</span>
returns 1.
</p></div></div><div class='footnote' id='footnote-236'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-236'>236)</a></div><p >Informally, this means that
<span class='texttt'>basic_filebuf</span>
assumes that the mappings from internal to external characters is
1 to N: a
<span class='texttt'>codecvt</span>
facet that is used by
<span class='texttt'>basic_filebuf</span>
must be able to translate characters one internal character at a time.
</p></div><div class='footnote' id='footnote-237'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-237'>237)</a></div><p >Typically these will be characters to return the state to
<span class='texttt'>stateT()</span>.</p></div><div class='footnote' id='footnote-238'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-238'>238)</a></div><p >If <span class='texttt'>encoding()</span>
yields <span class='texttt'>-1</span>, then more than <span class='texttt'>max_length()</span> <span class='texttt'>externT</span> elements
may be consumed when producing a single <span class='texttt'>internT</span> character, and additional
<span class='texttt'>externT</span> elements may appear at the end of a sequence after those that
yield the final <span class='texttt'>internT</span> character.</p></div></div></div></div></body></html>