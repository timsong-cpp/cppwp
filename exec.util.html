<!DOCTYPE html><html lang='en'><head><title>[exec.util]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>33</a> Execution control library <a class='abbr_ref' href='./#exec'>[exec]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>33.10</a> Sender/receiver utilities <a class='abbr_ref'>[exec.util]</a></h2><div id='cmplsig' class='section'><h3 ><a class='secnum' href='#cmplsig' style='min-width:80pt'>33.10.1</a> <span class='texttt'>execution&#x200b;::&#x200b;completion_<span class='shy'></span>signatures</span> <a class='abbr_ref' href='exec.util.cmplsig'>[exec.util.cmplsig]</a></h3><div class='para' id='cmplsig-1'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4758'>#</a></div><div class='texpara'><div id='cmplsig-1.sentence-1' class='sentence'><span class='texttt'>completion_<span class='shy'></span>signatures</span> is a type
that encodes a set of completion signatures (<a href='exec.async.ops' title='33.3&emsp;Asynchronous operations'>[exec.<span class='shy'></span>async.<span class='shy'></span>ops]</a>)<a class='hidden_link' href='#cmplsig-1.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='cmplsig-2'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4762'>#</a></div><div class='texpara'><div id='cmplsig-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cmplsig-example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> my_sender <span class='curlybracket'>{</span>
  <span class='keyword'>using</span> sender_concept <span class='operator'>=</span> sender_t;
  <span class='keyword'>using</span> completion_signatures <span class='operator'>=</span>
    execution<span class='operator'>::</span>completion_signatures<span class='anglebracket'>&lt;</span>
      set_value_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span>,
      set_value_t<span class='parenthesis'>(</span><span class='keyword'>int</span>, <span class='keyword'>float</span><span class='parenthesis'>)</span>,
      set_error_t<span class='parenthesis'>(</span>exception_ptr<span class='parenthesis'>)</span>,
      set_error_t<span class='parenthesis'>(</span>error_code<span class='parenthesis'>)</span>,
      set_stopped_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>;
</span> <div id='cmplsig-2.sentence-1' class='sentence'>
Declares <span class='texttt'>my_<span class='shy'></span>sender</span> to be a sender
that can complete by calling one of the following
for a receiver expression <span class='texttt'>rcvr</span>:
<ul class='itemize'><li id='cmplsig-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cmplsig-2.1'>(2.1)</a></div><span class='texttt'>set_<span class='shy'></span>value<span class='parenthesis'>(</span>rcvr<span class='parenthesis'>)</span></span></li><li id='cmplsig-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cmplsig-2.2'>(2.2)</a></div><span class='texttt'>set_<span class='shy'></span>value<span class='parenthesis'>(</span>rcvr, <span class='keyword'>int</span><span class='curlybracket'>{</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='curlybracket'>}</span>, <span class='keyword'>float</span><span class='curlybracket'>{</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span></span></li><li id='cmplsig-2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cmplsig-2.3'>(2.3)</a></div><span class='texttt'>set_<span class='shy'></span>error<span class='parenthesis'>(</span>rcvr, exception_<span class='shy'></span>ptr<span class='curlybracket'>{</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span></span></li><li id='cmplsig-2.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cmplsig-2.4'>(2.4)</a></div><span class='texttt'>set_<span class='shy'></span>error<span class='parenthesis'>(</span>rcvr, error_<span class='shy'></span>code<span class='curlybracket'>{</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span></span></li><li id='cmplsig-2.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cmplsig-2.5'>(2.5)</a></div><span class='texttt'>set_<span class='shy'></span>stopped<span class='parenthesis'>(</span>rcvr<span class='parenthesis'>)</span></span></li></ul></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='cmplsig-3'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4788'>#</a></div><div class='texpara'><div id='cmplsig-3.sentence-1' class='sentence'>This subclause makes use of the following exposition-only entities:
<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Fn<span class='anglebracket'>&gt;</span>
  <span class='keyword'>concept</span> <a class='hidden_link' href='#concept:completion-signature' title='33.10.1&emsp;execution&#x200b;::&#x200b;completion_&shy;signatures&emsp;[exec.util.cmplsig]'><span id='concept:completion-signature'><span class='tcode_in_codeblock'><i >completion-signature</i></span></span></a> <span class='operator'>=</span> <i ><span class='texttt'>see below</span></i>;
</span></div></div></div><div class='para' id='cmplsig-4'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4795'>#</a></div><div class='texpara'><div id='cmplsig-4.sentence-1' class='sentence'>A type <span class='texttt'>Fn</span> satisfies <a href='#concept:completion-signature' title='33.10.1&emsp;execution&#x200b;::&#x200b;completion_&shy;signatures&emsp;[exec.util.cmplsig]'><span id='conceptref:completion-signature'><span class='texttt'><i >completion-signature</i></span></span></a>
if and only if it is a function type with one of the following forms:
<ul class='itemize'><li id='cmplsig-4.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cmplsig-4.1'>(4.1)</a></div><div class='texpara'><div id='cmplsig-4.1.sentence-1' class='sentence'><span class='texttt'>set_<span class='shy'></span>value_<span class='shy'></span>t<span class='parenthesis'>(</span>Vs<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span>,
where <span class='texttt'>Vs</span> is a pack of object or reference types<a class='hidden_link' href='#cmplsig-4.1.sentence-1'>.</a></div></div></li><li id='cmplsig-4.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cmplsig-4.2'>(4.2)</a></div><div class='texpara'><div id='cmplsig-4.2.sentence-1' class='sentence'><span class='texttt'>set_<span class='shy'></span>error_<span class='shy'></span>t<span class='parenthesis'>(</span>Err<span class='parenthesis'>)</span></span>,
where <span class='texttt'>Err</span> is an object or reference type<a class='hidden_link' href='#cmplsig-4.2.sentence-1'>.</a></div></div></li><li id='cmplsig-4.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#cmplsig-4.3'>(4.3)</a></div><div class='texpara'><div id='cmplsig-4.3.sentence-1' class='sentence'><span class='texttt'>set_<span class='shy'></span>stopped_<span class='shy'></span>t<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span></div></div></li></ul></div></div></div><div class='para' id='cmplsig-5'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4809'>#</a></div><div class='texpara'><span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>bool</span><span class='anglebracket'>&gt;</span>
  <span class='keyword'>struct</span> <i >indirect-meta-apply</i> <span class='curlybracket'>{</span>
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> T, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> As<span class='anglebracket'>&gt;</span>
      <span class='keyword'>using</span> <i >meta-apply</i> <span class='operator'>=</span> T<span class='anglebracket'>&lt;</span>As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span>;                              <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span>
  <span class='keyword'>concept</span> <a class='hidden_link' href='#concept:always-true' title='33.10.1&emsp;execution&#x200b;::&#x200b;completion_&shy;signatures&emsp;[exec.util.cmplsig]'><span id='concept:always-true'><span class='tcode_in_codeblock'><i >always-true</i></span></span></a> <span class='operator'>=</span> <span class='literal'>true</span>;                                   <span class='comment'>// <i >exposition only</i></span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Tag,
         <a href='exec.snd.concepts#concept:valid-completion-signatures' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures'><span class='tcode_in_codeblock'><i >valid-completion-signatures</i></span></span></a> Completions,
         <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> Tuple,
         <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> Variant<span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> <i >gather-signatures</i> <span class='operator'>=</span> <i ><span class='texttt'>see below</span></i>;
</span></div></div><div class='para' id='cmplsig-6'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4827'>#</a></div><div class='texpara'><div id='cmplsig-6.sentence-1' class='sentence'>Let <span class='texttt'>Fns</span> be a pack of the arguments of
the <span class='texttt'>completion_<span class='shy'></span>signatures</span> specialization named by <span class='texttt'>Completions</span>,
let <span class='texttt'>TagFns</span> be a pack of the function types in <span class='texttt'>Fns</span>
whose return types are <span class='texttt'>Tag</span>, and
let <span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.298em;">Ts</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span></span> be a pack of the function argument types
in the <span class='math'><span class='mathalpha'>n</span></span>-th type in <span class='texttt'>TagFns</span><a class='hidden_link' href='#cmplsig-6.sentence-1'>.</a></div> <div id='cmplsig-6.sentence-2' class='sentence'>Then, given two variadic templates <span class='texttt'>Tuple</span> and <span class='texttt'>Variant</span>,
the type <span class='texttt'><span class='texttt'><i >gather-signatures</i></span><span class='anglebracket'>&lt;</span>Tag, Completions, Tuple, Variant<span class='anglebracket'>&gt;</span></span>
names the type
<span class='codeblock'><i >META-APPLY</i><span class='parenthesis'>(</span>Variant, <i >META-APPLY</i><span class='parenthesis'>(</span>Tuple, Ts<span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span></span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>,
                    <i >META-APPLY</i><span class='parenthesis'>(</span>Tuple, Ts<span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>,
                    &hellip;,
                    <i >META-APPLY</i><span class='parenthesis'>(</span>Tuple, Ts<span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span></span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
</span>
where <span class='math'><span class='mathalpha'>m</span></span> is the size of the pack <span class='texttt'>TagFns</span> and
<span class='texttt'>META<span class='operator'>-</span>APPLY<span class='parenthesis'>(</span>T, As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span> is equivalent to:
<span class='codeblock'><span class='keyword'>typename</span> <i >indirect-meta-apply</i><span class='anglebracket'>&lt;</span><i >always-true</i><span class='anglebracket'>&lt;</span>As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span><span class='keyword'>template</span> <i >meta-apply</i><span class='anglebracket'>&lt;</span>T, As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span>
</span></div></div></div><div class='para nonNormativeOnly' id='cmplsig-7'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4849'>#</a></div><div class='texpara'><div id='cmplsig-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#cmplsig-note-1'>1</a></i>:&ensp;<div id='cmplsig-7.sentence-1' class='sentence'>The purpose of <span class='texttt'><i >META-APPLY</i></span> is to make it valid
to use non-variadic templates as <span class='texttt'>Variant</span> and <span class='texttt'>Tuple</span> arguments
to <span class='texttt'><i >gather-signatures</i></span><a class='hidden_link' href='#cmplsig-7.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='cmplsig-8'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4856'>#</a></div><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std<span class='operator'>::</span>execution <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><a href='#concept:completion-signature' title='33.10.1&emsp;execution&#x200b;::&#x200b;completion_&shy;signatures&emsp;[exec.util.cmplsig]'><span id='conceptref:completion-signature_'><span class='tcode_in_codeblock'><i >completion-signature</i></span></span></a><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Fns<span class='anglebracket'>&gt;</span>
    <span class='keyword'>struct</span> completion_signatures <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Sndr, <span class='keyword'>class</span> Env <span class='operator'>=</span> env<span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span>,
           <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> Tuple <span class='operator'>=</span> <i >decayed-tuple</i>,
           <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> Variant <span class='operator'>=</span> <i >variant-or-empty</i><span class='anglebracket'>&gt;</span>
      <span class='keyword'>requires</span> <a href='exec.snd.concepts#concept:sender_in' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:sender_in'><span class='tcode_in_codeblock'>sender_<span class='shy'></span>in</span></span></a><span class='anglebracket'>&lt;</span>Sndr, Env<span class='anglebracket'>&gt;</span>
    <span class='keyword'>using</span> value_types_of_t <span class='operator'>=</span>
      <i >gather-signatures</i><span class='anglebracket'>&lt;</span>set_value_t, completion_signatures_of_t<span class='anglebracket'>&lt;</span>Sndr, Env<span class='anglebracket'>&gt;</span>, Tuple, Variant<span class='anglebracket'>&gt;</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Sndr, <span class='keyword'>class</span> Env <span class='operator'>=</span> env<span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span>,
           <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> Variant <span class='operator'>=</span> <i >variant-or-empty</i><span class='anglebracket'>&gt;</span>
      <span class='keyword'>requires</span> <a href='exec.snd.concepts#concept:sender_in' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:sender_in_'><span class='tcode_in_codeblock'>sender_<span class='shy'></span>in</span></span></a><span class='anglebracket'>&lt;</span>Sndr, Env<span class='anglebracket'>&gt;</span>
    <span class='keyword'>using</span> error_types_of_t <span class='operator'>=</span>
      <i >gather-signatures</i><span class='anglebracket'>&lt;</span>set_error_t, completion_signatures_of_t<span class='anglebracket'>&lt;</span>Sndr, Env<span class='anglebracket'>&gt;</span>,
                        type_identity_t, Variant<span class='anglebracket'>&gt;</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Sndr, <span class='keyword'>class</span> Env <span class='operator'>=</span> env<span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>
      <span class='keyword'>requires</span> <a href='exec.snd.concepts#concept:sender_in' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:sender_in__'><span class='tcode_in_codeblock'>sender_<span class='shy'></span>in</span></span></a><span class='anglebracket'>&lt;</span>Sndr, Env<span class='anglebracket'>&gt;</span>
    <span class='keyword'>constexpr</span> <span class='keyword'>bool</span> sends_stopped <span class='operator'>=</span>
      <span class='operator'>!</span><a href='concept.same#concept:same_as' title='18.4.2&emsp;Concept same_&shy;as&emsp;[concept.same]'><span id='conceptref:same_as'><span class='tcode_in_codeblock'>same_<span class='shy'></span>as</span></span></a><span class='anglebracket'>&lt;</span><i >type-list</i><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span>,
               <i >gather-signatures</i><span class='anglebracket'>&lt;</span>set_stopped_t, completion_signatures_of_t<span class='anglebracket'>&lt;</span>Sndr, Env<span class='anglebracket'>&gt;</span>,
                                 <i >type-list</i>, <i >type-list</i><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>
</span></div></div></div><div id='cmplsig.trans' class='section'><h3 ><a class='secnum' href='#cmplsig.trans' style='min-width:80pt'>33.10.2</a> <span class='texttt'>execution&#x200b;::&#x200b;transform_<span class='shy'></span>completion_<span class='shy'></span>signatures</span> <a class='abbr_ref' href='exec.util.cmplsig.trans'>[exec.util.cmplsig.trans]</a></h3><div class='para' id='cmplsig.trans-1'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4887'>#</a></div><div class='texpara'><div id='cmplsig.trans-1.sentence-1' class='sentence'><span class='texttt'>transform_<span class='shy'></span>completion_<span class='shy'></span>signatures</span> is an alias template
used to transform one set of completion signatures into another<a class='hidden_link' href='#cmplsig.trans-1.sentence-1'>.</a></div> <div id='cmplsig.trans-1.sentence-2' class='sentence'>It takes a set of completion signatures and
several other template arguments
that apply modifications to each completion signature in the set
to generate a new specialization of <span class='texttt'>completion_<span class='shy'></span>signature</span>s<a class='hidden_link' href='#cmplsig.trans-1.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='cmplsig.trans-2'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4894'>#</a></div><div class='texpara'><div id='cmplsig.trans-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#cmplsig.trans-example-1'>1</a></i>:&ensp;<div id='cmplsig.trans-2.sentence-1' class='sentence'>Given a sender <span class='texttt'>Sndr</span> and an environment <span class='texttt'>Env</span>,
adapt the completion signatures of <span class='texttt'>Sndr</span> by
lvalue-ref qualifying the values,
adding an additional <span class='texttt'>exception_<span class='shy'></span>ptr</span> error completion
if it is not already there, and
leaving the other completion signatures alone<a class='hidden_link' href='#cmplsig.trans-2.sentence-1'>.</a></div> <span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> my_set_value_t <span class='operator'>=</span>
    completion_signatures<span class='anglebracket'>&lt;</span>
      set_value_t<span class='parenthesis'>(</span>add_lvalue_reference_t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;

<span class='keyword'>using</span> my_completion_signatures <span class='operator'>=</span>
  transform_completion_signatures<span class='anglebracket'>&lt;</span>
    completion_signatures_of_t<span class='anglebracket'>&lt;</span>Sndr, Env<span class='anglebracket'>&gt;</span>,
    completion_signatures<span class='anglebracket'>&lt;</span>set_error_t<span class='parenthesis'>(</span>exception_ptr<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>,
    my_set_value_t<span class='anglebracket'>&gt;</span>;
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='cmplsig.trans-3'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4916'>#</a></div><div class='texpara'><div id='cmplsig.trans-3.sentence-1' class='sentence'>This subclause makes use of the following exposition-only entities:
<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> As<span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> <i >default-set-value</i> <span class='operator'>=</span>
    completion_signatures<span class='anglebracket'>&lt;</span>set_value_t<span class='parenthesis'>(</span>As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Err<span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> <i >default-set-error</i> <span class='operator'>=</span>
    completion_signatures<span class='anglebracket'>&lt;</span>set_error_t<span class='parenthesis'>(</span>Err<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;
</span></div></div></div><div class='para' id='cmplsig.trans-4'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4928'>#</a></div><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std<span class='operator'>::</span>execution <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><a href='exec.snd.concepts#concept:valid-completion-signatures' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures_'><span class='tcode_in_codeblock'><i >valid-completion-signatures</i></span></span></a> InputSignatures,
           <a href='exec.snd.concepts#concept:valid-completion-signatures' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures__'><span class='tcode_in_codeblock'><i >valid-completion-signatures</i></span></span></a> AdditionalSignatures <span class='operator'>=</span> completion_signatures<span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span>,
           <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> SetValue <span class='operator'>=</span> <i >default-set-value</i>,
           <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> SetError <span class='operator'>=</span> <i >default-set-error</i>,
           <a href='exec.snd.concepts#concept:valid-completion-signatures' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures___'><span class='tcode_in_codeblock'><i >valid-completion-signatures</i></span></span></a> SetStopped <span class='operator'>=</span> completion_signatures<span class='anglebracket'>&lt;</span>set_stopped_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>
  <span class='keyword'>using</span> transform_completion_signatures <span class='operator'>=</span> completion_signatures<span class='anglebracket'>&lt;</span><i ><span class='texttt'>see below</span></i><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>
</span></div></div><div class='para' id='cmplsig.trans-5'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4940'>#</a></div><div class='texpara'><div id='cmplsig.trans-5.sentence-1' class='sentence'><span class='texttt'>SetValue</span> shall name an alias template
such that for any pack of types <span class='texttt'>As</span>,
the type <span class='texttt'>SetValue<span class='anglebracket'>&lt;</span>As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span> is either ill-formed or else
<span class='texttt'><a href='exec.snd.concepts#concept:valid-completion-signatures' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures____'><span class='texttt'><i >valid-completion-signatures</i></span></span></a><span class='anglebracket'>&lt;</span>SetValue<span class='anglebracket'>&lt;</span>As<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> is satisfied<a class='hidden_link' href='#cmplsig.trans-5.sentence-1'>.</a></div> <div id='cmplsig.trans-5.sentence-2' class='sentence'><span class='texttt'>SetError</span> shall name an alias template
such that for any type <span class='texttt'>Err</span>,
<span class='texttt'>SetError<span class='anglebracket'>&lt;</span>Err<span class='anglebracket'>&gt;</span></span> is either ill-formed or else
<span class='texttt'><a href='exec.snd.concepts#concept:valid-completion-signatures' title='33.9.3&emsp;Sender concepts&emsp;[exec.snd.concepts]'><span id='conceptref:valid-completion-signatures_____'><span class='texttt'><i >valid-completion-signatures</i></span></span></a><span class='anglebracket'>&lt;</span>SetError<span class='anglebracket'>&lt;</span>Err<span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> is satisfied<a class='hidden_link' href='#cmplsig.trans-5.sentence-2'>.</a></div></div></div><div class='para' id='cmplsig.trans-6'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4950'>#</a></div><div class='texpara'><div id='cmplsig.trans-6.sentence-1' class='sentence'>Let <span class='texttt'>Vs</span> be a pack of the types in the <span class='texttt'><i >type-list</i></span> named by
<span class='texttt'><span class='texttt'><i >gather-signatures</i></span><span class='anglebracket'>&lt;</span>set_<span class='shy'></span>value_<span class='shy'></span>t, InputSignatures, SetValue, <span class='texttt'><i >type-list</i></span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#cmplsig.trans-6.sentence-1'>.</a></div></div></div><div class='para' id='cmplsig.trans-7'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4954'>#</a></div><div class='texpara'><div id='cmplsig.trans-7.sentence-1' class='sentence'>Let <span class='texttt'>Es</span> be a pack of the types in the <span class='texttt'><i >type-list</i></span> named by
<span class='texttt'><span class='texttt'><i >gather-signatures</i></span><span class='anglebracket'>&lt;</span>set_<span class='shy'></span>error_<span class='shy'></span>t, InputSignatures, type_<span class='shy'></span>identity_<span class='shy'></span>t, <span class='texttt'><i >error-list</i></span><span class='anglebracket'>&gt;</span></span>,
where <span class='texttt'><i >error-list</i></span> is an alias template
such that <span class='texttt'><span class='texttt'><i >error-list</i></span><span class='anglebracket'>&lt;</span>Ts<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span> is
<span class='texttt'><span class='texttt'><i >type-list</i></span><span class='anglebracket'>&lt;</span>SetError<span class='anglebracket'>&lt;</span>Ts<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#cmplsig.trans-7.sentence-1'>.</a></div></div></div><div class='para' id='cmplsig.trans-8'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4961'>#</a></div><div class='texpara'><div id='cmplsig.trans-8.sentence-1' class='sentence'>Let <span class='texttt'>Ss</span> name the type <span class='texttt'>completion_<span class='shy'></span>signatures<span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span></span> if
<span class='texttt'><span class='texttt'><i >gather-signatures</i></span><span class='anglebracket'>&lt;</span>set_<span class='shy'></span>stopped_<span class='shy'></span>t, InputSignatures, <span class='texttt'><i >type-list</i></span>, <span class='texttt'><i >type-list</i></span><span class='anglebracket'>&gt;</span></span>
is an alias for the type <span class='texttt'><span class='texttt'><i >type-list</i></span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span></span>;
otherwise, <span class='texttt'>SetStopped</span><a class='hidden_link' href='#cmplsig.trans-8.sentence-1'>.</a></div></div></div><div class='para' id='cmplsig.trans-9'><div class='marginalizedparent'><a class='marginalized' href='#cmplsig.trans-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/exec.tex#L4967'>#</a></div><div class='texpara'><div id='cmplsig.trans-9.sentence-1' class='sentence'>If any of the above types are ill-formed,
then
<span class='codeblock'>transform_completion_signatures<span class='anglebracket'>&lt;</span>InputSignatures, AdditionalSignatures,
                                SetValue, SetError, SetStopped<span class='anglebracket'>&gt;</span>
</span>
is ill-formed<a class='hidden_link' href='#cmplsig.trans-9.sentence-1'>.</a></div> <div id='cmplsig.trans-9.sentence-2' class='sentence'>Otherwise,
<span class='codeblock'>transform_completion_signatures<span class='anglebracket'>&lt;</span>InputSignatures, AdditionalSignatures,
                                SetValue, SetError, SetStopped<span class='anglebracket'>&gt;</span>
</span>
is the type <span class='texttt'>completion_<span class='shy'></span>signatures<span class='anglebracket'>&lt;</span>Sigs<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span>
where <span class='texttt'>Sigs<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> is the unique set of types in all the template arguments
of all the <span class='texttt'>completion_<span class='shy'></span>signatures</span> specializations in the set
<span class='texttt'>AdditionalSignatures</span>, <span class='texttt'>Vs<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span>, <span class='texttt'>Es<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span>, <span class='texttt'>Ss</span><a class='hidden_link' href='#cmplsig.trans-9.sentence-2'>.</a></div></div></div></div></div></body></html>