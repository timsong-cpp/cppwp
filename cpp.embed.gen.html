<!DOCTYPE html><html lang='en'><head><title>[cpp.embed.gen]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>15</a> Preprocessing directives <a class='abbr_ref' href='./#cpp'>[cpp]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>15.4</a> Resource inclusion <a class='abbr_ref' href='cpp.embed#gen'>[cpp.embed]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>15.4.1</a> General <a class='abbr_ref'>[cpp.embed.gen]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L845'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:search,bracket_resource' title='15.4.1&emsp;General&emsp;[cpp.embed.gen]'><span id='def:search,bracket_resource'><i >bracket resource search</i></span></a> for a sequence of characters
searches a sequence of places for a resource identified uniquely
by that sequence of characters<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>How the places are determined or the resource identified
is <a class='index' id=':determination_of_places_and_identification_of_resources_during_bracket_resource_search'></a>implementation-defined<a class='hidden_link' href='#1.sentence-2'>.</a></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L852'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:search,quote_resource' title='15.4.1&emsp;General&emsp;[cpp.embed.gen]'><span id='def:search,quote_resource'><i >quote resource search</i></span></a> for a sequence of characters
attempts to identify a resource that is named by the sequence of characters<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>The named resource is searched for
in an <a class='index' id=':search_for_resources_during_quote_resource_search'></a>implementation-defined manner<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>If the implementation does not support a quote resource search
for that sequence of characters, or if the search fails,
the result of the quote resource search
is the result of a bracket resource search for the same sequence of characters<a class='hidden_link' href='#2.sentence-3'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L862'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>A preprocessing directive of the form
<div class='simplebnf'>
<span class='terminal'><span class='preprocessordirective'># embed</span></span> <a href='lex.header#nt:header-name' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name'><span class='textsf'><i >header-name</i></span></span></a> <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens'><span class='textsf'><i >pp-tokens</i></span></span></a><span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span></span> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line'><span class='textsf'><i >new-line</i></span></span></a>
</div>
causes the replacement of that directive
by preprocessing tokens derived from data
in the resource identified by <a href='lex.header#nt:header-name' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name_'><span class='textsf'><i >header-name</i></span></span></a>,
as specified below<a class='hidden_link' href='#3.sentence-1'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L872'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'>If the <a href='lex.header#nt:header-name' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name__'><span class='textsf'><i >header-name</i></span></span></a> is of the form
<div class='simplebnf'>
<span class='terminal'><span class='anglebracket'>&lt;</span></span> <a href='lex.header#nt:h-char-sequence' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:h-char-sequence'><span class='textsf'><i >h-char-sequence</i></span></span></a> <span class='terminal'><span class='anglebracket'>&gt;</span></span>
</div>
the resource is identified by a bracket resource search
for the sequence of characters of the <a href='lex.header#nt:h-char-sequence' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:h-char-sequence_'><span class='textsf'><i >h-char-sequence</i></span></span></a><a class='hidden_link' href='#4.sentence-1'>.</a></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L880'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>If the <a href='lex.header#nt:header-name' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name___'><span class='textsf'><i >header-name</i></span></span></a> is of the form
<div class='simplebnf'>
<span class='terminal'>"</span> <a href='lex.header#nt:q-char-sequence' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:q-char-sequence'><span class='textsf'><i >q-char-sequence</i></span></span></a> <span class='terminal'>"</span>
</div>
the resource is identified by a quote resource search
for the sequence of characters of the <a href='lex.header#nt:q-char-sequence' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:q-char-sequence_'><span class='textsf'><i >q-char-sequence</i></span></span></a><a class='hidden_link' href='#5.sentence-1'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L888'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>If a bracket resource search fails,
or if a quote or bracket resource search identifies a resource
that cannot be processed by the implementation, the program is ill-formed<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='6.sentence-2' class='sentence'>If the resource cannot be processed, the program is ill-formed
even when processing <span class='texttt'><span class='preprocessordirective'>#embed</span></span> with <span class='texttt'>limit<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span></span> (<a href='cpp.embed.param.limit' title='15.4.2.1&emsp;limit parameter'>[cpp.<span class='shy'></span>embed.<span class='shy'></span>param.<span class='shy'></span>limit]</a>)
or evaluating <span class='texttt'><span class='preprocessordirective'>__has_<span class='shy'></span>embed</span></span><a class='hidden_link' href='#6.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L898'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'><i >Recommended practice</i>: A mechanism similar to, but distinct from, the
<a class='index' id=':sequence_of_places_searched_for_a_header'></a>implementation-defined
search paths used for <span class='texttt'><span class='preprocessordirective'>#include</span></span> (<a href='cpp.include' title='15.3&emsp;Source file inclusion'>[cpp.<span class='shy'></span>include]</a>)
is encouraged<a class='hidden_link' href='#7.sentence-1'>.</a></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L904'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'>Either form of the <span class='texttt'><span class='preprocessordirective'>#embed</span></span> directive processes the
<a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens_'><span class='textsf'><i >pp-tokens</i></span></span></a>, if present, just as in normal text<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>The <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens__'><span class='textsf'><i >pp-tokens</i></span></span></a> shall then have the form
<a href='cpp.pre#nt:embed-parameter-seq' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:embed-parameter-seq'><span class='textsf'><i >embed-parameter-seq</i></span></span></a><a class='hidden_link' href='#8.sentence-2'>.</a></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L910'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'>A resource is a source of data accessible from the translation environment<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.sentence-2' class='sentence'>A resource has an <a class='hidden_link' href='#def:implementation-resource-width' title='15.4.1&emsp;General&emsp;[cpp.embed.gen]'><span id='def:implementation-resource-width'><i >implementation-resource-width</i></span></a>, which is the
<a class='index' id=':size_in_bits_of_a_resource'></a>implementation-defined
size in bits of the resource<a class='hidden_link' href='#9.sentence-2'>.</a></div> <div id='9.sentence-3' class='sentence'>If the implementation-resource-width is not an integral multiple of
<span id='lib:CHAR_BIT'><span class='texttt'>CHAR_<span class='shy'></span>BIT</span></span>, the program is ill-formed<a class='hidden_link' href='#9.sentence-3'>.</a></div> <div id='9.sentence-4' class='sentence'>Let <a class='hidden_link' href='#def:implementation-resource-count' title='15.4.1&emsp;General&emsp;[cpp.embed.gen]'><span id='def:implementation-resource-count'><i >implementation-resource-count</i></span></a> be
implementation-resource-width divided by <span id='lib:CHAR_BIT_'><span class='texttt'>CHAR_<span class='shy'></span>BIT</span></span><a class='hidden_link' href='#9.sentence-4'>.</a></div> <div id='9.sentence-5' class='sentence'>Every resource also has a <a class='hidden_link' href='#def:resource-count' title='15.4.1&emsp;General&emsp;[cpp.embed.gen]'><span id='def:resource-count'><i >resource-count</i></span></a>, which is</div></div><div class='texpara'><ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.1'>(9.1)</a></div>the value as computed from the optionally-provided <span class='texttt'>limit</span>
  <a href='cpp.pre#nt:embed-parameter' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:embed-parameter'><span class='textsf'><i >embed-parameter</i></span></span></a> (<a href='cpp.embed.param.limit' title='15.4.2.1&emsp;limit parameter'>[cpp.<span class='shy'></span>embed.<span class='shy'></span>param.<span class='shy'></span>limit]</a>), if present;</li><li id='9.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.2'>(9.2)</a></div>otherwise, the implementation-resource-count.</li></ul></div><div class='texpara'><div id='9.sentence-6' class='sentence'>A resource is empty if the resource-count is zero<a class='hidden_link' href='#9.sentence-6'>.</a></div></div></div><div class='para nonNormativeOnly' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L931'>#</a></div><div class='texpara'><div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='comment'>// ill-formed if the implementation-resource-width is 6 bits</span>
<span class='preprocessordirective'>#embed</span> <span class='literal'>"6_bits.bin"</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L939'>#</a></div><div class='texpara'><div id='11.sentence-1' class='sentence'>The <span class='texttt'><span class='preprocessordirective'>#embed</span></span> directive is replaced by a comma-separated list of integer
literals of type <span class='texttt'><span class='keyword'>int</span></span>, unless otherwise modified by embed
parameters (<a href='cpp.embed.param' title='15.4.2&emsp;Embed parameters'>[cpp.<span class='shy'></span>embed.<span class='shy'></span>param]</a>)<a class='hidden_link' href='#11.sentence-1'>.</a></div></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L944'>#</a></div><div class='texpara'><div id='12.sentence-1' class='sentence'>The integer literals in the comma-separated list correspond to
resource-count consecutive calls to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>fgetc</span> (<a href='cstdio.syn' title='31.13.1&emsp;Header &lt;cstdio&gt; synopsis'>[cstdio.<span class='shy'></span>syn]</a>)
from the resource, as a binary file<a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.sentence-2' class='sentence'>If any call to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>fgetc</span> returns <span class='texttt'>EOF</span>, the program is
ill-formed<a class='hidden_link' href='#12.sentence-2'>.</a></div></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L951'>#</a></div><div class='texpara'><div id='13.sentence-1' class='sentence'><i >Recommended practice</i>: The value of each integer literal should closely represent
the bit stream of the resource unmodified<a class='hidden_link' href='#13.sentence-1'>.</a></div> <div id='13.sentence-2' class='sentence'>This can require an implementation to consider potential differences between
translation and execution environments, as well as any other applicable
sources of mismatch<a class='hidden_link' href='#13.sentence-2'>.</a></div></div><div class='texpara'><div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>cstring<span class='anglebracket'>&gt;</span>
<span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>cstddef<span class='anglebracket'>&gt;</span>
<span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>fstream<span class='anglebracket'>&gt;</span>
<span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>vector<span class='anglebracket'>&gt;</span>
<span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>cassert<span class='anglebracket'>&gt;</span>

<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='comment'>// If the file is the same as the resource in the translation environment, no assert in this program should fail.</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> d<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span>
<span class='preprocessordirective'>#embed</span> <span class='anglebracket'>&lt;</span>data<span class='operator'>.</span>dat<span class='anglebracket'>&gt;</span>
  <span class='curlybracket'>}</span>;
  <span class='keyword'>const</span> std<span class='operator'>::</span>vector<span class='anglebracket'>&lt;</span><span class='keyword'>unsigned</span> <span class='keyword'>char</span><span class='anglebracket'>&gt;</span> vec_d <span class='operator'>=</span> <span class='curlybracket'>{</span>
<span class='preprocessordirective'>#embed</span> <span class='anglebracket'>&lt;</span>data<span class='operator'>.</span>dat<span class='anglebracket'>&gt;</span>
  <span class='curlybracket'>}</span>;

  <span class='keyword'>constexpr</span> std<span class='operator'>::</span>size_t expected_size <span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>d<span class='parenthesis'>)</span>;

  <span class='comment'>// same file in execution environment as was embedded</span>
  std<span class='operator'>::</span>ifstream f_source<span class='parenthesis'>(</span><span class='literal'>"data.dat"</span>, std<span class='operator'>::</span>ios<span class='operator'>::</span>binary <span class='operator'>|</span> std<span class='operator'>::</span>ios<span class='operator'>::</span>in<span class='parenthesis'>)</span>;
  <span class='keyword'>unsigned</span> <span class='keyword'>char</span> runtime_d<span class='squarebracket'>[</span>expected_size<span class='squarebracket'>]</span>;
  <span class='keyword'>char</span><span class='operator'>*</span> ifstream_ptr <span class='operator'>=</span> <span class='keyword'>reinterpret_cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>runtime_d<span class='parenthesis'>)</span>;
  assert<span class='parenthesis'>(</span><span class='operator'>!</span>f_source<span class='operator'>.</span>read<span class='parenthesis'>(</span>ifstream_ptr, expected_size<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
  std<span class='operator'>::</span>size_t ifstream_size <span class='operator'>=</span> f_source<span class='operator'>.</span>gcount<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  assert <span class='parenthesis'>(</span>ifstream_size <span class='operator'>=</span><span class='operator'>=</span> expected_size<span class='parenthesis'>)</span>;
  <span class='keyword'>int</span> is_same <span class='operator'>=</span> std<span class='operator'>::</span>memcmp<span class='parenthesis'>(</span><span class='operator'>&amp;</span>d<span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span>, ifstream_ptr, ifstream_size<span class='parenthesis'>)</span>;
  assert<span class='parenthesis'>(</span>is_same <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;
  <span class='keyword'>int</span> is_same_vec <span class='operator'>=</span> std<span class='operator'>::</span>memcmp<span class='parenthesis'>(</span>vec_d<span class='operator'>.</span>data<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, ifstream_ptr, ifstream_size<span class='parenthesis'>)</span>;
  assert<span class='parenthesis'>(</span>is_same_vec <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>int</span> i <span class='operator'>=</span> <span class='curlybracket'>{</span>
<span class='preprocessordirective'>#embed</span> <span class='literal'>"i.dat"</span>
<span class='curlybracket'>}</span>;  <span class='comment'>// well-formed if <span class='tcode_in_codeblock'>i.dat</span> produces a single value</span>
<span class='keyword'>int</span> i2 <span class='operator'>=</span>
<span class='preprocessordirective'>#embed</span> <span class='literal'>"i.dat"</span>
;   <span class='comment'>// also well-formed if <span class='tcode_in_codeblock'>i.dat</span> produces a single value</span>
<span class='keyword'>struct</span> s <span class='curlybracket'>{</span>
  <span class='keyword'>double</span> a, b, c;
  <span class='keyword'>struct</span> <span class='curlybracket'>{</span> <span class='keyword'>double</span> e, f, g; <span class='curlybracket'>}</span> x;
  <span class='keyword'>double</span> h, i, j;
<span class='curlybracket'>}</span>;
s x <span class='operator'>=</span> <span class='curlybracket'>{</span>
<span class='comment'>// well-formed if the directive produces nine or fewer values</span>
<span class='preprocessordirective'>#embed</span> <span class='literal'>"s.dat"</span>
<span class='curlybracket'>}</span>;
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/98ce5ac6fbce2338787adb9b1c842fcf8ebab37c/source/preprocessor.tex#L1012'>#</a></div><div class='texpara'><div id='14.sentence-1' class='sentence'>A preprocessing directive of the form
<div class='simplebnf'>
<span class='terminal'><span class='preprocessordirective'># embed</span></span> <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens___'><span class='textsf'><i >pp-tokens</i></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line_'><span class='textsf'><i >new-line</i></span></span></a>
</div>
(that does not match the previous form) is permitted<a class='hidden_link' href='#14.sentence-1'>.</a></div> <div id='14.sentence-2' class='sentence'>The preprocessing tokens after <span class='texttt'>embed</span> in the directive are processed
just as in normal text (i.e., each identifier currently defined as a macro
name is replaced by its replacement list of preprocessing tokens)<a class='hidden_link' href='#14.sentence-2'>.</a></div> <div id='14.sentence-3' class='sentence'>Then, an attempt is made to form a <a href='lex.header#nt:header-name' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name____'><span class='textsf'><i >header-name</i></span></span></a>
preprocessing token (<a href='lex.header' title='5.6&emsp;Header names'>[lex.<span class='shy'></span>header]</a>) from the whitespace and the characters
of the spellings of the resulting sequence of preprocessing tokens immediately after <span class='texttt'>embed</span>;
the treatment of whitespace
is <a class='index' id=':treatment_of_whitespace_when_processing_a_#embed_directive'></a>implementation-defined<a class='hidden_link' href='#14.sentence-3'>.</a></div> <div id='14.sentence-4' class='sentence'>If the attempt succeeds, the directive with the so-formed <a href='lex.header#nt:header-name' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name_____'><span class='textsf'><i >header-name</i></span></span></a>
is processed as specified for the previous form<a class='hidden_link' href='#14.sentence-4'>.</a></div> <div id='14.sentence-5' class='sentence'>Otherwise, the program is ill-formed<a class='hidden_link' href='#14.sentence-5'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='14.sentence-6' class='sentence'>Adjacent <a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal'><span class='textsf'><i >string-literal</i></span></span></a><i >s</i> are not concatenated into a single
<a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal_'><span class='textsf'><i >string-literal</i></span></span></a> (see the translation phases in <a href='lex.phases' title='5.2&emsp;Phases of translation'>[lex.<span class='shy'></span>phases]</a>);
thus, an expansion that results in two <a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal__'><span class='textsf'><i >string-literal</i></span></span></a><i >s</i> is an
invalid directive<a class='hidden_link' href='#14.sentence-6'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='14.sentence-7' class='sentence'>
Any further processing as in normal text described for the previous
form is not performed<a class='hidden_link' href='#14.sentence-7'>.</a></div> <div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>:&ensp;<div id='14.sentence-8' class='sentence'>That is, processing as in normal text happens once and only once for the entire
directive<a class='hidden_link' href='#14.sentence-8'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-4'>4</a></i>:&ensp;<div id='14.sentence-9' class='sentence'>If the directive matches the second form, the whole directive is replaced<a class='hidden_link' href='#14.sentence-9'>.</a></div> <div id='14.sentence-10' class='sentence'>If the directive matches the first form, everything after the <a href='lex.header#nt:header-name' title='5.6&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name______'><span class='textsf'><i >header-name</i></span></span></a> is replaced<a class='hidden_link' href='#14.sentence-10'>.</a></div> <div id='14.sentence-11' class='sentence'><span class='codeblock'><span class='preprocessordirective'>#define</span> EMPTY
<span class='preprocessordirective'>#define</span> X myfile
<span class='preprocessordirective'>#define</span> Y rsc
<span class='preprocessordirective'>#define</span> Z <span class='literal'>42</span>
<span class='preprocessordirective'>#embed</span> <span class='anglebracket'>&lt;</span>myfile<span class='operator'>.</span>rsc<span class='anglebracket'>&gt;</span> prefix<span class='parenthesis'>(</span>Z<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#embed</span> EMPTY <span class='anglebracket'>&lt;</span>X<span class='operator'>.</span>Y<span class='anglebracket'>&gt;</span>  prefix<span class='parenthesis'>(</span>Z<span class='parenthesis'>)</span>
</span>
is equivalent to:
<span class='codeblock'><span class='preprocessordirective'>#embed</span> <span class='anglebracket'>&lt;</span>myfile<span class='operator'>.</span>rsc<span class='anglebracket'>&gt;</span> prefix<span class='parenthesis'>(</span><span class='literal'>42</span><span class='parenthesis'>)</span>
<span class='preprocessordirective'>#embed</span> <span class='anglebracket'>&lt;</span>myfile<span class='operator'>.</span>rsc<span class='anglebracket'>&gt;</span> prefix<span class='parenthesis'>(</span><span class='literal'>42</span><span class='parenthesis'>)</span>
</span></div> —&nbsp;<i>end example</i>]</div></div></div></div></div></body></html>