<!DOCTYPE html><html lang='en'><head><title>[cpp.import]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>15</a> Preprocessing directives <a class='abbr_ref' href='./#cpp'>[cpp]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>15.4</a> Header unit importation <a class='abbr_ref'>[cpp.import]</a></h2><span class='indexparent'><a class='index' id=':header_unit,preprocessing'></a></span><span class='indexparent'><a class='index' id=':macro,import'></a></span>
<pre class='bnf'><a class='nontermdef' href='#nt:pp-import' id='nt:pp-import'>pp-import:</a>
&#9;<span class='terminal'><span class='keyword'>export</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='keyword'>import</span></span> <a class='grammarterm' href='lex.header#nt:header-name'>header-name</a> <a class='grammarterm' href='cpp.pre#nt:pp-tokens'>pp-tokens</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>;</span> <a class='grammarterm' href='cpp.pre#nt:new-line'>new-line</a>
&#9;<span class='terminal'><span class='keyword'>export</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='keyword'>import</span></span> <a class='grammarterm' href='cpp.cond#nt:header-name-tokens'>header-name-tokens</a> <a class='grammarterm' href='cpp.pre#nt:pp-tokens'>pp-tokens</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>;</span> <a class='grammarterm' href='cpp.pre#nt:new-line'>new-line</a>
&#9;<span class='terminal'><span class='keyword'>export</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='keyword'>import</span></span> <a class='grammarterm' href='cpp.pre#nt:pp-tokens'>pp-tokens</a> <span class='terminal'>;</span> <a class='grammarterm' href='cpp.pre#nt:new-line'>new-line</a>
</pre><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/492f4fbc42cd74b34d0793c78f4210af55922fbc/source/preprocessor.tex#L681'>#</a></div><div id='1.sentence-1' class='sentence'>The preprocessing tokens after the <span class='texttt'><span class='keyword'>import</span></span> preprocessing token
in the <span class='texttt'><span class='keyword'>import</span></span> <a class='grammarterm' href='cpp.pre#nt:control-line'>control-line</a>
are processed just as in normal text
(i.e., each identifier currently defined as a macro name
is replaced by its replacement list of preprocessing tokens)<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>An <span class='texttt'><span class='keyword'>import</span></span> directive
matching the first two forms of a <a class='grammarterm' href='#nt:pp-import'>pp-import</a>
instructs the preprocessor to import macros
from the header unit (<a href='module.import'>[module.import]</a>)
denoted by the <a class='grammarterm' href='lex.header#nt:header-name'>header-name</a><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>The <a class='hidden_link' href='#def:macro,point_of_import' id='def:macro,point_of_import'><i >point of macro import</i></a> for the
first two forms of <a class='grammarterm' href='#nt:pp-import'>pp-import</a> is
immediately after the <a class='grammarterm' href='cpp.pre#nt:new-line'>new-line</a> terminating
the <a class='grammarterm' href='#nt:pp-import'>pp-import</a><a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'>The last form of <a class='grammarterm' href='#nt:pp-import'>pp-import</a> is only considered
if the first two forms did not match<a class='hidden_link' href='#1.sentence-4'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/492f4fbc42cd74b34d0793c78f4210af55922fbc/source/preprocessor.tex#L700'>#</a></div><div id='2.sentence-1' class='sentence'>In all three forms of <a class='grammarterm' href='#nt:pp-import'>pp-import</a>,
the <span class='texttt'><span class='keyword'>import</span></span> token is replaced by the <span class='grammarterm'>import-keyword</span> token<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>Additionally, in the second form of <a class='grammarterm' href='#nt:pp-import'>pp-import</a>,
a <a class='grammarterm' href='lex.header#nt:header-name'>header-name</a> token is formed as if
the <a class='grammarterm' href='cpp.cond#nt:header-name-tokens'>header-name-tokens</a>
were the <a class='grammarterm' href='cpp.pre#nt:pp-tokens'>pp-tokens</a> of a <span class='texttt'><span class='preprocessordirective'>#include</span></span> directive<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>The <a class='grammarterm' href='cpp.cond#nt:header-name-tokens'>header-name-tokens</a> are replaced by
the <a class='grammarterm' href='lex.header#nt:header-name'>header-name</a> token<a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.note-1' class='note'>[&nbsp;<a class='note_link' href='#2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-4' class='sentence'>This ensures that imports are treated consistently by
the preprocessor and later phases of translation<a class='hidden_link' href='#2.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/492f4fbc42cd74b34d0793c78f4210af55922fbc/source/preprocessor.tex#L714'>#</a></div><div id='3.sentence-1' class='sentence'>Each <span class='texttt'><span class='preprocessordirective'>#define</span></span> directive encountered when preprocessing
each translation unit in a program results in a distinct
<a class='hidden_link' href='#def:macro,definition' id='def:macro,definition'><i >macro definition</i></a><a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.note-1' class='note'>[&nbsp;<a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-2' class='sentence'>A predefined macro name (<a href='cpp.predefined'>[cpp.predefined]</a>)
is not introduced by a <span class='texttt'><span class='preprocessordirective'>#define</span></span> directive<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.sentence-3' class='sentence'>Implementations providing mechanisms to predefine additional macros
are encouraged to not treat them
as being introduced by a <span class='texttt'><span class='preprocessordirective'>#define</span></span> directive<a class='hidden_link' href='#3.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='3.sentence-4' class='sentence'>
Importing macros from a header unit makes macro definitions
from a translation unit visible in other translation units<a class='hidden_link' href='#3.sentence-4'>.</a></div> <div id='3.sentence-5' class='sentence'>Each macro definition has at most one point of definition in
each translation unit and at most one point of undefinition, as follows:
<ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div>The <a class='hidden_link' href='#def:macro,point_of_definition' id='def:macro,point_of_definition'><i >point of definition</i></a>
of a macro definition within a translation unit
is the point at which its <span class='texttt'><span class='preprocessordirective'>#define</span></span> directive occurs (in the translation
unit containing the <span class='texttt'><span class='preprocessordirective'>#define</span></span> directive), or,
if the macro name is not lexically identical to a keyword (<a href='lex.key'>[lex.key]</a>)
or to the <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a><span class='textit'>s</span> <span class='texttt'><span class='keyword'>module</span></span> or <span class='texttt'><span class='keyword'>import</span></span>,
the first point
of macro import of a translation unit containing a point of definition for the
macro definition, if any (in any other translation unit).</li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div>The <a class='hidden_link' href='#def:macro,point_of_undefinition' id='def:macro,point_of_undefinition'><i >point of undefinition</i></a>
of a macro definition within a translation unit
is the first point at which a <span class='texttt'><span class='preprocessordirective'>#undef</span></span> directive naming the macro occurs
after its point of definition, or the first point
of macro import of a translation unit containing a point of undefinition for the
macro definition, whichever (if any) occurs first.</li></ul></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/492f4fbc42cd74b34d0793c78f4210af55922fbc/source/preprocessor.tex#L752'>#</a></div><div id='4.sentence-1' class='sentence'>A macro directive is <a class='hidden_link' href='#def:macro,active' id='def:macro,active'><i >active</i></a> at a source location
if it has a point of definition in that translation unit preceding the location,
and does not have a point of undefinition in that translation unit preceding
the location<a class='hidden_link' href='#4.sentence-1'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/492f4fbc42cd74b34d0793c78f4210af55922fbc/source/preprocessor.tex#L759'>#</a></div><div id='5.sentence-1' class='sentence'>If a macro would be replaced or redefined, and multiple macro definitions
are active for that macro name, the active macro definitions shall all be
valid redefinitions of the same macro (<a href='cpp.replace'>[cpp.replace]</a>)<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.note-1' class='note'>[&nbsp;<a class='note_link' href='#5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='5.sentence-2' class='sentence'>The relative order of <a class='grammarterm' href='#nt:pp-import'>pp-import</a><span class='textit'>s</span> has no bearing on whether a
particular macro definition is active<a class='hidden_link' href='#5.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/492f4fbc42cd74b34d0793c78f4210af55922fbc/source/preprocessor.tex#L768'>#</a></div><div id='6.example-1' class='example'>[&nbsp;<a class='example_link' href='#6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Importable header <span class='texttt'><span class='literal'>"a.h"</span></span>:<pre class='codeblock'>
<span class='preprocessordirective'>#define</span> X <span class='literal'>123</span>   <span class='comment'>// #1</span>
<span class='preprocessordirective'>#define</span> Y <span class='literal'>45</span>    <span class='comment'>// #2</span>
<span class='preprocessordirective'>#define</span> Z a     <span class='comment'>// #3</span>
<span class='preprocessordirective'>#undef</span> X        <span class='comment'>// point of undefinition of #1 in <span class='tcode_in_codeblock'>"a.h"</span></span>
</pre><p>Importable header <span class='texttt'><span class='literal'>"b.h"</span></span>:<pre class='codeblock'>
<span class='keyword'>import</span> <span class='literal'>"a.h"</span>;   <span class='comment'>// point of definition of #1, #2, and #3, point of undefinition of #1 in <span class='tcode_in_codeblock'>"b.h"</span></span>
<span class='preprocessordirective'>#define</span> X <span class='literal'>456</span>   <span class='comment'>// OK, #1 is not active</span>
<span class='preprocessordirective'>#define</span> Y <span class='literal'>6</span>     <span class='comment'>// error: #2 is active</span>
</pre><p>Importable header <span class='texttt'><span class='literal'>"c.h"</span></span>:<pre class='codeblock'>
<span class='preprocessordirective'>#define</span> Y <span class='literal'>45</span>    <span class='comment'>// #4</span>
<span class='preprocessordirective'>#define</span> Z c     <span class='comment'>// #5</span>
</pre><p>Importable header <span class='texttt'><span class='literal'>"d.h"</span></span>:<pre class='codeblock'>
<span class='keyword'>import</span> <span class='literal'>"a.h"</span>;   <span class='comment'>// point of definition of #1, #2, and #3, point of undefinition of #1 in <span class='tcode_in_codeblock'>"d.h"</span></span>
<span class='keyword'>import</span> <span class='literal'>"c.h"</span>;   <span class='comment'>// point of definition of #4 and #5 in <span class='tcode_in_codeblock'>"d.h"</span></span>
<span class='keyword'>int</span> a <span class='operator'>=</span> Y;      <span class='comment'>// OK, active macro definitions #2 and #4 are valid redefinitions</span>
<span class='keyword'>int</span> c <span class='operator'>=</span> Z;      <span class='comment'>// error: active macro definitions #3 and #5 are not valid redefinitions of <span class='tcode_in_codeblock'>Z</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  </div></div></body></html>