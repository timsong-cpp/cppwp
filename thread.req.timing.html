<!DOCTYPE html><html lang='en'><head><title>[thread.req.timing]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>30</a> Thread support library <a class='abbr_ref' href='./#thread'>[thread]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>30.2</a> Requirements <a class='abbr_ref' href='thread.req#timing'>[thread.req]</a></h2><div id='thread.req.timing'><h3 ><a class='secnum' style='min-width:103pt'>30.2.4</a> Timing specifications <a class='abbr_ref'>[thread.req.timing]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><p >Several functions described in this Clause take an argument to specify a timeout. These
timeouts are specified as either a <span class='texttt'>duration</span> or a <span class='texttt'>time_point</span> type as
specified in <a href='time'>[time]</a>.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><p >Implementations necessarily have some delay in returning from a timeout. Any overhead in
interrupt response, function return, and scheduling induces a “quality of implementation”
delay, expressed as duration <span class='math'><span class='mathalpha'>D</span><sub ><span class='mathalpha'>i</span></sub></span>. Ideally, this delay would be zero. Further, any contention for
processor and memory resources induces a “quality of management” delay, expressed as duration
<span class='math'><span class='mathalpha'>D</span><sub ><span class='mathalpha'>m</span></sub></span>. The delay durations may vary from timeout to timeout, but in all cases shorter is better.</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><p >The member functions whose names end in <span class='texttt'>_for</span> take an argument that
specifies a duration. These functions produce relative timeouts. Implementations
should use a steady clock to measure time for these functions.<a class='footnotenum' href='#footnote-333'>333</a> Given a duration
argument <span class='math'><span class='mathalpha'>D</span><sub ><span class='mathalpha'>t</span></sub></span>, the real-time duration of the timeout is <span class='math'><span class='mathalpha'>D</span><sub ><span class='mathalpha'>t</span></sub> + <span class='mathalpha'>D</span><sub ><span class='mathalpha'>i</span></sub> + <span class='mathalpha'>D</span><sub ><span class='mathalpha'>m</span></sub></span>.</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><p >The member functions whose names end in <span class='texttt'>_until</span> take an argument that specifies a time
point. These functions produce absolute timeouts. Implementations should use the clock
specified in the time point to measure time for these functions. Given a clock time point
argument <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>t</span></sub></span>, the clock time point of the return from timeout should be <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>t</span></sub> + <span class='mathalpha'>D</span><sub ><span class='mathalpha'>i</span></sub> + <span class='mathalpha'>D</span><sub ><span class='mathalpha'>m</span></sub></span>
when the clock is not adjusted during the timeout. If the clock is adjusted to the time <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>a</span></sub></span>
during the timeout, the behavior should be as follows:</p><ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div><p >if <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>a</span></sub> &gt; <span class='mathalpha'>C</span><sub ><span class='mathalpha'>t</span></sub></span>, the waiting function should wake as soon as possible, i.e. <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>a</span></sub> + <span class='mathalpha'>D</span><sub ><span class='mathalpha'>i</span></sub> + <span class='mathalpha'>D</span><sub ><span class='mathalpha'>m</span></sub></span>,
since the timeout is already satisfied. [&nbsp;<i>Note:</i><span class='space'></span> This specification may result in the total
duration of the wait decreasing when measured against a steady clock. <i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div><p >if <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>a</span></sub> &lt;= <span class='mathalpha'>C</span><sub ><span class='mathalpha'>t</span></sub></span>, the waiting function should not time out until <span class='texttt'>Clock::now()</span> returns a
time <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>n</span></sub> &gt;= <span class='mathalpha'>C</span><sub ><span class='mathalpha'>t</span></sub></span>, i.e. waking at <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>t</span></sub> + <span class='mathalpha'>D</span><sub ><span class='mathalpha'>i</span></sub> + <span class='mathalpha'>D</span><sub ><span class='mathalpha'>m</span></sub></span>. [&nbsp;<i>Note:</i><span class='space'></span> When the clock is adjusted
backwards, this specification may result in the total duration of the wait increasing when
measured against a steady clock. When the clock is adjusted forwards, this specification may
result in the total duration of the wait decreasing when measured against a steady clock.
<i>&nbsp;—&nbsp;end note</i>&nbsp;]
</p></li></ul><p >An implementation shall return from such a timeout at any point from the time specified above to
the time it would return from a steady-clock relative timeout on the difference between <span class='math'><span class='mathalpha'>C</span><sub ><span class='mathalpha'>t</span></sub></span>
and the time point of the call to the <span class='texttt'>_until</span> function. [&nbsp;<i>Note:</i><span class='space'></span> Implementations
should decrease the duration of the wait when the clock is adjusted forwards.
<i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><p >[&nbsp;<i>Note:</i><span class='space'></span> If the clock is not synchronized with a steady clock, e.g., a CPU time clock, these
timeouts might not provide useful functionality. <i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><p >The resolution of timing provided by an implementation depends on both operating system
and hardware. The finest resolution provided by an implementation is called the
<a class='hidden_link' href='#def:native_resolution' id='def:native_resolution'><i>native resolution</i></a>.</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><p >Implementation-provided clocks that are used for these functions shall meet the
<span class='texttt'>TrivialClock</span> requirements (<a href='time.clock.req'>[time.clock.req]</a>).</p></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><p >A function that takes an argument which specifies a timeout will throw if,
during its execution, a clock, time point, or time duration throws an exception.
Such exceptions are referred to as <a class='hidden_link' href='#def:timeout-related_exceptions' id='def:timeout-related_exceptions'><i>timeout-related exceptions</i></a>.
[&nbsp;<i>Note:</i><span class='space'></span> instantiations of clock, time point and duration types supplied by
the implementation as specified in <a href='time.clock'>[time.clock]</a> do not throw exceptions.
<i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></div><div class='footnote' id='footnote-333'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-333'>333)</a></div><p >All
implementations for which standard time units are meaningful must necessarily
have a steady clock within their hardware implementation.</p></div></div></div></body></html>