<!DOCTYPE html><html lang='en'><head><title>[temp.deduct.partial]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>17</a> Templates <a class='abbr_ref' href='./#temp'>[temp]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>17.8</a> Function template specializations <a class='abbr_ref' href='temp.fct.spec#temp.deduct.partial'>[temp.fct.spec]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>17.8.2</a> Template argument deduction <a class='abbr_ref' href='temp.deduct#partial'>[temp.deduct]</a></h3><h4 ><a class='secnum' style='min-width:118pt'>17.8.2.4</a> Deducing template arguments during partial ordering <a class='abbr_ref'>[temp.deduct.partial]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6571'>#</a></div><div id='1.sentence-1' class='sentence'>Template argument deduction is done by comparing certain types associated with
the two function templates being compared<a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6575'>#</a></div><div id='2.sentence-1' class='sentence'>Two sets of types are used to determine the partial ordering<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>For each of
the templates involved there is the original function type and the
transformed function type<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'><div id='2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-6' class='sentence'>The creation of the transformed type is described in <a href='temp.func.order'>[temp.func.order]</a><a class='hidden_link' href='#2.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div> <div id='2.sentence-4' class='sentence'>
The deduction process uses the
transformed type as the argument template and the original type of the
other template as the parameter template<a class='hidden_link' href='#2.sentence-4'>.</a></div> <div id='2.sentence-5' class='sentence'>This process is done twice
for each type involved in the partial ordering comparison: once using
the transformed template-1 as the argument template and template-2 as
the parameter template and again using the transformed template-2 as
the argument template and template-1 as the parameter template<a class='hidden_link' href='#2.sentence-5'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6590'>#</a></div><div id='3.sentence-1' class='sentence'>The types used to determine the ordering depend on the context in which
the partial ordering is done:</div><div id='3.sentence-2' class='sentence'><ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div><div id='3.1.sentence-3' class='sentence'>In the context of a function call, the types used are those function parameter types
for which the function call has arguments<a class='hidden_link' href='#3.1.sentence-3'>.</a><a class='footnotenum' href='#footnote-141'>141</a></div></li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div><div id='3.2.sentence-4' class='sentence'>In the context of a call to a conversion function, the return types of
the conversion function templates are used<a class='hidden_link' href='#3.2.sentence-4'>.</a></div></li><li id='3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.3'>(3.3)</a></div><div id='3.3.sentence-5' class='sentence'>In <a href='temp.func.order'>other contexts</a> the function template's function
type is used<a class='hidden_link' href='#3.3.sentence-5'>.</a></div></li></ul></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6608'>#</a></div><div id='4.sentence-1' class='sentence'>Each type nominated above from the parameter template and the corresponding type from the
argument template are used as the types of
<span class='texttt'>P</span>
and
<span class='texttt'>A</span><a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>If a particular <span class='texttt'>P</span> contains no <i ><a href='temp.param#nt:template-parameter'>template-parameter</a></i><span class='textit'>s</span>
that participate in template argument deduction, that <span class='texttt'>P</span> is not
used to determine the ordering<a class='hidden_link' href='#4.sentence-2'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6618'>#</a></div><div id='5.sentence-1' class='sentence'>Before the partial ordering is done, certain transformations are performed
on the types used for partial ordering:</div><div id='5.sentence-2' class='sentence'><ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.1'>(5.1)</a></div><div id='5.1.sentence-3' class='sentence'>If
<span class='texttt'>P</span>
is a reference type,
<span class='texttt'>P</span>
is replaced by the type referred to<a class='hidden_link' href='#5.1.sentence-3'>.</a></div></li><li id='5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.2'>(5.2)</a></div><div id='5.2.sentence-4' class='sentence'>If
<span class='texttt'>A</span>
is a reference type,
<span class='texttt'>A</span>
is replaced by the type referred to<a class='hidden_link' href='#5.2.sentence-4'>.</a></div></li></ul></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6637'>#</a></div><div id='6.sentence-1' class='sentence'>If both
<span class='texttt'>P</span>
and
<span class='texttt'>A</span>
were reference types (before being replaced with the type referred to
above), determine which of the two types (if any) is more cv-qualified
than the other; otherwise the types are considered to be equally
cv-qualified for partial ordering purposes<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>The result of this
determination will be used below<a class='hidden_link' href='#6.sentence-2'>.</a></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6648'>#</a></div><div id='7.sentence-1' class='sentence'>Remove any top-level cv-qualifiers:
<ul class='itemize'><li id='7.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#7.1'>(7.1)</a></div><div id='7.1.sentence-2' class='sentence'>If
<span class='texttt'>P</span>
is a cv-qualified type,
<span class='texttt'>P</span>
is replaced by the cv-unqualified version of
<span class='texttt'>P</span><a class='hidden_link' href='#7.1.sentence-2'>.</a></div></li><li id='7.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#7.2'>(7.2)</a></div><div id='7.2.sentence-3' class='sentence'>If
<span class='texttt'>A</span>
is a cv-qualified type,
<span class='texttt'>A</span>
is replaced by the cv-unqualified version of
<span class='texttt'>A</span><a class='hidden_link' href='#7.2.sentence-3'>.</a></div></li></ul></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6667'>#</a></div><div id='8.sentence-1' class='sentence'>Using the resulting types
<span class='texttt'>P</span>
and
<span class='texttt'>A</span>,
the deduction is then done as described in <a href='temp.deduct.type'>[temp.deduct.type]</a><a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>If <span class='texttt'>P</span> is a function parameter pack, the type <span class='texttt'>A</span> of each remaining
parameter type of the argument template is compared with the type <span class='texttt'>P</span> of
the <i ><a href='dcl.decl#nt:declarator-id'>declarator-id</a></i> of the function parameter pack<a class='hidden_link' href='#8.sentence-2'>.</a></div> <div id='8.sentence-3' class='sentence'>Each comparison
deduces template arguments for subsequent positions in the template parameter
packs expanded by the function parameter pack<a class='hidden_link' href='#8.sentence-3'>.</a></div> <div id='8.sentence-4' class='sentence'>Similarly, if <span class='texttt'>A</span> was transformed from a function parameter pack,
it is compared with each remaining parameter type of the parameter template<a class='hidden_link' href='#8.sentence-4'>.</a></div> <div id='8.sentence-5' class='sentence'>If deduction succeeds for a given type,
the type from the argument template is considered to be at least as specialized
as the type from the parameter template<a class='hidden_link' href='#8.sentence-5'>.</a></div> <div id='8.sentence-6' class='sentence'><div id='8.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='8.sentence-7' class='sentence'><pre class='codeblock'>
template&lt;class... Args&gt;           void f(Args... args);         <span class='comment'>// #1
</span>template&lt;class T1, class... Args&gt; void f(T1 a1, Args... args);  <span class='comment'>// #2
</span>template&lt;class T1, class T2&gt;      void f(T1 a1, T2 a2);         <span class='comment'>// #3
</span>
f();                <span class='comment'>// calls #1
</span>f(1, 2, 3);         <span class='comment'>// calls #2
</span>f(1, 2);            <span class='comment'>// calls #3; non-variadic template #3 is more specialized
</span>                    <span class='comment'>// than the variadic templates #1 and #2
</span></pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6696'>#</a></div><div id='9.sentence-1' class='sentence'>If, for a given type, deduction succeeds in both directions (i.e., the
types are identical after the transformations above)
and both <span class='texttt'>P</span> and <span class='texttt'>A</span> were reference types (before being replaced with the
type referred to above):</div><div id='9.sentence-2' class='sentence'><ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.1'>(9.1)</a></div><div id='9.1.sentence-3' class='sentence'>if the type from the argument template was an lvalue reference and the type
from the parameter template was not,
the parameter type is not considered to be
at least as specialized as the argument type; otherwise,</div></li><li id='9.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.2'>(9.2)</a></div><div id='9.2.sentence-4' class='sentence'>if the type from
the argument template is more cv-qualified than the type from the
parameter template (as described above),
the parameter type is not considered to be
at least as specialized as the argument type<a class='hidden_link' href='#9.2.sentence-4'>.</a></div></li></ul></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6715'>#</a></div><div id='10.sentence-1' class='sentence'>Function template <span class='texttt'>F</span>
is <span class='textit'>at least as specialized as</span>
function template <span class='texttt'>G</span> if,
for each pair of types used to determine the ordering,
the type from <span class='texttt'>F</span>
is at least as specialized as
the type from <span class='texttt'>G</span><a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='10.sentence-2' class='sentence'><span class='texttt'>F</span>
is <a class='hidden_link' href='#def:more_specialized,function_template' id='def:more_specialized,function_template'><i >more specialized than</i></a>
<span class='texttt'>G</span> if
<span class='texttt'>F</span>
is at least as specialized as
<span class='texttt'>G</span> and
<span class='texttt'>G</span>
is not at least as specialized as
<span class='texttt'>F</span><a class='hidden_link' href='#10.sentence-2'>.</a></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6734'>#</a></div><div id='11.sentence-1' class='sentence'>If, after considering the above, function template <span class='texttt'>F</span>
is at least as specialized as function template <span class='texttt'>G</span> and vice-versa, and
if <span class='texttt'>G</span> has a trailing parameter pack
for which <span class='texttt'>F</span> does not have a corresponding parameter, and
if <span class='texttt'>F</span> does not have a trailing parameter pack,
then <span class='texttt'>F</span> is more specialized than <span class='texttt'>G</span><a class='hidden_link' href='#11.sentence-1'>.</a></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6742'>#</a></div><div id='12.sentence-1' class='sentence'>In most cases, all template parameters must have values in order for
deduction to succeed, but for partial ordering purposes a template
parameter may remain without a value provided it is not used in the
types being used for partial ordering<a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.sentence-2' class='sentence'><div id='12.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#12.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='12.sentence-4' class='sentence'>A template parameter used in a non-deduced context is considered used<a class='hidden_link' href='#12.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div> <div id='12.sentence-3' class='sentence'><div id='12.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#12.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='12.sentence-5' class='sentence'><pre class='codeblock'>
template &lt;class T&gt; T f(int);            <span class='comment'>// #1
</span>template &lt;class T, class U&gt; T f(U);     <span class='comment'>// #2
</span>void g() {
  f&lt;int&gt;(1);                            <span class='comment'>// calls #1
</span>}</pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/82796606a63a7c62b05785593f651fba105f1c2c/source/templates.tex#L6760'>#</a></div><div id='13.sentence-1' class='sentence'><div id='13.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#13.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='13.sentence-3' class='sentence'>Partial ordering of function templates containing
template parameter packs is independent of the number of deduced arguments
for those template parameter packs<a class='hidden_link' href='#13.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div> <div id='13.sentence-2' class='sentence'><div id='13.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#13.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='13.sentence-4' class='sentence'><pre class='codeblock'>
template&lt;class ...&gt; struct Tuple { };
template&lt;class ... Types&gt; void g(Tuple&lt;Types ...&gt;);                 <span class='comment'>// #1
</span>template&lt;class T1, class ... Types&gt; void g(Tuple&lt;T1, Types ...&gt;);   <span class='comment'>// #2
</span>template&lt;class T1, class ... Types&gt; void g(Tuple&lt;T1, Types&amp; ...&gt;);  <span class='comment'>// #3
</span>
g(Tuple&lt;&gt;());                   <span class='comment'>// calls #1
</span>g(Tuple&lt;int, float&gt;());         <span class='comment'>// calls #2
</span>g(Tuple&lt;int, float&amp;&gt;());        <span class='comment'>// calls #3
</span>g(Tuple&lt;int&gt;());                <span class='comment'>// calls #3
</span></pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='footnote' id='footnote-141'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-141'>141)</a></div><div id='footnote-141.sentence-1' class='sentence'>Default arguments
are not considered to be arguments in this context; they only become arguments
after a function has been selected<a class='hidden_link' href='#footnote-141.sentence-1'>.</a></div></div></div></body></html>