<!DOCTYPE html><html lang='en'><head><title>[support.runtime]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>21</a> Language support library <a class='abbr_ref' href='./#language.support'>[language.support]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>21.10</a> Other runtime support <a class='abbr_ref'>[support.runtime]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3705'>#</a></div><p ><span class='indexparent'><a class='index' id=':<cstdarg>'></a></span><span class='indexparent'><a class='index' id='lib:<cstdarg>'></a></span><span class='indexparent'><a class='index' id=':<csetjmp>'></a></span><span class='indexparent'><a class='index' id='lib:<csetjmp>'></a></span><span class='indexparent'><a class='index' id=':<ctime>'></a></span><span class='indexparent'><a class='index' id='lib:<ctime>'></a></span><span class='indexparent'><a class='index' id=':<csignal>'></a></span><span class='indexparent'><a class='index' id='lib:<csignal>'></a></span><span class='indexparent'><a class='index' id=':<cstdlib>'></a></span><span class='indexparent'><a class='index' id='lib:<cstdlib>'></a></span><span class='indexparent'><a class='index' id=':<cstdbool>'></a></span><span class='indexparent'><a class='index' id='lib:<cstdbool>'></a></span><span class='indexparent'><a class='index' id='lib:getenv'></a></span><span class='indexparent'><a class='index' id='lib:system'></a></span><span class='indexparent'><a class='index' id='lib:__bool_true_false_are_defined'></a></span>Headers
<span class='texttt'>&lt;csetjmp&gt;</span> (nonlocal jumps),
<span class='texttt'>&lt;csignal&gt;</span> (signal handling),
<span class='texttt'>&lt;cstdarg&gt;</span> (variable arguments),
and
<span class='texttt'>&lt;cstdlib&gt;</span> (runtime environment <span class='texttt'>getenv</span>, <span class='texttt'>system</span>),
provide further compatibility with C code.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3729'>#</a></div><p >Calls to the function
<span class='indexparent'><a class='index' id='lib:getenv_'></a></span><a href='cstdlib.syn#lib:getenv'><span class='texttt'>getenv</span></a> shall not introduce a data
race (<a href='res.on.data.races'>[res.on.data.races]</a>) provided that nothing modifies the environment.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  Calls to the POSIX functions
<span class='indexparent'><a class='index' id='lib:setenv'></a></span><span class='texttt'>setenv</span> and
<span class='indexparent'><a class='index' id='lib:putenv'></a></span><span class='texttt'>putenv</span> modify the
environment. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3741'>#</a></div><p >A call to the <a href='c.locales#lib:setlocale'><span class='texttt'>setlocale</span></a> function
may introduce a data race with other
calls to the <span class='texttt'>setlocale</span> function or with calls to functions that are
affected by the current C locale. The implementation shall behave as if no
library function other than <span class='texttt'>locale&#x200b;::&#x200b;global</span> calls the <span class='texttt'>setlocale</span>
function.</p></div><div id='cstdarg.syn'><h3 ><a class='secnum' href='#cstdarg.syn' style='min-width:103pt'>21.10.1</a> Header <span class='texttt'>&lt;cstdarg&gt;</span> synopsis <a class='abbr_ref' href='cstdarg.syn'>[cstdarg.syn]</a></h3><p ><span class='indexparent'><a class='index' id=':<cstdarg>_'></a></span><span class='indexparent'><a class='index' id='lib:<cstdarg>_'></a></span></p><pre class='codeblock'>
namespace std {
  using <span id='lib:va_list'><span class='tcode_in_codeblock'>va_&shy;list</span></span> = <span class='textit'><span class='texttt'>see below</span></span>;
}

#define <span id='lib:va_arg'><span class='tcode_in_codeblock'>va_&shy;arg</span></span>(V, P) <span class='textit'><span class='texttt'>see below</span></span>
#define <span id='lib:va_copy'><span class='tcode_in_codeblock'>va_&shy;copy</span></span>(VDST, VSRC) <span class='textit'><span class='texttt'>see below</span></span>
#define <span id='lib:va_end'><span class='tcode_in_codeblock'>va_&shy;end</span></span>(V) <span class='textit'><span class='texttt'>see below</span></span>
#define <span id='lib:va_start'><span class='tcode_in_codeblock'>va_&shy;start</span></span>(V, P) <span class='textit'><span class='texttt'>see below</span></span></pre><div class='para' id='cstdarg.syn-1'><div class='marginalizedparent'><a class='marginalized' href='#cstdarg.syn-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3764'>#</a></div><p ><span class='indexparent'><a class='index' id=':<stdarg.h>'></a></span><span class='indexparent'><a class='index' id='lib:<stdarg.h>'></a></span>The contents of the header <span class='texttt'>&lt;cstdarg&gt;</span> are the same as the C
standard library header <span class='texttt'>&lt;stdarg.h&gt;</span>, with the following changes:
The restrictions that ISO C places on the second parameter to the
<span class='indexparent'><a class='index' id='lib:va_start_'></a></span><span class='texttt'>va_&shy;start</span>
macro in header
<span class='indexparent'><a class='index' id='lib:<stdarg.h>_'></a></span><span class='texttt'>&lt;stdarg.h&gt;</span>
are different in this International Standard.
The parameter
<span class='texttt'>parmN</span>
is the rightmost parameter in the variable parameter list
of the function definition (the one just before the
<span class='texttt'>...</span>).<a class='footnotenum' href='#footnote-219'>219</a>
If the parameter <span class='texttt'>parmN</span> is a pack expansion (<a href='temp.variadic'>[temp.variadic]</a>) or
an entity resulting from a lambda capture (<a href='expr.prim.lambda'>[expr.prim.lambda]</a>),
the program is ill-formed, no diagnostic required.
If the parameter
<span class='texttt'>parmN</span>
is of a reference type, or of a type that is not compatible with the
type that results when passing an argument for which there is no
parameter, the behavior is undefined.</p><p ><span class='textsc'>See also:</span> ISO C 7.16.1.1</p></div><div class='footnote' id='footnote-219'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-219'>219)</a></div><p >Note that
<span class='texttt'>va_&shy;start</span>
is required to work as specified even if unary
<span class='texttt'>operator&amp;</span>
is overloaded for the type of
<span class='texttt'>parmN</span>.</p></div></div><div id='csetjmp.syn'><h3 ><a class='secnum' href='#csetjmp.syn' style='min-width:103pt'>21.10.2</a> Header <span class='texttt'>&lt;csetjmp&gt;</span> synopsis <a class='abbr_ref' href='csetjmp.syn'>[csetjmp.syn]</a></h3><p ><span class='indexparent'><a class='index' id=':<csetjmp>_'></a></span><span class='indexparent'><a class='index' id='lib:<csetjmp>_'></a></span><span class='indexparent'><a class='index' id='lib:jmp_buf'></a></span><span class='indexparent'><a class='index' id='lib:longjmp'></a></span><span class='indexparent'><a class='index' id='lib:setjmp'></a></span></p><pre class='codeblock'>
namespace std {
  using jmp_buf = <span class='textit'><span class='texttt'>see below</span></span>;
  [[noreturn]] void longjmp(jmp_buf env, int val);
}

#define setjmp(env) <span class='textit'><span class='texttt'>see below</span></span></pre><div class='para' id='csetjmp.syn-1'><div class='marginalizedparent'><a class='marginalized' href='#csetjmp.syn-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3813'>#</a></div><p ><span class='indexparent'><a class='index' id=':<setjmp.h>'></a></span><span class='indexparent'><a class='index' id='lib:<setjmp.h>'></a></span>The contents of the header <span class='texttt'>&lt;csetjmp&gt;</span> are the same as the C
standard library header <span class='texttt'>&lt;setjmp.h&gt;</span>.</p></div><div class='para' id='csetjmp.syn-2'><div class='marginalizedparent'><a class='marginalized' href='#csetjmp.syn-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3819'>#</a></div><p >The function signature
<span class='indexparent'><a class='index' id='lib:longjmp_'></a></span><span class='texttt'>longjmp(jmp_&shy;buf jbuf, int val)</span>
has more restricted behavior in this International Standard.
A <span class='texttt'>setjmp</span>/<span class='texttt'>longjmp</span> call pair has undefined
behavior if replacing the <span class='texttt'>setjmp</span> and <span class='texttt'>longjmp</span>
by <span class='texttt'>catch</span> and <span class='texttt'>throw</span> would invoke any non-trivial destructors for any automatic
objects.</p><p ><span class='textsc'>See also:</span> ISO C 7.13</p></div></div><div id='csignal.syn'><h3 ><a class='secnum' href='#csignal.syn' style='min-width:103pt'>21.10.3</a> Header <span class='texttt'>&lt;csignal&gt;</span> synopsis <a class='abbr_ref' href='csignal.syn'>[csignal.syn]</a></h3><p ><span class='indexparent'><a class='index' id=':<csignal>_'></a></span><span class='indexparent'><a class='index' id='lib:<csignal>_'></a></span><span class='indexparent'><a class='index' id='lib:sig_atomic_t'></a></span><span class='indexparent'><a class='index' id='lib:signal'></a></span><span class='indexparent'><a class='index' id='lib:raise'></a></span><span class='indexparent'><a class='index' id='lib:SIG_IGN'></a></span><span class='indexparent'><a class='index' id='lib:SIGABRT'></a></span><span class='indexparent'><a class='index' id='lib:SIGFPE'></a></span><span class='indexparent'><a class='index' id='lib:SIGILL'></a></span><span class='indexparent'><a class='index' id='lib:SIGINT'></a></span><span class='indexparent'><a class='index' id='lib:SIGSEGV'></a></span><span class='indexparent'><a class='index' id='lib:SIGTERM'></a></span><span class='indexparent'><a class='index' id='lib:SIG_DFL'></a></span><span class='indexparent'><a class='index' id='lib:SIG_ERR'></a></span></p><pre class='codeblock'>
namespace std {
  using sig_atomic_t = <span class='textit'><span class='texttt'>see below</span></span>;

  <span class='comment'>// <a href='support.signal'>[support.signal]</a>, signal handlers
</span>  extern "C" using <span class='textit'>signal-handler</span> = void(int);  <span class='comment'>// <span class='textit'>exposition only</span>
</span>  <span class='textit'>signal-handler</span>* signal(int sig, <span class='textit'>signal-handler</span>* func);

  int raise(int sig);
}

#define SIG_DFL <span class='textit'><span class='texttt'>see below</span></span>
#define SIG_ERR <span class='textit'><span class='texttt'>see below</span></span>
#define SIG_IGN <span class='textit'><span class='texttt'>see below</span></span>
#define SIGABRT <span class='textit'><span class='texttt'>see below</span></span>
#define SIGFPE <span class='textit'><span class='texttt'>see below</span></span>
#define SIGILL <span class='textit'><span class='texttt'>see below</span></span>
#define SIGINT <span class='textit'><span class='texttt'>see below</span></span>
#define SIGSEGV <span class='textit'><span class='texttt'>see below</span></span>
#define SIGTERM <span class='textit'><span class='texttt'>see below</span></span></pre><div class='para' id='csignal.syn-1'><div class='marginalizedparent'><a class='marginalized' href='#csignal.syn-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3869'>#</a></div><p ><span class='indexparent'><a class='index' id=':<signal.h>'></a></span><span class='indexparent'><a class='index' id='lib:<signal.h>'></a></span>The contents of the header <span class='texttt'>&lt;csignal&gt;</span> are the same as the C
standard library header <span class='texttt'>&lt;signal.h&gt;</span>.</p></div></div><div id='support.signal'><h3 ><a class='secnum' href='#support.signal' style='min-width:103pt'>21.10.4</a> Signal handlers <a class='abbr_ref' href='support.signal'>[support.signal]</a></h3><div class='para' id='support.signal-1'><div class='marginalizedparent'><a class='marginalized' href='#support.signal-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3877'>#</a></div><p >A call to the function <span class='texttt'>signal</span> synchronizes with any resulting
invocation of the signal handler so installed.</p></div><div class='para' id='support.signal-2'><div class='marginalizedparent'><a class='marginalized' href='#support.signal-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3881'>#</a></div><p >A <a class='hidden_link' href='#def:plain_lock-free_atomic_operation' id='def:plain_lock-free_atomic_operation'><i >plain lock-free atomic operation</i></a> is
an invocation of a function <span class='texttt'>f</span> from Clause <a href='atomics'>[atomics]</a>,
such that:</p><ul class='itemize'><li id='support.signal-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-2.1'>(2.1)</a></div><p ><span class='texttt'>f</span> is the function <span class='texttt'>atomic_&shy;is_&shy;lock_&shy;free()</span>, or</p></li><li id='support.signal-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-2.2'>(2.2)</a></div><p ><span class='texttt'>f</span> is the member function <span class='texttt'>is_&shy;lock_&shy;free()</span>, or</p></li><li id='support.signal-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-2.3'>(2.3)</a></div><p ><span class='texttt'>f</span> is a non-static member function invoked on an object <span class='texttt'>A</span>,
such that <span class='texttt'>A.is_&shy;lock_&shy;free()</span> yields <span class='texttt'>true</span>, or</p></li><li id='support.signal-2.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-2.4'>(2.4)</a></div><p ><span class='texttt'>f</span> is a non-member function, and
for every pointer-to-atomic argument <span class='texttt'>A</span> passed to <span class='texttt'>f</span>,
<span class='texttt'>atomic_&shy;is_&shy;lock_&shy;free(A)</span> yields <span class='texttt'>true</span>.
</p></li></ul></div><div class='para' id='support.signal-3'><div class='marginalizedparent'><a class='marginalized' href='#support.signal-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3903'>#</a></div><p >An evaluation is <a class='hidden_link' href='#def:evaluation,signal-safe' id='def:evaluation,signal-safe'><i >signal-safe</i></a> unless it includes one of the following:</p><ul class='itemize'><li id='support.signal-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-3.1'>(3.1)</a></div><p >a call to any standard library function,
except for plain lock-free atomic operations and
functions explicitly identified as signal-safe.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span> 
This implicitly excludes the use of <span class='texttt'>new</span> and <span class='texttt'>delete</span> expressions
that rely on a library-provided memory allocator.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></li><li id='support.signal-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-3.2'>(3.2)</a></div><p >an access to an object with thread storage duration;</p></li><li id='support.signal-3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-3.3'>(3.3)</a></div><p >a <span class='texttt'>dynamic_&shy;cast</span> expression;</p></li><li id='support.signal-3.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-3.4'>(3.4)</a></div><p >throwing of an exception;</p></li><li id='support.signal-3.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-3.5'>(3.5)</a></div><p >control entering a <i ><a href='except#nt:try-block'>try-block</a></i> or <i ><a href='except#nt:function-try-block'>function-try-block</a></i>;</p></li><li id='support.signal-3.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-3.6'>(3.6)</a></div><p >initialization of a variable with static storage duration
requiring dynamic initialization (<a href='basic.start.dynamic'>[basic.start.dynamic]</a>, <a href='stmt.dcl'>[stmt.dcl]</a>)<a class='footnotenum' href='#footnote-220'>220</a>; or</p></li><li id='support.signal-3.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#support.signal-3.7'>(3.7)</a></div><p >waiting for the completion of the initialization of a variable with static storage duration (<a href='stmt.dcl'>[stmt.dcl]</a>).
</p></li></ul><p >A signal handler invocation has undefined behavior if it includes
an evaluation that is not signal-safe.</p></div><div class='para' id='support.signal-4'><div class='marginalizedparent'><a class='marginalized' href='#support.signal-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ae6271c88727c3fabe7dd8258f8687b369d83d6d/source/support.tex#L3941'>#</a></div><p ><span class='indexparent'><a class='index' id=':signal-safe,signal'></a></span>The function <span class='texttt'>signal</span> is signal-safe if it is invoked
with the first argument equal to the signal number
corresponding to the signal that caused the invocation of the handler.</p><p ><span class='textsc'>See also:</span> ISO C 7.14
</p></div><div class='footnote' id='footnote-220'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-220'>220)</a></div><p >Such initialization might occur because it is the first odr-use (<a href='basic.def.odr'>[basic.def.odr]</a>) of that variable.</p></div></div></div></body></html>