<!DOCTYPE html><html lang='en'><head><title>[thread]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>33</a> Thread support library <a class='abbr_ref' href='./#thread'>[thread]</a></h1><div id='general' class='section'><h2 ><a class='secnum' href='#general' style='min-width:88pt'>33.1</a> General <a class='abbr_ref' href='thread.general'>[thread.general]</a></h2><div class='para' id='general-1'><div class='marginalizedparent'><a class='marginalized' href='#general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L6'>#</a></div><div id='general-1.sentence-1' class='sentence'>The following subclauses describe components to create and manage
<a href='intro.multithread#def:thread'>threads</a>, perform mutual exclusion, and communicate conditions
and values
between threads, as summarized in Table <a href='#tab:thread.lib.summary'>140</a><a class='hidden_link' href='#general-1.sentence-1'>.</a></div><div class='numberedTable' id='tab:thread.lib.summary'>Table <a href='#tab:thread.lib.summary'>140</a> — Thread support library summary<br><table ><tr class='rowsep'><td colspan='2' class='center'><div id='general-1.sentence-2' class='sentence'><b>Subclause</b></div></td><td class='left'><div id='general-1.sentence-3' class='sentence'><b>Header(s)</b></div></td></tr><tr class='capsep'><td class='left'><div id='general-1.sentence-4' class='sentence'><a href='thread.req'>[thread.req]</a></div></td><td class='left'><div id='general-1.sentence-5' class='sentence'>Requirements</div></td><td class='left'></td></tr><tr class='rowsep'><td class='left'><div id='general-1.sentence-6' class='sentence'><a href='thread.threads'>[thread.threads]</a></div></td><td class='left'><div id='general-1.sentence-7' class='sentence'>Threads</div></td><td class='left'><div id='general-1.sentence-8' class='sentence'><span class='texttt'>&lt;thread&gt;</span></div></td></tr><tr class='rowsep'><td class='left'><div id='general-1.sentence-9' class='sentence'><a href='thread.mutex'>[thread.mutex]</a></div></td><td class='left'><div id='general-1.sentence-10' class='sentence'>Mutual exclusion</div></td><td class='left'><div id='general-1.sentence-11' class='sentence'><span class='texttt'>&lt;mutex&gt;</span></div></td></tr><tr ><td class='left'></td><td class='left'></td><td class='left'><div id='general-1.sentence-12' class='sentence'><span class='texttt'>&lt;shared_&shy;mutex&gt;</span></div></td></tr><tr class='rowsep'><td class='left'><div id='general-1.sentence-13' class='sentence'><a href='thread.condition'>[thread.condition]</a></div></td><td class='left'><div id='general-1.sentence-14' class='sentence'>Condition variables</div></td><td class='left'><div id='general-1.sentence-15' class='sentence'><span class='texttt'>&lt;condition_&shy;variable&gt;</span></div></td></tr><tr class='rowsep'><td class='left'><div id='general-1.sentence-16' class='sentence'><a href='futures'>[futures]</a></div></td><td class='left'><div id='general-1.sentence-17' class='sentence'>Futures</div></td><td class='left'><div id='general-1.sentence-18' class='sentence'><span class='texttt'>&lt;future&gt;</span></div></td></tr></table></div></div></div><div id='req' class='section'><h2 ><a class='secnum' href='#req' style='min-width:88pt'>33.2</a> Requirements <a class='abbr_ref' href='thread.req'>[thread.req]</a></h2><div id='req.paramname' class='section'><h3 ><a class='secnum' href='#req.paramname' style='min-width:103pt'>33.2.1</a> Template parameter names <a class='abbr_ref' href='thread.req.paramname'>[thread.req.paramname]</a></h3><div class='para' id='req.paramname-1'><div class='marginalizedparent'><a class='marginalized' href='#req.paramname-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L25'>#</a></div><div id='req.paramname-1.sentence-1' class='sentence'>Throughout this Clause, the names of template parameters are used to express type
requirements<a class='hidden_link' href='#req.paramname-1.sentence-1'>.</a></div> <div id='req.paramname-1.sentence-2' class='sentence'>If a template parameter is named <span class='texttt'>Predicate</span>, <span class='texttt'>operator()</span> applied to
the template argument shall return a value that is convertible to <span class='texttt'>bool</span><a class='hidden_link' href='#req.paramname-1.sentence-2'>.</a></div></div></div><div id='req.exception' class='section'><h3 ><a class='secnum' href='#req.exception' style='min-width:103pt'>33.2.2</a> Exceptions <a class='abbr_ref' href='thread.req.exception'>[thread.req.exception]</a></h3><div class='para' id='req.exception-1'><div class='marginalizedparent'><a class='marginalized' href='#req.exception-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L33'>#</a></div><div id='req.exception-1.sentence-1' class='sentence'>Some functions described in this Clause are specified to throw exceptions of type
<a href='syserr.syserr'><span class='texttt'>system_&shy;error</span></a><a class='hidden_link' href='#req.exception-1.sentence-1'>.</a></div> <div id='req.exception-1.sentence-2' class='sentence'>Such exceptions shall be thrown if
any of the function's error conditions is detected or
a call to
an operating system or other underlying API results in an error that prevents the
library function from
meeting its specifications<a class='hidden_link' href='#req.exception-1.sentence-2'>.</a></div> <div id='req.exception-1.sentence-3' class='sentence'>Failure to allocate storage shall be reported as described
in <a href='res.on.exception.handling'>[res.on.exception.handling]</a><a class='hidden_link' href='#req.exception-1.sentence-3'>.</a></div><div style='height:0.6em;display:block'></div><div id='req.exception-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#req.exception-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='req.exception-1.sentence-4' class='sentence'>Consider a function in this clause that is specified to throw exceptions of type
<span class='texttt'>system_&shy;error</span> and specifies error conditions that include
<span class='texttt'>operation_&shy;not_&shy;permitted</span> for a thread that does not have the privilege to
perform the operation<a class='hidden_link' href='#req.exception-1.sentence-4'>.</a></div> <div id='req.exception-1.sentence-5' class='sentence'>Assume that, during the execution of this function, an <span class='texttt'>errno</span>
of <span class='texttt'>EPERM</span> is reported by a POSIX API call used by the implementation<a class='hidden_link' href='#req.exception-1.sentence-5'>.</a></div> <div id='req.exception-1.sentence-6' class='sentence'>Since POSIX
specifies an <span class='texttt'>errno</span> of <span class='texttt'>EPERM</span> when “the caller does not have the privilege
to perform the operation”, the implementation maps <span class='texttt'>EPERM</span> to an
<span class='texttt'>error_&shy;condition</span> of <span class='texttt'>operation_&shy;not_&shy;permitted</span> (<a href='syserr'>[syserr]</a>) and an exception
of type <span class='texttt'>system_&shy;error</span> is thrown<a class='hidden_link' href='#req.exception-1.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='req.exception-2'><div class='marginalizedparent'><a class='marginalized' href='#req.exception-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L55'>#</a></div><div id='req.exception-2.sentence-1' class='sentence'>The <span class='texttt'>error_&shy;code</span> reported by such an exception's <span class='texttt'>code()</span> member function
shall compare equal to one of the conditions specified in the function's error condition
element<a class='hidden_link' href='#req.exception-2.sentence-1'>.</a></div></div></div><div id='req.native' class='section'><h3 ><a class='secnum' href='#req.native' style='min-width:103pt'>33.2.3</a> Native handles <a class='abbr_ref' href='thread.req.native'>[thread.req.native]</a></h3><div class='para' id='req.native-1'><div class='marginalizedparent'><a class='marginalized' href='#req.native-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L62'>#</a></div><div id='req.native-1.sentence-1' class='sentence'>Several classes described in this Clause have members <span class='texttt'>native_&shy;handle_&shy;type</span> and
<span class='texttt'>native_&shy;handle</span><a class='hidden_link' href='#req.native-1.sentence-1'>.</a></div> <div id='req.native-1.sentence-2' class='sentence'>The presence of these members and their semantics is
<span class='indexparent'><a class='index' id=':presence_and_meaning_of_native_handle_type_and_native_handle'></a></span>implementation-defined<a class='hidden_link' href='#req.native-1.sentence-2'>.</a></div> <div id='req.native-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.native-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.native-1.sentence-3' class='sentence'>These members allow implementations to provide access
to implementation details<a class='hidden_link' href='#req.native-1.sentence-3'>.</a></div> <div id='req.native-1.sentence-4' class='sentence'>Their names are specified to facilitate portable compile-time
detection<a class='hidden_link' href='#req.native-1.sentence-4'>.</a></div> <div id='req.native-1.sentence-5' class='sentence'>Actual use of these members is inherently non-portable<a class='hidden_link' href='#req.native-1.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='req.timing' class='section'><h3 ><a class='secnum' href='#req.timing' style='min-width:103pt'>33.2.4</a> Timing specifications <a class='abbr_ref' href='thread.req.timing'>[thread.req.timing]</a></h3><div class='para' id='req.timing-1'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L72'>#</a></div><div id='req.timing-1.sentence-1' class='sentence'>Several functions described in this Clause take an argument to specify a timeout<a class='hidden_link' href='#req.timing-1.sentence-1'>.</a></div> <div id='req.timing-1.sentence-2' class='sentence'>These
timeouts are specified as either a <span class='texttt'>duration</span> or a <span class='texttt'>time_&shy;point</span> type as
specified in <a href='time'>[time]</a><a class='hidden_link' href='#req.timing-1.sentence-2'>.</a></div></div><div class='para' id='req.timing-2'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L77'>#</a></div><div id='req.timing-2.sentence-1' class='sentence'>Implementations necessarily have some delay in returning from a timeout<a class='hidden_link' href='#req.timing-2.sentence-1'>.</a></div> <div id='req.timing-2.sentence-2' class='sentence'>Any overhead in
interrupt response, function return, and scheduling induces a “quality of implementation”
delay, expressed as duration <span class="mjx-chtml"><span class="mjx-math" aria-label="D_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span><a class='hidden_link' href='#req.timing-2.sentence-2'>.</a></div> <div id='req.timing-2.sentence-3' class='sentence'>Ideally, this delay would be zero<a class='hidden_link' href='#req.timing-2.sentence-3'>.</a></div> <div id='req.timing-2.sentence-4' class='sentence'>Further, any contention for
processor and memory resources induces a “quality of management” delay, expressed as duration
<span class="mjx-chtml"><span class="mjx-math" aria-label="D_m"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span><a class='hidden_link' href='#req.timing-2.sentence-4'>.</a></div> <div id='req.timing-2.sentence-5' class='sentence'>The delay durations may vary from timeout to timeout, but in all cases shorter is better<a class='hidden_link' href='#req.timing-2.sentence-5'>.</a></div></div><div class='para' id='req.timing-3'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L84'>#</a></div><div id='req.timing-3.sentence-1' class='sentence'>The member functions whose names end in <span class='texttt'>_&shy;for</span> take an argument that
specifies a duration<a class='hidden_link' href='#req.timing-3.sentence-1'>.</a></div> <div id='req.timing-3.sentence-2' class='sentence'>These functions produce relative timeouts<a class='hidden_link' href='#req.timing-3.sentence-2'>.</a></div> <div id='req.timing-3.sentence-3' class='sentence'>Implementations
should use a steady clock to measure time for these functions<a class='hidden_link' href='#req.timing-3.sentence-3'>.</a><a class='footnotenum' href='#footnote-331'>331</a></div> <div id='req.timing-3.sentence-4' class='sentence'> Given a duration
argument <span class="mjx-chtml"><span class="mjx-math" aria-label="D_t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, the real-time duration of the timeout is <span class="mjx-chtml"><span class="mjx-math" aria-label="D_t + D_i + D_m"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span><a class='hidden_link' href='#req.timing-3.sentence-4'>.</a></div></div><div class='para' id='req.timing-4'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L92'>#</a></div><div id='req.timing-4.sentence-1' class='sentence'>The member functions whose names end in <span class='texttt'>_&shy;until</span> take an argument that specifies a time
point<a class='hidden_link' href='#req.timing-4.sentence-1'>.</a></div> <div id='req.timing-4.sentence-2' class='sentence'>These functions produce absolute timeouts<a class='hidden_link' href='#req.timing-4.sentence-2'>.</a></div> <div id='req.timing-4.sentence-3' class='sentence'>Implementations should use the clock
specified in the time point to measure time for these functions<a class='hidden_link' href='#req.timing-4.sentence-3'>.</a></div> <div id='req.timing-4.sentence-4' class='sentence'>Given a clock time point
argument <span class="mjx-chtml"><span class="mjx-math" aria-label="C_t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, the clock time point of the return from timeout should be <span class="mjx-chtml"><span class="mjx-math" aria-label="C_t + D_i + D_m"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span>
when the clock is not adjusted during the timeout<a class='hidden_link' href='#req.timing-4.sentence-4'>.</a></div> <div id='req.timing-4.sentence-5' class='sentence'>If the clock is adjusted to the time <span class="mjx-chtml"><span class="mjx-math" aria-label="C_a"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span></span></span>
during the timeout, the behavior should be as follows:</div><div id='req.timing-4.sentence-6' class='sentence'><ul class='itemize'><li id='req.timing-4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#req.timing-4.1'>(4.1)</a></div><div id='req.timing-4.1.sentence-1' class='sentence'>if <span class="mjx-chtml"><span class="mjx-math" aria-label="C_a > C_t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">&gt;</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, the waiting function should wake as soon as possible, i.e. <span class="mjx-chtml"><span class="mjx-math" aria-label="C_a + D_i + D_m"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span>,
since the timeout is already satisfied<a class='hidden_link' href='#req.timing-4.1.sentence-1'>.</a></div> <div id='req.timing-4.1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.timing-4.1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.timing-4.1.sentence-2' class='sentence'>This specification may result in the total
duration of the wait decreasing when measured against a steady clock<a class='hidden_link' href='#req.timing-4.1.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li><li id='req.timing-4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#req.timing-4.2'>(4.2)</a></div><div id='req.timing-4.2.sentence-1' class='sentence'>if <span class="mjx-chtml"><span class="mjx-math" aria-label="C_a \leq {}C_t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, the waiting function should not time out until <span class='texttt'>Clock&#x200b;::&#x200b;now()</span> returns a
time <span class="mjx-chtml"><span class="mjx-math" aria-label="C_n \geq {}C_t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≥</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, i.e. waking at <span class="mjx-chtml"><span class="mjx-math" aria-label="C_t + D_i + D_m"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span><a class='hidden_link' href='#req.timing-4.2.sentence-1'>.</a></div> <div id='req.timing-4.2.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.timing-4.2.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.timing-4.2.sentence-2' class='sentence'>When the clock is adjusted
backwards, this specification may result in the total duration of the wait increasing when
measured against a steady clock<a class='hidden_link' href='#req.timing-4.2.sentence-2'>.</a></div> <div id='req.timing-4.2.sentence-3' class='sentence'>When the clock is adjusted forwards, this specification may
result in the total duration of the wait decreasing when measured against a steady clock<a class='hidden_link' href='#req.timing-4.2.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul></div><div id='req.timing-4.sentence-7' class='sentence'>An implementation shall return from such a timeout at any point from the time specified above to
the time it would return from a steady-clock relative timeout on the difference between <span class="mjx-chtml"><span class="mjx-math" aria-label="C_t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>
and the time point of the call to the <span class='texttt'>_&shy;until</span> function<a class='hidden_link' href='#req.timing-4.sentence-7'>.</a></div> <div id='req.timing-4.note-3' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.timing-4.note-3'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.timing-4.sentence-8' class='sentence'>Implementations
should decrease the duration of the wait when the clock is adjusted forwards<a class='hidden_link' href='#req.timing-4.sentence-8'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='req.timing-5'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L121'>#</a></div><div id='req.timing-5.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.timing-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.timing-5.sentence-1' class='sentence'>If the clock is not synchronized with a steady clock, e.g., a CPU time clock, these
timeouts might not provide useful functionality<a class='hidden_link' href='#req.timing-5.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='req.timing-6'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L125'>#</a></div><div id='req.timing-6.sentence-1' class='sentence'>The resolution of timing provided by an implementation depends on both operating system
and hardware<a class='hidden_link' href='#req.timing-6.sentence-1'>.</a></div> <div id='req.timing-6.sentence-2' class='sentence'>The finest resolution provided by an implementation is called the
<a class='hidden_link' href='#def:native_resolution' id='def:native_resolution'><i>native resolution</i></a><a class='hidden_link' href='#req.timing-6.sentence-2'>.</a></div></div><div class='para' id='req.timing-7'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L130'>#</a></div><div id='req.timing-7.sentence-1' class='sentence'>Implementation-provided clocks that are used for these functions shall meet the
<a href='time.clock.req'><span class='texttt'>TrivialClock</span></a> requirements<a class='hidden_link' href='#req.timing-7.sentence-1'>.</a></div></div><div class='para' id='req.timing-8'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L134'>#</a></div><div id='req.timing-8.sentence-1' class='sentence'>A function that takes an argument which specifies a timeout will throw if,
during its execution, a clock, time point, or time duration throws an exception<a class='hidden_link' href='#req.timing-8.sentence-1'>.</a></div> <div id='req.timing-8.sentence-2' class='sentence'>Such exceptions are referred to as <a class='hidden_link' href='#def:timeout-related_exceptions' id='def:timeout-related_exceptions'><i>timeout-related exceptions</i></a><a class='hidden_link' href='#req.timing-8.sentence-2'>.</a></div> <div id='req.timing-8.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.timing-8.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.timing-8.sentence-3' class='sentence'>Instantiations of clock, time point and duration types supplied by
the implementation as specified in <a href='time.clock'>[time.clock]</a> do not throw exceptions<a class='hidden_link' href='#req.timing-8.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='footnote' id='footnote-331'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-331'>331)</a></div><div id='footnote-331.sentence-1' class='sentence'>All
implementations for which standard time units are meaningful must necessarily
have a steady clock within their hardware implementation<a class='hidden_link' href='#footnote-331.sentence-1'>.</a></div></div></div><div id='req.lockable' class='section'><h3 ><a class='secnum' href='#req.lockable' style='min-width:103pt'>33.2.5</a> Requirements for <span class='texttt'>Lockable</span> types <a class='abbr_ref' href='thread.req.lockable'>[thread.req.lockable]</a></h3><div id='req.lockable.general' class='section'><h4 ><a class='secnum' href='#req.lockable.general' style='min-width:118pt'>33.2.5.1</a> In general <a class='abbr_ref' href='thread.req.lockable.general'>[thread.req.lockable.general]</a></h4><div class='para' id='req.lockable.general-1'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L146'>#</a></div><div id='req.lockable.general-1.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:execution_agent' id='def:execution_agent'><i >execution agent</i></a> is an entity such as a thread that may perform work in parallel with
other execution agents<a class='hidden_link' href='#req.lockable.general-1.sentence-1'>.</a></div> <div id='req.lockable.general-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.lockable.general-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.lockable.general-1.sentence-3' class='sentence'>Implementations or users may introduce other kinds of
agents such as processes or thread-pool tasks<a class='hidden_link' href='#req.lockable.general-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='req.lockable.general-1.sentence-2' class='sentence'> The calling agent is determined by
context, e.g. the calling thread that contains the call, and so on<a class='hidden_link' href='#req.lockable.general-1.sentence-2'>.</a></div></div><div class='para' id='req.lockable.general-2'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L152'>#</a></div><div id='req.lockable.general-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.lockable.general-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.lockable.general-2.sentence-1' class='sentence'>Some lockable objects are “agent oblivious” in that they work for any
execution agent model because they do not determine or store the agent's ID (e.g., an
ordinary spin lock)<a class='hidden_link' href='#req.lockable.general-2.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='req.lockable.general-3'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L157'>#</a></div><div id='req.lockable.general-3.sentence-1' class='sentence'>The standard library templates <span class='texttt'>unique_&shy;lock</span> (<a href='thread.lock.unique'>[thread.lock.unique]</a>),
<span class='texttt'>shared_&shy;lock</span> (<a href='thread.lock.shared'>[thread.lock.shared]</a>),
<span class='texttt'>scoped_&shy;lock</span> (<a href='thread.lock.scoped'>[thread.lock.scoped]</a>),
<span class='texttt'>lock_&shy;guard</span> (<a href='thread.lock.guard'>[thread.lock.guard]</a>), <span class='texttt'>lock</span>,
<span class='texttt'>try_&shy;lock</span> (<a href='thread.lock.algorithm'>[thread.lock.algorithm]</a>), and
<span class='texttt'>condition_&shy;variable_&shy;any</span> (<a href='thread.condition.condvarany'>[thread.condition.condvarany]</a>) all operate on user-supplied
lockable objects<a class='hidden_link' href='#req.lockable.general-3.sentence-1'>.</a></div> <div id='req.lockable.general-3.sentence-2' class='sentence'>The <span class='texttt'>BasicLockable</span> requirements, the <span class='texttt'>Lockable</span> requirements,
and the <span class='texttt'>TimedLockable</span> requirements list the requirements imposed by these library types
in order to acquire or release ownership of a <span class='texttt'>lock</span> by a given execution agent<a class='hidden_link' href='#req.lockable.general-3.sentence-2'>.</a></div> <div id='req.lockable.general-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#req.lockable.general-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.lockable.general-3.sentence-3' class='sentence'>The nature of any lock ownership and any synchronization it may entail are not part
of these requirements<a class='hidden_link' href='#req.lockable.general-3.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='req.lockable.basic' class='section'><h4 ><a class='secnum' href='#req.lockable.basic' style='min-width:118pt'>33.2.5.2</a> <span class='texttt'>BasicLockable</span> requirements <a class='abbr_ref' href='thread.req.lockable.basic'>[thread.req.lockable.basic]</a></h4><div class='para' id='req.lockable.basic-1'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L172'>#</a></div><div id='req.lockable.basic-1.sentence-1' class='sentence'>A type <span class='texttt'>L</span> meets the <span class='texttt'>BasicLockable</span> requirements if the following expressions are
well-formed and have the specified semantics (<span class='texttt'>m</span> denotes a value of type <span class='texttt'>L</span>)<a class='hidden_link' href='#req.lockable.basic-1.sentence-1'>.</a></div></div><code class='itemdecl'>m.lock()
</code><div class='itemdescr'></div><div class='para' id='req.lockable.basic-2'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L181'>#</a></div><div id='req.lockable.basic-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Blocks until a lock can be acquired for the current execution agent<a class='hidden_link' href='#req.lockable.basic-2.sentence-1'>.</a></div> <div id='req.lockable.basic-2.sentence-2' class='sentence'>If an exception
is thrown then a lock shall not have been acquired for the current execution agent<a class='hidden_link' href='#req.lockable.basic-2.sentence-2'>.</a></div></div></div><code class='itemdecl'>m.unlock()
</code><div class='itemdescr'></div><div class='para' id='req.lockable.basic-3'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L191'>#</a></div><div id='req.lockable.basic-3.sentence-1' class='sentence'><span class='textit'>Requires:</span> The current execution agent shall hold a lock on <span class='texttt'>m</span><a class='hidden_link' href='#req.lockable.basic-3.sentence-1'>.</a></div></div></div><div class='para' id='req.lockable.basic-4'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L194'>#</a></div><div id='req.lockable.basic-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Releases a lock on <span class='texttt'>m</span> held by the current execution agent<a class='hidden_link' href='#req.lockable.basic-4.sentence-1'>.</a></div></div></div><div class='para' id='req.lockable.basic-5'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L197'>#</a></div><div id='req.lockable.basic-5.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#req.lockable.basic-5.sentence-1'>.</a></div></div></div></div><div id='req.lockable.req' class='section'><h4 ><a class='secnum' href='#req.lockable.req' style='min-width:118pt'>33.2.5.3</a> <span class='texttt'>Lockable</span> requirements <a class='abbr_ref' href='thread.req.lockable.req'>[thread.req.lockable.req]</a></h4><div class='para' id='req.lockable.req-1'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.req-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L203'>#</a></div><div id='req.lockable.req-1.sentence-1' class='sentence'>A type <span class='texttt'>L</span> meets the <span class='texttt'>Lockable</span> requirements if it meets the <span class='texttt'>BasicLockable</span>
requirements and the following expressions are well-formed and have the specified semantics
(<span class='texttt'>m</span> denotes a value of type <span class='texttt'>L</span>)<a class='hidden_link' href='#req.lockable.req-1.sentence-1'>.</a></div></div><code class='itemdecl'>m.try_lock()
</code><div class='itemdescr'></div><div class='para' id='req.lockable.req-2'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.req-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L213'>#</a></div><div id='req.lockable.req-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Attempts to acquire a lock for the current execution agent without blocking<a class='hidden_link' href='#req.lockable.req-2.sentence-1'>.</a></div> <div id='req.lockable.req-2.sentence-2' class='sentence'>If an
exception is thrown then a lock shall not have been acquired for the current execution agent<a class='hidden_link' href='#req.lockable.req-2.sentence-2'>.</a></div></div></div><div class='para' id='req.lockable.req-3'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.req-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L217'>#</a></div><div id='req.lockable.req-3.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#req.lockable.req-3.sentence-1'>.</a></div></div></div><div class='para' id='req.lockable.req-4'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.req-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L220'>#</a></div><div id='req.lockable.req-4.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if the lock was acquired, <span class='texttt'>false</span> otherwise<a class='hidden_link' href='#req.lockable.req-4.sentence-1'>.</a></div></div></div></div><div id='req.lockable.timed' class='section'><h4 ><a class='secnum' href='#req.lockable.timed' style='min-width:118pt'>33.2.5.4</a> <span class='texttt'>TimedLockable</span> requirements <a class='abbr_ref' href='thread.req.lockable.timed'>[thread.req.lockable.timed]</a></h4><div class='para' id='req.lockable.timed-1'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L226'>#</a></div><div id='req.lockable.timed-1.sentence-1' class='sentence'>A type <span class='texttt'>L</span> meets the <span class='texttt'>TimedLockable</span> requirements if it meets the <span class='texttt'>Lockable</span>
requirements and the following expressions are well-formed and have the specified semantics
(<span class='texttt'>m</span> denotes a value of type <span class='texttt'>L</span>, <span class='texttt'>rel_&shy;time</span> denotes a value of an
instantiation of <a href='time.duration'><span class='texttt'>duration</span></a>, and <span class='texttt'>abs_&shy;time</span> denotes a value
of an instantiation of <a href='time.point'><span class='texttt'>time_&shy;point</span></a>)<a class='hidden_link' href='#req.lockable.timed-1.sentence-1'>.</a></div></div><code class='itemdecl'>m.try_lock_for(rel_time)
</code><div class='itemdescr'></div><div class='para' id='req.lockable.timed-2'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L238'>#</a></div><div id='req.lockable.timed-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Attempts to acquire a lock for the current execution agent within the relative
timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>rel_&shy;time</span><a class='hidden_link' href='#req.lockable.timed-2.sentence-1'>.</a></div> <div id='req.lockable.timed-2.sentence-2' class='sentence'>The function shall not return
within the timeout specified by <span class='texttt'>rel_&shy;time</span> unless it has obtained a lock on <span class='texttt'>m</span>
for the current execution agent<a class='hidden_link' href='#req.lockable.timed-2.sentence-2'>.</a></div> <div id='req.lockable.timed-2.sentence-3' class='sentence'>If an exception is thrown then a lock shall not have been
acquired for the current execution agent<a class='hidden_link' href='#req.lockable.timed-2.sentence-3'>.</a></div></div></div><div class='para' id='req.lockable.timed-3'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L245'>#</a></div><div id='req.lockable.timed-3.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#req.lockable.timed-3.sentence-1'>.</a></div></div></div><div class='para' id='req.lockable.timed-4'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L248'>#</a></div><div id='req.lockable.timed-4.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if the lock was acquired, <span class='texttt'>false</span> otherwise<a class='hidden_link' href='#req.lockable.timed-4.sentence-1'>.</a></div></div></div><code class='itemdecl'>m.try_lock_until(abs_time)
</code><div class='itemdescr'></div><div class='para' id='req.lockable.timed-5'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L257'>#</a></div><div id='req.lockable.timed-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> Attempts to acquire a lock for the current execution agent before the absolute
timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>abs_&shy;time</span><a class='hidden_link' href='#req.lockable.timed-5.sentence-1'>.</a></div> <div id='req.lockable.timed-5.sentence-2' class='sentence'>The function shall not return
before the timeout specified by <span class='texttt'>abs_&shy;time</span> unless it has obtained a lock on <span class='texttt'>m</span> for
the current execution agent<a class='hidden_link' href='#req.lockable.timed-5.sentence-2'>.</a></div> <div id='req.lockable.timed-5.sentence-3' class='sentence'>If an exception is thrown then a lock shall not have been acquired
for the current execution agent<a class='hidden_link' href='#req.lockable.timed-5.sentence-3'>.</a></div></div></div><div class='para' id='req.lockable.timed-6'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L264'>#</a></div><div id='req.lockable.timed-6.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#req.lockable.timed-6.sentence-1'>.</a></div></div></div><div class='para' id='req.lockable.timed-7'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L267'>#</a></div><div id='req.lockable.timed-7.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if the lock was acquired, <span class='texttt'>false</span> otherwise<a class='hidden_link' href='#req.lockable.timed-7.sentence-1'>.</a></div></div></div></div></div><div id='decaycopy' class='section'><h3 ><a class='secnum' href='#decaycopy' style='min-width:103pt'>33.2.6</a> <span class='texttt'>decay_&shy;copy</span> <a class='abbr_ref' href='thread.decaycopy'>[thread.decaycopy]</a></h3><div class='para' id='decaycopy-1'><div class='marginalizedparent'><a class='marginalized' href='#decaycopy-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L273'>#</a></div><div id='decaycopy-1.sentence-1' class='sentence'>In several places in this Clause the operation
<span class='indexparent'><a class='index' id=':DECAY_COPY'></a></span><span class='indexparent'><a class='index' id='lib:DECAY_COPY'></a></span><span class='texttt'><span class='textit'>DECAY_&shy;COPY</span>(x)</span> is used<a class='hidden_link' href='#decaycopy-1.sentence-1'>.</a></div> <div id='decaycopy-1.sentence-2' class='sentence'>All
such uses mean call the function <span class='texttt'>decay_&shy;copy(x)</span> and use the
result, where <span class='texttt'>decay_&shy;copy</span> is defined as follows:</div><pre class='codeblock'>
template &lt;class T&gt; decay_t&lt;T&gt; decay_copy(T&amp;&amp; v)
  { return std::forward&lt;T&gt;(v); }</pre></div></div></div><div id='threads' class='section'><h2 ><a class='secnum' href='#threads' style='min-width:88pt'>33.3</a> Threads <a class='abbr_ref' href='thread.threads'>[thread.threads]</a></h2><div class='para' id='threads-1'><div class='marginalizedparent'><a class='marginalized' href='#threads-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L288'>#</a></div><div id='threads-1.sentence-1' class='sentence'><a href='thread.threads'>[thread.threads]</a> describes components that can be used to create and manage threads<a class='hidden_link' href='#threads-1.sentence-1'>.</a></div> <div id='threads-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#threads-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='threads-1.sentence-2' class='sentence'>These threads are intended to map one-to-one with operating system threads<a class='hidden_link' href='#threads-1.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div id='syn' class='section'><h3 ><a class='secnum' href='#syn' style='min-width:103pt'>33.3.1</a> Header <span class='texttt'>&lt;thread&gt;</span> synopsis <a class='abbr_ref' href='thread.syn'>[thread.syn]</a></h3><div id='syn-sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':<thread>'></a></span><span class='indexparent'><a class='index' id='lib:<thread>'></a></span>
<pre class='codeblock'>
namespace std {
  class thread;

  void swap(thread&amp; x, thread&amp; y) noexcept;

  namespace this_thread {
    thread::id get_id() noexcept;

    void yield() noexcept;
    template &lt;class Clock, class Duration&gt;
      void sleep_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    template &lt;class Rep, class Period&gt;
      void sleep_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
  }
}</pre></div></div><div id='thread.class' class='section'><h3 ><a class='secnum' href='#thread.class' style='min-width:103pt'>33.3.2</a> Class <span class='texttt'>thread</span> <a class='abbr_ref' href='thread.thread.class'>[thread.thread.class]</a></h3><div class='para' id='thread.class-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L317'>#</a></div><div id='thread.class-1.sentence-1' class='sentence'>The class <span class='texttt'>thread</span> provides a mechanism to create a new thread of execution, to join with
a thread (i.e., wait for a thread to complete), and to perform other operations that manage and
query the state of a thread. A <span class='texttt'>thread</span> object uniquely represents a particular thread of
execution<a class='hidden_link' href='#thread.class-1.sentence-1'>.</a></div> <div id='thread.class-1.sentence-2' class='sentence'>That representation may be transferred to other <span class='texttt'>thread</span> objects in such a way
that no two <span class='texttt'>thread</span> objects simultaneously represent the same thread of execution<a class='hidden_link' href='#thread.class-1.sentence-2'>.</a></div> <div id='thread.class-1.sentence-3' class='sentence'>A
thread of execution is <a class='hidden_link' href='#def:detached' id='def:detached'><i>detached</i></a> when no <span class='texttt'>thread</span> object represents that thread<a class='hidden_link' href='#thread.class-1.sentence-3'>.</a></div> <div id='thread.class-1.sentence-4' class='sentence'>Objects of class <span class='texttt'>thread</span> can be in a state that does not represent a thread of
execution<a class='hidden_link' href='#thread.class-1.sentence-4'>.</a></div> <div id='thread.class-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#thread.class-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='thread.class-1.sentence-5' class='sentence'>A <span class='texttt'>thread</span> object does not represent a thread of execution after
default construction, after being moved from, or after a successful call to <span class='texttt'>detach</span> or
<span class='texttt'>join</span><a class='hidden_link' href='#thread.class-1.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> <span class='indexparent'><a class='index' id='lib:thread'></a></span><pre class='codeblock'>
namespace std {
  class thread {
  public:
    <span class='comment'>// types:
</span>    class id;
    using native_handle_type = <span class='textit'>implementation-defined</span>;         <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>
    <span class='comment'>// construct/copy/destroy:
</span>    thread() noexcept;
    template &lt;class F, class... Args&gt; explicit thread(F&amp;&amp; f, Args&amp;&amp;... args);
    ~thread();
    thread(const thread&amp;) = delete;
    thread(thread&amp;&amp;) noexcept;
    thread&amp; operator=(const thread&amp;) = delete;
    thread&amp; operator=(thread&amp;&amp;) noexcept;

    <span class='comment'>// members:
</span>    void swap(thread&amp;) noexcept;
    bool joinable() const noexcept;
    void join();
    void detach();
    id get_id() const noexcept;
    native_handle_type native_handle();                         <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>
    <span class='comment'>// static members:
</span>    static unsigned int hardware_concurrency() noexcept;
  };
}</pre></div><div id='thread.id' class='section'><h4 ><a class='secnum' href='#thread.id' style='min-width:118pt'>33.3.2.1</a> Class <span class='texttt'>thread&#x200b;::&#x200b;id</span> <a class='abbr_ref' href='thread.thread.id'>[thread.thread.id]</a></h4><span class='indexparent'><a class='index' id='lib:thread::id'></a></span><span class='indexparent'><a class='index' id='lib:thread,id'></a></span><pre class='codeblock'>
namespace std {
  class thread::id {
  public:
    id() noexcept;
  };

  bool operator==(thread::id x, thread::id y) noexcept;
  bool operator!=(thread::id x, thread::id y) noexcept;
  bool operator&lt;(thread::id x, thread::id y) noexcept;
  bool operator&lt;=(thread::id x, thread::id y) noexcept;
  bool operator&gt;(thread::id x, thread::id y) noexcept;
  bool operator&gt;=(thread::id x, thread::id y) noexcept;

  template&lt;class charT, class traits&gt;
    basic_ostream&lt;charT, traits&gt;&amp;
      operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; out, thread::id id);

  <span class='comment'>// Hash support
</span>  template &lt;class T&gt; struct hash;
  template &lt;&gt; struct hash&lt;thread::id&gt;;
}</pre><div class='para' id='thread.id-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L389'>#</a></div><div id='thread.id-1.sentence-1' class='sentence'>An object of type <span class='texttt'>thread&#x200b;::&#x200b;id</span> provides a unique identifier for
each thread of execution and a single distinct value for all <span class='texttt'>thread</span>
objects that do not represent a thread of
execution (<a href='thread.thread.class'>[thread.thread.class]</a>)<a class='hidden_link' href='#thread.id-1.sentence-1'>.</a></div> <div id='thread.id-1.sentence-2' class='sentence'>Each thread of execution has an
associated <span class='texttt'>thread&#x200b;::&#x200b;id</span> object that is not equal to the
<span class='texttt'>thread&#x200b;::&#x200b;id</span> object of any other thread of execution and that is not
equal to the <span class='texttt'>thread&#x200b;::&#x200b;id</span> object of any <span class='texttt'>thread</span> object that
does not represent threads of execution<a class='hidden_link' href='#thread.id-1.sentence-2'>.</a></div></div><div class='para' id='thread.id-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L398'>#</a></div><div id='thread.id-2.sentence-1' class='sentence'><span class='texttt'>thread&#x200b;::&#x200b;id</span> shall be a <a href='class#def:trivially_copyable_class'>trivially copyable class</a><a class='hidden_link' href='#thread.id-2.sentence-1'>.</a></div> <div id='thread.id-2.sentence-2' class='sentence'>The library may reuse the value of a <span class='texttt'>thread&#x200b;::&#x200b;id</span> of a terminated thread that can no longer be joined<a class='hidden_link' href='#thread.id-2.sentence-2'>.</a></div></div><div class='para' id='thread.id-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L402'>#</a></div><div id='thread.id-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#thread.id-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='thread.id-3.sentence-1' class='sentence'>Relational operators allow <span class='texttt'>thread&#x200b;::&#x200b;id</span> objects to be used as
keys in associative containers<a class='hidden_link' href='#thread.id-3.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <span class='indexparent'><a class='index' id='lib:thread::id,constructor'></a></span></div><code class='itemdecl'>id() noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.id-4'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L412'>#</a></div><div id='thread.id-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>id</span><a class='hidden_link' href='#thread.id-4.sentence-1'>.</a></div></div></div><div class='para' id='thread.id-5'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L414'>#</a></div><div id='thread.id-5.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> The constructed object does not represent a thread of execution<a class='hidden_link' href='#thread.id-5.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator==,thread::id'></a></span><span class='indexparent'><a class='index' id='lib:thread::id,operator=='></a></span><code class='itemdecl'>bool operator==(thread::id x, thread::id y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.id-6'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L423'>#</a></div><div id='thread.id-6.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> only if <span class='texttt'>x</span> and <span class='texttt'>y</span> represent the same
thread of execution or neither <span class='texttt'>x</span> nor <span class='texttt'>y</span> represents a thread of
execution<a class='hidden_link' href='#thread.id-6.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator!=,thread::id'></a></span><span class='indexparent'><a class='index' id='lib:thread::id,operator!='></a></span><code class='itemdecl'>bool operator!=(thread::id x, thread::id y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.id-7'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L434'>#</a></div><div id='thread.id-7.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>!(x == y)</span></div></div></div><span class='indexparent'><a class='index' id='lib:operator<,thread::id'></a></span><span class='indexparent'><a class='index' id='lib:thread::id,operator<'></a></span><code class='itemdecl'>bool operator&lt;(thread::id x, thread::id y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.id-8'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L443'>#</a></div><div id='thread.id-8.sentence-1' class='sentence'><span class='textit'>Returns:</span> A value such that <span class='texttt'>operator&lt;</span> is a total ordering as described in <a href='alg.sorting'>[alg.sorting]</a><a class='hidden_link' href='#thread.id-8.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator<=,thread::id'></a></span><span class='indexparent'><a class='index' id='lib:thread::id,operator<='></a></span><code class='itemdecl'>bool operator&lt;=(thread::id x, thread::id y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.id-9'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L453'>#</a></div><div id='thread.id-9.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>!(y &lt; x)</span><a class='hidden_link' href='#thread.id-9.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator>,thread::id'></a></span><span class='indexparent'><a class='index' id='lib:thread::id,operator>'></a></span><code class='itemdecl'>bool operator&gt;(thread::id x, thread::id y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.id-10'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L463'>#</a></div><div id='thread.id-10.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>y &lt; x</span><a class='hidden_link' href='#thread.id-10.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator>=,thread::id'></a></span><span class='indexparent'><a class='index' id='lib:thread::id,operator>='></a></span><code class='itemdecl'>bool operator&gt;=(thread::id x, thread::id y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.id-11'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L472'>#</a></div><div id='thread.id-11.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>!(x &lt; y)</span><a class='hidden_link' href='#thread.id-11.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator<<,thread::id'></a></span><span class='indexparent'><a class='index' id='lib:thread::id,operator<<'></a></span><code class='itemdecl'>template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT, traits&gt;&amp;
    operator&lt;&lt; (basic_ostream&lt;charT, traits&gt;&amp; out, thread::id id);
</code><div class='itemdescr'></div><div class='para' id='thread.id-12'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L483'>#</a></div><div id='thread.id-12.sentence-1' class='sentence'><span class='textit'>Effects:</span> Inserts an unspecified text representation of <span class='texttt'>id</span> into
<span class='texttt'>out</span><a class='hidden_link' href='#thread.id-12.sentence-1'>.</a></div> <div id='thread.id-12.sentence-2' class='sentence'>For two objects of type <span class='texttt'>thread&#x200b;::&#x200b;id</span> <span class='texttt'>x</span> and <span class='texttt'>y</span>,
if <span class='texttt'>x == y</span> the <span class='texttt'>thread&#x200b;::&#x200b;id</span> objects shall have the same text
representation and if <span class='texttt'>x != y</span> the <span class='texttt'>thread&#x200b;::&#x200b;id</span> objects shall have
distinct text representations<a class='hidden_link' href='#thread.id-12.sentence-2'>.</a></div></div></div><div class='para' id='thread.id-13'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L489'>#</a></div><div id='thread.id-13.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>out</span><a class='hidden_link' href='#thread.id-13.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:hash,thread::id'></a></span><code class='itemdecl'>template &lt;&gt; struct hash&lt;thread::id&gt;;
</code><div class='itemdescr'></div><div class='para' id='thread.id-14'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L498'>#</a></div><div id='thread.id-14.sentence-1' class='sentence'>The specialization is enabled (<a href='unord.hash'>[unord.hash]</a>)<a class='hidden_link' href='#thread.id-14.sentence-1'>.</a></div></div></div></div><div id='thread.constr' class='section'><h4 ><a class='secnum' href='#thread.constr' style='min-width:118pt'>33.3.2.2</a> <span class='texttt'>thread</span> constructors <a class='abbr_ref' href='thread.thread.constr'>[thread.thread.constr]</a></h4><span class='indexparent'><a class='index' id='lib:thread,constructor'></a></span><code class='itemdecl'>thread() noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.constr-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L509'>#</a></div><div id='thread.constr-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a <span class='texttt'>thread</span> object that does not represent a thread of execution<a class='hidden_link' href='#thread.constr-1.sentence-1'>.</a></div></div></div><div class='para' id='thread.constr-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L511'>#</a></div><div id='thread.constr-2.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>get_&shy;id() == id()</span><a class='hidden_link' href='#thread.constr-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:thread,constructor_'></a></span><code class='itemdecl'>template &lt;class F, class... Args&gt; explicit thread(F&amp;&amp; f, Args&amp;&amp;... args);
</code><div class='itemdescr'></div><div class='para' id='thread.constr-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L520'>#</a></div><div id='thread.constr-3.sentence-1' class='sentence'><span class='textit'>Requires:</span> &nbsp;<span class='texttt'>F</span> and each <span class='texttt'>Ti</span> in <span class='texttt'>Args</span> shall satisfy the
<span class='texttt'>MoveConstructible</span> requirements<a class='hidden_link' href='#thread.constr-3.sentence-1'>.</a></div> <div id='thread.constr-3.sentence-2' class='sentence'><span class='texttt'><span class='textit'>INVOKE</span>(&#x200b;<span class='textit'>DECAY_&shy;COPY</span>(&#x200b;std&#x200b;::&#x200b;forward&lt;F&gt;(f)),
<span class='textit'>DECAY_&shy;COPY</span>(&#x200b;std&#x200b;::&#x200b;forward&lt;Args&gt;(&#x200b;args))...)</span> (<a href='func.require'>[func.require]</a>) shall be
a valid expression<a class='hidden_link' href='#thread.constr-3.sentence-2'>.</a></div></div></div><div class='para' id='thread.constr-4'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L531'>#</a></div><div id='thread.constr-4.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
This constructor shall not participate in overload resolution if <span class='texttt'>decay_&shy;t&lt;F&gt;</span>
is the same type as <span class='texttt'>std&#x200b;::&#x200b;thread</span><a class='hidden_link' href='#thread.constr-4.sentence-1'>.</a></div></div></div><div class='para' id='thread.constr-5'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L536'>#</a></div><div id='thread.constr-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> &nbsp;Constructs an object of type <span class='texttt'>thread</span><a class='hidden_link' href='#thread.constr-5.sentence-1'>.</a></div> <div id='thread.constr-5.sentence-2' class='sentence'>The new thread of execution executes
<span class='texttt'><span class='textit'>INVOKE</span>(&#x200b;<span class='textit'>DECAY_&shy;COPY</span>(&#x200b;std&#x200b;::&#x200b;forward&lt;F&gt;(f)),
<span class='textit'>DECAY_&shy;COPY</span>(&#x200b;std&#x200b;::&#x200b;forward&lt;Args&gt;(&#x200b;args))...)</span> with the calls to
<span class='texttt'><span class='textit'>DECAY_&shy;COPY</span></span> being evaluated in the constructing thread<a class='hidden_link' href='#thread.constr-5.sentence-2'>.</a></div> <div id='thread.constr-5.sentence-3' class='sentence'>Any return value from this invocation
is ignored<a class='hidden_link' href='#thread.constr-5.sentence-3'>.</a></div> <div id='thread.constr-5.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#thread.constr-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='thread.constr-5.sentence-5' class='sentence'>This implies that any exceptions not thrown from the invocation of the copy
of <span class='texttt'>f</span> will be thrown in the constructing thread, not the new thread<a class='hidden_link' href='#thread.constr-5.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='thread.constr-5.sentence-4' class='sentence'> If the
invocation of
<span class='texttt'><span class='textit'>INVOKE</span>(&#x200b;<span class='textit'>DECAY_&shy;COPY</span>(&#x200b;std&#x200b;::&#x200b;forward&lt;F&gt;(f)),
<span class='textit'>DECAY_&shy;COPY</span>(&#x200b;std&#x200b;::&#x200b;forward&lt;Args&gt;(args))...)</span>
terminates with an uncaught exception, <span class='texttt'>terminate</span> shall be called<a class='hidden_link' href='#thread.constr-5.sentence-4'>.</a></div></div></div><div class='para' id='thread.constr-6'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L557'>#</a></div><div id='thread.constr-6.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> The completion of the invocation of the constructor
synchronizes with the beginning of the invocation of the copy of <span class='texttt'>f</span><a class='hidden_link' href='#thread.constr-6.sentence-1'>.</a></div></div></div><div class='para' id='thread.constr-7'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L560'>#</a></div><div id='thread.constr-7.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>get_&shy;id() != id()</span><a class='hidden_link' href='#thread.constr-7.sentence-1'>.</a></div> <div id='thread.constr-7.sentence-2' class='sentence'><span class='texttt'>*this</span> represents the newly started thread<a class='hidden_link' href='#thread.constr-7.sentence-2'>.</a></div></div></div><div class='para' id='thread.constr-8'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L562'>#</a></div><div id='thread.constr-8.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> if unable to start the new thread<a class='hidden_link' href='#thread.constr-8.sentence-1'>.</a></div></div></div><div class='para' id='thread.constr-9'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L564'>#</a></div><div id='thread.constr-9.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='thread.constr-9.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#thread.constr-9.1'>(9.1)</a></div><div id='thread.constr-9.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — the system lacked the necessary
resources to create another thread, or the system-imposed limit on the number of
threads in a process would be exceeded<a class='hidden_link' href='#thread.constr-9.1.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:thread,constructor__'></a></span><code class='itemdecl'>thread(thread&amp;&amp; x) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.constr-10'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L578'>#</a></div><div id='thread.constr-10.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>thread</span> from <span class='texttt'>x</span>, and sets
<span class='texttt'>x</span> to a default constructed state<a class='hidden_link' href='#thread.constr-10.sentence-1'>.</a></div></div></div><div class='para' id='thread.constr-11'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L582'>#</a></div><div id='thread.constr-11.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>x.get_&shy;id() == id()</span> and <span class='texttt'>get_&shy;id()</span> returns the
value of <span class='texttt'>x.get_&shy;id()</span> prior to the start of construction<a class='hidden_link' href='#thread.constr-11.sentence-1'>.</a></div></div></div></div><div id='thread.destr' class='section'><h4 ><a class='secnum' href='#thread.destr' style='min-width:118pt'>33.3.2.3</a> <span class='texttt'>thread</span> destructor <a class='abbr_ref' href='thread.thread.destr'>[thread.thread.destr]</a></h4><span class='indexparent'><a class='index' id='lib:thread,destructor'></a></span><code class='itemdecl'>~thread();
</code><div class='itemdescr'></div><div class='para' id='thread.destr-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.destr-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L596'>#</a></div><div id='thread.destr-1.sentence-1' class='sentence'>If <span class='texttt'>joinable()</span>, calls <span class='texttt'>terminate()</span><a class='hidden_link' href='#thread.destr-1.sentence-1'>.</a></div> <div id='thread.destr-1.sentence-2' class='sentence'>Otherwise, has no effects<a class='hidden_link' href='#thread.destr-1.sentence-2'>.</a></div> <div id='thread.destr-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#thread.destr-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='thread.destr-1.sentence-3' class='sentence'>Either implicitly detaching or joining a <span class='texttt'>joinable()</span> thread in its
destructor could result in difficult to debug correctness (for detach) or performance
(for join) bugs encountered only when an exception is thrown<a class='hidden_link' href='#thread.destr-1.sentence-3'>.</a></div> <div id='thread.destr-1.sentence-4' class='sentence'>Thus the programmer must
ensure that the destructor is never executed while the thread is still joinable<a class='hidden_link' href='#thread.destr-1.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div><div id='thread.assign' class='section'><h4 ><a class='secnum' href='#thread.assign' style='min-width:118pt'>33.3.2.4</a> <span class='texttt'>thread</span> assignment <a class='abbr_ref' href='thread.thread.assign'>[thread.thread.assign]</a></h4><span class='indexparent'><a class='index' id='lib:operator=,thread'></a></span><span class='indexparent'><a class='index' id='lib:thread,operator='></a></span><code class='itemdecl'>thread&amp; operator=(thread&amp;&amp; x) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.assign-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.assign-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L613'>#</a></div><div id='thread.assign-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>joinable()</span>, calls <span class='texttt'>terminate()</span><a class='hidden_link' href='#thread.assign-1.sentence-1'>.</a></div> <div id='thread.assign-1.sentence-2' class='sentence'>Otherwise, assigns the
state of <span class='texttt'>x</span> to <span class='texttt'>*this</span> and sets <span class='texttt'>x</span> to a default constructed state<a class='hidden_link' href='#thread.assign-1.sentence-2'>.</a></div></div></div><div class='para' id='thread.assign-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.assign-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L617'>#</a></div><div id='thread.assign-2.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>x.get_&shy;id() == id()</span> and <span class='texttt'>get_&shy;id()</span> returns the value of
<span class='texttt'>x.get_&shy;id()</span> prior to the assignment<a class='hidden_link' href='#thread.assign-2.sentence-1'>.</a></div></div></div><div class='para' id='thread.assign-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.assign-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L621'>#</a></div><div id='thread.assign-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*this</span><a class='hidden_link' href='#thread.assign-3.sentence-1'>.</a></div></div></div></div><div id='thread.member' class='section'><h4 ><a class='secnum' href='#thread.member' style='min-width:118pt'>33.3.2.5</a> <span class='texttt'>thread</span> members <a class='abbr_ref' href='thread.thread.member'>[thread.thread.member]</a></h4><span class='indexparent'><a class='index' id='lib:swap,thread'></a></span><span class='indexparent'><a class='index' id='lib:thread,swap'></a></span><code class='itemdecl'>void swap(thread&amp; x) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.member-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L633'>#</a></div><div id='thread.member-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Swaps the state of <span class='texttt'>*this</span> and <span class='texttt'>x</span><a class='hidden_link' href='#thread.member-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:joinable,thread'></a></span><span class='indexparent'><a class='index' id='lib:thread,joinable'></a></span><code class='itemdecl'>bool joinable() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.member-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L643'>#</a></div><div id='thread.member-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>get_&shy;id() != id()</span><a class='hidden_link' href='#thread.member-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:join,thread'></a></span><span class='indexparent'><a class='index' id='lib:thread,join'></a></span><code class='itemdecl'>void join();
</code><div class='itemdescr'></div><div class='para' id='thread.member-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L653'>#</a></div><div id='thread.member-3.sentence-1' class='sentence'><span class='textit'>Effects:</span> &nbsp;Blocks until the thread represented by <span class='texttt'>*this</span> has completed<a class='hidden_link' href='#thread.member-3.sentence-1'>.</a></div></div></div><div class='para' id='thread.member-4'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L656'>#</a></div><div id='thread.member-4.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> The completion of the thread represented by <span class='texttt'>*this</span> <a href='intro.multithread#def:synchronize_with'>synchronizes with</a>
the corresponding successful
<span class='texttt'>join()</span> return<a class='hidden_link' href='#thread.member-4.sentence-1'>.</a></div> <div id='thread.member-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#thread.member-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='thread.member-4.sentence-2' class='sentence'>Operations on
<span class='texttt'>*this</span> are not synchronized<a class='hidden_link' href='#thread.member-4.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='thread.member-5'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L662'>#</a></div><div id='thread.member-5.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> The thread represented by <span class='texttt'>*this</span> has completed<a class='hidden_link' href='#thread.member-5.sentence-1'>.</a></div> <div id='thread.member-5.sentence-2' class='sentence'><span class='texttt'>get_&shy;id() == id()</span><a class='hidden_link' href='#thread.member-5.sentence-2'>.</a></div></div></div><div class='para' id='thread.member-6'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L665'>#</a></div><div id='thread.member-6.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#thread.member-6.sentence-1'>.</a></div></div></div><div class='para' id='thread.member-7'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L669'>#</a></div><div id='thread.member-7.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='thread.member-7.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#thread.member-7.1'>(7.1)</a></div><div id='thread.member-7.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if deadlock is detected or
<span class='texttt'>get_&shy;id() == this_&shy;thread&#x200b;::&#x200b;&#x200b;get_&shy;id()</span><a class='hidden_link' href='#thread.member-7.1.sentence-1'>.</a></div></li><li id='thread.member-7.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#thread.member-7.2'>(7.2)</a></div><div id='thread.member-7.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;such_&shy;process</span> — if the thread is not valid<a class='hidden_link' href='#thread.member-7.2.sentence-1'>.</a></div></li><li id='thread.member-7.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#thread.member-7.3'>(7.3)</a></div><div id='thread.member-7.3.sentence-1' class='sentence'><span class='texttt'>invalid_&shy;argument</span> — if the thread is not joinable<a class='hidden_link' href='#thread.member-7.3.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:detach,thread'></a></span><span class='indexparent'><a class='index' id='lib:thread,detach'></a></span><code class='itemdecl'>void detach();
</code><div class='itemdescr'></div><div class='para' id='thread.member-8'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L687'>#</a></div><div id='thread.member-8.sentence-1' class='sentence'><span class='textit'>Effects:</span> The thread represented by <span class='texttt'>*this</span> continues execution without the calling thread
blocking<a class='hidden_link' href='#thread.member-8.sentence-1'>.</a></div> <div id='thread.member-8.sentence-2' class='sentence'>When <span class='texttt'>detach()</span> returns, <span class='texttt'>*this</span> no longer represents the possibly continuing
thread of execution<a class='hidden_link' href='#thread.member-8.sentence-2'>.</a></div> <div id='thread.member-8.sentence-3' class='sentence'>When the thread previously represented by <span class='texttt'>*this</span> ends execution, the
implementation shall release any owned resources<a class='hidden_link' href='#thread.member-8.sentence-3'>.</a></div></div></div><div class='para' id='thread.member-9'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L693'>#</a></div><div id='thread.member-9.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>get_&shy;id() == id()</span><a class='hidden_link' href='#thread.member-9.sentence-1'>.</a></div></div></div><div class='para' id='thread.member-10'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L695'>#</a></div><div id='thread.member-10.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#thread.member-10.sentence-1'>.</a></div></div></div><div class='para' id='thread.member-11'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L698'>#</a></div><div id='thread.member-11.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='thread.member-11.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#thread.member-11.1'>(11.1)</a></div><div id='thread.member-11.1.sentence-1' class='sentence'><span class='texttt'>no_&shy;such_&shy;process</span> — if the thread is not valid<a class='hidden_link' href='#thread.member-11.1.sentence-1'>.</a></div></li><li id='thread.member-11.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#thread.member-11.2'>(11.2)</a></div><div id='thread.member-11.2.sentence-1' class='sentence'><span class='texttt'>invalid_&shy;argument</span> — if the thread is not joinable<a class='hidden_link' href='#thread.member-11.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:get_id,thread'></a></span><span class='indexparent'><a class='index' id='lib:thread,get_id'></a></span><code class='itemdecl'>id get_id() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.member-12'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L711'>#</a></div><div id='thread.member-12.sentence-1' class='sentence'><span class='textit'>Returns:</span> A default constructed <span class='texttt'>id</span> object if <span class='texttt'>*this</span> does not represent a thread,
otherwise <span class='texttt'>this_&shy;thread&#x200b;::&#x200b;get_&shy;id()</span> for the thread of execution represented by
<span class='texttt'>*this</span><a class='hidden_link' href='#thread.member-12.sentence-1'>.</a></div></div></div></div><div id='thread.static' class='section'><h4 ><a class='secnum' href='#thread.static' style='min-width:118pt'>33.3.2.6</a> <span class='texttt'>thread</span> static members <a class='abbr_ref' href='thread.thread.static'>[thread.thread.static]</a></h4><span class='indexparent'><a class='index' id='lib:hardware_concurrency,thread'></a></span><span class='indexparent'><a class='index' id='lib:thread,hardware_concurrency'></a></span><code class='itemdecl'>unsigned hardware_concurrency() noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.static-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.static-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L725'>#</a></div><div id='thread.static-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> The number of hardware thread contexts<a class='hidden_link' href='#thread.static-1.sentence-1'>.</a></div> <div id='thread.static-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#thread.static-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='thread.static-1.sentence-3' class='sentence'>This value should
only be considered to be a hint<a class='hidden_link' href='#thread.static-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='thread.static-1.sentence-2' class='sentence'> If this value is not computable or
well defined, an implementation should return 0<a class='hidden_link' href='#thread.static-1.sentence-2'>.</a></div></div></div></div><div id='thread.algorithm' class='section'><h4 ><a class='secnum' href='#thread.algorithm' style='min-width:118pt'>33.3.2.7</a> <span class='texttt'>thread</span> specialized algorithms <a class='abbr_ref' href='thread.thread.algorithm'>[thread.thread.algorithm]</a></h4><span class='indexparent'><a class='index' id='lib:swap,thread_'></a></span><span class='indexparent'><a class='index' id='lib:thread,swap_'></a></span><code class='itemdecl'>void swap(thread&amp; x, thread&amp; y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.algorithm-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.algorithm-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L739'>#</a></div><div id='thread.algorithm-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>x.swap(y)</span><a class='hidden_link' href='#thread.algorithm-1.sentence-1'>.</a></div></div></div></div></div><div id='thread.this' class='section'><h3 ><a class='secnum' href='#thread.this' style='min-width:103pt'>33.3.3</a> Namespace <span class='texttt'>this_&shy;thread</span> <a class='abbr_ref' href='thread.thread.this'>[thread.thread.this]</a></h3><pre class='codeblock'>
namespace std::this_thread {
  thread::id get_id() noexcept;

  void yield() noexcept;
  template &lt;class Clock, class Duration&gt;
    void sleep_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
  template &lt;class Rep, class Period&gt;
    void sleep_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
}</pre> <span class='indexparent'><a class='index' id='lib:get_id,this_thread'></a></span><span class='indexparent'><a class='index' id='lib:this_thread,get_id'></a></span><code class='itemdecl'>thread::id this_thread::get_id() noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.this-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L762'>#</a></div><div id='thread.this-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> An object of type <span class='texttt'>thread&#x200b;::&#x200b;id</span> that uniquely identifies the current thread of
execution<a class='hidden_link' href='#thread.this-1.sentence-1'>.</a></div> <div id='thread.this-1.sentence-2' class='sentence'>No other thread of execution shall have this id and this thread of execution shall
always have this id<a class='hidden_link' href='#thread.this-1.sentence-2'>.</a></div> <div id='thread.this-1.sentence-3' class='sentence'>The object returned shall not compare equal to a default constructed
<span class='texttt'>thread&#x200b;::&#x200b;id</span><a class='hidden_link' href='#thread.this-1.sentence-3'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:yield,this_thread'></a></span><span class='indexparent'><a class='index' id='lib:this_thread,yield'></a></span><code class='itemdecl'>void this_thread::yield() noexcept;
</code><div class='itemdescr'></div><div class='para' id='thread.this-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L775'>#</a></div><div id='thread.this-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Offers the implementation the opportunity to reschedule<a class='hidden_link' href='#thread.this-2.sentence-1'>.</a></div></div></div><div class='para' id='thread.this-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L778'>#</a></div><div id='thread.this-3.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> None<a class='hidden_link' href='#thread.this-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:sleep_until,this_thread'></a></span><span class='indexparent'><a class='index' id='lib:this_thread,sleep_until'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  void sleep_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</code><div class='itemdescr'></div><div class='para' id='thread.this-4'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L789'>#</a></div><div id='thread.this-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Blocks the calling thread for the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified
by <span class='texttt'>abs_&shy;time</span><a class='hidden_link' href='#thread.this-4.sentence-1'>.</a></div></div></div><div class='para' id='thread.this-5'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L793'>#</a></div><div id='thread.this-5.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> None<a class='hidden_link' href='#thread.this-5.sentence-1'>.</a></div></div></div><div class='para' id='thread.this-6'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L796'>#</a></div><div id='thread.this-6.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#thread.this-6.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:sleep_for,this_thread'></a></span><span class='indexparent'><a class='index' id='lib:this_thread,sleep_for'></a></span><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  void sleep_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</code><div class='itemdescr'></div><div class='para' id='thread.this-7'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L807'>#</a></div><div id='thread.this-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> Blocks the calling thread for the relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified
by <span class='texttt'>rel_&shy;time</span><a class='hidden_link' href='#thread.this-7.sentence-1'>.</a></div></div></div><div class='para' id='thread.this-8'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L811'>#</a></div><div id='thread.this-8.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> None<a class='hidden_link' href='#thread.this-8.sentence-1'>.</a></div></div></div><div class='para' id='thread.this-9'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L814'>#</a></div><div id='thread.this-9.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#thread.this-9.sentence-1'>.</a></div></div></div></div></div><div id='mutex' class='section'><h2 ><a class='secnum' href='#mutex' style='min-width:88pt'>33.4</a> Mutual exclusion <a class='abbr_ref' href='thread.mutex'>[thread.mutex]</a></h2><div class='para' id='mutex-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L820'>#</a></div><div id='mutex-1.sentence-1' class='sentence'>This section provides mechanisms for mutual exclusion: mutexes, locks, and call
once<a class='hidden_link' href='#mutex-1.sentence-1'>.</a></div> <div id='mutex-1.sentence-2' class='sentence'>These mechanisms ease the production of race-free
programs (<a href='intro.multithread'>[intro.multithread]</a>)<a class='hidden_link' href='#mutex-1.sentence-2'>.</a></div></div><div id='mutex.syn' class='section'><h3 ><a class='secnum' href='#mutex.syn' style='min-width:103pt'>33.4.1</a> Header <span class='texttt'>&lt;mutex&gt;</span> synopsis <a class='abbr_ref' href='mutex.syn'>[mutex.syn]</a></h3><div id='mutex.syn-sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':<mutex>'></a></span><span class='indexparent'><a class='index' id='lib:<mutex>'></a></span>
<pre class='codeblock'>
namespace std {
  class mutex;
  class recursive_mutex;
  class timed_mutex;
  class recursive_timed_mutex;

  struct defer_lock_t { explicit defer_lock_t() = default; };
  struct try_to_lock_t { explicit try_to_lock_t() = default; };
  struct adopt_lock_t { explicit adopt_lock_t() = default; };

  inline constexpr defer_lock_t  defer_lock { };
  inline constexpr try_to_lock_t try_to_lock { };
  inline constexpr adopt_lock_t  adopt_lock { };

  template &lt;class Mutex&gt; class lock_guard;
  template &lt;class... MutexTypes&gt; class scoped_lock;
  template &lt;class Mutex&gt; class unique_lock;

  template &lt;class Mutex&gt;
    void swap(unique_lock&lt;Mutex&gt;&amp; x, unique_lock&lt;Mutex&gt;&amp; y) noexcept;

  template &lt;class L1, class L2, class... L3&gt; int try_lock(L1&amp;, L2&amp;, L3&amp;...);
  template &lt;class L1, class L2, class... L3&gt; void lock(L1&amp;, L2&amp;, L3&amp;...);

  struct once_flag;

  template&lt;class Callable, class... Args&gt;
    void call_once(once_flag&amp; flag, Callable&amp;&amp; func, Args&amp;&amp;... args);
}</pre></div></div><div id='shared_mutex.syn' class='section'><h3 ><a class='secnum' href='#shared_mutex.syn' style='min-width:103pt'>33.4.2</a> Header <span class='texttt'>&lt;shared_&shy;mutex&gt;</span> synopsis <a class='abbr_ref' href='shared_mutex.syn'>[shared_mutex.syn]</a></h3><div id='shared_mutex.syn-sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':<shared_mutex>'></a></span><span class='indexparent'><a class='index' id='lib:<shared_mutex>'></a></span>
<pre class='codeblock'>
namespace std {
  class shared_mutex;
  class shared_timed_mutex;
  template &lt;class Mutex&gt; class shared_lock;
  template &lt;class Mutex&gt;
    void swap(shared_lock&lt;Mutex&gt;&amp; x, shared_lock&lt;Mutex&gt;&amp; y) noexcept;
}</pre></div></div><div id='mutex.requirements' class='section'><h3 ><a class='secnum' href='#mutex.requirements' style='min-width:103pt'>33.4.3</a> Mutex requirements <a class='abbr_ref' href='thread.mutex.requirements'>[thread.mutex.requirements]</a></h3><div id='mutex.requirements.general' class='section'><h4 ><a class='secnum' href='#mutex.requirements.general' style='min-width:118pt'>33.4.3.1</a> In general <a class='abbr_ref' href='thread.mutex.requirements.general'>[thread.mutex.requirements.general]</a></h4><div class='para' id='mutex.requirements.general-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L879'>#</a></div><div id='mutex.requirements.general-1.sentence-1' class='sentence'>A mutex object facilitates protection against data races and allows safe synchronization of
data between <a href='thread.req.lockable#def:execution_agent'>execution agents</a><a class='hidden_link' href='#mutex.requirements.general-1.sentence-1'>.</a></div> <div id='mutex.requirements.general-1.sentence-2' class='sentence'>An execution agent <a class='hidden_link' href='#def:owns' id='def:owns'><i>owns</i></a> a mutex from the time it successfully calls one of the
lock functions until it calls unlock<a class='hidden_link' href='#mutex.requirements.general-1.sentence-2'>.</a></div> <div id='mutex.requirements.general-1.sentence-3' class='sentence'>Mutexes can be either recursive or non-recursive, and can
grant simultaneous ownership to one or many execution agents<a class='hidden_link' href='#mutex.requirements.general-1.sentence-3'>.</a></div> <div id='mutex.requirements.general-1.sentence-4' class='sentence'>Both
recursive and non-recursive mutexes are supplied<a class='hidden_link' href='#mutex.requirements.general-1.sentence-4'>.</a></div></div></div><div id='mutex.requirements.mutex' class='section'><h4 ><a class='secnum' href='#mutex.requirements.mutex' style='min-width:118pt'>33.4.3.2</a> Mutex types <a class='abbr_ref' href='thread.mutex.requirements.mutex'>[thread.mutex.requirements.mutex]</a></h4><div class='para' id='mutex.requirements.mutex-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L889'>#</a></div><div id='mutex.requirements.mutex-1.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:mutex_types' id='def:mutex_types'><i >mutex types</i></a> are the standard library types <span class='texttt'>mutex</span>,
<span class='texttt'>recursive_&shy;mutex</span>, <span class='texttt'>timed_&shy;mutex</span>, <span class='texttt'>recursive_&shy;timed_&shy;mutex</span>,
<span class='texttt'>shared_&shy;mutex</span>, and <span class='texttt'>shared_&shy;timed_&shy;mutex</span><a class='hidden_link' href='#mutex.requirements.mutex-1.sentence-1'>.</a></div> <div id='mutex.requirements.mutex-1.sentence-2' class='sentence'>They shall meet the requirements set out in this section<a class='hidden_link' href='#mutex.requirements.mutex-1.sentence-2'>.</a></div> <div id='mutex.requirements.mutex-1.sentence-3' class='sentence'>In this description, <span class='texttt'>m</span>
denotes an object of a mutex type<a class='hidden_link' href='#mutex.requirements.mutex-1.sentence-3'>.</a></div></div><div class='para' id='mutex.requirements.mutex-2'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L896'>#</a></div><div id='mutex.requirements.mutex-2.sentence-1' class='sentence'>The mutex types shall meet the <a href='thread.req.lockable.req'><span class='texttt'>Lockable</span></a> requirements<a class='hidden_link' href='#mutex.requirements.mutex-2.sentence-1'>.</a></div></div><div class='para' id='mutex.requirements.mutex-3'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L899'>#</a></div><div id='mutex.requirements.mutex-3.sentence-1' class='sentence'>The mutex types shall be <span class='texttt'>DefaultConstructible</span> and <span class='texttt'>Destructible</span><a class='hidden_link' href='#mutex.requirements.mutex-3.sentence-1'>.</a></div> <div id='mutex.requirements.mutex-3.sentence-2' class='sentence'>If
initialization of an object of a mutex type fails, an exception of type
<span class='texttt'>system_&shy;error</span> shall be thrown<a class='hidden_link' href='#mutex.requirements.mutex-3.sentence-2'>.</a></div> <div id='mutex.requirements.mutex-3.sentence-3' class='sentence'>The mutex types shall not be copyable or movable<a class='hidden_link' href='#mutex.requirements.mutex-3.sentence-3'>.</a></div></div><div class='para' id='mutex.requirements.mutex-4'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L904'>#</a></div><div id='mutex.requirements.mutex-4.sentence-1' class='sentence'>The error conditions for error codes, if any, reported by member functions of the mutex types
shall be:
<ul class='itemize'><li id='mutex.requirements.mutex-4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#mutex.requirements.mutex-4.1'>(4.1)</a></div><div id='mutex.requirements.mutex-4.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if any native handle type manipulated is not available<a class='hidden_link' href='#mutex.requirements.mutex-4.1.sentence-1'>.</a></div></li><li id='mutex.requirements.mutex-4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#mutex.requirements.mutex-4.2'>(4.2)</a></div><div id='mutex.requirements.mutex-4.2.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if the thread does not have the
privilege to perform the operation<a class='hidden_link' href='#mutex.requirements.mutex-4.2.sentence-1'>.</a></div></li><li id='mutex.requirements.mutex-4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#mutex.requirements.mutex-4.3'>(4.3)</a></div><div id='mutex.requirements.mutex-4.3.sentence-1' class='sentence'><span class='texttt'>invalid_&shy;argument</span> — if any native handle type manipulated as part of mutex
construction is incorrect<a class='hidden_link' href='#mutex.requirements.mutex-4.3.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='mutex.requirements.mutex-5'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L915'>#</a></div><div id='mutex.requirements.mutex-5.sentence-1' class='sentence'>The implementation shall provide lock and unlock operations, as described below<a class='hidden_link' href='#mutex.requirements.mutex-5.sentence-1'>.</a></div> <div id='mutex.requirements.mutex-5.sentence-2' class='sentence'>For purposes of determining the existence of a data race, these behave as
atomic operations (<a href='intro.multithread'>[intro.multithread]</a>)<a class='hidden_link' href='#mutex.requirements.mutex-5.sentence-2'>.</a></div> <div id='mutex.requirements.mutex-5.sentence-3' class='sentence'>The lock and unlock operations on
a single mutex shall appear to occur in a single total order<a class='hidden_link' href='#mutex.requirements.mutex-5.sentence-3'>.</a></div> <div id='mutex.requirements.mutex-5.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#mutex.requirements.mutex-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='mutex.requirements.mutex-5.sentence-4' class='sentence'>This
can be viewed as the <a href='intro.multithread#def:modification_order'>modification order</a> of the
mutex<a class='hidden_link' href='#mutex.requirements.mutex-5.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='mutex.requirements.mutex-5.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#mutex.requirements.mutex-5.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='mutex.requirements.mutex-5.sentence-5' class='sentence'>Construction and
destruction of an object of a mutex type need not be thread-safe; other
synchronization should be used to ensure that mutex objects are initialized
and visible to other threads<a class='hidden_link' href='#mutex.requirements.mutex-5.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='mutex.requirements.mutex-6'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L927'>#</a></div><div id='mutex.requirements.mutex-6.sentence-1' class='sentence'>The expression <span class='texttt'>m.lock()</span> shall be well-formed and have the following semantics:</div></div><div class='itemdescr'></div><div class='para' id='mutex.requirements.mutex-7'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L931'>#</a></div><div id='mutex.requirements.mutex-7.sentence-1' class='sentence'><span class='textit'>Requires:</span> If <span class='texttt'>m</span> is of type <span class='texttt'>mutex</span>, <span class='texttt'>timed_&shy;mutex</span>,
<span class='texttt'>shared_&shy;mutex</span>, or <span class='texttt'>shared_&shy;timed_&shy;mutex</span>, the calling
thread does not own the mutex<a class='hidden_link' href='#mutex.requirements.mutex-7.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-8'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L936'>#</a></div><div id='mutex.requirements.mutex-8.sentence-1' class='sentence'><span class='textit'>Effects:</span> Blocks the calling thread until ownership of the mutex can be obtained for the calling thread<a class='hidden_link' href='#mutex.requirements.mutex-8.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-9'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L939'>#</a></div><div id='mutex.requirements.mutex-9.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> The calling thread owns the mutex<a class='hidden_link' href='#mutex.requirements.mutex-9.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-10'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L942'>#</a></div><div id='mutex.requirements.mutex-10.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>void</span><a class='hidden_link' href='#mutex.requirements.mutex-10.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-11'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L945'>#</a></div><div id='mutex.requirements.mutex-11.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> Prior <span class='texttt'>unlock()</span> operations on the same object shall
<a href='intro.multithread#def:synchronize_with'>synchronize with</a> this operation<a class='hidden_link' href='#mutex.requirements.mutex-11.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-12'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L949'>#</a></div><div id='mutex.requirements.mutex-12.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#mutex.requirements.mutex-12.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-13'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L953'>#</a></div><div id='mutex.requirements.mutex-13.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='mutex.requirements.mutex-13.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#mutex.requirements.mutex-13.1'>(13.1)</a></div><div id='mutex.requirements.mutex-13.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if the thread does not have the
privilege to perform the operation<a class='hidden_link' href='#mutex.requirements.mutex-13.1.sentence-1'>.</a></div></li><li id='mutex.requirements.mutex-13.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#mutex.requirements.mutex-13.2'>(13.2)</a></div><div id='mutex.requirements.mutex-13.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if the implementation detects
that a deadlock would occur<a class='hidden_link' href='#mutex.requirements.mutex-13.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='mutex.requirements.mutex-14'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L963'>#</a></div><div id='mutex.requirements.mutex-14.sentence-1' class='sentence'>The expression <span class='texttt'>m.try_&shy;lock()</span> shall be well-formed and have the following semantics:</div></div><div class='itemdescr'></div><div class='para' id='mutex.requirements.mutex-15'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L967'>#</a></div><div id='mutex.requirements.mutex-15.sentence-1' class='sentence'><span class='textit'>Requires:</span> If <span class='texttt'>m</span> is of type <span class='texttt'>mutex</span>, <span class='texttt'>timed_&shy;mutex</span>,
<span class='texttt'>shared_&shy;mutex</span>, or <span class='texttt'>shared_&shy;timed_&shy;mutex</span>, the calling
thread does not own the mutex<a class='hidden_link' href='#mutex.requirements.mutex-15.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-16'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L972'>#</a></div><div id='mutex.requirements.mutex-16.sentence-1' class='sentence'><span class='textit'>Effects:</span> Attempts to obtain ownership of the mutex for the calling thread without
blocking<a class='hidden_link' href='#mutex.requirements.mutex-16.sentence-1'>.</a></div> <div id='mutex.requirements.mutex-16.sentence-2' class='sentence'>If ownership is not obtained, there is no effect and <span class='texttt'>try_&shy;lock()</span>
immediately returns<a class='hidden_link' href='#mutex.requirements.mutex-16.sentence-2'>.</a></div> <div id='mutex.requirements.mutex-16.sentence-3' class='sentence'>An implementation may fail to obtain the lock even if it is not
held by any other thread<a class='hidden_link' href='#mutex.requirements.mutex-16.sentence-3'>.</a></div> <div id='mutex.requirements.mutex-16.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#mutex.requirements.mutex-16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='mutex.requirements.mutex-16.sentence-5' class='sentence'>This spurious failure is normally uncommon, but
allows interesting implementations based on a simple
compare and exchange (<a href='atomics'>[atomics]</a>)<a class='hidden_link' href='#mutex.requirements.mutex-16.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='mutex.requirements.mutex-16.sentence-4' class='sentence'>
An implementation should ensure that <span class='texttt'>try_&shy;lock()</span> does not consistently return <span class='texttt'>false</span>
in the absence of contending mutex acquisitions<a class='hidden_link' href='#mutex.requirements.mutex-16.sentence-4'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-17'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L983'>#</a></div><div id='mutex.requirements.mutex-17.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#mutex.requirements.mutex-17.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-18'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L986'>#</a></div><div id='mutex.requirements.mutex-18.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if ownership of the mutex was obtained for the calling
thread, otherwise <span class='texttt'>false</span><a class='hidden_link' href='#mutex.requirements.mutex-18.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-19'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L990'>#</a></div><div id='mutex.requirements.mutex-19.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> If <span class='texttt'>try_&shy;lock()</span> returns <span class='texttt'>true</span>, prior <span class='texttt'>unlock()</span> operations
on the same object <a href='intro.multithread#def:synchronize_with'>synchronize with</a> this operation<a class='hidden_link' href='#mutex.requirements.mutex-19.sentence-1'>.</a></div> <div id='mutex.requirements.mutex-19.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#mutex.requirements.mutex-19.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='mutex.requirements.mutex-19.sentence-2' class='sentence'>Since <span class='texttt'>lock()</span> does not synchronize with a failed subsequent
<span class='texttt'>try_&shy;lock()</span>, the visibility rules are weak enough that little would be
known about the state after a failure, even in the absence of spurious failures<a class='hidden_link' href='#mutex.requirements.mutex-19.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='mutex.requirements.mutex-20'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L997'>#</a></div><div id='mutex.requirements.mutex-20.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#mutex.requirements.mutex-20.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-21'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-21'>21</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1001'>#</a></div><div id='mutex.requirements.mutex-21.sentence-1' class='sentence'>The expression <span class='texttt'>m.unlock()</span> shall be well-formed and have the following semantics:</div></div><div class='itemdescr'></div><div class='para' id='mutex.requirements.mutex-22'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1005'>#</a></div><div id='mutex.requirements.mutex-22.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread shall own the mutex<a class='hidden_link' href='#mutex.requirements.mutex-22.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-23'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1008'>#</a></div><div id='mutex.requirements.mutex-23.sentence-1' class='sentence'><span class='textit'>Effects:</span> Releases the calling thread's ownership of the mutex<a class='hidden_link' href='#mutex.requirements.mutex-23.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-24'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1011'>#</a></div><div id='mutex.requirements.mutex-24.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>void</span><a class='hidden_link' href='#mutex.requirements.mutex-24.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-25'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1014'>#</a></div><div id='mutex.requirements.mutex-25.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> This operation <a href='intro.multithread#def:synchronize_with'>synchronizes with</a> subsequent
lock operations that obtain ownership on the same object<a class='hidden_link' href='#mutex.requirements.mutex-25.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex-26'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1018'>#</a></div><div id='mutex.requirements.mutex-26.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#mutex.requirements.mutex-26.sentence-1'>.</a></div></div></div><div id='mutex.class' class='section'><h4 ><a class='secnum' href='#mutex.class' style='min-width:133pt'>33.4.3.2.1</a> Class <span class='texttt'>mutex</span> <a class='abbr_ref' href='thread.mutex.class'>[thread.mutex.class]</a></h4><span class='indexparent'><a class='index' id='lib:mutex'></a></span><pre class='codeblock'>
namespace std {
  class mutex {
  public:
    constexpr mutex() noexcept;
    ~mutex();

    mutex(const mutex&amp;) = delete;
    mutex&amp; operator=(const mutex&amp;) = delete;

    void lock();
    bool try_lock();
    void unlock();

    using native_handle_type = <span class='textit'>implementation-defined</span>;          <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>    native_handle_type native_handle();                         <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>  };
}</pre><div class='para' id='mutex.class-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1045'>#</a></div><div id='mutex.class-1.sentence-1' class='sentence'>The class <span class='texttt'>mutex</span> provides a non-recursive mutex with exclusive ownership
semantics<a class='hidden_link' href='#mutex.class-1.sentence-1'>.</a></div> <div id='mutex.class-1.sentence-2' class='sentence'>If one thread owns a mutex object, attempts by another thread to acquire
ownership of that object will fail (for <span class='texttt'>try_&shy;lock()</span>) or block (for
<span class='texttt'>lock()</span>) until the owning thread has released ownership with a call to
<span class='texttt'>unlock()</span><a class='hidden_link' href='#mutex.class-1.sentence-2'>.</a></div></div><div class='para' id='mutex.class-2'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1052'>#</a></div><div id='mutex.class-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#mutex.class-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='mutex.class-2.sentence-1' class='sentence'>After a thread <span class='texttt'>A</span> has called <span class='texttt'>unlock()</span>, releasing a mutex, it is possible for another
thread <span class='texttt'>B</span> to lock the same mutex, observe that it is no longer in use, unlock it, and
destroy it, before thread <span class='texttt'>A</span> appears to have returned from its unlock call<a class='hidden_link' href='#mutex.class-2.sentence-1'>.</a></div> <div id='mutex.class-2.sentence-2' class='sentence'>Implementations
are required to handle such scenarios correctly, as long as thread <span class='texttt'>A</span> doesn't access the
mutex after the unlock call returns<a class='hidden_link' href='#mutex.class-2.sentence-2'>.</a></div> <div id='mutex.class-2.sentence-3' class='sentence'>These cases typically occur when a reference-counted object
contains a mutex that is used to protect the reference count<a class='hidden_link' href='#mutex.class-2.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='mutex.class-3'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1062'>#</a></div><div id='mutex.class-3.sentence-1' class='sentence'>The class <span class='texttt'>mutex</span> shall satisfy all of the <a href='thread.mutex.requirements'>mutex
requirements</a><a class='hidden_link' href='#mutex.class-3.sentence-1'>.</a></div> <div id='mutex.class-3.sentence-2' class='sentence'>It shall be a
<a href='class#def:standard-layout_class'>standard-layout class</a><a class='hidden_link' href='#mutex.class-3.sentence-2'>.</a></div></div><div class='para' id='mutex.class-4'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1067'>#</a></div><div id='mutex.class-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#mutex.class-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='mutex.class-4.sentence-1' class='sentence'>A program may deadlock if the thread that owns a <span class='texttt'>mutex</span> object calls
<span class='texttt'>lock()</span> on that object<a class='hidden_link' href='#mutex.class-4.sentence-1'>.</a></div> <div id='mutex.class-4.sentence-2' class='sentence'>If the implementation can detect the deadlock,
a <span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> error condition may be observed<a class='hidden_link' href='#mutex.class-4.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='mutex.class-5'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1072'>#</a></div><div id='mutex.class-5.sentence-1' class='sentence'>The behavior of a program is undefined if
it destroys a <span class='texttt'>mutex</span> object owned by any thread or
a thread terminates while owning a <span class='texttt'>mutex</span> object<a class='hidden_link' href='#mutex.class-5.sentence-1'>.</a></div></div></div><div id='mutex.recursive' class='section'><h4 ><a class='secnum' href='#mutex.recursive' style='min-width:133pt'>33.4.3.2.2</a> Class <span class='texttt'>recursive_&shy;mutex</span> <a class='abbr_ref' href='thread.mutex.recursive'>[thread.mutex.recursive]</a></h4><span class='indexparent'><a class='index' id='lib:recursive_mutex'></a></span><pre class='codeblock'>
namespace std {
  class recursive_mutex {
  public:
    recursive_mutex();
    ~recursive_mutex();

    recursive_mutex(const recursive_mutex&amp;) = delete;
    recursive_mutex&amp; operator=(const recursive_mutex&amp;) = delete;

    void lock();
    bool try_lock() noexcept;
    void unlock();

    using native_handle_type = <span class='textit'>implementation-defined</span>;          <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>    native_handle_type native_handle();                         <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>  };
}</pre><div class='para' id='mutex.recursive-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.recursive-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1100'>#</a></div><div id='mutex.recursive-1.sentence-1' class='sentence'>The class <span class='texttt'>recursive_&shy;mutex</span> provides a recursive mutex with exclusive ownership
semantics<a class='hidden_link' href='#mutex.recursive-1.sentence-1'>.</a></div> <div id='mutex.recursive-1.sentence-2' class='sentence'>If one thread owns a <span class='texttt'>recursive_&shy;mutex</span> object, attempts by another
thread to acquire ownership of that object will fail (for <span class='texttt'>try_&shy;lock()</span>) or block
(for <span class='texttt'>lock()</span>) until the first thread has completely released ownership<a class='hidden_link' href='#mutex.recursive-1.sentence-2'>.</a></div></div><div class='para' id='mutex.recursive-2'><div class='marginalizedparent'><a class='marginalized' href='#mutex.recursive-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1106'>#</a></div><div id='mutex.recursive-2.sentence-1' class='sentence'>The class <span class='texttt'>recursive_&shy;mutex</span> shall satisfy all of the <a href='thread.mutex.requirements'>mutex
requirements</a><a class='hidden_link' href='#mutex.recursive-2.sentence-1'>.</a></div> <div id='mutex.recursive-2.sentence-2' class='sentence'>It shall be a
<a href='class#def:standard-layout_class'>standard-layout class</a><a class='hidden_link' href='#mutex.recursive-2.sentence-2'>.</a></div></div><div class='para' id='mutex.recursive-3'><div class='marginalizedparent'><a class='marginalized' href='#mutex.recursive-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1111'>#</a></div><div id='mutex.recursive-3.sentence-1' class='sentence'>A thread that owns a <span class='texttt'>recursive_&shy;mutex</span> object may acquire additional levels of
ownership by calling <span class='texttt'>lock()</span> or <span class='texttt'>try_&shy;lock()</span> on that object<a class='hidden_link' href='#mutex.recursive-3.sentence-1'>.</a></div> <div id='mutex.recursive-3.sentence-2' class='sentence'>It is
unspecified how many levels of ownership may be acquired by a single thread<a class='hidden_link' href='#mutex.recursive-3.sentence-2'>.</a></div> <div id='mutex.recursive-3.sentence-3' class='sentence'>If a thread
has already acquired the maximum level of ownership for a <span class='texttt'>recursive_&shy;mutex</span>
object, additional calls to <span class='texttt'>try_&shy;lock()</span> shall fail, and additional calls to
<span class='texttt'>lock()</span> shall throw an exception of type <span class='texttt'>system_&shy;error</span><a class='hidden_link' href='#mutex.recursive-3.sentence-3'>.</a></div> <div id='mutex.recursive-3.sentence-4' class='sentence'>A thread
shall call <span class='texttt'>unlock()</span> once for each level of ownership acquired by calls to
<span class='texttt'>lock()</span> and <span class='texttt'>try_&shy;lock()</span><a class='hidden_link' href='#mutex.recursive-3.sentence-4'>.</a></div> <div id='mutex.recursive-3.sentence-5' class='sentence'>Only when all levels of ownership have been
released may ownership be acquired by another thread<a class='hidden_link' href='#mutex.recursive-3.sentence-5'>.</a></div></div><div class='para' id='mutex.recursive-4'><div class='marginalizedparent'><a class='marginalized' href='#mutex.recursive-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1122'>#</a></div><div id='mutex.recursive-4.sentence-1' class='sentence'>The behavior of a program is undefined if:</div><div id='mutex.recursive-4.sentence-2' class='sentence'><ul class='itemize'><li id='mutex.recursive-4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#mutex.recursive-4.1'>(4.1)</a></div><div id='mutex.recursive-4.1.sentence-1' class='sentence'>it destroys a <span class='texttt'>recursive_&shy;mutex</span> object owned by any thread or</div></li><li id='mutex.recursive-4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#mutex.recursive-4.2'>(4.2)</a></div><div id='mutex.recursive-4.2.sentence-1' class='sentence'>a thread terminates while owning a <span class='texttt'>recursive_&shy;mutex</span> object<a class='hidden_link' href='#mutex.recursive-4.2.sentence-1'>.</a></div></li></ul></div></div></div></div><div id='timedmutex.requirements' class='section'><h4 ><a class='secnum' href='#timedmutex.requirements' style='min-width:118pt'>33.4.3.3</a> Timed mutex types <a class='abbr_ref' href='thread.timedmutex.requirements'>[thread.timedmutex.requirements]</a></h4><div class='para' id='timedmutex.requirements-1'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1132'>#</a></div><div id='timedmutex.requirements-1.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:timed_mutex_types' id='def:timed_mutex_types'><i >timed mutex types</i></a> are the standard library types <span class='texttt'>timed_&shy;mutex</span>,
<span class='texttt'>recursive_&shy;timed_&shy;mutex</span>, and <span class='texttt'>shared_&shy;timed_&shy;mutex</span><a class='hidden_link' href='#timedmutex.requirements-1.sentence-1'>.</a></div> <div id='timedmutex.requirements-1.sentence-2' class='sentence'>They shall
meet the requirements set out below<a class='hidden_link' href='#timedmutex.requirements-1.sentence-2'>.</a></div> <div id='timedmutex.requirements-1.sentence-3' class='sentence'>In this description, <span class='texttt'>m</span> denotes an object of a mutex type,
<span class='texttt'>rel_&shy;time</span> denotes an object of an
instantiation of <a href='time.duration'><span class='texttt'>duration</span></a>, and <span class='texttt'>abs_&shy;time</span> denotes an
object of an
instantiation of <a href='time.point'><span class='texttt'>time_&shy;point</span></a><a class='hidden_link' href='#timedmutex.requirements-1.sentence-3'>.</a></div></div><div class='para' id='timedmutex.requirements-2'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1142'>#</a></div><div id='timedmutex.requirements-2.sentence-1' class='sentence'>The timed mutex types shall meet the
<a href='thread.req.lockable.timed'><span class='texttt'>TimedLockable</span></a> requirements<a class='hidden_link' href='#timedmutex.requirements-2.sentence-1'>.</a></div></div><div class='para' id='timedmutex.requirements-3'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1146'>#</a></div><div id='timedmutex.requirements-3.sentence-1' class='sentence'>The expression <span class='texttt'>m.try_&shy;lock_&shy;for(rel_&shy;time)</span> shall be well-formed and have the
following semantics:</div></div><div class='itemdescr'></div><div class='para' id='timedmutex.requirements-4'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1151'>#</a></div><div id='timedmutex.requirements-4.sentence-1' class='sentence'><span class='textit'>Requires:</span> If <span class='texttt'>m</span> is of type <span class='texttt'>timed_&shy;mutex</span> or
<span class='texttt'>shared_&shy;timed_&shy;mutex</span>, the calling thread does not
own the mutex<a class='hidden_link' href='#timedmutex.requirements-4.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-5'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1156'>#</a></div><div id='timedmutex.requirements-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> The function attempts to obtain ownership of the mutex within the
relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>)
specified by <span class='texttt'>rel_&shy;time</span><a class='hidden_link' href='#timedmutex.requirements-5.sentence-1'>.</a></div> <div id='timedmutex.requirements-5.sentence-2' class='sentence'>If the time specified by <span class='texttt'>rel_&shy;time</span> is less than or
equal to <span class='texttt'>rel_&shy;time.zero()</span>, the function attempts to obtain ownership without blocking (as if by calling
<span class='texttt'>try_&shy;lock()</span>)<a class='hidden_link' href='#timedmutex.requirements-5.sentence-2'>.</a></div> <div id='timedmutex.requirements-5.sentence-3' class='sentence'>The function shall return within the timeout specified by
<span class='texttt'>rel_&shy;time</span> only if it has obtained ownership of the mutex object<a class='hidden_link' href='#timedmutex.requirements-5.sentence-3'>.</a></div> <div id='timedmutex.requirements-5.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#timedmutex.requirements-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='timedmutex.requirements-5.sentence-4' class='sentence'>As
with <span class='texttt'>try_&shy;lock()</span>, there is no guarantee that ownership will be obtained if the
lock is available, but implementations are expected to make a strong effort to do so<a class='hidden_link' href='#timedmutex.requirements-5.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='timedmutex.requirements-6'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1167'>#</a></div><div id='timedmutex.requirements-6.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#timedmutex.requirements-6.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-7'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1170'>#</a></div><div id='timedmutex.requirements-7.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if ownership was obtained, otherwise <span class='texttt'>false</span><a class='hidden_link' href='#timedmutex.requirements-7.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-8'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1173'>#</a></div><div id='timedmutex.requirements-8.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> If <span class='texttt'>try_&shy;lock_&shy;for()</span> returns <span class='texttt'>true</span>, prior <span class='texttt'>unlock()</span> operations
on the same object <a href='intro.multithread#def:synchronize_with'>synchronize with</a> this operation<a class='hidden_link' href='#timedmutex.requirements-8.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-9'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1177'>#</a></div><div id='timedmutex.requirements-9.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#timedmutex.requirements-9.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-10'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1180'>#</a></div><div id='timedmutex.requirements-10.sentence-1' class='sentence'>The expression <span class='texttt'>m.try_&shy;lock_&shy;until(abs_&shy;time)</span> shall be well-formed and have the
following semantics:</div></div><div class='itemdescr'></div><div class='para' id='timedmutex.requirements-11'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1185'>#</a></div><div id='timedmutex.requirements-11.sentence-1' class='sentence'><span class='textit'>Requires:</span> If <span class='texttt'>m</span> is of type <span class='texttt'>timed_&shy;mutex</span> or
<span class='texttt'>shared_&shy;timed_&shy;mutex</span>, the calling thread does not own the
mutex<a class='hidden_link' href='#timedmutex.requirements-11.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-12'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1190'>#</a></div><div id='timedmutex.requirements-12.sentence-1' class='sentence'><span class='textit'>Effects:</span> The function attempts to obtain ownership of the mutex<a class='hidden_link' href='#timedmutex.requirements-12.sentence-1'>.</a></div> <div id='timedmutex.requirements-12.sentence-2' class='sentence'>If
<span class='texttt'>abs_&shy;time</span> has already passed, the function attempts to obtain ownership
without blocking (as if by calling <span class='texttt'>try_&shy;lock()</span>)<a class='hidden_link' href='#timedmutex.requirements-12.sentence-2'>.</a></div> <div id='timedmutex.requirements-12.sentence-3' class='sentence'>The function shall
return before the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by
<span class='texttt'>abs_&shy;time</span> only if it has obtained ownership of the mutex object<a class='hidden_link' href='#timedmutex.requirements-12.sentence-3'>.</a></div> <div id='timedmutex.requirements-12.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#timedmutex.requirements-12.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='timedmutex.requirements-12.sentence-4' class='sentence'>As with <span class='texttt'>try_&shy;lock()</span>, there is no guarantee that ownership will
be obtained if the lock is available, but implementations are expected to make a
strong effort to do so<a class='hidden_link' href='#timedmutex.requirements-12.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='timedmutex.requirements-13'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1200'>#</a></div><div id='timedmutex.requirements-13.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#timedmutex.requirements-13.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-14'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1202'>#</a></div><div id='timedmutex.requirements-14.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if ownership was obtained, otherwise <span class='texttt'>false</span><a class='hidden_link' href='#timedmutex.requirements-14.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-15'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1205'>#</a></div><div id='timedmutex.requirements-15.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> If <span class='texttt'>try_&shy;lock_&shy;until()</span> returns <span class='texttt'>true</span>, prior <span class='texttt'>unlock()</span>
operations on the same object <a href='intro.multithread#def:synchronize_with'>synchronize with</a>
this operation<a class='hidden_link' href='#timedmutex.requirements-15.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements-16'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1210'>#</a></div><div id='timedmutex.requirements-16.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#timedmutex.requirements-16.sentence-1'>.</a></div></div></div><div id='timedmutex.class' class='section'><h4 ><a class='secnum' href='#timedmutex.class' style='min-width:133pt'>33.4.3.3.1</a> Class <span class='texttt'>timed_&shy;mutex</span> <a class='abbr_ref' href='thread.timedmutex.class'>[thread.timedmutex.class]</a></h4><span class='indexparent'><a class='index' id='lib:timed_mutex'></a></span><pre class='codeblock'>
namespace std {
  class timed_mutex {
  public:
    timed_mutex();
    ~timed_mutex();

    timed_mutex(const timed_mutex&amp;) = delete;
    timed_mutex&amp; operator=(const timed_mutex&amp;) = delete;

    void lock();    <span class='comment'>// blocking
</span>    bool try_lock();
    template &lt;class Rep, class Period&gt;
      bool try_lock_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Clock, class Duration&gt;
      bool try_lock_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    void unlock();

    using native_handle_type = <span class='textit'>implementation-defined</span>;          <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>    native_handle_type native_handle();                         <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>  };
}</pre><div class='para' id='timedmutex.class-1'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1240'>#</a></div><div id='timedmutex.class-1.sentence-1' class='sentence'>The class <span class='texttt'>timed_&shy;mutex</span> provides a non-recursive mutex with exclusive ownership
semantics<a class='hidden_link' href='#timedmutex.class-1.sentence-1'>.</a></div> <div id='timedmutex.class-1.sentence-2' class='sentence'>If one thread owns a <span class='texttt'>timed_&shy;mutex</span> object, attempts by another thread
to acquire ownership of that object will fail (for <span class='texttt'>try_&shy;lock()</span>) or block
(for <span class='texttt'>lock()</span>, <span class='texttt'>try_&shy;lock_&shy;for()</span>, and <span class='texttt'>try_&shy;lock_&shy;until()</span>) until
the owning thread has released ownership with a call to <span class='texttt'>unlock()</span> or the
call to <span class='texttt'>try_&shy;lock_&shy;for()</span> or <span class='texttt'>try_&shy;lock_&shy;until()</span> times out (having
failed to obtain ownership)<a class='hidden_link' href='#timedmutex.class-1.sentence-2'>.</a></div></div><div class='para' id='timedmutex.class-2'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1249'>#</a></div><div id='timedmutex.class-2.sentence-1' class='sentence'>The class <span class='texttt'>timed_&shy;mutex</span> shall satisfy all of the <a href='thread.timedmutex.requirements'>timed mutex
requirements</a><a class='hidden_link' href='#timedmutex.class-2.sentence-1'>.</a></div> <div id='timedmutex.class-2.sentence-2' class='sentence'>It shall be a
<a href='class#def:standard-layout_class'>standard-layout class</a><a class='hidden_link' href='#timedmutex.class-2.sentence-2'>.</a></div></div><div class='para' id='timedmutex.class-3'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1254'>#</a></div><div id='timedmutex.class-3.sentence-1' class='sentence'>The behavior of a program is undefined if:</div><div id='timedmutex.class-3.sentence-2' class='sentence'><ul class='itemize'><li id='timedmutex.class-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#timedmutex.class-3.1'>(3.1)</a></div><div id='timedmutex.class-3.1.sentence-1' class='sentence'>it destroys a <span class='texttt'>timed_&shy;mutex</span> object owned by any thread,</div></li><li id='timedmutex.class-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#timedmutex.class-3.2'>(3.2)</a></div><div id='timedmutex.class-3.2.sentence-1' class='sentence'>a thread that owns a <span class='texttt'>timed_&shy;mutex</span> object calls <span class='texttt'>lock()</span>,
<span class='texttt'>try_&shy;lock()</span>, <span class='texttt'>try_&shy;lock_&shy;for()</span>, or <span class='texttt'>try_&shy;lock_&shy;until()</span> on that object, or</div></li><li id='timedmutex.class-3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#timedmutex.class-3.3'>(3.3)</a></div><div id='timedmutex.class-3.3.sentence-1' class='sentence'>a thread terminates while owning a <span class='texttt'>timed_&shy;mutex</span> object<a class='hidden_link' href='#timedmutex.class-3.3.sentence-1'>.</a></div></li></ul></div></div></div><div id='timedmutex.recursive' class='section'><h4 ><a class='secnum' href='#timedmutex.recursive' style='min-width:133pt'>33.4.3.3.2</a> Class <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> <a class='abbr_ref' href='thread.timedmutex.recursive'>[thread.timedmutex.recursive]</a></h4><span class='indexparent'><a class='index' id='lib:recursive_timed_mutex'></a></span><pre class='codeblock'>
namespace std {
  class recursive_timed_mutex {
  public:
    recursive_timed_mutex();
    ~recursive_timed_mutex();

    recursive_timed_mutex(const recursive_timed_mutex&amp;) = delete;
    recursive_timed_mutex&amp; operator=(const recursive_timed_mutex&amp;) = delete;

    void lock();    <span class='comment'>// blocking
</span>    bool try_lock() noexcept;
    template &lt;class Rep, class Period&gt;
      bool try_lock_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Clock, class Duration&gt;
      bool try_lock_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    void unlock();

    using native_handle_type = <span class='textit'>implementation-defined</span>;          <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>    native_handle_type native_handle();                         <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>  };
}</pre><div class='para' id='timedmutex.recursive-1'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.recursive-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1291'>#</a></div><div id='timedmutex.recursive-1.sentence-1' class='sentence'>The class <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> provides a recursive mutex with exclusive
ownership semantics<a class='hidden_link' href='#timedmutex.recursive-1.sentence-1'>.</a></div> <div id='timedmutex.recursive-1.sentence-2' class='sentence'>If one thread owns a <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object,
attempts by another thread to acquire ownership of that object will fail (for
<span class='texttt'>try_&shy;lock()</span>) or block (for <span class='texttt'>lock()</span>, <span class='texttt'>try_&shy;lock_&shy;for()</span>, and
<span class='texttt'>try_&shy;lock_&shy;until()</span>) until the owning thread has completely released
ownership or the call to <span class='texttt'>try_&shy;lock_&shy;for()</span> or <span class='texttt'>try_&shy;lock_&shy;until()</span>
times out (having failed to obtain ownership)<a class='hidden_link' href='#timedmutex.recursive-1.sentence-2'>.</a></div></div><div class='para' id='timedmutex.recursive-2'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.recursive-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1300'>#</a></div><div id='timedmutex.recursive-2.sentence-1' class='sentence'>The class <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> shall satisfy all of the <a href='thread.timedmutex.requirements'>timed mutex
requirements</a><a class='hidden_link' href='#timedmutex.recursive-2.sentence-1'>.</a></div> <div id='timedmutex.recursive-2.sentence-2' class='sentence'>It shall be a standard-layout
class (<a href='class'>[class]</a>)<a class='hidden_link' href='#timedmutex.recursive-2.sentence-2'>.</a></div></div><div class='para' id='timedmutex.recursive-3'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.recursive-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1305'>#</a></div><div id='timedmutex.recursive-3.sentence-1' class='sentence'>A thread that owns a <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object may acquire additional
levels of ownership by calling <span class='texttt'>lock()</span>, <span class='texttt'>try_&shy;lock()</span>,
<span class='texttt'>try_&shy;lock_&shy;for()</span>, or <span class='texttt'>try_&shy;lock_&shy;until()</span> on that object<a class='hidden_link' href='#timedmutex.recursive-3.sentence-1'>.</a></div> <div id='timedmutex.recursive-3.sentence-2' class='sentence'>It is
unspecified how many levels of ownership may be acquired by a single thread<a class='hidden_link' href='#timedmutex.recursive-3.sentence-2'>.</a></div> <div id='timedmutex.recursive-3.sentence-3' class='sentence'>If
a thread has already acquired the maximum level of ownership for a
<span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object, additional calls to <span class='texttt'>try_&shy;lock()</span>,
<span class='texttt'>try_&shy;lock_&shy;for()</span>, or <span class='texttt'>try_&shy;lock_&shy;until()</span> shall fail, and additional
calls to <span class='texttt'>lock()</span> shall throw an exception of type <span class='texttt'>system_&shy;error</span><a class='hidden_link' href='#timedmutex.recursive-3.sentence-3'>.</a></div> <div id='timedmutex.recursive-3.sentence-4' class='sentence'>A
thread shall call <span class='texttt'>unlock()</span> once for each level of ownership acquired by
calls to <span class='texttt'>lock()</span>, <span class='texttt'>try_&shy;lock()</span>, <span class='texttt'>try_&shy;lock_&shy;for()</span>, and
<span class='texttt'>try_&shy;lock_&shy;until()</span><a class='hidden_link' href='#timedmutex.recursive-3.sentence-4'>.</a></div> <div id='timedmutex.recursive-3.sentence-5' class='sentence'>Only when all levels of ownership have been released
may ownership of the object be acquired by another thread<a class='hidden_link' href='#timedmutex.recursive-3.sentence-5'>.</a></div></div><div class='para' id='timedmutex.recursive-4'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.recursive-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1319'>#</a></div><div id='timedmutex.recursive-4.sentence-1' class='sentence'>The behavior of a program is undefined if:</div><div id='timedmutex.recursive-4.sentence-2' class='sentence'><ul class='itemize'><li id='timedmutex.recursive-4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#timedmutex.recursive-4.1'>(4.1)</a></div><div id='timedmutex.recursive-4.1.sentence-1' class='sentence'>it destroys a <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object owned by any thread, or</div></li><li id='timedmutex.recursive-4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#timedmutex.recursive-4.2'>(4.2)</a></div><div id='timedmutex.recursive-4.2.sentence-1' class='sentence'>a thread terminates while owning a <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object<a class='hidden_link' href='#timedmutex.recursive-4.2.sentence-1'>.</a></div></li></ul></div></div></div></div><div id='sharedmutex.requirements' class='section'><h4 ><a class='secnum' href='#sharedmutex.requirements' style='min-width:118pt'>33.4.3.4</a> Shared mutex types <a class='abbr_ref' href='thread.sharedmutex.requirements'>[thread.sharedmutex.requirements]</a></h4><div class='para' id='sharedmutex.requirements-1'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1330'>#</a></div><div id='sharedmutex.requirements-1.sentence-1' class='sentence'>The standard library types <span class='texttt'>shared_&shy;mutex</span> and <span class='texttt'>shared_&shy;timed_&shy;mutex</span>
are <a class='hidden_link' href='#def:shared_mutex_types' id='def:shared_mutex_types'><i >shared mutex types</i></a><a class='hidden_link' href='#sharedmutex.requirements-1.sentence-1'>.</a></div> <div id='sharedmutex.requirements-1.sentence-2' class='sentence'>Shared mutex types shall meet the <a href='thread.mutex.requirements.mutex'>requirements of
mutex types</a>, and additionally
shall meet the requirements set out below<a class='hidden_link' href='#sharedmutex.requirements-1.sentence-2'>.</a></div> <div id='sharedmutex.requirements-1.sentence-3' class='sentence'>In this description,
<span class='texttt'>m</span> denotes an object of a shared mutex type<a class='hidden_link' href='#sharedmutex.requirements-1.sentence-3'>.</a></div></div><div class='para' id='sharedmutex.requirements-2'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1337'>#</a></div><div id='sharedmutex.requirements-2.sentence-1' class='sentence'>In addition to the exclusive lock ownership mode specified
in <a href='thread.mutex.requirements.mutex'>[thread.mutex.requirements.mutex]</a>, shared mutex types provide a
<a class='hidden_link' href='#def:shared_lock' id='def:shared_lock'><i >shared lock</i></a> ownership mode<a class='hidden_link' href='#sharedmutex.requirements-2.sentence-1'>.</a></div> <div id='sharedmutex.requirements-2.sentence-2' class='sentence'>Multiple execution agents can
simultaneously hold a shared lock ownership of a shared mutex type<a class='hidden_link' href='#sharedmutex.requirements-2.sentence-2'>.</a></div> <div id='sharedmutex.requirements-2.sentence-3' class='sentence'>But no
execution agent shall hold a shared lock while another execution agent holds an
exclusive lock on the same shared mutex type, and vice-versa<a class='hidden_link' href='#sharedmutex.requirements-2.sentence-3'>.</a></div> <div id='sharedmutex.requirements-2.sentence-4' class='sentence'>The maximum
number of execution agents which can share a shared lock on a single shared
mutex type is unspecified, but shall be at least 10000<a class='hidden_link' href='#sharedmutex.requirements-2.sentence-4'>.</a></div> <div id='sharedmutex.requirements-2.sentence-5' class='sentence'>If more than the
maximum number of execution agents attempt to obtain a shared lock, the
excess execution agents shall block until the number of shared locks are
reduced below the maximum amount by other execution agents releasing their
shared lock<a class='hidden_link' href='#sharedmutex.requirements-2.sentence-5'>.</a></div></div><div class='para' id='sharedmutex.requirements-3'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1351'>#</a></div><div id='sharedmutex.requirements-3.sentence-1' class='sentence'>The expression <span class='texttt'>m.lock_&shy;shared()</span> shall be well-formed and have the
following semantics:</div></div><div class='itemdescr'></div><div class='para' id='sharedmutex.requirements-4'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1356'>#</a></div><div id='sharedmutex.requirements-4.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread has no ownership of the mutex<a class='hidden_link' href='#sharedmutex.requirements-4.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-5'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1359'>#</a></div><div id='sharedmutex.requirements-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> Blocks the calling thread until shared ownership of the mutex can be obtained for the calling thread<a class='hidden_link' href='#sharedmutex.requirements-5.sentence-1'>.</a></div> <div id='sharedmutex.requirements-5.sentence-2' class='sentence'>If an exception is thrown then a shared lock shall not have been acquired for the current thread<a class='hidden_link' href='#sharedmutex.requirements-5.sentence-2'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-6'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1363'>#</a></div><div id='sharedmutex.requirements-6.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> The calling thread has a shared lock on the mutex<a class='hidden_link' href='#sharedmutex.requirements-6.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-7'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1366'>#</a></div><div id='sharedmutex.requirements-7.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>void</span><a class='hidden_link' href='#sharedmutex.requirements-7.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-8'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1369'>#</a></div><div id='sharedmutex.requirements-8.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> Prior <span class='texttt'>unlock()</span> operations on the same object shall <a href='intro.multithread#def:synchronize_with'>synchronize with</a> this operation<a class='hidden_link' href='#sharedmutex.requirements-8.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-9'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1372'>#</a></div><div id='sharedmutex.requirements-9.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#sharedmutex.requirements-9.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-10'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1375'>#</a></div><div id='sharedmutex.requirements-10.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='sharedmutex.requirements-10.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#sharedmutex.requirements-10.1'>(10.1)</a></div><div id='sharedmutex.requirements-10.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if the thread does not have the privilege to perform the operation<a class='hidden_link' href='#sharedmutex.requirements-10.1.sentence-1'>.</a></div></li><li id='sharedmutex.requirements-10.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#sharedmutex.requirements-10.2'>(10.2)</a></div><div id='sharedmutex.requirements-10.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if the implementation detects that a deadlock would occur<a class='hidden_link' href='#sharedmutex.requirements-10.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='sharedmutex.requirements-11'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1383'>#</a></div><div id='sharedmutex.requirements-11.sentence-1' class='sentence'>The expression <span class='texttt'>m.unlock_&shy;shared()</span> shall be well-formed and have the following semantics:</div></div><div class='itemdescr'></div><div class='para' id='sharedmutex.requirements-12'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1387'>#</a></div><div id='sharedmutex.requirements-12.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread shall hold a shared lock on the mutex<a class='hidden_link' href='#sharedmutex.requirements-12.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-13'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1390'>#</a></div><div id='sharedmutex.requirements-13.sentence-1' class='sentence'><span class='textit'>Effects:</span> Releases a shared lock on the mutex held by the calling thread<a class='hidden_link' href='#sharedmutex.requirements-13.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-14'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1393'>#</a></div><div id='sharedmutex.requirements-14.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>void</span><a class='hidden_link' href='#sharedmutex.requirements-14.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-15'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1396'>#</a></div><div id='sharedmutex.requirements-15.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> This operation <a href='intro.multithread#def:synchronize_with'>synchronizes with</a> subsequent
<span class='texttt'>lock()</span> operations that obtain ownership on the same object<a class='hidden_link' href='#sharedmutex.requirements-15.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-16'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1400'>#</a></div><div id='sharedmutex.requirements-16.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#sharedmutex.requirements-16.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-17'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1404'>#</a></div><div id='sharedmutex.requirements-17.sentence-1' class='sentence'>The expression <span class='texttt'>m.try_&shy;lock_&shy;shared()</span> shall be well-formed and have the following semantics:</div></div><div class='itemdescr'></div><div class='para' id='sharedmutex.requirements-18'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1408'>#</a></div><div id='sharedmutex.requirements-18.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread has no ownership of the mutex<a class='hidden_link' href='#sharedmutex.requirements-18.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-19'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1411'>#</a></div><div id='sharedmutex.requirements-19.sentence-1' class='sentence'><span class='textit'>Effects:</span> Attempts to obtain shared ownership of the mutex for the calling
thread without blocking<a class='hidden_link' href='#sharedmutex.requirements-19.sentence-1'>.</a></div> <div id='sharedmutex.requirements-19.sentence-2' class='sentence'>If shared ownership is not obtained, there is no
effect and <span class='texttt'>try_&shy;lock_&shy;shared()</span> immediately returns<a class='hidden_link' href='#sharedmutex.requirements-19.sentence-2'>.</a></div> <div id='sharedmutex.requirements-19.sentence-3' class='sentence'>An implementation
may fail to obtain the lock even if it is not held by any other thread<a class='hidden_link' href='#sharedmutex.requirements-19.sentence-3'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-20'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1417'>#</a></div><div id='sharedmutex.requirements-20.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#sharedmutex.requirements-20.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-21'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1420'>#</a></div><div id='sharedmutex.requirements-21.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if the shared ownership lock was acquired, <span class='texttt'>false</span>
otherwise<a class='hidden_link' href='#sharedmutex.requirements-21.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-22'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1424'>#</a></div><div id='sharedmutex.requirements-22.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> If <span class='texttt'>try_&shy;lock_&shy;shared()</span> returns <span class='texttt'>true</span>, prior <span class='texttt'>unlock()</span>
operations on the same object <a href='intro.multithread#def:synchronize_with'>synchronize with</a> this
operation<a class='hidden_link' href='#sharedmutex.requirements-22.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.requirements-23'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1429'>#</a></div><div id='sharedmutex.requirements-23.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#sharedmutex.requirements-23.sentence-1'>.</a></div></div></div><div id='sharedmutex.class' class='section'><h4 ><a class='secnum' href='#sharedmutex.class' style='min-width:133pt'>33.4.3.4.1</a> Class <span class='texttt'>shared_&shy;mutex</span> <a class='abbr_ref' href='thread.sharedmutex.class'>[thread.sharedmutex.class]</a></h4><span class='indexparent'><a class='index' id='lib:shared_mutex'></a></span><pre class='codeblock'>
namespace std {
  class shared_mutex {
  public:
    shared_mutex();
    ~shared_mutex();

    shared_mutex(const shared_mutex&amp;) = delete;
    shared_mutex&amp; operator=(const shared_mutex&amp;) = delete;

    <span class='comment'>// Exclusive ownership
</span>    void lock();                <span class='comment'>// blocking
</span>    bool try_lock();
    void unlock();

    <span class='comment'>// Shared ownership
</span>    void lock_shared();         <span class='comment'>// blocking
</span>    bool try_lock_shared();
    void unlock_shared();

    using native_handle_type = <span class='textit'>implementation-defined</span>;          <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>    native_handle_type native_handle();                         <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>  };
}</pre><div class='para' id='sharedmutex.class-1'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1462'>#</a></div><div id='sharedmutex.class-1.sentence-1' class='sentence'>The class <span class='texttt'>shared_&shy;mutex</span> provides a non-recursive mutex
with shared ownership semantics<a class='hidden_link' href='#sharedmutex.class-1.sentence-1'>.</a></div></div><div class='para' id='sharedmutex.class-2'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1466'>#</a></div><div id='sharedmutex.class-2.sentence-1' class='sentence'>The class <span class='texttt'>shared_&shy;mutex</span> shall satisfy all of the
<a href='thread.sharedmutex.requirements'>shared mutex requirements</a><a class='hidden_link' href='#sharedmutex.class-2.sentence-1'>.</a></div> <div id='sharedmutex.class-2.sentence-2' class='sentence'>It shall be a standard-layout class (<a href='class'>[class]</a>)<a class='hidden_link' href='#sharedmutex.class-2.sentence-2'>.</a></div></div><div class='para' id='sharedmutex.class-3'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1471'>#</a></div><div id='sharedmutex.class-3.sentence-1' class='sentence'>The behavior of a program is undefined if:
<ul class='itemize'><li id='sharedmutex.class-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sharedmutex.class-3.1'>(3.1)</a></div><div id='sharedmutex.class-3.1.sentence-1' class='sentence'>it destroys a <span class='texttt'>shared_&shy;mutex</span> object owned by any thread,</div></li><li id='sharedmutex.class-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sharedmutex.class-3.2'>(3.2)</a></div><div id='sharedmutex.class-3.2.sentence-1' class='sentence'>a thread attempts to recursively gain any ownership of a <span class='texttt'>shared_&shy;mutex</span>, or</div></li><li id='sharedmutex.class-3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sharedmutex.class-3.3'>(3.3)</a></div><div id='sharedmutex.class-3.3.sentence-1' class='sentence'>a thread terminates while possessing any ownership of a <span class='texttt'>shared_&shy;mutex</span><a class='hidden_link' href='#sharedmutex.class-3.3.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='sharedmutex.class-4'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.class-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1479'>#</a></div><div id='sharedmutex.class-4.sentence-1' class='sentence'><span class='texttt'>shared_&shy;mutex</span> may be a synonym for <span class='texttt'>shared_&shy;timed_&shy;mutex</span><a class='hidden_link' href='#sharedmutex.class-4.sentence-1'>.</a></div></div></div></div><div id='sharedtimedmutex.requirements' class='section'><h4 ><a class='secnum' href='#sharedtimedmutex.requirements' style='min-width:118pt'>33.4.3.5</a> Shared timed mutex types <a class='abbr_ref' href='thread.sharedtimedmutex.requirements'>[thread.sharedtimedmutex.requirements]</a></h4><div class='para' id='sharedtimedmutex.requirements-1'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1484'>#</a></div><div id='sharedtimedmutex.requirements-1.sentence-1' class='sentence'>The standard library type <span class='texttt'>shared_&shy;timed_&shy;mutex</span> is a
<a class='hidden_link' href='#def:shared_timed_mutex_type' id='def:shared_timed_mutex_type'><i >shared timed mutex type</i></a><a class='hidden_link' href='#sharedtimedmutex.requirements-1.sentence-1'>.</a></div> <div id='sharedtimedmutex.requirements-1.sentence-2' class='sentence'>Shared timed mutex types shall meet the requirements of
<a href='thread.timedmutex.requirements'>timed mutex types</a>,
<a href='thread.sharedmutex.requirements'>shared mutex types</a>, and additionally
shall meet the requirements set out below<a class='hidden_link' href='#sharedtimedmutex.requirements-1.sentence-2'>.</a></div> <div id='sharedtimedmutex.requirements-1.sentence-3' class='sentence'>In this description,
<span class='texttt'>m</span> denotes an object of a shared timed mutex type,
<span class='texttt'>rel_&shy;type</span> denotes an object of an instantiation of
<a href='time.duration'><span class='texttt'>duration</span></a>, and
<span class='texttt'>abs_&shy;time</span> denotes an object of an instantiation of
<a href='time.point'><span class='texttt'>time_&shy;point</span></a><a class='hidden_link' href='#sharedtimedmutex.requirements-1.sentence-3'>.</a></div></div><div class='para' id='sharedtimedmutex.requirements-2'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1496'>#</a></div><div id='sharedtimedmutex.requirements-2.sentence-1' class='sentence'>The expression <span class='texttt'>m.try_&shy;lock_&shy;shared_&shy;for(rel_&shy;time)</span> shall be well-formed and
have the following semantics:</div></div><div class='itemdescr'></div><div class='para' id='sharedtimedmutex.requirements-3'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1501'>#</a></div><div id='sharedtimedmutex.requirements-3.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread has no ownership of the mutex<a class='hidden_link' href='#sharedtimedmutex.requirements-3.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-4'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1504'>#</a></div><div id='sharedtimedmutex.requirements-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Attempts to obtain
shared lock ownership for the calling thread within the relative
timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>rel_&shy;time</span><a class='hidden_link' href='#sharedtimedmutex.requirements-4.sentence-1'>.</a></div> <div id='sharedtimedmutex.requirements-4.sentence-2' class='sentence'>If the time
specified by <span class='texttt'>rel_&shy;time</span> is less than or equal to <span class='texttt'>rel_&shy;time.zero()</span>,
the function attempts to obtain ownership without blocking (as if by calling
<span class='texttt'>try_&shy;lock_&shy;shared()</span>)<a class='hidden_link' href='#sharedtimedmutex.requirements-4.sentence-2'>.</a></div> <div id='sharedtimedmutex.requirements-4.sentence-3' class='sentence'>The function shall return within the timeout
specified by <span class='texttt'>rel_&shy;time</span> only if it has obtained shared ownership of the
mutex object<a class='hidden_link' href='#sharedtimedmutex.requirements-4.sentence-3'>.</a></div> <div id='sharedtimedmutex.requirements-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#sharedtimedmutex.requirements-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='sharedtimedmutex.requirements-4.sentence-5' class='sentence'>As with <span class='texttt'>try_&shy;lock()</span>, there is no guarantee that
ownership will be obtained if the lock is available, but implementations are
expected to make a strong effort to do so<a class='hidden_link' href='#sharedtimedmutex.requirements-4.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='sharedtimedmutex.requirements-4.sentence-4' class='sentence'>
If an exception is thrown then a shared lock shall not have been acquired for
the current thread<a class='hidden_link' href='#sharedtimedmutex.requirements-4.sentence-4'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-5'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1518'>#</a></div><div id='sharedtimedmutex.requirements-5.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#sharedtimedmutex.requirements-5.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-6'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1521'>#</a></div><div id='sharedtimedmutex.requirements-6.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if the shared lock was acquired, <span class='texttt'>false</span> otherwise<a class='hidden_link' href='#sharedtimedmutex.requirements-6.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-7'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1524'>#</a></div><div id='sharedtimedmutex.requirements-7.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> If <span class='texttt'>try_&shy;lock_&shy;shared_&shy;for()</span> returns <span class='texttt'>true</span>, prior
<span class='texttt'>unlock()</span> operations on the same object synchronize
with (<a href='intro.multithread'>[intro.multithread]</a>) this operation<a class='hidden_link' href='#sharedtimedmutex.requirements-7.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-8'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1529'>#</a></div><div id='sharedtimedmutex.requirements-8.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#sharedtimedmutex.requirements-8.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-9'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1533'>#</a></div><div id='sharedtimedmutex.requirements-9.sentence-1' class='sentence'>The expression <span class='texttt'>m.try_&shy;lock_&shy;shared_&shy;until(abs_&shy;time)</span> shall be well-formed
and have the following semantics:</div></div><div class='itemdescr'></div><div class='para' id='sharedtimedmutex.requirements-10'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1538'>#</a></div><div id='sharedtimedmutex.requirements-10.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread has no ownership of the mutex<a class='hidden_link' href='#sharedtimedmutex.requirements-10.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-11'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1541'>#</a></div><div id='sharedtimedmutex.requirements-11.sentence-1' class='sentence'><span class='textit'>Effects:</span> The function attempts to obtain shared ownership of the mutex<a class='hidden_link' href='#sharedtimedmutex.requirements-11.sentence-1'>.</a></div> <div id='sharedtimedmutex.requirements-11.sentence-2' class='sentence'>If
<span class='texttt'>abs_&shy;time</span> has already passed, the function attempts to obtain shared
ownership without blocking (as if by calling <span class='texttt'>try_&shy;lock_&shy;shared()</span>)<a class='hidden_link' href='#sharedtimedmutex.requirements-11.sentence-2'>.</a></div> <div id='sharedtimedmutex.requirements-11.sentence-3' class='sentence'>The
function shall return before the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>)
specified by <span class='texttt'>abs_&shy;time</span> only if it has obtained shared ownership of the
mutex object<a class='hidden_link' href='#sharedtimedmutex.requirements-11.sentence-3'>.</a></div> <div id='sharedtimedmutex.requirements-11.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#sharedtimedmutex.requirements-11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='sharedtimedmutex.requirements-11.sentence-5' class='sentence'>As with <span class='texttt'>try_&shy;lock()</span>, there is no guarantee that
ownership will be obtained if the lock is available, but implementations are
expected to make a strong effort to do so<a class='hidden_link' href='#sharedtimedmutex.requirements-11.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='sharedtimedmutex.requirements-11.sentence-4' class='sentence'>
If an exception is thrown then a shared lock shall not have been acquired for
the current thread<a class='hidden_link' href='#sharedtimedmutex.requirements-11.sentence-4'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-12'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1553'>#</a></div><div id='sharedtimedmutex.requirements-12.sentence-1' class='sentence'><span class='textit'>Return type:</span> <span class='texttt'>bool</span><a class='hidden_link' href='#sharedtimedmutex.requirements-12.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-13'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1556'>#</a></div><div id='sharedtimedmutex.requirements-13.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if the shared lock was acquired, <span class='texttt'>false</span> otherwise<a class='hidden_link' href='#sharedtimedmutex.requirements-13.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-14'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1559'>#</a></div><div id='sharedtimedmutex.requirements-14.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> If <span class='texttt'>try_&shy;lock_&shy;shared_&shy;until()</span> returns <span class='texttt'>true</span>, prior
<span class='texttt'>unlock()</span> operations on the same object synchronize
with (<a href='intro.multithread'>[intro.multithread]</a>) this operation<a class='hidden_link' href='#sharedtimedmutex.requirements-14.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements-15'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1564'>#</a></div><div id='sharedtimedmutex.requirements-15.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#sharedtimedmutex.requirements-15.sentence-1'>.</a></div></div></div><div id='sharedtimedmutex.class' class='section'><h4 ><a class='secnum' href='#sharedtimedmutex.class' style='min-width:133pt'>33.4.3.5.1</a> Class <span class='texttt'>shared_&shy;timed_&shy;mutex</span> <a class='abbr_ref' href='thread.sharedtimedmutex.class'>[thread.sharedtimedmutex.class]</a></h4><span class='indexparent'><a class='index' id='lib:shared_timed_mutex'></a></span><pre class='codeblock'>
namespace std {
  class shared_timed_mutex {
  public:
    shared_timed_mutex();
    ~shared_timed_mutex();

    shared_timed_mutex(const shared_timed_mutex&amp;) = delete;
    shared_timed_mutex&amp; operator=(const shared_timed_mutex&amp;) = delete;

    <span class='comment'>// Exclusive ownership
</span>    void lock();                <span class='comment'>// blocking
</span>    bool try_lock();
    template &lt;class Rep, class Period&gt;
      bool try_lock_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Clock, class Duration&gt;
      bool try_lock_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    void unlock();

    <span class='comment'>// Shared ownership
</span>    void lock_shared();         <span class='comment'>// blocking
</span>    bool try_lock_shared();
    template &lt;class Rep, class Period&gt;
      bool try_lock_shared_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Clock, class Duration&gt;
      bool try_lock_shared_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    void unlock_shared();
  };
}</pre><div class='para' id='sharedtimedmutex.class-1'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1602'>#</a></div><div id='sharedtimedmutex.class-1.sentence-1' class='sentence'>The class <span class='texttt'>shared_&shy;timed_&shy;mutex</span> provides a non-recursive mutex with shared
ownership semantics<a class='hidden_link' href='#sharedtimedmutex.class-1.sentence-1'>.</a></div></div><div class='para' id='sharedtimedmutex.class-2'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1606'>#</a></div><div id='sharedtimedmutex.class-2.sentence-1' class='sentence'>The class <span class='texttt'>shared_&shy;timed_&shy;mutex</span> shall satisfy all of the
<a href='thread.sharedtimedmutex.requirements'>shared timed mutex requirements</a><a class='hidden_link' href='#sharedtimedmutex.class-2.sentence-1'>.</a></div> <div id='sharedtimedmutex.class-2.sentence-2' class='sentence'>It shall be a standard-layout class (<a href='class'>[class]</a>)<a class='hidden_link' href='#sharedtimedmutex.class-2.sentence-2'>.</a></div></div><div class='para' id='sharedtimedmutex.class-3'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1611'>#</a></div><div id='sharedtimedmutex.class-3.sentence-1' class='sentence'>The behavior of a program is undefined if:
<ul class='itemize'><li id='sharedtimedmutex.class-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sharedtimedmutex.class-3.1'>(3.1)</a></div><div id='sharedtimedmutex.class-3.1.sentence-1' class='sentence'>it destroys a <span class='texttt'>shared_&shy;timed_&shy;mutex</span> object owned by any thread,</div></li><li id='sharedtimedmutex.class-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sharedtimedmutex.class-3.2'>(3.2)</a></div><div id='sharedtimedmutex.class-3.2.sentence-1' class='sentence'>a thread attempts to recursively gain any ownership of a <span class='texttt'>shared_&shy;timed_&shy;mutex</span>, or</div></li><li id='sharedtimedmutex.class-3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#sharedtimedmutex.class-3.3'>(3.3)</a></div><div id='sharedtimedmutex.class-3.3.sentence-1' class='sentence'>a thread terminates while possessing any ownership of a <span class='texttt'>shared_&shy;timed_&shy;mutex</span><a class='hidden_link' href='#sharedtimedmutex.class-3.3.sentence-1'>.</a></div></li></ul></div></div></div></div></div><div id='lock' class='section'><h3 ><a class='secnum' href='#lock' style='min-width:103pt'>33.4.4</a> Locks <a class='abbr_ref' href='thread.lock'>[thread.lock]</a></h3><div class='para' id='lock-1'><div class='marginalizedparent'><a class='marginalized' href='#lock-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1621'>#</a></div><div id='lock-1.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:lock' id='def:lock'><i>lock</i></a> is an object that holds a reference to a lockable object and may unlock the
lockable object during the lock's destruction (such as when leaving block scope)<a class='hidden_link' href='#lock-1.sentence-1'>.</a></div> <div id='lock-1.sentence-2' class='sentence'>An execution
agent may use a lock to aid in managing ownership of a lockable object in an exception safe
manner<a class='hidden_link' href='#lock-1.sentence-2'>.</a></div> <div id='lock-1.sentence-3' class='sentence'>A lock is said to <a class='hidden_link' href='#def:own' id='def:own'><i>own</i></a> a lockable object if it is currently managing the
ownership of that lockable object for an execution agent<a class='hidden_link' href='#lock-1.sentence-3'>.</a></div> <div id='lock-1.sentence-4' class='sentence'>A lock does not manage the lifetime
of the lockable object it references<a class='hidden_link' href='#lock-1.sentence-4'>.</a></div> <div id='lock-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#lock-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lock-1.sentence-5' class='sentence'>Locks are intended to ease the burden of
unlocking the lockable object under both normal and exceptional circumstances<a class='hidden_link' href='#lock-1.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='lock-2'><div class='marginalizedparent'><a class='marginalized' href='#lock-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1630'>#</a></div><div id='lock-2.sentence-1' class='sentence'>Some lock constructors take tag types which describe what should be done with the lockable
object during the lock's construction<a class='hidden_link' href='#lock-2.sentence-1'>.</a></div><span class='indexparent'><a class='index' id='lib:defer_lock_t'></a></span><span class='indexparent'><a class='index' id='lib:try_to_lock_t'></a></span><span class='indexparent'><a class='index' id='lib:adopt_lock_t'></a></span><span class='indexparent'><a class='index' id='lib:defer_lock'></a></span><span class='indexparent'><a class='index' id='lib:try_to_lock'></a></span><span class='indexparent'><a class='index' id='lib:adopt_lock'></a></span><pre class='codeblock'>
namespace std {
  struct defer_lock_t  { };     <span class='comment'>// do not acquire ownership of the mutex
</span>  struct try_to_lock_t { };     <span class='comment'>// try to acquire ownership of the mutex
</span>                                <span class='comment'>// without blocking
</span>  struct adopt_lock_t  { };     <span class='comment'>// assume the calling thread has already
</span>                                <span class='comment'>// obtained mutex ownership and manage it
</span>
  inline constexpr defer_lock_t   defer_lock { };
  inline constexpr try_to_lock_t  try_to_lock { };
  inline constexpr adopt_lock_t   adopt_lock { };
}</pre></div><div id='lock.guard' class='section'><h4 ><a class='secnum' href='#lock.guard' style='min-width:118pt'>33.4.4.1</a> Class template <span class='texttt'>lock_&shy;guard</span> <a class='abbr_ref' href='thread.lock.guard'>[thread.lock.guard]</a></h4><span class='indexparent'><a class='index' id='lib:lock_guard'></a></span><pre class='codeblock'>
namespace std {
  template &lt;class Mutex&gt;
  class lock_guard {
  public:
    using mutex_type = Mutex;

    explicit lock_guard(mutex_type&amp; m);
    lock_guard(mutex_type&amp; m, adopt_lock_t);
    ~lock_guard();

    lock_guard(const lock_guard&amp;) = delete;
    lock_guard&amp; operator=(const lock_guard&amp;) = delete;

  private:
    mutex_type&amp; pm;             <span class='comment'>// <span class='textit'>exposition only</span>
</span>  };

  template&lt;class Mutex&gt; lock_guard(lock_guard&lt;Mutex&gt;) -&gt; lock_guard&lt;Mutex&gt;;
}</pre><div class='para' id='lock.guard-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1679'>#</a></div><div id='lock.guard-1.sentence-1' class='sentence'>An object of type <span class='texttt'>lock_&shy;guard</span> controls the ownership of a lockable object
within a scope<a class='hidden_link' href='#lock.guard-1.sentence-1'>.</a></div> <div id='lock.guard-1.sentence-2' class='sentence'>A <span class='texttt'>lock_&shy;guard</span> object maintains ownership of a lockable
object throughout the <span class='texttt'>lock_&shy;guard</span> object's <a href='basic.life#def:lifetime'>lifetime</a><a class='hidden_link' href='#lock.guard-1.sentence-2'>.</a></div> <div id='lock.guard-1.sentence-3' class='sentence'>The behavior of a program is undefined if the lockable object referenced by
<span class='texttt'>pm</span> does not exist for the entire lifetime of the <span class='texttt'>lock_&shy;guard</span>
object<a class='hidden_link' href='#lock.guard-1.sentence-3'>.</a></div> <div id='lock.guard-1.sentence-4' class='sentence'>The supplied <span class='texttt'>Mutex</span> type shall meet the
<a href='thread.req.lockable.basic'><span class='texttt'>BasicLockable</span></a> requirements<a class='hidden_link' href='#lock.guard-1.sentence-4'>.</a></div> <span class='indexparent'><a class='index' id='lib:lock_guard,constructor'></a></span></div><code class='itemdecl'>explicit lock_guard(mutex_type&amp; m);
</code><div class='itemdescr'></div><div class='para' id='lock.guard-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1694'>#</a></div><div id='lock.guard-2.sentence-1' class='sentence'><span class='textit'>Requires:</span> If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex,
the calling thread does not own the mutex <span class='texttt'>m</span><a class='hidden_link' href='#lock.guard-2.sentence-1'>.</a></div></div></div><div class='para' id='lock.guard-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1698'>#</a></div><div id='lock.guard-3.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>m.lock()</span><a class='hidden_link' href='#lock.guard-3.sentence-1'>.</a></div></div></div><div class='para' id='lock.guard-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1701'>#</a></div><div id='lock.guard-4.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>&amp;pm == &amp;m</span></div></div></div><span class='indexparent'><a class='index' id='lib:lock_guard,constructor_'></a></span><code class='itemdecl'>lock_guard(mutex_type&amp; m, adopt_lock_t);
</code><div class='itemdescr'></div><div class='para' id='lock.guard-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1711'>#</a></div><div id='lock.guard-5.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread owns the mutex <span class='texttt'>m</span><a class='hidden_link' href='#lock.guard-5.sentence-1'>.</a></div></div></div><div class='para' id='lock.guard-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1714'>#</a></div><div id='lock.guard-6.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>&amp;pm == &amp;m</span></div></div></div><div class='para' id='lock.guard-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1717'>#</a></div><div id='lock.guard-7.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#lock.guard-7.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:lock_guard,destructor'></a></span><code class='itemdecl'>~lock_guard();
</code><div class='itemdescr'></div><div class='para' id='lock.guard-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1727'>#</a></div><div id='lock.guard-8.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm.unlock()</span><a class='hidden_link' href='#lock.guard-8.sentence-1'>.</a></div></div></div></div><div id='lock.scoped' class='section'><h4 ><a class='secnum' href='#lock.scoped' style='min-width:118pt'>33.4.4.2</a> Class template <span class='texttt'>scoped_&shy;lock</span> <a class='abbr_ref' href='thread.lock.scoped'>[thread.lock.scoped]</a></h4><span class='indexparent'><a class='index' id='lib:scoped_lock'></a></span><pre class='codeblock'>
namespace std {
  template &lt;class... MutexTypes&gt;
  class scoped_lock {
  public:
    using mutex_type = Mutex;   <span class='comment'>// If <span class='tcode_in_codeblock'>MutexTypes...</span> consists of the single type <span class='tcode_in_codeblock'>Mutex</span>
</span>
    explicit scoped_lock(MutexTypes&amp;... m);
    explicit scoped_lock(adopt_lock_t, MutexTypes&amp;... m);
    ~scoped_lock();

    scoped_lock(const scoped_lock&amp;) = delete;
    scoped_lock&amp; operator=(const scoped_lock&amp;) = delete;

  private:
    tuple&lt;MutexTypes&amp;...&gt; pm;   <span class='comment'>// <span class='textit'>exposition only</span>
</span>  };

  template&lt;class... MutexTypes&gt;
    scoped_lock(scoped_lock&lt;MutexTypes...&gt;) -&gt; scoped_lock&lt;MutexTypes...&gt;;
}</pre><div class='para' id='lock.scoped-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1758'>#</a></div><div id='lock.scoped-1.sentence-1' class='sentence'>An object of type <span class='texttt'>scoped_&shy;lock</span> controls the ownership of lockable objects
within a scope<a class='hidden_link' href='#lock.scoped-1.sentence-1'>.</a></div> <div id='lock.scoped-1.sentence-2' class='sentence'>A <span class='texttt'>scoped_&shy;lock</span> object maintains ownership of lockable
objects throughout the <span class='texttt'>scoped_&shy;lock</span> object's <a href='basic.life#def:lifetime'>lifetime</a><a class='hidden_link' href='#lock.scoped-1.sentence-2'>.</a></div> <div id='lock.scoped-1.sentence-3' class='sentence'>The behavior of a program is undefined if the lockable objects referenced by
<span class='texttt'>pm</span> do not exist for the entire lifetime of the <span class='texttt'>scoped_&shy;lock</span>
object<a class='hidden_link' href='#lock.scoped-1.sentence-3'>.</a></div> <div id='lock.scoped-1.sentence-4' class='sentence'>When <span class='texttt'>sizeof...(MutexTypes)</span> is <span class='texttt'>1</span>,
the supplied <span class='texttt'>Mutex</span> type
shall meet the <a href='thread.req.lockable.basic'><span class='texttt'>BasicLockable</span></a> requirements<a class='hidden_link' href='#lock.scoped-1.sentence-4'>.</a></div> <div id='lock.scoped-1.sentence-5' class='sentence'>Otherwise, each of the mutex types
shall meet the <a href='thread.req.lockable.req'><span class='texttt'>Lockable</span></a> requirements<a class='hidden_link' href='#lock.scoped-1.sentence-5'>.</a></div> <span class='indexparent'><a class='index' id='lib:scoped_lock,constructor'></a></span></div><code class='itemdecl'>explicit scoped_lock(MutexTypes&amp;... m);
</code><div class='itemdescr'></div><div class='para' id='lock.scoped-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1777'>#</a></div><div id='lock.scoped-2.sentence-1' class='sentence'><span class='textit'>Requires:</span> If a <span class='texttt'>MutexTypes</span> type is not a recursive mutex,
the calling thread does not own the corresponding mutex element of <span class='texttt'>m</span><a class='hidden_link' href='#lock.scoped-2.sentence-1'>.</a></div></div></div><div class='para' id='lock.scoped-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1781'>#</a></div><div id='lock.scoped-3.sentence-1' class='sentence'><span class='textit'>Effects:</span> Initializes <span class='texttt'>pm</span> with <span class='texttt'>tie(m...)</span><a class='hidden_link' href='#lock.scoped-3.sentence-1'>.</a></div> <div id='lock.scoped-3.sentence-2' class='sentence'>Then if <span class='texttt'>sizeof...(MutexTypes)</span> is <span class='texttt'>0</span>, no effects<a class='hidden_link' href='#lock.scoped-3.sentence-2'>.</a></div> <div id='lock.scoped-3.sentence-3' class='sentence'>Otherwise if <span class='texttt'>sizeof...(MutexTypes)</span> is <span class='texttt'>1</span>, then <span class='texttt'>m.lock()</span><a class='hidden_link' href='#lock.scoped-3.sentence-3'>.</a></div> <div id='lock.scoped-3.sentence-4' class='sentence'>Otherwise, <span class='texttt'>lock(m...)</span><a class='hidden_link' href='#lock.scoped-3.sentence-4'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:scoped_lock,constructor_'></a></span><code class='itemdecl'>explicit scoped_lock(adopt_lock_t, MutexTypes&amp;... m);
</code><div class='itemdescr'></div><div class='para' id='lock.scoped-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1794'>#</a></div><div id='lock.scoped-4.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread owns all the mutexes in <span class='texttt'>m</span><a class='hidden_link' href='#lock.scoped-4.sentence-1'>.</a></div></div></div><div class='para' id='lock.scoped-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1797'>#</a></div><div id='lock.scoped-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> Initializes <span class='texttt'>pm</span> with <span class='texttt'>tie(m...)</span><a class='hidden_link' href='#lock.scoped-5.sentence-1'>.</a></div></div></div><div class='para' id='lock.scoped-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1800'>#</a></div><div id='lock.scoped-6.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#lock.scoped-6.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:scoped_lock,destructor'></a></span><code class='itemdecl'>~scoped_lock();
</code><div class='itemdescr'></div><div class='para' id='lock.scoped-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1810'>#</a></div><div id='lock.scoped-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> For all <span class='texttt'>i</span> in <span class='texttt'>[0, sizeof...(MutexTypes))</span>,
<span class='texttt'>get&lt;i&gt;(pm).unlock()</span><a class='hidden_link' href='#lock.scoped-7.sentence-1'>.</a></div></div></div></div><div id='lock.unique' class='section'><h4 ><a class='secnum' href='#lock.unique' style='min-width:118pt'>33.4.4.3</a> Class template <span class='texttt'>unique_&shy;lock</span> <a class='abbr_ref' href='thread.lock.unique'>[thread.lock.unique]</a></h4><span class='indexparent'><a class='index' id='lib:unique_lock'></a></span><pre class='codeblock'>
namespace std {
  template &lt;class Mutex&gt;
  class unique_lock {
  public:
    using mutex_type = Mutex;

    <span class='comment'>// <a href='thread.lock.unique.cons'>[thread.lock.unique.cons]</a>, construct/copy/destroy
</span>    unique_lock() noexcept;
    explicit unique_lock(mutex_type&amp; m);
    unique_lock(mutex_type&amp; m, defer_lock_t) noexcept;
    unique_lock(mutex_type&amp; m, try_to_lock_t);
    unique_lock(mutex_type&amp; m, adopt_lock_t);
    template &lt;class Clock, class Duration&gt;
      unique_lock(mutex_type&amp; m, const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    template &lt;class Rep, class Period&gt;
      unique_lock(mutex_type&amp; m, const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    ~unique_lock();

    unique_lock(const unique_lock&amp;) = delete;
    unique_lock&amp; operator=(const unique_lock&amp;) = delete;

    unique_lock(unique_lock&amp;&amp; u) noexcept;
    unique_lock&amp; operator=(unique_lock&amp;&amp; u);

    <span class='comment'>// <a href='thread.lock.unique.locking'>[thread.lock.unique.locking]</a>, locking
</span>    void lock();
    bool try_lock();

    template &lt;class Rep, class Period&gt;
      bool try_lock_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Clock, class Duration&gt;
      bool try_lock_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);

    void unlock();

    <span class='comment'>// <a href='thread.lock.unique.mod'>[thread.lock.unique.mod]</a>, modifiers
</span>    void swap(unique_lock&amp; u) noexcept;
    mutex_type* release() noexcept;

    <span class='comment'>// <a href='thread.lock.unique.obs'>[thread.lock.unique.obs]</a>, observers
</span>    bool owns_lock() const noexcept;
    explicit operator bool () const noexcept;
    mutex_type* mutex() const noexcept;

  private:
    mutex_type* pm;             <span class='comment'>// <span class='textit'>exposition only</span>
</span>    bool owns;                  <span class='comment'>// <span class='textit'>exposition only</span>
</span>  };

  template&lt;class Mutex&gt; unique_lock(unique_lock&lt;Mutex&gt;) -&gt; unique_lock&lt;Mutex&gt;;

  template &lt;class Mutex&gt;
    void swap(unique_lock&lt;Mutex&gt;&amp; x, unique_lock&lt;Mutex&gt;&amp; y) noexcept;
}</pre><div class='para' id='lock.unique-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1875'>#</a></div><div id='lock.unique-1.sentence-1' class='sentence'>An object of type <span class='texttt'>unique_&shy;lock</span> controls the ownership of a lockable
object within a scope<a class='hidden_link' href='#lock.unique-1.sentence-1'>.</a></div> <div id='lock.unique-1.sentence-2' class='sentence'>Ownership of the lockable object may be acquired at
construction or after construction, and may be transferred, after
acquisition, to another <span class='texttt'>unique_&shy;lock</span> object<a class='hidden_link' href='#lock.unique-1.sentence-2'>.</a></div> <div id='lock.unique-1.sentence-3' class='sentence'>Objects of type <span class='texttt'>unique_&shy;lock</span> are not
copyable but are movable<a class='hidden_link' href='#lock.unique-1.sentence-3'>.</a></div> <div id='lock.unique-1.sentence-4' class='sentence'>The behavior of a program is undefined if the contained pointer
<span class='texttt'>pm</span> is not null and the lockable object pointed
to by <span class='texttt'>pm</span> does not exist for the entire remaining
<a href='basic.life#def:lifetime'>lifetime</a> of the <span class='texttt'>unique_&shy;lock</span> object<a class='hidden_link' href='#lock.unique-1.sentence-4'>.</a></div> <div id='lock.unique-1.sentence-5' class='sentence'>The supplied
<span class='texttt'>Mutex</span> type shall meet the
<a href='thread.req.lockable.basic'><span class='texttt'>BasicLockable</span></a> requirements<a class='hidden_link' href='#lock.unique-1.sentence-5'>.</a></div></div><div class='para' id='lock.unique-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1887'>#</a></div><div id='lock.unique-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#lock.unique-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lock.unique-2.sentence-1' class='sentence'><span class='texttt'>unique_&shy;lock&lt;Mutex&gt;</span> meets the <span class='texttt'>BasicLockable</span> requirements<a class='hidden_link' href='#lock.unique-2.sentence-1'>.</a></div> <div id='lock.unique-2.sentence-2' class='sentence'>If <span class='texttt'>Mutex</span>
meets the <a href='thread.req.lockable.req'><span class='texttt'>Lockable</span></a> requirements,
<span class='texttt'>unique_&shy;lock&lt;Mutex&gt;</span> also meets the <span class='texttt'>Lockable</span> requirements;
if <span class='texttt'>Mutex</span>
meets the <a href='thread.req.lockable.timed'><span class='texttt'>TimedLockable</span></a> requirements,
<span class='texttt'>unique_&shy;lock&lt;Mutex&gt;</span> also meets the <span class='texttt'>TimedLockable</span> requirements<a class='hidden_link' href='#lock.unique-2.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div id='lock.unique.cons' class='section'><h4 ><a class='secnum' href='#lock.unique.cons' style='min-width:133pt'>33.4.4.3.1</a> <span class='texttt'>unique_&shy;lock</span> constructors, destructor, and assignment <a class='abbr_ref' href='thread.lock.unique.cons'>[thread.lock.unique.cons]</a></h4><span class='indexparent'><a class='index' id='lib:unique_lock,constructor'></a></span><code class='itemdecl'>unique_lock() noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1903'>#</a></div><div id='lock.unique.cons-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>unique_&shy;lock</span><a class='hidden_link' href='#lock.unique.cons-1.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1906'>#</a></div><div id='lock.unique.cons-2.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == 0</span> and <span class='texttt'>owns == false</span><a class='hidden_link' href='#lock.unique.cons-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:unique_lock,constructor_'></a></span><code class='itemdecl'>explicit unique_lock(mutex_type&amp; m);
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1916'>#</a></div><div id='lock.unique.cons-3.sentence-1' class='sentence'><span class='textit'>Requires:</span> If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex the calling thread does not own the mutex<a class='hidden_link' href='#lock.unique.cons-3.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1919'>#</a></div><div id='lock.unique.cons-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>unique_&shy;lock</span> and calls <span class='texttt'>m.lock()</span><a class='hidden_link' href='#lock.unique.cons-4.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1922'>#</a></div><div id='lock.unique.cons-5.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == true</span><a class='hidden_link' href='#lock.unique.cons-5.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:unique_lock,constructor__'></a></span><code class='itemdecl'>unique_lock(mutex_type&amp; m, defer_lock_t) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1932'>#</a></div><div id='lock.unique.cons-6.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>unique_&shy;lock</span><a class='hidden_link' href='#lock.unique.cons-6.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1935'>#</a></div><div id='lock.unique.cons-7.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == false</span><a class='hidden_link' href='#lock.unique.cons-7.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:unique_lock,constructor___'></a></span><code class='itemdecl'>unique_lock(mutex_type&amp; m, try_to_lock_t);
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1945'>#</a></div><div id='lock.unique.cons-8.sentence-1' class='sentence'><span class='textit'>Requires:</span> 
The supplied <span class='texttt'>Mutex</span> type shall meet the
<a href='thread.req.lockable.req'><span class='texttt'>Lockable</span></a> requirements<a class='hidden_link' href='#lock.unique.cons-8.sentence-1'>.</a></div> <div id='lock.unique.cons-8.sentence-2' class='sentence'>If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex the calling thread does not own the mutex<a class='hidden_link' href='#lock.unique.cons-8.sentence-2'>.</a></div></div></div><div class='para' id='lock.unique.cons-9'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1951'>#</a></div><div id='lock.unique.cons-9.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>unique_&shy;lock</span> and calls <span class='texttt'>m.try_&shy;lock()</span><a class='hidden_link' href='#lock.unique.cons-9.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-10'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1954'>#</a></div><div id='lock.unique.cons-10.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == res</span>,
where <span class='texttt'>res</span> is the value returned by the call to <span class='texttt'>m.try_&shy;lock()</span><a class='hidden_link' href='#lock.unique.cons-10.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:unique_lock,constructor____'></a></span><code class='itemdecl'>unique_lock(mutex_type&amp; m, adopt_lock_t);
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-11'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1965'>#</a></div><div id='lock.unique.cons-11.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread owns the mutex<a class='hidden_link' href='#lock.unique.cons-11.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-12'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1968'>#</a></div><div id='lock.unique.cons-12.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>unique_&shy;lock</span><a class='hidden_link' href='#lock.unique.cons-12.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-13'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1971'>#</a></div><div id='lock.unique.cons-13.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == true</span><a class='hidden_link' href='#lock.unique.cons-13.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-14'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1974'>#</a></div><div id='lock.unique.cons-14.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#lock.unique.cons-14.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:unique_lock,constructor_____'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  unique_lock(mutex_type&amp; m, const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-15'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1985'>#</a></div><div id='lock.unique.cons-15.sentence-1' class='sentence'><span class='textit'>Requires:</span> If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex the calling thread
does not own the mutex<a class='hidden_link' href='#lock.unique.cons-15.sentence-1'>.</a></div> <div id='lock.unique.cons-15.sentence-2' class='sentence'>The supplied <span class='texttt'>Mutex</span> type shall meet the
<a href='thread.req.lockable.timed'><span class='texttt'>TimedLockable</span></a> requirements<a class='hidden_link' href='#lock.unique.cons-15.sentence-2'>.</a></div></div></div><div class='para' id='lock.unique.cons-16'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1990'>#</a></div><div id='lock.unique.cons-16.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>unique_&shy;lock</span> and calls <span class='texttt'>m.try_&shy;lock_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.unique.cons-16.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-17'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L1993'>#</a></div><div id='lock.unique.cons-17.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == res</span>,
where <span class='texttt'>res</span> is
the value returned by the call to <span class='texttt'>m.try_&shy;lock_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.unique.cons-17.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:unique_lock,constructor______'></a></span><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  unique_lock(mutex_type&amp; m, const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-18'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2006'>#</a></div><div id='lock.unique.cons-18.sentence-1' class='sentence'><span class='textit'>Requires:</span> If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex the calling thread does not own the mutex<a class='hidden_link' href='#lock.unique.cons-18.sentence-1'>.</a></div> <div id='lock.unique.cons-18.sentence-2' class='sentence'>The supplied <span class='texttt'>Mutex</span> type shall meet the <a href='thread.req.lockable.timed'><span class='texttt'>TimedLockable</span></a> requirements<a class='hidden_link' href='#lock.unique.cons-18.sentence-2'>.</a></div></div></div><div class='para' id='lock.unique.cons-19'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2010'>#</a></div><div id='lock.unique.cons-19.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>unique_&shy;lock</span> and calls <span class='texttt'>m.try_&shy;lock_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.unique.cons-19.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-20'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2013'>#</a></div><div id='lock.unique.cons-20.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == res</span>,
where <span class='texttt'>res</span> is the value returned by the call to <span class='texttt'>m.try_&shy;lock_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.unique.cons-20.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:unique_lock,constructor_______'></a></span><code class='itemdecl'>unique_lock(unique_lock&amp;&amp; u) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-21'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2024'>#</a></div><div id='lock.unique.cons-21.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == u_&shy;p.pm</span> and <span class='texttt'>owns == u_&shy;p.owns</span> (where <span class='texttt'>u_&shy;p</span> is the state of <span class='texttt'>u</span> just prior to this construction),  <span class='texttt'>u.pm == 0</span> and <span class='texttt'>u.owns == false</span><a class='hidden_link' href='#lock.unique.cons-21.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,operator='></a></span><code class='itemdecl'>unique_lock&amp; operator=(unique_lock&amp;&amp; u);
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-22'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2033'>#</a></div><div id='lock.unique.cons-22.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>owns</span> calls <span class='texttt'>pm-&gt;unlock()</span><a class='hidden_link' href='#lock.unique.cons-22.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-23'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2035'>#</a></div><div id='lock.unique.cons-23.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == u_&shy;p.pm</span> and <span class='texttt'>owns == u_&shy;p.owns</span> (where <span class='texttt'>u_&shy;p</span> is the state of <span class='texttt'>u</span> just prior to this construction),  <span class='texttt'>u.pm == 0</span> and <span class='texttt'>u.owns == false</span><a class='hidden_link' href='#lock.unique.cons-23.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.cons-24'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2037'>#</a></div><div id='lock.unique.cons-24.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#lock.unique.cons-24.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lock.unique.cons-24.sentence-1' class='sentence'>With a recursive mutex it is possible for both <span class='texttt'>*this</span> and <span class='texttt'>u</span> to own the same mutex before the assignment<a class='hidden_link' href='#lock.unique.cons-24.sentence-1'>.</a></div> <div id='lock.unique.cons-24.sentence-2' class='sentence'>In this case, <span class='texttt'>*this</span> will own the mutex after the assignment and <span class='texttt'>u</span> will not<a class='hidden_link' href='#lock.unique.cons-24.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='lock.unique.cons-25'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2040'>#</a></div><div id='lock.unique.cons-25.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#lock.unique.cons-25.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:unique_lock,destructor'></a></span><code class='itemdecl'>~unique_lock();
</code><div class='itemdescr'></div><div class='para' id='lock.unique.cons-26'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2050'>#</a></div><div id='lock.unique.cons-26.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>owns</span> calls <span class='texttt'>pm-&gt;unlock()</span><a class='hidden_link' href='#lock.unique.cons-26.sentence-1'>.</a></div></div></div></div><div id='lock.unique.locking' class='section'><h4 ><a class='secnum' href='#lock.unique.locking' style='min-width:133pt'>33.4.4.3.2</a> <span class='texttt'>unique_&shy;lock</span> locking <a class='abbr_ref' href='thread.lock.unique.locking'>[thread.lock.unique.locking]</a></h4><span class='indexparent'><a class='index' id='lib:lock,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,lock'></a></span><code class='itemdecl'>void lock();
</code><div class='itemdescr'></div><div class='para' id='lock.unique.locking-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2061'>#</a></div><div id='lock.unique.locking-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;lock()</span><a class='hidden_link' href='#lock.unique.locking-1.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2064'>#</a></div><div id='lock.unique.locking-2.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == true</span><a class='hidden_link' href='#lock.unique.locking-2.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2067'>#</a></div><div id='lock.unique.locking-3.sentence-1' class='sentence'><span class='textit'>Throws:</span> 
Any exception thrown by <span class='texttt'>pm-&gt;lock()</span><a class='hidden_link' href='#lock.unique.locking-3.sentence-1'>.</a></div> <div id='lock.unique.locking-3.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception
is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.unique.locking-3.sentence-2'>.</a></div></div></div><div class='para' id='lock.unique.locking-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2072'>#</a></div><div id='lock.unique.locking-4.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.unique.locking-4.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-4.1'>(4.1)</a></div><div id='lock.unique.locking-4.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'>nullptr</span><a class='hidden_link' href='#lock.unique.locking-4.1.sentence-1'>.</a></div></li><li id='lock.unique.locking-4.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-4.2'>(4.2)</a></div><div id='lock.unique.locking-4.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span>
is <span class='texttt'>true</span><a class='hidden_link' href='#lock.unique.locking-4.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:try_lock,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,try_lock'></a></span><code class='itemdecl'>bool try_lock();
</code><div class='itemdescr'></div><div class='para' id='lock.unique.locking-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2087'>#</a></div><div id='lock.unique.locking-5.sentence-1' class='sentence'><span class='textit'>Requires:</span> The supplied <span class='texttt'>Mutex</span> shall meet the
<a href='thread.req.lockable.req'><span class='texttt'>Lockable</span></a> requirements<a class='hidden_link' href='#lock.unique.locking-5.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2091'>#</a></div><div id='lock.unique.locking-6.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;try_&shy;lock()</span><a class='hidden_link' href='#lock.unique.locking-6.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2094'>#</a></div><div id='lock.unique.locking-7.sentence-1' class='sentence'><span class='textit'>Returns:</span> The value returned by the call to <span class='texttt'>try_&shy;lock()</span><a class='hidden_link' href='#lock.unique.locking-7.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2096'>#</a></div><div id='lock.unique.locking-8.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == res</span>, where <span class='texttt'>res</span> is the value returned by
the call to <span class='texttt'>try_&shy;lock()</span><a class='hidden_link' href='#lock.unique.locking-8.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-9'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2100'>#</a></div><div id='lock.unique.locking-9.sentence-1' class='sentence'><span class='textit'>Throws:</span> 
Any exception thrown by <span class='texttt'>pm-&gt;try_&shy;lock()</span><a class='hidden_link' href='#lock.unique.locking-9.sentence-1'>.</a></div> <div id='lock.unique.locking-9.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception
is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.unique.locking-9.sentence-2'>.</a></div></div></div><div class='para' id='lock.unique.locking-10'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2105'>#</a></div><div id='lock.unique.locking-10.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.unique.locking-10.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-10.1'>(10.1)</a></div><div id='lock.unique.locking-10.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'>nullptr</span><a class='hidden_link' href='#lock.unique.locking-10.1.sentence-1'>.</a></div></li><li id='lock.unique.locking-10.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-10.2'>(10.2)</a></div><div id='lock.unique.locking-10.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span>
is <span class='texttt'>true</span><a class='hidden_link' href='#lock.unique.locking-10.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:try_lock_until,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,try_lock_until'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  bool try_lock_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</code><div class='itemdescr'></div><div class='para' id='lock.unique.locking-11'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2121'>#</a></div><div id='lock.unique.locking-11.sentence-1' class='sentence'><span class='textit'>Requires:</span> The supplied <span class='texttt'>Mutex</span> type shall meet the
<a href='thread.req.lockable.timed'><span class='texttt'>TimedLockable</span></a> requirements<a class='hidden_link' href='#lock.unique.locking-11.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-12'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2125'>#</a></div><div id='lock.unique.locking-12.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.unique.locking-12.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-13'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2128'>#</a></div><div id='lock.unique.locking-13.sentence-1' class='sentence'><span class='textit'>Returns:</span> The value returned by the call to <span class='texttt'>try_&shy;lock_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.unique.locking-13.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-14'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2131'>#</a></div><div id='lock.unique.locking-14.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == res</span>, where <span class='texttt'>res</span> is the value returned by
the call to <span class='texttt'>try_&shy;lock_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.unique.locking-14.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-15'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2135'>#</a></div><div id='lock.unique.locking-15.sentence-1' class='sentence'><span class='textit'>Throws:</span> Any exception thrown by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;until()</span><a class='hidden_link' href='#lock.unique.locking-15.sentence-1'>.</a></div> <div id='lock.unique.locking-15.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an
exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.unique.locking-15.sentence-2'>.</a></div></div></div><div class='para' id='lock.unique.locking-16'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2139'>#</a></div><div id='lock.unique.locking-16.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.unique.locking-16.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-16.1'>(16.1)</a></div><div id='lock.unique.locking-16.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'>nullptr</span><a class='hidden_link' href='#lock.unique.locking-16.1.sentence-1'>.</a></div></li><li id='lock.unique.locking-16.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-16.2'>(16.2)</a></div><div id='lock.unique.locking-16.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'>true</span><a class='hidden_link' href='#lock.unique.locking-16.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:try_lock_for,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,try_lock_for'></a></span><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  bool try_lock_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</code><div class='itemdescr'></div><div class='para' id='lock.unique.locking-17'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2155'>#</a></div><div id='lock.unique.locking-17.sentence-1' class='sentence'><span class='textit'>Requires:</span> The supplied <span class='texttt'>Mutex</span> type shall meet the <a href='thread.req.lockable.timed'><span class='texttt'>TimedLockable</span></a> requirements<a class='hidden_link' href='#lock.unique.locking-17.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-18'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2158'>#</a></div><div id='lock.unique.locking-18.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.unique.locking-18.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-19'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2161'>#</a></div><div id='lock.unique.locking-19.sentence-1' class='sentence'><span class='textit'>Returns:</span> The value returned by the call to <span class='texttt'>try_&shy;lock_&shy;until(rel_&shy;time)</span><a class='hidden_link' href='#lock.unique.locking-19.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-20'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2164'>#</a></div><div id='lock.unique.locking-20.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == res</span>, where <span class='texttt'>res</span> is the value returned by the call to <span class='texttt'>try_&shy;lock_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.unique.locking-20.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-21'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2167'>#</a></div><div id='lock.unique.locking-21.sentence-1' class='sentence'><span class='textit'>Throws:</span> Any exception thrown by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;for()</span><a class='hidden_link' href='#lock.unique.locking-21.sentence-1'>.</a></div> <div id='lock.unique.locking-21.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an
exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.unique.locking-21.sentence-2'>.</a></div></div></div><div class='para' id='lock.unique.locking-22'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2171'>#</a></div><div id='lock.unique.locking-22.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.unique.locking-22.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-22.1'>(22.1)</a></div><div id='lock.unique.locking-22.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'>nullptr</span><a class='hidden_link' href='#lock.unique.locking-22.1.sentence-1'>.</a></div></li><li id='lock.unique.locking-22.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-22.2'>(22.2)</a></div><div id='lock.unique.locking-22.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'>true</span><a class='hidden_link' href='#lock.unique.locking-22.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:unlock,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,unlock'></a></span><code class='itemdecl'>void unlock();
</code><div class='itemdescr'></div><div class='para' id='lock.unique.locking-23'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2186'>#</a></div><div id='lock.unique.locking-23.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;unlock()</span><a class='hidden_link' href='#lock.unique.locking-23.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-24'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2188'>#</a></div><div id='lock.unique.locking-24.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == false</span><a class='hidden_link' href='#lock.unique.locking-24.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-25'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2190'>#</a></div><div id='lock.unique.locking-25.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.unique.locking-25.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.locking-26'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2193'>#</a></div><div id='lock.unique.locking-26.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.unique.locking-26.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.unique.locking-26.1'>(26.1)</a></div><div id='lock.unique.locking-26.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if on entry <span class='texttt'>owns</span> is <span class='texttt'>false</span><a class='hidden_link' href='#lock.unique.locking-26.1.sentence-1'>.</a></div></li></ul></div></div></div></div><div id='lock.unique.mod' class='section'><h4 ><a class='secnum' href='#lock.unique.mod' style='min-width:133pt'>33.4.4.3.3</a> <span class='texttt'>unique_&shy;lock</span> modifiers <a class='abbr_ref' href='thread.lock.unique.mod'>[thread.lock.unique.mod]</a></h4><span class='indexparent'><a class='index' id='lib:swap,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,swap'></a></span><code class='itemdecl'>void swap(unique_lock&amp; u) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.mod-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.mod-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2207'>#</a></div><div id='lock.unique.mod-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Swaps the data members of <span class='texttt'>*this</span> and <span class='texttt'>u</span><a class='hidden_link' href='#lock.unique.mod-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:release,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,release'></a></span><code class='itemdecl'>mutex_type* release() noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.mod-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.mod-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2216'>#</a></div><div id='lock.unique.mod-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> The previous value of <span class='texttt'>pm</span><a class='hidden_link' href='#lock.unique.mod-2.sentence-1'>.</a></div></div></div><div class='para' id='lock.unique.mod-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.mod-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2218'>#</a></div><div id='lock.unique.mod-3.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == 0</span> and <span class='texttt'>owns == false</span><a class='hidden_link' href='#lock.unique.mod-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:swap,unique_lock_'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,swap_'></a></span><code class='itemdecl'>template &lt;class Mutex&gt;
  void swap(unique_lock&lt;Mutex&gt;&amp; x, unique_lock&lt;Mutex&gt;&amp; y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.mod-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.mod-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2228'>#</a></div><div id='lock.unique.mod-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>x.swap(y)</span><a class='hidden_link' href='#lock.unique.mod-4.sentence-1'>.</a></div></div></div></div><div id='lock.unique.obs' class='section'><h4 ><a class='secnum' href='#lock.unique.obs' style='min-width:133pt'>33.4.4.3.4</a> <span class='texttt'>unique_&shy;lock</span> observers <a class='abbr_ref' href='thread.lock.unique.obs'>[thread.lock.unique.obs]</a></h4><span class='indexparent'><a class='index' id='lib:owns_lock,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,owns_lock'></a></span><code class='itemdecl'>bool owns_lock() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.obs-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.obs-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2239'>#</a></div><div id='lock.unique.obs-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>owns</span><a class='hidden_link' href='#lock.unique.obs-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator_bool,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,operator_bool'></a></span><code class='itemdecl'>explicit operator bool() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.obs-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.obs-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2248'>#</a></div><div id='lock.unique.obs-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>owns</span><a class='hidden_link' href='#lock.unique.obs-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:mutex,unique_lock'></a></span><span class='indexparent'><a class='index' id='lib:unique_lock,mutex'></a></span><code class='itemdecl'>mutex_type *mutex() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.unique.obs-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.obs-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2257'>#</a></div><div id='lock.unique.obs-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>pm</span><a class='hidden_link' href='#lock.unique.obs-3.sentence-1'>.</a></div></div></div></div></div><div id='lock.shared' class='section'><h4 ><a class='secnum' href='#lock.shared' style='min-width:118pt'>33.4.4.4</a> Class template <span class='texttt'>shared_&shy;lock</span> <a class='abbr_ref' href='thread.lock.shared'>[thread.lock.shared]</a></h4><span class='indexparent'><a class='index' id='lib:shared_lock'></a></span><pre class='codeblock'>
namespace std {
  template &lt;class Mutex&gt;
  class shared_lock {
  public:
    using mutex_type = Mutex;

    <span class='comment'>// <a href='thread.lock.shared.cons'>[thread.lock.shared.cons]</a>, construct/copy/destroy
</span>    shared_lock() noexcept;
    explicit shared_lock(mutex_type&amp; m);        <span class='comment'>// blocking
</span>    shared_lock(mutex_type&amp; m, defer_lock_t) noexcept;
    shared_lock(mutex_type&amp; m, try_to_lock_t);
    shared_lock(mutex_type&amp; m, adopt_lock_t);
    template &lt;class Clock, class Duration&gt;
      shared_lock(mutex_type&amp; m, const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    template &lt;class Rep, class Period&gt;
      shared_lock(mutex_type&amp; m, const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    ~shared_lock();

    shared_lock(const shared_lock&amp;) = delete;
    shared_lock&amp; operator=(const shared_lock&amp;) = delete;

    shared_lock(shared_lock&amp;&amp; u) noexcept;
    shared_lock&amp; operator=(shared_lock&amp;&amp; u) noexcept;

    <span class='comment'>// <a href='thread.lock.shared.locking'>[thread.lock.shared.locking]</a>, locking
</span>    void lock();                                <span class='comment'>// blocking
</span>    bool try_lock();
    template &lt;class Rep, class Period&gt;
      bool try_lock_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Clock, class Duration&gt;
      bool try_lock_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    void unlock();

    <span class='comment'>// <a href='thread.lock.shared.mod'>[thread.lock.shared.mod]</a>, modifiers
</span>    void swap(shared_lock&amp; u) noexcept;
    mutex_type* release() noexcept;

    <span class='comment'>// <a href='thread.lock.shared.obs'>[thread.lock.shared.obs]</a>, observers
</span>    bool owns_lock() const noexcept;
    explicit operator bool () const noexcept;
    mutex_type* mutex() const noexcept;

  private:
    mutex_type* pm;                             <span class='comment'>// <span class='textit'>exposition only</span>
</span>    bool owns;                                  <span class='comment'>// <span class='textit'>exposition only</span>
</span>  };

  template&lt;class Mutex&gt; shared_lock(shared_lock&lt;Mutex&gt;) -&gt; shared_lock&lt;Mutex&gt;;

  template &lt;class Mutex&gt;
    void swap(shared_lock&lt;Mutex&gt;&amp; x, shared_lock&lt;Mutex&gt;&amp; y) noexcept;
}</pre><div class='para' id='lock.shared-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2318'>#</a></div><div id='lock.shared-1.sentence-1' class='sentence'>An object of type <span class='texttt'>shared_&shy;lock</span> controls the shared ownership of a
lockable object within a scope<a class='hidden_link' href='#lock.shared-1.sentence-1'>.</a></div> <div id='lock.shared-1.sentence-2' class='sentence'>Shared ownership of the lockable object may be
acquired at construction or after construction, and may be transferred, after
acquisition, to another <span class='texttt'>shared_&shy;lock</span> object<a class='hidden_link' href='#lock.shared-1.sentence-2'>.</a></div> <div id='lock.shared-1.sentence-3' class='sentence'>Objects of type
<span class='texttt'>shared_&shy;lock</span> are not copyable but are movable<a class='hidden_link' href='#lock.shared-1.sentence-3'>.</a></div> <div id='lock.shared-1.sentence-4' class='sentence'>The behavior of a program
is undefined if the contained pointer <span class='texttt'>pm</span> is not null and the lockable
object pointed to by <span class='texttt'>pm</span> does not exist for the entire remaining
<a href='basic.life#def:lifetime'>lifetime</a> of the <span class='texttt'>shared_&shy;lock</span> object<a class='hidden_link' href='#lock.shared-1.sentence-4'>.</a></div> <div id='lock.shared-1.sentence-5' class='sentence'>The supplied
<span class='texttt'>Mutex</span> type shall meet the <a href='thread.sharedtimedmutex.requirements'>shared mutex
requirements</a><a class='hidden_link' href='#lock.shared-1.sentence-5'>.</a></div></div><div class='para' id='lock.shared-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2330'>#</a></div><div id='lock.shared-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#lock.shared-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lock.shared-2.sentence-1' class='sentence'><span class='texttt'>shared_&shy;lock&lt;Mutex&gt;</span> meets the <span class='texttt'>TimedLockable</span>
requirements (<a href='thread.req.lockable.timed'>[thread.req.lockable.timed]</a>)<a class='hidden_link' href='#lock.shared-2.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div id='lock.shared.cons' class='section'><h4 ><a class='secnum' href='#lock.shared.cons' style='min-width:133pt'>33.4.4.4.1</a> <span class='texttt'>shared_&shy;lock</span> constructors, destructor, and assignment <a class='abbr_ref' href='thread.lock.shared.cons'>[thread.lock.shared.cons]</a></h4><span class='indexparent'><a class='index' id='lib:shared_lock,constructor'></a></span><code class='itemdecl'>shared_lock() noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2342'>#</a></div><div id='lock.shared.cons-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>shared_&shy;lock</span><a class='hidden_link' href='#lock.shared.cons-1.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2345'>#</a></div><div id='lock.shared.cons-2.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == nullptr</span> and <span class='texttt'>owns == false</span><a class='hidden_link' href='#lock.shared.cons-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_lock,constructor_'></a></span><code class='itemdecl'>explicit shared_lock(mutex_type&amp; m);
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2355'>#</a></div><div id='lock.shared.cons-3.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread does not own the mutex for any ownership mode<a class='hidden_link' href='#lock.shared.cons-3.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2358'>#</a></div><div id='lock.shared.cons-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>shared_&shy;lock</span> and calls <span class='texttt'>m.lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.cons-4.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2361'>#</a></div><div id='lock.shared.cons-5.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == true</span><a class='hidden_link' href='#lock.shared.cons-5.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_lock,constructor__'></a></span><code class='itemdecl'>shared_lock(mutex_type&amp; m, defer_lock_t) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2371'>#</a></div><div id='lock.shared.cons-6.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>shared_&shy;lock</span><a class='hidden_link' href='#lock.shared.cons-6.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2374'>#</a></div><div id='lock.shared.cons-7.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == false</span><a class='hidden_link' href='#lock.shared.cons-7.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_lock,constructor___'></a></span><code class='itemdecl'>shared_lock(mutex_type&amp; m, try_to_lock_t);
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2384'>#</a></div><div id='lock.shared.cons-8.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread does not own the mutex for any ownership mode<a class='hidden_link' href='#lock.shared.cons-8.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-9'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2387'>#</a></div><div id='lock.shared.cons-9.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>shared_&shy;lock</span> and calls <span class='texttt'>m.try_&shy;lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.cons-9.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-10'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2390'>#</a></div><div id='lock.shared.cons-10.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == res</span>
where <span class='texttt'>res</span> is the
value returned by the call to <span class='texttt'>m.try_&shy;lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.cons-10.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_lock,constructor____'></a></span><code class='itemdecl'>shared_lock(mutex_type&amp; m, adopt_lock_t);
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-11'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2402'>#</a></div><div id='lock.shared.cons-11.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread has shared ownership of the mutex<a class='hidden_link' href='#lock.shared.cons-11.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-12'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2405'>#</a></div><div id='lock.shared.cons-12.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>shared_&shy;lock</span><a class='hidden_link' href='#lock.shared.cons-12.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-13'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2408'>#</a></div><div id='lock.shared.cons-13.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == true</span><a class='hidden_link' href='#lock.shared.cons-13.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_lock,constructor_____'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  shared_lock(mutex_type&amp; m,
              const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-14'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2420'>#</a></div><div id='lock.shared.cons-14.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread does not own the mutex for any ownership mode<a class='hidden_link' href='#lock.shared.cons-14.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-15'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2423'>#</a></div><div id='lock.shared.cons-15.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>shared_&shy;lock</span> and calls
<span class='texttt'>m.try_&shy;lock_&shy;shared_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.shared.cons-15.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-16'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2427'>#</a></div><div id='lock.shared.cons-16.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == res</span>
where <span class='texttt'>res</span>
is the value returned by the call to <span class='texttt'>m.try_&shy;lock_&shy;shared_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.shared.cons-16.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_lock,constructor______'></a></span><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  shared_lock(mutex_type&amp; m,
              const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-17'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2441'>#</a></div><div id='lock.shared.cons-17.sentence-1' class='sentence'><span class='textit'>Requires:</span> The calling thread does not own the mutex for any ownership mode<a class='hidden_link' href='#lock.shared.cons-17.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-18'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2444'>#</a></div><div id='lock.shared.cons-18.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>shared_&shy;lock</span> and calls
<span class='texttt'>m.try_&shy;lock_&shy;shared_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.shared.cons-18.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-19'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2448'>#</a></div><div id='lock.shared.cons-19.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == addressof(m)</span> and <span class='texttt'>owns == res</span>
where <span class='texttt'>res</span> is
the value returned by the call to <span class='texttt'>m.try_&shy;lock_&shy;shared_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.shared.cons-19.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_lock,destructor'></a></span><code class='itemdecl'>~shared_lock();
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-20'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2460'>#</a></div><div id='lock.shared.cons-20.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>owns</span> calls <span class='texttt'>pm-&gt;unlock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.cons-20.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_lock,constructor_______'></a></span><code class='itemdecl'>shared_lock(shared_lock&amp;&amp; sl) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-21'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2470'>#</a></div><div id='lock.shared.cons-21.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == sl_&shy;p.pm</span> and <span class='texttt'>owns == sl_&shy;p.owns</span> (where
<span class='texttt'>sl_&shy;p</span> is the state of <span class='texttt'>sl</span> just prior to this construction),
<span class='texttt'>sl.pm == nullptr</span> and <span class='texttt'>sl.owns == false</span><a class='hidden_link' href='#lock.shared.cons-21.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,operator='></a></span><code class='itemdecl'>shared_lock&amp; operator=(shared_lock&amp;&amp; sl) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.cons-22'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2482'>#</a></div><div id='lock.shared.cons-22.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>owns</span> calls <span class='texttt'>pm-&gt;unlock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.cons-22.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.cons-23'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2485'>#</a></div><div id='lock.shared.cons-23.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == sl_&shy;p.pm</span> and <span class='texttt'>owns == sl_&shy;p.owns</span> (where
<span class='texttt'>sl_&shy;p</span> is the state of <span class='texttt'>sl</span> just prior to this assignment),
<span class='texttt'>sl.pm == nullptr</span> and <span class='texttt'>sl.owns == false</span><a class='hidden_link' href='#lock.shared.cons-23.sentence-1'>.</a></div></div></div></div><div id='lock.shared.locking' class='section'><h4 ><a class='secnum' href='#lock.shared.locking' style='min-width:133pt'>33.4.4.4.2</a> <span class='texttt'>shared_&shy;lock</span> locking <a class='abbr_ref' href='thread.lock.shared.locking'>[thread.lock.shared.locking]</a></h4><span class='indexparent'><a class='index' id='lib:lock,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,lock'></a></span><code class='itemdecl'>void lock();
</code><div class='itemdescr'></div><div class='para' id='lock.shared.locking-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2499'>#</a></div><div id='lock.shared.locking-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.locking-1.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2502'>#</a></div><div id='lock.shared.locking-2.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == true</span><a class='hidden_link' href='#lock.shared.locking-2.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2505'>#</a></div><div id='lock.shared.locking-3.sentence-1' class='sentence'><span class='textit'>Throws:</span> Any exception thrown by <span class='texttt'>pm-&gt;lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.locking-3.sentence-1'>.</a></div> <div id='lock.shared.locking-3.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.shared.locking-3.sentence-2'>.</a></div></div></div><div class='para' id='lock.shared.locking-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2509'>#</a></div><div id='lock.shared.locking-4.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.shared.locking-4.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-4.1'>(4.1)</a></div><div id='lock.shared.locking-4.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'>nullptr</span><a class='hidden_link' href='#lock.shared.locking-4.1.sentence-1'>.</a></div></li><li id='lock.shared.locking-4.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-4.2'>(4.2)</a></div><div id='lock.shared.locking-4.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'>true</span><a class='hidden_link' href='#lock.shared.locking-4.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:try_lock,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,try_lock'></a></span><code class='itemdecl'>bool try_lock();
</code><div class='itemdescr'></div><div class='para' id='lock.shared.locking-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2524'>#</a></div><div id='lock.shared.locking-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.locking-5.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2527'>#</a></div><div id='lock.shared.locking-6.sentence-1' class='sentence'><span class='textit'>Returns:</span> The value returned by the call to <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.locking-6.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2530'>#</a></div><div id='lock.shared.locking-7.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == res</span>, where <span class='texttt'>res</span> is the value returned by
the call to <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.locking-7.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2534'>#</a></div><div id='lock.shared.locking-8.sentence-1' class='sentence'><span class='textit'>Throws:</span> Any exception thrown by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.locking-8.sentence-1'>.</a></div> <div id='lock.shared.locking-8.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.shared.locking-8.sentence-2'>.</a></div></div></div><div class='para' id='lock.shared.locking-9'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2538'>#</a></div><div id='lock.shared.locking-9.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.shared.locking-9.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-9.1'>(9.1)</a></div><div id='lock.shared.locking-9.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'>nullptr</span><a class='hidden_link' href='#lock.shared.locking-9.1.sentence-1'>.</a></div></li><li id='lock.shared.locking-9.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-9.2'>(9.2)</a></div><div id='lock.shared.locking-9.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'>true</span><a class='hidden_link' href='#lock.shared.locking-9.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:try_lock_until,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,try_lock_until'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  bool try_lock_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</code><div class='itemdescr'></div><div class='para' id='lock.shared.locking-10'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2554'>#</a></div><div id='lock.shared.locking-10.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.shared.locking-10.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-11'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2557'>#</a></div><div id='lock.shared.locking-11.sentence-1' class='sentence'><span class='textit'>Returns:</span> The value returned by the call to
<span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.shared.locking-11.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-12'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2561'>#</a></div><div id='lock.shared.locking-12.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == res</span>, where <span class='texttt'>res</span> is the value returned by
the call to <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.shared.locking-12.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-13'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2565'>#</a></div><div id='lock.shared.locking-13.sentence-1' class='sentence'><span class='textit'>Throws:</span> Any exception thrown by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared_&shy;until(abs_&shy;time)</span><a class='hidden_link' href='#lock.shared.locking-13.sentence-1'>.</a></div> <div id='lock.shared.locking-13.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.shared.locking-13.sentence-2'>.</a></div></div></div><div class='para' id='lock.shared.locking-14'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2569'>#</a></div><div id='lock.shared.locking-14.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.shared.locking-14.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-14.1'>(14.1)</a></div><div id='lock.shared.locking-14.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'>nullptr</span><a class='hidden_link' href='#lock.shared.locking-14.1.sentence-1'>.</a></div></li><li id='lock.shared.locking-14.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-14.2'>(14.2)</a></div><div id='lock.shared.locking-14.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'>true</span><a class='hidden_link' href='#lock.shared.locking-14.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:try_lock_for,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,try_lock_for'></a></span><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  bool try_lock_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</code><div class='itemdescr'></div><div class='para' id='lock.shared.locking-15'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2585'>#</a></div><div id='lock.shared.locking-15.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.shared.locking-15.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-16'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2588'>#</a></div><div id='lock.shared.locking-16.sentence-1' class='sentence'><span class='textit'>Returns:</span> The value returned by the call to <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.shared.locking-16.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-17'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2591'>#</a></div><div id='lock.shared.locking-17.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == res</span>, where <span class='texttt'>res</span> is the value returned by the call to <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.shared.locking-17.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-18'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2594'>#</a></div><div id='lock.shared.locking-18.sentence-1' class='sentence'><span class='textit'>Throws:</span> Any exception thrown by <span class='texttt'>pm-&gt;try_&shy;lock_&shy;shared_&shy;for(rel_&shy;time)</span><a class='hidden_link' href='#lock.shared.locking-18.sentence-1'>.</a></div> <div id='lock.shared.locking-18.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.shared.locking-18.sentence-2'>.</a></div></div></div><div class='para' id='lock.shared.locking-19'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2597'>#</a></div><div id='lock.shared.locking-19.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.shared.locking-19.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-19.1'>(19.1)</a></div><div id='lock.shared.locking-19.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'>nullptr</span><a class='hidden_link' href='#lock.shared.locking-19.1.sentence-1'>.</a></div></li><li id='lock.shared.locking-19.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-19.2'>(19.2)</a></div><div id='lock.shared.locking-19.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'>true</span><a class='hidden_link' href='#lock.shared.locking-19.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:unlock,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,unlock'></a></span><code class='itemdecl'>void unlock();
</code><div class='itemdescr'></div><div class='para' id='lock.shared.locking-20'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2612'>#</a></div><div id='lock.shared.locking-20.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>pm-&gt;unlock_&shy;shared()</span><a class='hidden_link' href='#lock.shared.locking-20.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-21'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2615'>#</a></div><div id='lock.shared.locking-21.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>owns == false</span><a class='hidden_link' href='#lock.shared.locking-21.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-22'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2618'>#</a></div><div id='lock.shared.locking-22.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#lock.shared.locking-22.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.locking-23'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2621'>#</a></div><div id='lock.shared.locking-23.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='lock.shared.locking-23.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#lock.shared.locking-23.1'>(23.1)</a></div><div id='lock.shared.locking-23.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'>false</span><a class='hidden_link' href='#lock.shared.locking-23.1.sentence-1'>.</a></div></li></ul></div></div></div></div><div id='lock.shared.mod' class='section'><h4 ><a class='secnum' href='#lock.shared.mod' style='min-width:133pt'>33.4.4.4.3</a> <span class='texttt'>shared_&shy;lock</span> modifiers <a class='abbr_ref' href='thread.lock.shared.mod'>[thread.lock.shared.mod]</a></h4><span class='indexparent'><a class='index' id='lib:swap,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,swap'></a></span><code class='itemdecl'>void swap(shared_lock&amp; sl) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.mod-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.mod-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2637'>#</a></div><div id='lock.shared.mod-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Swaps the data members of <span class='texttt'>*this</span> and <span class='texttt'>sl</span><a class='hidden_link' href='#lock.shared.mod-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:release,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,release'></a></span><code class='itemdecl'>mutex_type* release() noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.mod-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.mod-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2647'>#</a></div><div id='lock.shared.mod-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> The previous value of <span class='texttt'>pm</span><a class='hidden_link' href='#lock.shared.mod-2.sentence-1'>.</a></div></div></div><div class='para' id='lock.shared.mod-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.mod-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2650'>#</a></div><div id='lock.shared.mod-3.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>pm == nullptr</span> and <span class='texttt'>owns == false</span><a class='hidden_link' href='#lock.shared.mod-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:swap,shared_lock_'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,swap_'></a></span><code class='itemdecl'>template &lt;class Mutex&gt;
  void swap(shared_lock&lt;Mutex&gt;&amp; x, shared_lock&lt;Mutex&gt;&amp; y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.mod-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.mod-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2661'>#</a></div><div id='lock.shared.mod-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>x.swap(y)</span><a class='hidden_link' href='#lock.shared.mod-4.sentence-1'>.</a></div></div></div></div><div id='lock.shared.obs' class='section'><h4 ><a class='secnum' href='#lock.shared.obs' style='min-width:133pt'>33.4.4.4.4</a> <span class='texttt'>shared_&shy;lock</span> observers <a class='abbr_ref' href='thread.lock.shared.obs'>[thread.lock.shared.obs]</a></h4><span class='indexparent'><a class='index' id='lib:owns_lock,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,owns_lock'></a></span><code class='itemdecl'>bool owns_lock() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.obs-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.obs-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2673'>#</a></div><div id='lock.shared.obs-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>owns</span><a class='hidden_link' href='#lock.shared.obs-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator_bool,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,operator_bool'></a></span><code class='itemdecl'>explicit operator bool() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.obs-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.obs-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2683'>#</a></div><div id='lock.shared.obs-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>owns</span><a class='hidden_link' href='#lock.shared.obs-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:mutex,shared_lock'></a></span><span class='indexparent'><a class='index' id='lib:shared_lock,mutex'></a></span><code class='itemdecl'>mutex_type* mutex() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='lock.shared.obs-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.obs-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2693'>#</a></div><div id='lock.shared.obs-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>pm</span><a class='hidden_link' href='#lock.shared.obs-3.sentence-1'>.</a></div></div></div></div></div></div><div id='lock.algorithm' class='section'><h3 ><a class='secnum' href='#lock.algorithm' style='min-width:103pt'>33.4.5</a> Generic locking algorithms <a class='abbr_ref' href='thread.lock.algorithm'>[thread.lock.algorithm]</a></h3><div id='lock.algorithm-sentence-1' class='sentence'><div id='lib:try_lock'>
<code class='itemdecl'>template &lt;class L1, class L2, class... L3&gt; int try_lock(L1&amp;, L2&amp;, L3&amp;...);
</code>
</div></div><div class='itemdescr'></div><div class='para' id='lock.algorithm-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2706'>#</a></div><div id='lock.algorithm-1.sentence-1' class='sentence'><span class='textit'>Requires:</span> Each template parameter type shall meet the <span class='texttt'>Lockable</span> requirements<a class='hidden_link' href='#lock.algorithm-1.sentence-1'>.</a></div> <div id='lock.algorithm-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#lock.algorithm-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lock.algorithm-1.sentence-2' class='sentence'>The
<span class='texttt'>unique_&shy;lock</span> class template meets these requirements when suitably instantiated<a class='hidden_link' href='#lock.algorithm-1.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='lock.algorithm-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2711'>#</a></div><div id='lock.algorithm-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Calls <span class='texttt'>try_&shy;lock()</span> for each argument in order beginning with the
first until all arguments have been processed or a call to <span class='texttt'>try_&shy;lock()</span> fails,
either by returning <span class='texttt'>false</span> or by throwing an exception<a class='hidden_link' href='#lock.algorithm-2.sentence-1'>.</a></div> <div id='lock.algorithm-2.sentence-2' class='sentence'>If a call to
<span class='texttt'>try_&shy;lock()</span> fails, <span class='texttt'>unlock()</span> shall be called for all prior arguments
and there shall be no further calls to <span class='texttt'>try_&shy;lock()</span><a class='hidden_link' href='#lock.algorithm-2.sentence-2'>.</a></div></div></div><div class='para' id='lock.algorithm-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2718'>#</a></div><div id='lock.algorithm-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>-1</span> if all calls to <span class='texttt'>try_&shy;lock()</span> returned <span class='texttt'>true</span>,
otherwise a zero-based index value that indicates the argument for which <span class='texttt'>try_&shy;lock()</span>
returned <span class='texttt'>false</span><a class='hidden_link' href='#lock.algorithm-3.sentence-1'>.</a></div></div></div><div id='lock.algorithm-sentence-1' class='sentence'><div id='lib:lock'>
<code class='itemdecl'>template &lt;class L1, class L2, class... L3&gt; void lock(L1&amp;, L2&amp;, L3&amp;...);
</code>
</div></div><div class='itemdescr'></div><div class='para' id='lock.algorithm-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2731'>#</a></div><div id='lock.algorithm-4.sentence-1' class='sentence'><span class='textit'>Requires:</span> Each template parameter type shall meet the <span class='texttt'>Lockable</span> requirements,
<div id='lock.algorithm-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#lock.algorithm-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lock.algorithm-4.sentence-2' class='sentence'>The
<span class='texttt'>unique_&shy;lock</span> class template meets these requirements when suitably instantiated<a class='hidden_link' href='#lock.algorithm-4.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div><div class='para' id='lock.algorithm-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2737'>#</a></div><div id='lock.algorithm-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> All arguments are locked via a sequence of calls to <span class='texttt'>lock()</span>,
<span class='texttt'>try_&shy;lock()</span>, or <span class='texttt'>unlock()</span> on each argument<a class='hidden_link' href='#lock.algorithm-5.sentence-1'>.</a></div> <div id='lock.algorithm-5.sentence-2' class='sentence'>The sequence of calls shall
not result in deadlock, but is otherwise unspecified<a class='hidden_link' href='#lock.algorithm-5.sentence-2'>.</a></div> <div id='lock.algorithm-5.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#lock.algorithm-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lock.algorithm-5.sentence-4' class='sentence'>A deadlock avoidance
algorithm such as try-and-back-off must be used, but the specific algorithm is not
specified to avoid over-constraining implementations<a class='hidden_link' href='#lock.algorithm-5.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='lock.algorithm-5.sentence-3' class='sentence'> If a call to
<span class='texttt'>lock()</span> or <span class='texttt'>try_&shy;lock()</span> throws an exception, <span class='texttt'>unlock()</span> shall be
called for any argument that had been locked by a call to <span class='texttt'>lock()</span> or
<span class='texttt'>try_&shy;lock()</span><a class='hidden_link' href='#lock.algorithm-5.sentence-3'>.</a></div></div></div></div><div id='once' class='section'><h3 ><a class='secnum' href='#once' style='min-width:103pt'>33.4.6</a> Call once <a class='abbr_ref' href='thread.once'>[thread.once]</a></h3><div id='once.onceflag' class='section'><h4 ><a class='secnum' href='#once.onceflag' style='min-width:118pt'>33.4.6.1</a> Struct <span class='texttt'>once_&shy;flag</span> <a class='abbr_ref' href='thread.once.onceflag'>[thread.once.onceflag]</a></h4><span class='indexparent'><a class='index' id='lib:once_flag'></a></span><pre class='codeblock'>
namespace std {
  struct once_flag {
    constexpr once_flag() noexcept;

    once_flag(const once_flag&amp;) = delete;
    once_flag&amp; operator=(const once_flag&amp;) = delete;
  };
}</pre><div class='para' id='once.onceflag-1'><div class='marginalizedparent'><a class='marginalized' href='#once.onceflag-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2764'>#</a></div><div id='once.onceflag-1.sentence-1' class='sentence'>The class <span class='texttt'>once_&shy;flag</span> is an opaque data structure that <span class='texttt'>call_&shy;once</span> uses to
initialize data without causing a data race or deadlock<a class='hidden_link' href='#once.onceflag-1.sentence-1'>.</a></div> <span class='indexparent'><a class='index' id='lib:once_flag_'></a></span></div><code class='itemdecl'>constexpr once_flag() noexcept;
</code><div class='itemdescr'></div><div class='para' id='once.onceflag-2'><div class='marginalizedparent'><a class='marginalized' href='#once.onceflag-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2774'>#</a></div><div id='once.onceflag-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>once_&shy;flag</span><a class='hidden_link' href='#once.onceflag-2.sentence-1'>.</a></div></div></div><div class='para' id='once.onceflag-3'><div class='marginalizedparent'><a class='marginalized' href='#once.onceflag-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2776'>#</a></div><div id='once.onceflag-3.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> The construction of a <span class='texttt'>once_&shy;flag</span> object is not synchronized<a class='hidden_link' href='#once.onceflag-3.sentence-1'>.</a></div></div></div><div class='para' id='once.onceflag-4'><div class='marginalizedparent'><a class='marginalized' href='#once.onceflag-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2778'>#</a></div><div id='once.onceflag-4.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> The object's internal state is set to indicate to an invocation of
<span class='texttt'>call_&shy;once</span> with the object as its initial argument that no function has been
called<a class='hidden_link' href='#once.onceflag-4.sentence-1'>.</a></div></div></div></div><div id='once.callonce' class='section'><h4 ><a class='secnum' href='#once.callonce' style='min-width:118pt'>33.4.6.2</a> Function <span class='texttt'>call_&shy;once</span> <a class='abbr_ref' href='thread.once.callonce'>[thread.once.callonce]</a></h4><span class='indexparent'><a class='index' id='lib:call_once'></a></span><code class='itemdecl'>template&lt;class Callable, class... Args&gt;
  void call_once(once_flag&amp; flag, Callable&amp;&amp; func, Args&amp;&amp;... args);
</code><div class='itemdescr'></div><div class='para' id='once.callonce-1'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2792'>#</a></div><div id='once.callonce-1.sentence-1' class='sentence'><span class='textit'>Requires:</span> 
<pre class='codeblock'>
<span class='textit'>INVOKE</span>(std::forward&lt;Callable&gt;(func), std::forward&lt;Args&gt;(args)...)</pre>
(see <a href='func.require'>[func.require]</a>) shall be a valid expression<a class='hidden_link' href='#once.callonce-1.sentence-1'>.</a></div></div></div><div class='para' id='once.callonce-2'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2799'>#</a></div><div id='once.callonce-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> An execution of <span class='texttt'>call_&shy;once</span> that does not call its <span class='texttt'>func</span> is a
<a class='hidden_link' href='#def:passive' id='def:passive'><i>passive</i></a> execution<a class='hidden_link' href='#once.callonce-2.sentence-1'>.</a></div> <div id='once.callonce-2.sentence-2' class='sentence'>An execution of <span class='texttt'>call_&shy;once</span> that calls its <span class='texttt'>func</span>
is an <a class='hidden_link' href='#def:active' id='def:active'><i>active</i></a> execution<a class='hidden_link' href='#once.callonce-2.sentence-2'>.</a></div> <div id='once.callonce-2.sentence-3' class='sentence'>An active execution shall call
<span class='texttt'><span class='textit'>INVOKE</span>(&#x200b;std&#x200b;::&#x200b;forward&lt;Callable&gt;(func),
std&#x200b;::&#x200b;forward&lt;Args&gt;(args)...)</span><a class='hidden_link' href='#once.callonce-2.sentence-3'>.</a></div> <div id='once.callonce-2.sentence-4' class='sentence'>If such a call to <span class='texttt'>func</span>
throws an exception the execution is <a class='hidden_link' href='#def:exceptional' id='def:exceptional'><i>exceptional</i></a>, otherwise it is <a class='hidden_link' href='#def:returning' id='def:returning'><i>returning</i></a><a class='hidden_link' href='#once.callonce-2.sentence-4'>.</a></div> <div id='once.callonce-2.sentence-5' class='sentence'>An exceptional execution shall propagate the exception to the caller of
<span class='texttt'>call_&shy;once</span><a class='hidden_link' href='#once.callonce-2.sentence-5'>.</a></div> <div id='once.callonce-2.sentence-6' class='sentence'>Among all executions of <span class='texttt'>call_&shy;once</span> for any given
<span class='texttt'>once_&shy;flag</span>: at most one shall be a returning execution; if there is a
returning execution, it shall be the last active execution; and there are
passive executions only if there is a returning execution<a class='hidden_link' href='#once.callonce-2.sentence-6'>.</a></div> <div id='once.callonce-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#once.callonce-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='once.callonce-2.sentence-7' class='sentence'>Passive
executions allow other threads to reliably observe the results produced by the
earlier returning execution<a class='hidden_link' href='#once.callonce-2.sentence-7'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='once.callonce-3'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2815'>#</a></div><div id='once.callonce-3.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> For any given <span class='texttt'>once_&shy;flag</span>: all active executions occur in a total
order; completion of an active execution <a href='intro.multithread#def:synchronize_with'>synchronizes with</a>
the start of the next one in this total order; and the returning execution
synchronizes with the return from all passive executions<a class='hidden_link' href='#once.callonce-3.sentence-1'>.</a></div></div></div><div class='para' id='once.callonce-4'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2821'>#</a></div><div id='once.callonce-4.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>), or any exception thrown by <span class='texttt'>func</span><a class='hidden_link' href='#once.callonce-4.sentence-1'>.</a></div></div></div><div class='para' id='once.callonce-5'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2824'>#</a></div><div id='once.callonce-5.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#once.callonce-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='comment'>// global flag, regular function
</span>void init();
std::once_flag flag;

void f() {
  std::call_once(flag, init);
}

<span class='comment'>// function static flag, function object
</span>struct initializer {
  void operator()();
};

void g() {
  static std::once_flag flag2;
  std::call_once(flag2, initializer());
}

<span class='comment'>// object flag, member function
</span>class information {
  std::once_flag verified;
  void verifier();
public:
  void verify() { std::call_once(verified, &amp;information::verifier, *this); }
};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div></div></div><div id='condition' class='section'><h2 ><a class='secnum' href='#condition' style='min-width:88pt'>33.5</a> Condition variables <a class='abbr_ref' href='thread.condition'>[thread.condition]</a></h2><div class='para' id='condition-1'><div class='marginalizedparent'><a class='marginalized' href='#condition-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2859'>#</a></div><div id='condition-1.sentence-1' class='sentence'>Condition variables provide synchronization primitives used to block a thread until
notified by some other thread that some condition is met or until a system time is
reached<a class='hidden_link' href='#condition-1.sentence-1'>.</a></div> <div id='condition-1.sentence-2' class='sentence'>Class <span class='texttt'>condition_&shy;variable</span> provides a condition variable that can only
wait on an object of type <span class='texttt'>unique_&shy;lock&lt;mutex&gt;</span>, allowing maximum efficiency on some
platforms<a class='hidden_link' href='#condition-1.sentence-2'>.</a></div> <div id='condition-1.sentence-3' class='sentence'>Class <span class='texttt'>condition_&shy;variable_&shy;any</span> provides a general condition variable
that can wait on objects of user-supplied lock types<a class='hidden_link' href='#condition-1.sentence-3'>.</a></div></div><div class='para' id='condition-2'><div class='marginalizedparent'><a class='marginalized' href='#condition-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2867'>#</a></div><div id='condition-2.sentence-1' class='sentence'>Condition variables permit concurrent invocation of the <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>,
<span class='texttt'>wait_&shy;until</span>, <span class='texttt'>notify_&shy;one</span> and <span class='texttt'>notify_&shy;all</span> member functions<a class='hidden_link' href='#condition-2.sentence-1'>.</a></div></div><div class='para' id='condition-3'><div class='marginalizedparent'><a class='marginalized' href='#condition-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2871'>#</a></div><div id='condition-3.sentence-1' class='sentence'>The execution of <span class='texttt'>notify_&shy;one</span> and <span class='texttt'>notify_&shy;all</span> shall be atomic<a class='hidden_link' href='#condition-3.sentence-1'>.</a></div> <div id='condition-3.sentence-2' class='sentence'>The
execution of <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, and <span class='texttt'>wait_&shy;until</span> shall be performed
in three atomic parts:</div><div id='condition-3.sentence-3' class='sentence'><ol class='enumerate'><li id='condition-3.1'><a class='enumerated_item_num' href='#condition-3.1'>1.</a><div id='condition-3.1.sentence-1' class='sentence'>the release of the mutex and entry into the waiting state;</div></li><li id='condition-3.2'><a class='enumerated_item_num' href='#condition-3.2'>2.</a><div id='condition-3.2.sentence-1' class='sentence'>the unblocking of the wait; and</div></li><li id='condition-3.3'><a class='enumerated_item_num' href='#condition-3.3'>3.</a><div id='condition-3.3.sentence-1' class='sentence'>the reacquisition of the lock<a class='hidden_link' href='#condition-3.3.sentence-1'>.</a></div></li></ol></div></div><div class='para' id='condition-4'><div class='marginalizedparent'><a class='marginalized' href='#condition-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2882'>#</a></div><div id='condition-4.sentence-1' class='sentence'>The implementation shall behave as if all executions of <span class='texttt'>notify_&shy;one</span>, <span class='texttt'>notify_&shy;all</span>, and each
part of the <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, and <span class='texttt'>wait_&shy;until</span> executions are
executed in a single unspecified total order consistent with the "happens before" order<a class='hidden_link' href='#condition-4.sentence-1'>.</a></div></div><div class='para' id='condition-5'><div class='marginalizedparent'><a class='marginalized' href='#condition-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2887'>#</a></div><div id='condition-5.sentence-1' class='sentence'>Condition variable construction and destruction need not be synchronized<a class='hidden_link' href='#condition-5.sentence-1'>.</a></div></div><div id='condition_variable.syn' class='section'><h3 ><a class='secnum' href='#condition_variable.syn' style='min-width:103pt'>33.5.1</a> Header <span class='texttt'>&lt;condition_&shy;variable&gt;</span> synopsis <a class='abbr_ref' href='condition_variable.syn'>[condition_variable.syn]</a></h3><div id='condition_variable.syn-sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':<condition_variable>'></a></span><span class='indexparent'><a class='index' id='lib:<condition_variable>'></a></span>
<span class='indexparent'><a class='index' id='lib:cv_status'></a></span><pre class='codeblock'>
namespace std {
  class condition_variable;
  class condition_variable_any;

  void notify_all_at_thread_exit(condition_variable&amp; cond, unique_lock&lt;mutex&gt; lk);

  enum class cv_status { no_timeout, timeout };
}</pre></div></div><div id='condition.nonmember' class='section'><h3 ><a class='secnum' href='#condition.nonmember' style='min-width:103pt'>33.5.2</a> Non-member functions <a class='abbr_ref' href='thread.condition.nonmember'>[thread.condition.nonmember]</a></h3><span class='indexparent'><a class='index' id='lib:notify_all_at_thread_exit'></a></span><code class='itemdecl'>void notify_all_at_thread_exit(condition_variable&amp; cond, unique_lock&lt;mutex&gt; lk);
</code><div class='itemdescr'></div><div class='para' id='condition.nonmember-1'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2913'>#</a></div><div id='condition.nonmember-1.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>lk</span> is locked by the calling thread and either</div><div id='condition.nonmember-1.sentence-2' class='sentence'><ul class='itemize'><li id='condition.nonmember-1.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.nonmember-1.1'>(1.1)</a></div><div id='condition.nonmember-1.1.sentence-1' class='sentence'>no other thread is waiting on <span class='texttt'>cond</span>, or</div></li><li id='condition.nonmember-1.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.nonmember-1.2'>(1.2)</a></div><div id='condition.nonmember-1.2.sentence-1' class='sentence'><span class='texttt'>lk.mutex()</span> returns the same value for each of the lock arguments
supplied by all concurrently waiting (via <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>,
or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.nonmember-1.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.nonmember-2'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2923'>#</a></div><div id='condition.nonmember-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Transfers ownership of the lock associated with <span class='texttt'>lk</span> into
internal storage and schedules <span class='texttt'>cond</span> to be notified when the current
thread exits, after all objects of thread storage duration associated with
the current thread have been destroyed<a class='hidden_link' href='#condition.nonmember-2.sentence-1'>.</a></div> <div id='condition.nonmember-2.sentence-2' class='sentence'>This notification shall be as if:
<pre class='codeblock'>
lk.unlock();
cond.notify_all();</pre></div></div></div><div class='para' id='condition.nonmember-3'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2933'>#</a></div><div id='condition.nonmember-3.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> The implied <span class='texttt'>lk.unlock()</span> call is sequenced after the destruction of
all objects with thread storage duration associated with the current thread<a class='hidden_link' href='#condition.nonmember-3.sentence-1'>.</a></div></div></div><div class='para' id='condition.nonmember-4'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2937'>#</a></div><div id='condition.nonmember-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.nonmember-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.nonmember-4.sentence-1' class='sentence'>The supplied lock will be held until the thread exits, and care
should be taken to ensure that this does not cause deadlock due to lock
ordering issues<a class='hidden_link' href='#condition.nonmember-4.sentence-1'>.</a></div> <div id='condition.nonmember-4.sentence-2' class='sentence'>After calling <span class='texttt'>notify_&shy;all_&shy;at_&shy;thread_&shy;exit</span> it is
recommended that the thread should be exited as soon as possible, and
that no blocking or time-consuming tasks are run on that thread<a class='hidden_link' href='#condition.nonmember-4.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.nonmember-5'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2946'>#</a></div><div id='condition.nonmember-5.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.nonmember-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.nonmember-5.sentence-1' class='sentence'>It is the user's responsibility to ensure that waiting threads
do not erroneously assume that the thread has finished if they experience
spurious wakeups<a class='hidden_link' href='#condition.nonmember-5.sentence-1'>.</a></div> <div id='condition.nonmember-5.sentence-2' class='sentence'>This typically requires that the condition being waited
for is satisfied while holding the lock on <span class='texttt'>lk</span>, and that this lock
is not released and reacquired prior to calling <span class='texttt'>notify_&shy;all_&shy;at_&shy;thread_&shy;exit</span><a class='hidden_link' href='#condition.nonmember-5.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div><div id='condition.condvar' class='section'><h3 ><a class='secnum' href='#condition.condvar' style='min-width:103pt'>33.5.3</a> Class <span class='texttt'>condition_&shy;variable</span> <a class='abbr_ref' href='thread.condition.condvar'>[thread.condition.condvar]</a></h3><span class='indexparent'><a class='index' id='lib:condition_variable'></a></span><pre class='codeblock'>
namespace std {
  class condition_variable {
  public:
    condition_variable();
    ~condition_variable();

    condition_variable(const condition_variable&amp;) = delete;
    condition_variable&amp; operator=(const condition_variable&amp;) = delete;

    void notify_one() noexcept;
    void notify_all() noexcept;
    void wait(unique_lock&lt;mutex&gt;&amp; lock);
    template &lt;class Predicate&gt;
      void wait(unique_lock&lt;mutex&gt;&amp; lock, Predicate pred);
    template &lt;class Clock, class Duration&gt;
      cv_status wait_until(unique_lock&lt;mutex&gt;&amp; lock,
                           const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    template &lt;class Clock, class Duration, class Predicate&gt;
      bool wait_until(unique_lock&lt;mutex&gt;&amp; lock,
                      const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time,
                      Predicate pred);
    template &lt;class Rep, class Period&gt;
      cv_status wait_for(unique_lock&lt;mutex&gt;&amp; lock,
                         const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Rep, class Period, class Predicate&gt;
      bool wait_for(unique_lock&lt;mutex&gt;&amp; lock,
                    const chrono::duration&lt;Rep, Period&gt;&amp; rel_time,
                    Predicate pred);

    using native_handle_type = <span class='textit'>implementation-defined</span>;          <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>    native_handle_type native_handle();                         <span class='comment'>// see <a href='thread.req.native'>[thread.req.native]</a>
</span>  };
}</pre><div class='para' id='condition.condvar-1'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L2995'>#</a></div><div id='condition.condvar-1.sentence-1' class='sentence'>The class <span class='texttt'>condition_&shy;variable</span> shall be a standard-layout class (<a href='class'>[class]</a>)<a class='hidden_link' href='#condition.condvar-1.sentence-1'>.</a></div> <span class='indexparent'><a class='index' id='lib:condition_variable,constructor'></a></span></div><code class='itemdecl'>condition_variable();
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-2'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3004'>#</a></div><div id='condition.condvar-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>condition_&shy;variable</span><a class='hidden_link' href='#condition.condvar-2.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-3'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3007'>#</a></div><div id='condition.condvar-3.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#condition.condvar-3.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-4'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3010'>#</a></div><div id='condition.condvar-4.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='condition.condvar-4.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-4.1'>(4.1)</a></div><div id='condition.condvar-4.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if some non-memory resource
limitation prevents initialization<a class='hidden_link' href='#condition.condvar-4.1.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:condition_variable,destructor'></a></span><code class='itemdecl'>~condition_variable();
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-5'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3024'>#</a></div><div id='condition.condvar-5.sentence-1' class='sentence'><span class='textit'>Requires:</span> There shall be no thread blocked on <span class='texttt'>*this</span><a class='hidden_link' href='#condition.condvar-5.sentence-1'>.</a></div> <div id='condition.condvar-5.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-5.sentence-2' class='sentence'>That is, all
threads shall have been notified; they may subsequently block on the lock specified in the
wait<a class='hidden_link' href='#condition.condvar-5.sentence-2'>.</a></div> <div id='condition.condvar-5.sentence-3' class='sentence'>This relaxes the usual rules, which would have required all wait calls to happen before
destruction<a class='hidden_link' href='#condition.condvar-5.sentence-3'>.</a></div> <div id='condition.condvar-5.sentence-4' class='sentence'>Only the notification to unblock the wait needs to happen before destruction<a class='hidden_link' href='#condition.condvar-5.sentence-4'>.</a></div> <div id='condition.condvar-5.sentence-5' class='sentence'>The user should take care to ensure that no threads wait on <span class='texttt'>*this</span> once the destructor has
been started, especially when the waiting threads are calling the wait functions in a loop or
using the overloads of <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span> that take a predicate<a class='hidden_link' href='#condition.condvar-5.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-6'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3035'>#</a></div><div id='condition.condvar-6.sentence-1' class='sentence'><span class='textit'>Effects:</span> Destroys the object<a class='hidden_link' href='#condition.condvar-6.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:notify_one,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,notify_one'></a></span><code class='itemdecl'>void notify_one() noexcept;
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-7'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3044'>#</a></div><div id='condition.condvar-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> If any threads are blocked waiting for <span class='texttt'>*this</span>, unblocks one of those threads<a class='hidden_link' href='#condition.condvar-7.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:notify_all,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,notify_all'></a></span><code class='itemdecl'>void notify_all() noexcept;
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-8'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3053'>#</a></div><div id='condition.condvar-8.sentence-1' class='sentence'><span class='textit'>Effects:</span> Unblocks all threads that are blocked waiting for <span class='texttt'>*this</span><a class='hidden_link' href='#condition.condvar-8.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait'></a></span><code class='itemdecl'>void wait(unique_lock&lt;mutex&gt;&amp; lock);
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-9'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3062'>#</a></div><div id='condition.condvar-9.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-9.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-9.1'>(9.1)</a></div><div id='condition.condvar-9.1.sentence-1' class='sentence'>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</div></li><li id='condition.condvar-9.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-9.2'>(9.2)</a></div><div id='condition.condvar-9.2.sentence-1' class='sentence'><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-9.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvar-10'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3072'>#</a></div><div id='condition.condvar-10.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='condition.condvar-10.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-10.1'>(10.1)</a></div><div id='condition.condvar-10.1.sentence-1' class='sentence'>Atomically calls <span class='texttt'>lock.unlock()</span> and blocks on <span class='texttt'>*this</span><a class='hidden_link' href='#condition.condvar-10.1.sentence-1'>.</a></div></li><li id='condition.condvar-10.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-10.2'>(10.2)</a></div><div id='condition.condvar-10.2.sentence-1' class='sentence'>When unblocked, calls <span class='texttt'>lock.lock()</span> (possibly blocking on the lock), then returns<a class='hidden_link' href='#condition.condvar-10.2.sentence-1'>.</a></div></li><li id='condition.condvar-10.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-10.3'>(10.3)</a></div><div id='condition.condvar-10.3.sentence-1' class='sentence'>The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one()</span>
or a call to <span class='texttt'>notify_&shy;all()</span>, or spuriously<a class='hidden_link' href='#condition.condvar-10.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvar-11'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3080'>#</a></div><div id='condition.condvar-11.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvar-11.sentence-1'>.</a></div> <div id='condition.condvar-11.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-11.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-11.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-12'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3086'>#</a></div><div id='condition.condvar-12.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-12.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-13'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3090'>#</a></div><div id='condition.condvar-13.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#condition.condvar-13.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait,condition_variable_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_'></a></span><code class='itemdecl'>template &lt;class Predicate&gt;
  void wait(unique_lock&lt;mutex&gt;&amp; lock, Predicate pred);
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-14'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3101'>#</a></div><div id='condition.condvar-14.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span> is
locked by the calling thread, and either</div><div id='condition.condvar-14.sentence-2' class='sentence'><ul class='itemize'><li id='condition.condvar-14.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-14.1'>(14.1)</a></div><div id='condition.condvar-14.1.sentence-1' class='sentence'>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</div></li><li id='condition.condvar-14.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-14.2'>(14.2)</a></div><div id='condition.condvar-14.2.sentence-1' class='sentence'><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-14.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvar-15'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3112'>#</a></div><div id='condition.condvar-15.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to:
<pre class='codeblock'>
while (!pred())
  wait(lock);</pre></div></div></div><div class='para' id='condition.condvar-16'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3119'>#</a></div><div id='condition.condvar-16.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvar-16.sentence-1'>.</a></div> <div id='condition.condvar-16.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-16.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-16.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-17'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3125'>#</a></div><div id='condition.condvar-17.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-17.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-18'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3129'>#</a></div><div id='condition.condvar-18.sentence-1' class='sentence'><span class='textit'>Throws:</span> Any exception thrown by <span class='texttt'>pred</span><a class='hidden_link' href='#condition.condvar-18.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_until,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_until'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  cv_status wait_until(unique_lock&lt;mutex&gt;&amp; lock,
                       const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-19'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3142'>#</a></div><div id='condition.condvar-19.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-19.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-19.1'>(19.1)</a></div><div id='condition.condvar-19.1.sentence-1' class='sentence'>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</div></li><li id='condition.condvar-19.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-19.2'>(19.2)</a></div><div id='condition.condvar-19.2.sentence-1' class='sentence'><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-19.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvar-20'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3152'>#</a></div><div id='condition.condvar-20.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='condition.condvar-20.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-20.1'>(20.1)</a></div><div id='condition.condvar-20.1.sentence-1' class='sentence'>Atomically calls <span class='texttt'>lock.unlock()</span> and blocks on <span class='texttt'>*this</span><a class='hidden_link' href='#condition.condvar-20.1.sentence-1'>.</a></div></li><li id='condition.condvar-20.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-20.2'>(20.2)</a></div><div id='condition.condvar-20.2.sentence-1' class='sentence'>When unblocked, calls <span class='texttt'>lock.lock()</span> (possibly blocking on the lock), then returns<a class='hidden_link' href='#condition.condvar-20.2.sentence-1'>.</a></div></li><li id='condition.condvar-20.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-20.3'>(20.3)</a></div><div id='condition.condvar-20.3.sentence-1' class='sentence'>The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one()</span>, a call to <span class='texttt'>notify_&shy;all()</span>,
expiration of the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>abs_&shy;time</span>,
or spuriously<a class='hidden_link' href='#condition.condvar-20.3.sentence-1'>.</a></div></li><li id='condition.condvar-20.4'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-20.4'>(20.4)</a></div><div id='condition.condvar-20.4.sentence-1' class='sentence'>If the function exits via an exception, <span class='texttt'>lock.lock()</span> shall be called prior to exiting the function<a class='hidden_link' href='#condition.condvar-20.4.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvar-21'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3170'>#</a></div><div id='condition.condvar-21.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvar-21.sentence-1'>.</a></div> <div id='condition.condvar-21.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-21.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-21.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-21.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-22'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3176'>#</a></div><div id='condition.condvar-22.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-22.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-23'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3180'>#</a></div><div id='condition.condvar-23.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;timeout</span> if
the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>abs_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;no_&shy;timeout</span><a class='hidden_link' href='#condition.condvar-23.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-24'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3185'>#</a></div><div id='condition.condvar-24.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#condition.condvar-24.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_for,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_for'></a></span><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  cv_status wait_for(unique_lock&lt;mutex&gt;&amp; lock,
                     const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-25'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3198'>#</a></div><div id='condition.condvar-25.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-25.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-25.1'>(25.1)</a></div><div id='condition.condvar-25.1.sentence-1' class='sentence'>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</div></li><li id='condition.condvar-25.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-25.2'>(25.2)</a></div><div id='condition.condvar-25.2.sentence-1' class='sentence'><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span> arguments
supplied by all concurrently waiting (via <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or
<span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-25.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvar-26'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3208'>#</a></div><div id='condition.condvar-26.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to:
<pre class='codeblock'>
return wait_until(lock, chrono::steady_clock::now() + rel_time);</pre></div></div></div><div class='para' id='condition.condvar-27'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3214'>#</a></div><div id='condition.condvar-27.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;timeout</span> if
the relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>rel_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;no_&shy;timeout</span><a class='hidden_link' href='#condition.condvar-27.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-28'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3219'>#</a></div><div id='condition.condvar-28.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvar-28.sentence-1'>.</a></div> <div id='condition.condvar-28.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-28.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-28.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-28.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-29'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3225'>#</a></div><div id='condition.condvar-29.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-29.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-30'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-30'>30</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3229'>#</a></div><div id='condition.condvar-30.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#condition.condvar-30.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_until,condition_variable_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_until_'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration, class Predicate&gt;
  bool wait_until(unique_lock&lt;mutex&gt;&amp; lock,
                  const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time,
                  Predicate pred);
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-31'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-31'>31</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3244'>#</a></div><div id='condition.condvar-31.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span> is
locked by the calling thread, and either</div><div id='condition.condvar-31.sentence-2' class='sentence'><ul class='itemize'><li id='condition.condvar-31.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-31.1'>(31.1)</a></div><div id='condition.condvar-31.1.sentence-1' class='sentence'>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</div></li><li id='condition.condvar-31.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-31.2'>(31.2)</a></div><div id='condition.condvar-31.2.sentence-1' class='sentence'><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-31.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvar-32'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-32'>32</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3255'>#</a></div><div id='condition.condvar-32.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to:
<pre class='codeblock'>
while (!pred())
  if (wait_until(lock, abs_time) == cv_status::timeout)
    return pred();
return true;</pre></div></div></div><div class='para' id='condition.condvar-33'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-33'>33</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3264'>#</a></div><div id='condition.condvar-33.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvar-33.sentence-1'>.</a></div> <div id='condition.condvar-33.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-33.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-33.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-33.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-34'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-34'>34</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3270'>#</a></div><div id='condition.condvar-34.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-34.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-35'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-35'>35</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3274'>#</a></div><div id='condition.condvar-35.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-35.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-35.sentence-1' class='sentence'>The returned value indicates whether the predicate evaluated to
<span class='texttt'>true</span> regardless of whether the timeout was triggered<a class='hidden_link' href='#condition.condvar-35.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-36'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-36'>36</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3278'>#</a></div><div id='condition.condvar-36.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>) or any exception thrown by <span class='texttt'>pred</span><a class='hidden_link' href='#condition.condvar-36.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_for,condition_variable_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_for_'></a></span><code class='itemdecl'>template &lt;class Rep, class Period, class Predicate&gt;
  bool wait_for(unique_lock&lt;mutex&gt;&amp; lock,
                const chrono::duration&lt;Rep, Period&gt;&amp; rel_time,
                Predicate pred);
</code><div class='itemdescr'></div><div class='para' id='condition.condvar-37'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-37'>37</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3293'>#</a></div><div id='condition.condvar-37.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-37.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-37.1'>(37.1)</a></div><div id='condition.condvar-37.1.sentence-1' class='sentence'>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</div></li><li id='condition.condvar-37.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvar-37.2'>(37.2)</a></div><div id='condition.condvar-37.2.sentence-1' class='sentence'><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span> arguments
supplied by all concurrently waiting (via <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or
<span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-37.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvar-38'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-38'>38</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3306'>#</a></div><div id='condition.condvar-38.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to:
<pre class='codeblock'>
return wait_until(lock, chrono::steady_clock::now() + rel_time, std::move(pred));</pre></div></div></div><div class='para' id='condition.condvar-39'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-39'>39</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3312'>#</a></div><div id='condition.condvar-39.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-39.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-39.sentence-1' class='sentence'>There is no blocking if <span class='texttt'>pred()</span> is initially <span class='texttt'>true</span>, even if the
timeout has already expired<a class='hidden_link' href='#condition.condvar-39.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-40'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-40'>40</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3316'>#</a></div><div id='condition.condvar-40.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvar-40.sentence-1'>.</a></div> <div id='condition.condvar-40.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-40.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-40.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-40.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-41'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-41'>41</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3322'>#</a></div><div id='condition.condvar-41.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-41.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvar-42'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-42'>42</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3326'>#</a></div><div id='condition.condvar-42.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvar-42.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvar-42.sentence-1' class='sentence'>The returned value indicates whether the predicate evaluates to <span class='texttt'>true</span>
regardless of whether the timeout was triggered<a class='hidden_link' href='#condition.condvar-42.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvar-43'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-43'>43</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3330'>#</a></div><div id='condition.condvar-43.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>) or any exception thrown by <span class='texttt'>pred</span><a class='hidden_link' href='#condition.condvar-43.sentence-1'>.</a></div></div></div></div><div id='condition.condvarany' class='section'><h3 ><a class='secnum' href='#condition.condvarany' style='min-width:103pt'>33.5.4</a> Class <span class='texttt'>condition_&shy;variable_&shy;any</span> <a class='abbr_ref' href='thread.condition.condvarany'>[thread.condition.condvarany]</a></h3><div class='para' id='condition.condvarany-1'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3338'>#</a></div><div id='condition.condvarany-1.sentence-1' class='sentence'>A <span class='texttt'>Lock</span> type shall meet the
<a href='thread.req.lockable.basic'><span class='texttt'>BasicLockable</span></a> requirements<a class='hidden_link' href='#condition.condvarany-1.sentence-1'>.</a></div> <div id='condition.condvarany-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvarany-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvarany-1.sentence-2' class='sentence'>All of the standard
mutex types meet this requirement<a class='hidden_link' href='#condition.condvarany-1.sentence-2'>.</a></div> <div id='condition.condvarany-1.sentence-3' class='sentence'>If a <span class='texttt'>Lock</span> type other than one of the
standard mutex types or a <span class='texttt'>unique_&shy;lock</span> wrapper for a standard mutex type
is used with <span class='texttt'>condition_&shy;variable_&shy;any</span>, the user should ensure that any
necessary synchronization is in place with respect to the predicate associated
with the <span class='texttt'>condition_&shy;variable_&shy;any</span> instance<a class='hidden_link' href='#condition.condvarany-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> <span class='indexparent'><a class='index' id='lib:condition_variable_any'></a></span><pre class='codeblock'>
namespace std {
  class condition_variable_any {
  public:
    condition_variable_any();
    ~condition_variable_any();

    condition_variable_any(const condition_variable_any&amp;) = delete;
    condition_variable_any&amp; operator=(const condition_variable_any&amp;) = delete;

    void notify_one() noexcept;
    void notify_all() noexcept;
    template &lt;class Lock&gt;
      void wait(Lock&amp; lock);
    template &lt;class Lock, class Predicate&gt;
      void wait(Lock&amp; lock, Predicate pred);

    template &lt;class Lock, class Clock, class Duration&gt;
      cv_status wait_until(Lock&amp; lock, const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    template &lt;class Lock, class Clock, class Duration, class Predicate&gt;
      bool wait_until(Lock&amp; lock, const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time,
                      Predicate pred);
    template &lt;class Lock, class Rep, class Period&gt;
      cv_status wait_for(Lock&amp; lock, const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Lock, class Rep, class Period, class Predicate&gt;
      bool wait_for(Lock&amp; lock, const chrono::duration&lt;Rep, Period&gt;&amp; rel_time, Predicate pred);
  };
}</pre><span class='indexparent'><a class='index' id='lib:condition_variable_any,constructor'></a></span></div><code class='itemdecl'>condition_variable_any();
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-2'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3385'>#</a></div><div id='condition.condvarany-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>condition_&shy;variable_&shy;any</span><a class='hidden_link' href='#condition.condvarany-2.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvarany-3'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3388'>#</a></div><div id='condition.condvarany-3.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>bad_&shy;alloc</span> or <span class='texttt'>system_&shy;error</span> when an exception is
required (<a href='thread.req.exception'>[thread.req.exception]</a>)<a class='hidden_link' href='#condition.condvarany-3.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvarany-4'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3392'>#</a></div><div id='condition.condvarany-4.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='condition.condvarany-4.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-4.1'>(4.1)</a></div><div id='condition.condvarany-4.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if some non-memory resource
limitation prevents initialization<a class='hidden_link' href='#condition.condvarany-4.1.sentence-1'>.</a></div></li><li id='condition.condvarany-4.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-4.2'>(4.2)</a></div><div id='condition.condvarany-4.2.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if the thread does not have the
privilege to perform the operation<a class='hidden_link' href='#condition.condvarany-4.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:condition_variable_any,destructor'></a></span><code class='itemdecl'>~condition_variable_any();
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-5'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3409'>#</a></div><div id='condition.condvarany-5.sentence-1' class='sentence'><span class='textit'>Requires:</span> There shall be no thread blocked on <span class='texttt'>*this</span><a class='hidden_link' href='#condition.condvarany-5.sentence-1'>.</a></div> <div id='condition.condvarany-5.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvarany-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvarany-5.sentence-2' class='sentence'>That is, all
threads shall have been notified; they may subsequently block on the lock specified in the
wait<a class='hidden_link' href='#condition.condvarany-5.sentence-2'>.</a></div> <div id='condition.condvarany-5.sentence-3' class='sentence'>This relaxes the usual rules, which would have required all wait calls to happen before
destruction<a class='hidden_link' href='#condition.condvarany-5.sentence-3'>.</a></div> <div id='condition.condvarany-5.sentence-4' class='sentence'>Only the notification to unblock the wait needs to happen before destruction<a class='hidden_link' href='#condition.condvarany-5.sentence-4'>.</a></div> <div id='condition.condvarany-5.sentence-5' class='sentence'>The user should take care to ensure that no threads wait on <span class='texttt'>*this</span> once the destructor has
been started, especially when the waiting threads are calling the wait functions in a loop or
using the overloads of <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span> that take a predicate<a class='hidden_link' href='#condition.condvarany-5.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvarany-6'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3420'>#</a></div><div id='condition.condvarany-6.sentence-1' class='sentence'><span class='textit'>Effects:</span> Destroys the object<a class='hidden_link' href='#condition.condvarany-6.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:notify_one,condition_variable_any'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable_any,notify_one'></a></span><code class='itemdecl'>void notify_one() noexcept;
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-7'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3429'>#</a></div><div id='condition.condvarany-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> If any threads are blocked waiting for <span class='texttt'>*this</span>, unblocks one of those threads<a class='hidden_link' href='#condition.condvarany-7.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:notify_all,condition_variable_any'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable_any,notify_all'></a></span><code class='itemdecl'>void notify_all() noexcept;
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-8'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3438'>#</a></div><div id='condition.condvarany-8.sentence-1' class='sentence'><span class='textit'>Effects:</span> Unblocks all threads that are blocked waiting for <span class='texttt'>*this</span><a class='hidden_link' href='#condition.condvarany-8.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait,condition_variable_any'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable_any,wait'></a></span><code class='itemdecl'>template &lt;class Lock&gt;
  void wait(Lock&amp; lock);
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-9'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3448'>#</a></div><div id='condition.condvarany-9.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='condition.condvarany-9.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-9.1'>(9.1)</a></div><div id='condition.condvarany-9.1.sentence-1' class='sentence'>Atomically calls <span class='texttt'>lock.unlock()</span> and blocks on <span class='texttt'>*this</span><a class='hidden_link' href='#condition.condvarany-9.1.sentence-1'>.</a></div></li><li id='condition.condvarany-9.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-9.2'>(9.2)</a></div><div id='condition.condvarany-9.2.sentence-1' class='sentence'>When unblocked, calls <span class='texttt'>lock.lock()</span> (possibly blocking on the lock) and returns<a class='hidden_link' href='#condition.condvarany-9.2.sentence-1'>.</a></div></li><li id='condition.condvarany-9.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-9.3'>(9.3)</a></div><div id='condition.condvarany-9.3.sentence-1' class='sentence'>The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one()</span>,
a call to <span class='texttt'>notify_&shy;all()</span>, or spuriously<a class='hidden_link' href='#condition.condvarany-9.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvarany-10'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3457'>#</a></div><div id='condition.condvarany-10.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvarany-10.sentence-1'>.</a></div> <div id='condition.condvarany-10.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvarany-10.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvarany-10.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvarany-10.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvarany-11'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3463'>#</a></div><div id='condition.condvarany-11.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock</span> is locked by the calling thread<a class='hidden_link' href='#condition.condvarany-11.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvarany-12'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3465'>#</a></div><div id='condition.condvarany-12.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#condition.condvarany-12.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait,condition_variable_any_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable_any,wait_'></a></span><code class='itemdecl'>template &lt;class Lock, class Predicate&gt;
  void wait(Lock&amp; lock, Predicate pred);
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-13'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3476'>#</a></div><div id='condition.condvarany-13.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to:
<pre class='codeblock'>
while (!pred())
  wait(lock);</pre></div></div></div><span class='indexparent'><a class='index' id='lib:wait_until,condition_variable_any'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable_any,wait_until'></a></span><code class='itemdecl'>template &lt;class Lock, class Clock, class Duration&gt;
  cv_status wait_until(Lock&amp; lock, const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-14'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3491'>#</a></div><div id='condition.condvarany-14.sentence-1' class='sentence'><span class='textit'>Effects:</span> </div><div id='condition.condvarany-14.sentence-2' class='sentence'><ul class='itemize'><li id='condition.condvarany-14.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-14.1'>(14.1)</a></div><div id='condition.condvarany-14.1.sentence-1' class='sentence'>Atomically calls <span class='texttt'>lock.unlock()</span> and blocks on <span class='texttt'>*this</span><a class='hidden_link' href='#condition.condvarany-14.1.sentence-1'>.</a></div></li><li id='condition.condvarany-14.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-14.2'>(14.2)</a></div><div id='condition.condvarany-14.2.sentence-1' class='sentence'>When unblocked, calls <span class='texttt'>lock.lock()</span> (possibly blocking on the lock) and returns<a class='hidden_link' href='#condition.condvarany-14.2.sentence-1'>.</a></div></li><li id='condition.condvarany-14.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-14.3'>(14.3)</a></div><div id='condition.condvarany-14.3.sentence-1' class='sentence'>The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one()</span>, a call to <span class='texttt'>notify_&shy;all()</span>,
expiration of the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>abs_&shy;time</span>,
or spuriously<a class='hidden_link' href='#condition.condvarany-14.3.sentence-1'>.</a></div></li><li id='condition.condvarany-14.4'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#condition.condvarany-14.4'>(14.4)</a></div><div id='condition.condvarany-14.4.sentence-1' class='sentence'>If the function exits via an exception, <span class='texttt'>lock.lock()</span> shall be called prior to exiting the function<a class='hidden_link' href='#condition.condvarany-14.4.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='condition.condvarany-15'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3509'>#</a></div><div id='condition.condvarany-15.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvarany-15.sentence-1'>.</a></div> <div id='condition.condvarany-15.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvarany-15.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvarany-15.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvarany-15.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvarany-16'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3515'>#</a></div><div id='condition.condvarany-16.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock</span> is locked by the calling thread<a class='hidden_link' href='#condition.condvarany-16.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvarany-17'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3518'>#</a></div><div id='condition.condvarany-17.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;timeout</span> if
the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>abs_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;no_&shy;timeout</span><a class='hidden_link' href='#condition.condvarany-17.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvarany-18'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3523'>#</a></div><div id='condition.condvarany-18.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#condition.condvarany-18.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_for,condition_variable_any'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable_any,wait_for'></a></span><code class='itemdecl'>template &lt;class Lock, class Rep, class Period&gt;
  cv_status wait_for(Lock&amp; lock, const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-19'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3536'>#</a></div><div id='condition.condvarany-19.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to:
<pre class='codeblock'>
return wait_until(lock, chrono::steady_clock::now() + rel_time);</pre></div></div></div><div class='para' id='condition.condvarany-20'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3542'>#</a></div><div id='condition.condvarany-20.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;timeout</span> if
the relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>rel_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;no_&shy;timeout</span><a class='hidden_link' href='#condition.condvarany-20.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvarany-21'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3547'>#</a></div><div id='condition.condvarany-21.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#condition.condvarany-21.sentence-1'>.</a></div> <div id='condition.condvarany-21.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvarany-21.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvarany-21.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvarany-21.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvarany-22'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3553'>#</a></div><div id='condition.condvarany-22.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>lock</span> is locked by the calling thread<a class='hidden_link' href='#condition.condvarany-22.sentence-1'>.</a></div></div></div><div class='para' id='condition.condvarany-23'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3556'>#</a></div><div id='condition.condvarany-23.sentence-1' class='sentence'><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#condition.condvarany-23.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_until,condition_variable_any_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable_any,wait_until_'></a></span><code class='itemdecl'>template &lt;class Lock, class Clock, class Duration, class Predicate&gt;
  bool wait_until(Lock&amp; lock, const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time, Predicate pred);
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-24'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3569'>#</a></div><div id='condition.condvarany-24.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to:
<pre class='codeblock'>
while (!pred())
  if (wait_until(lock, abs_time) == cv_status::timeout)
    return pred();
return true;</pre></div></div></div><div class='para' id='condition.condvarany-25'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3578'>#</a></div><div id='condition.condvarany-25.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvarany-25.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvarany-25.sentence-1' class='sentence'>There is no blocking if <span class='texttt'>pred()</span> is initially <span class='texttt'>true</span>, or
if the timeout has already expired<a class='hidden_link' href='#condition.condvarany-25.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='condition.condvarany-26'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3582'>#</a></div><div id='condition.condvarany-26.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#condition.condvarany-26.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='condition.condvarany-26.sentence-1' class='sentence'>The returned value indicates whether the predicate evaluates to <span class='texttt'>true</span>
regardless of whether the timeout was triggered<a class='hidden_link' href='#condition.condvarany-26.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:wait_for,condition_variable_any_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable_any,wait_for_'></a></span><code class='itemdecl'>template &lt;class Lock, class Rep, class Period, class Predicate&gt;
  bool wait_for(Lock&amp; lock, const chrono::duration&lt;Rep, Period&gt;&amp; rel_time, Predicate pred);
</code><div class='itemdescr'></div><div class='para' id='condition.condvarany-27'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3594'>#</a></div><div id='condition.condvarany-27.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to:
<pre class='codeblock'>
return wait_until(lock, chrono::steady_clock::now() + rel_time, std::move(pred));</pre></div></div></div></div></div><div id='futures' class='section'><h2 ><a class='secnum' href='#futures' style='min-width:88pt'>33.6</a> Futures <a class='abbr_ref' href='futures'>[futures]</a></h2><div id='futures.overview' class='section'><h3 ><a class='secnum' href='#futures.overview' style='min-width:103pt'>33.6.1</a> Overview <a class='abbr_ref' href='futures.overview'>[futures.overview]</a></h3><div class='para' id='futures.overview-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.overview-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3605'>#</a></div><div id='futures.overview-1.sentence-1' class='sentence'><a href='futures'>[futures]</a> describes components that a C++ program can use to retrieve in one thread the
result (value or exception) from a function that has run in the same thread or another thread<a class='hidden_link' href='#futures.overview-1.sentence-1'>.</a></div> <div id='futures.overview-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.overview-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.overview-1.sentence-2' class='sentence'>These components are not restricted to multi-threaded programs but can be useful in
single-threaded programs as well<a class='hidden_link' href='#futures.overview-1.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='future.syn' class='section'><h3 ><a class='secnum' href='#future.syn' style='min-width:103pt'>33.6.2</a> Header <span class='texttt'>&lt;future&gt;</span> synopsis <a class='abbr_ref' href='future.syn'>[future.syn]</a></h3><span class='indexparent'><a class='index' id=':<future>'></a></span><span class='indexparent'><a class='index' id='lib:<future>'></a></span><span class='indexparent'><a class='index' id='lib:future_errc'></a></span><pre class='codeblock'>
namespace std {
  enum class future_errc {
    broken_promise = <span class='textit'>implementation-defined</span>,
    future_already_retrieved = <span class='textit'>implementation-defined</span>,
    promise_already_satisfied = <span class='textit'>implementation-defined</span>,
    no_state = <span class='textit'>implementation-defined</span>
  };

  enum class launch : <span class='textit'><span class='texttt'>unspecified</span></span> {
    async = <span class='textit'><span class='texttt'>unspecified</span></span>,
    deferred = <span class='textit'><span class='texttt'>unspecified</span></span>,
    <span class='textit'>implementation-defined</span>
  };

  enum class future_status {
    ready,
    timeout,
    deferred
  };

  template &lt;&gt; struct is_error_code_enum&lt;future_errc&gt; : public true_type { };
  error_code make_error_code(future_errc e) noexcept;
  error_condition make_error_condition(future_errc e) noexcept;

  const error_category&amp; future_category() noexcept;

  class future_error;

  template &lt;class R&gt; class promise;
  template &lt;class R&gt; class promise&lt;R&amp;&gt;;
  template &lt;&gt; class promise&lt;void&gt;;

  template &lt;class R&gt;
    void swap(promise&lt;R&gt;&amp; x, promise&lt;R&gt;&amp; y) noexcept;

  template &lt;class R, class Alloc&gt;
    struct uses_allocator&lt;promise&lt;R&gt;, Alloc&gt;;

  template &lt;class R&gt; class future;
  template &lt;class R&gt; class future&lt;R&amp;&gt;;
  template &lt;&gt; class future&lt;void&gt;;

  template &lt;class R&gt; class shared_future;
  template &lt;class R&gt; class shared_future&lt;R&amp;&gt;;
  template &lt;&gt; class shared_future&lt;void&gt;;

  template &lt;class&gt; class packaged_task;   <span class='comment'>// not defined
</span>  template &lt;class R, class... ArgTypes&gt;
    class packaged_task&lt;R(ArgTypes...)&gt;;

  template &lt;class R, class... ArgTypes&gt;
    void swap(packaged_task&lt;R(ArgTypes...)&gt;&amp;, packaged_task&lt;R(ArgTypes...)&gt;&amp;) noexcept;

  template &lt;class R, class Alloc&gt;
    struct uses_allocator&lt;packaged_task&lt;R&gt;, Alloc&gt;;

  template &lt;class F, class... Args&gt;
    future&lt;invoke_result_t&lt;decay_t&lt;F&gt;, decay_t&lt;Args&gt;...&gt;&gt;
    async(F&amp;&amp; f, Args&amp;&amp;... args);
  template &lt;class F, class... Args&gt;
    future&lt;invoke_result_t&lt;decay_t&lt;F&gt;, decay_t&lt;Args&gt;...&gt;&gt;
    async(launch policy, F&amp;&amp; f, Args&amp;&amp;... args);
}</pre><div class='para' id='future.syn-1'><div class='marginalizedparent'><a class='marginalized' href='#future.syn-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3682'>#</a></div><div id='future.syn-1.sentence-1' class='sentence'>The <span class='texttt'>enum</span> type <span class='texttt'>launch</span> is a <a href='bitmask.types'>bitmask type</a> with
elements <span class='texttt'>launch&#x200b;::&#x200b;async</span> and <span class='texttt'>launch&#x200b;::&#x200b;deferred</span><a class='hidden_link' href='#future.syn-1.sentence-1'>.</a></div> <div id='future.syn-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#future.syn-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='future.syn-1.sentence-2' class='sentence'>Implementations can provide bitmasks to specify restrictions on task
interaction by functions launched by <span class='texttt'>async()</span> applicable to a
corresponding subset of available launch policies<a class='hidden_link' href='#future.syn-1.sentence-2'>.</a></div> <div id='future.syn-1.sentence-3' class='sentence'>Implementations can extend
the behavior of the first overload of <span class='texttt'>async()</span> by adding their extensions
to the launch policy under the “as if” rule<a class='hidden_link' href='#future.syn-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='future.syn-2'><div class='marginalizedparent'><a class='marginalized' href='#future.syn-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3691'>#</a></div><div id='future.syn-2.sentence-1' class='sentence'>The enum values of <span class='texttt'>future_&shy;errc</span> are distinct and not zero<a class='hidden_link' href='#future.syn-2.sentence-1'>.</a></div></div></div><div id='futures.errors' class='section'><h3 ><a class='secnum' href='#futures.errors' style='min-width:103pt'>33.6.3</a> Error handling <a class='abbr_ref' href='futures.errors'>[futures.errors]</a></h3><span class='indexparent'><a class='index' id='lib:future_category'></a></span><code class='itemdecl'>const error_category&amp; future_category() noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.errors-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.errors-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3702'>#</a></div><div id='futures.errors-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> &nbsp;A reference to an object of a type derived from class <span class='texttt'>error_&shy;category</span><a class='hidden_link' href='#futures.errors-1.sentence-1'>.</a></div></div></div><div class='para' id='futures.errors-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.errors-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3705'>#</a></div><div id='futures.errors-2.sentence-1' class='sentence'>The object's <span class='texttt'>default_&shy;error_&shy;condition</span> and equivalent virtual functions shall
behave as specified for the class <span class='texttt'>error_&shy;category</span><a class='hidden_link' href='#futures.errors-2.sentence-1'>.</a></div> <div id='futures.errors-2.sentence-2' class='sentence'>The object's <span class='texttt'>name</span>
virtual function shall return a pointer to the string <span class='texttt'>"future"</span><a class='hidden_link' href='#futures.errors-2.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:make_error_code,future_errc'></a></span><span class='indexparent'><a class='index' id='lib:future_errc,make_error_code'></a></span><code class='itemdecl'>error_code make_error_code(future_errc e) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.errors-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.errors-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3717'>#</a></div><div id='futures.errors-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>error_&shy;code(static_&shy;cast&lt;int&gt;(e), future_&shy;category())</span><a class='hidden_link' href='#futures.errors-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:make_error_condition,future_errc'></a></span><span class='indexparent'><a class='index' id='lib:future_errc,make_error_condition'></a></span><code class='itemdecl'>error_condition make_error_condition(future_errc e) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.errors-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.errors-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3727'>#</a></div><div id='futures.errors-4.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>error_&shy;condition(static_&shy;cast&lt;int&gt;(e), future_&shy;category())</span><a class='hidden_link' href='#futures.errors-4.sentence-1'>.</a></div></div></div></div><div id='futures.future_error' class='section'><h3 ><a class='secnum' href='#futures.future_error' style='min-width:103pt'>33.6.4</a> Class <span class='texttt'>future_&shy;error</span> <a class='abbr_ref' href='futures.future_error'>[futures.future_error]</a></h3><span class='indexparent'><a class='index' id='lib:future_error'></a></span><pre class='codeblock'>
namespace std {
  class future_error : public logic_error {
  public:
    explicit future_error(future_errc e);

    const error_code&amp; code() const noexcept;
    const char*       what() const noexcept;

  private:
    error_code ec_;             <span class='comment'>// <span class='textit'>exposition only</span>
</span>  };
}</pre><span class='indexparent'><a class='index' id='lib:future_error,constructor'></a></span><code class='itemdecl'>explicit future_error(future_errc e);
</code><div class='itemdescr'></div><div class='para' id='futures.future_error-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.future_error-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3755'>#</a></div><div id='futures.future_error-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an object of class <span class='texttt'>future_&shy;error</span>
and initializes <span class='texttt'>ec_&shy;</span> with <span class='texttt'>make_&shy;error_&shy;code(e)</span><a class='hidden_link' href='#futures.future_error-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:code,future_error'></a></span><span class='indexparent'><a class='index' id='lib:future_error,code'></a></span><code class='itemdecl'>const error_code&amp; code() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.future_error-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.future_error-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3766'>#</a></div><div id='futures.future_error-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>ec_&shy;</span><a class='hidden_link' href='#futures.future_error-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:what,future_error'></a></span><span class='indexparent'><a class='index' id='lib:future_error,what'></a></span><code class='itemdecl'>const char* what() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.future_error-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.future_error-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3776'>#</a></div><div id='futures.future_error-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> An <span class='textsc'>ntbs</span> incorporating <span class='texttt'>code().message()</span><a class='hidden_link' href='#futures.future_error-3.sentence-1'>.</a></div></div></div></div><div id='futures.state' class='section'><h3 ><a class='secnum' href='#futures.state' style='min-width:103pt'>33.6.5</a> Shared state <a class='abbr_ref' href='futures.state'>[futures.state]</a></h3><div class='para' id='futures.state-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3782'>#</a></div><div id='futures.state-1.sentence-1' class='sentence'>Many of the classes introduced in this subclause use some state to communicate results<a class='hidden_link' href='#futures.state-1.sentence-1'>.</a></div> <div id='futures.state-1.sentence-2' class='sentence'>This

<a class='hidden_link' href='#def:future,shared_state' id='def:future,shared_state'><i >shared state</i></a> consists of some state information and some (possibly not
yet evaluated) <a class='hidden_link' href='#def:result' id='def:result'><i>result</i></a>, which can be a (possibly void) value or an exception<a class='hidden_link' href='#futures.state-1.sentence-2'>.</a></div> <div id='futures.state-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.state-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.state-1.sentence-3' class='sentence'>Futures, promises, and tasks defined in this clause reference such shared state<a class='hidden_link' href='#futures.state-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='futures.state-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3789'>#</a></div><div id='futures.state-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.state-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.state-2.sentence-1' class='sentence'>The result can be any kind of object including a function to compute that result,
as used by <span class='texttt'>async</span> when <span class='texttt'>policy</span> is <span class='texttt'>launch&#x200b;::&#x200b;deferred</span><a class='hidden_link' href='#futures.state-2.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='futures.state-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3793'>#</a></div><div id='futures.state-3.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:asynchronous_return_object' id='def:asynchronous_return_object'><i >asynchronous return object</i></a> is an object that reads results from a
shared state<a class='hidden_link' href='#futures.state-3.sentence-1'>.</a></div> <div id='futures.state-3.sentence-2' class='sentence'>A <a class='hidden_link' href='#def:waiting_function' id='def:waiting_function'><i >waiting function</i></a> of an asynchronous return object is one
that potentially blocks to wait for the shared state to be made
ready<a class='hidden_link' href='#futures.state-3.sentence-2'>.</a></div> <div id='futures.state-3.sentence-3' class='sentence'>If a waiting function can return before the state is made ready because of a
timeout (<a href='thread.req.lockable'>[thread.req.lockable]</a>), then it is a <a class='hidden_link' href='#def:timed_waiting_function' id='def:timed_waiting_function'><i>timed waiting function</i></a>, otherwise
it is a <a class='hidden_link' href='#def:non-timed_waiting_function' id='def:non-timed_waiting_function'><i>non-timed waiting function</i></a><a class='hidden_link' href='#futures.state-3.sentence-3'>.</a></div></div><div class='para' id='futures.state-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3802'>#</a></div><div id='futures.state-4.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:asynchronous_provider' id='def:asynchronous_provider'><i >asynchronous provider</i></a> is an object that provides a result to a shared
state<a class='hidden_link' href='#futures.state-4.sentence-1'>.</a></div> <div id='futures.state-4.sentence-2' class='sentence'>The result of a shared state is set by
respective functions on the asynchronous provider<a class='hidden_link' href='#futures.state-4.sentence-2'>.</a></div> <div id='futures.state-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.state-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.state-4.sentence-4' class='sentence'>Such as promises or tasks<a class='hidden_link' href='#futures.state-4.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='futures.state-4.sentence-3' class='sentence'> The means of setting the result of a shared state is specified
in the description of those classes and functions that create such a state object<a class='hidden_link' href='#futures.state-4.sentence-3'>.</a></div></div><div class='para' id='futures.state-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3810'>#</a></div><div id='futures.state-5.sentence-1' class='sentence'>When an asynchronous return object or an asynchronous provider is said to release its
shared state, it means:</div><div id='futures.state-5.sentence-2' class='sentence'><ul class='itemize'><li id='futures.state-5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#futures.state-5.1'>(5.1)</a></div><div id='futures.state-5.1.sentence-1' class='sentence'>if the return object or provider holds the last reference to its shared state,
the shared state is destroyed; and</div></li><li id='futures.state-5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#futures.state-5.2'>(5.2)</a></div><div id='futures.state-5.2.sentence-1' class='sentence'>the return object or provider gives up its reference to its shared state; and</div></li><li id='futures.state-5.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#futures.state-5.3'>(5.3)</a></div><div id='futures.state-5.3.sentence-1' class='sentence'>these actions will not block for the shared state to become ready, except that it
may block if all of the following are true: the shared state was created by a call to
<span class='texttt'>std&#x200b;::&#x200b;async</span>, the shared state is not yet ready, and this was the last reference
to the shared state<a class='hidden_link' href='#futures.state-5.3.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='futures.state-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3828'>#</a></div><div id='futures.state-6.sentence-1' class='sentence'>When an asynchronous provider is said to make its shared state ready, it means:</div><div id='futures.state-6.sentence-2' class='sentence'><ul class='itemize'><li id='futures.state-6.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#futures.state-6.1'>(6.1)</a></div><div id='futures.state-6.1.sentence-1' class='sentence'>first, the provider marks its shared state as ready; and</div></li><li id='futures.state-6.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#futures.state-6.2'>(6.2)</a></div><div id='futures.state-6.2.sentence-1' class='sentence'>second, the provider unblocks any execution agents waiting for its shared
state to become ready<a class='hidden_link' href='#futures.state-6.2.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='futures.state-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3840'>#</a></div><div id='futures.state-7.sentence-1' class='sentence'>When an asynchronous provider is said to abandon its shared state, it means:</div><div id='futures.state-7.sentence-2' class='sentence'><ul class='itemize'><li id='futures.state-7.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#futures.state-7.1'>(7.1)</a></div><div id='futures.state-7.1.sentence-1' class='sentence'>first, if that state is not ready, the provider</div><div id='futures.state-7.1.sentence-2' class='sentence'><ul class='itemize'><li id='futures.state-7.1.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#futures.state-7.1.1'>(7.1.1)</a></div><div id='futures.state-7.1.1.sentence-1' class='sentence'>stores an exception object of type <span class='texttt'>future_&shy;error</span> with an error condition of
<span class='texttt'>broken_&shy;promise</span> within its shared state; and then</div></li><li id='futures.state-7.1.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#futures.state-7.1.2'>(7.1.2)</a></div><div id='futures.state-7.1.2.sentence-1' class='sentence'>makes its shared state ready;</div></li></ul></div></li><li id='futures.state-7.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#futures.state-7.2'>(7.2)</a></div><div id='futures.state-7.2.sentence-1' class='sentence'>second, the provider releases its shared state<a class='hidden_link' href='#futures.state-7.2.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='futures.state-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3860'>#</a></div><div id='futures.state-8.sentence-1' class='sentence'>A shared state is <a class='hidden_link' href='#def:ready' id='def:ready'><i >ready</i></a> only if it holds a value or an exception ready for
retrieval<a class='hidden_link' href='#futures.state-8.sentence-1'>.</a></div> <div id='futures.state-8.sentence-2' class='sentence'>Waiting for a shared state to become ready may invoke code to compute the result on
the waiting thread if so specified in the description of the class or function that creates
the state object<a class='hidden_link' href='#futures.state-8.sentence-2'>.</a></div></div><div class='para' id='futures.state-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3867'>#</a></div><div id='futures.state-9.sentence-1' class='sentence'>Calls to functions that successfully set the stored result of a shared
state <a href='intro.multithread#def:synchronize_with'>synchronize with</a> calls to functions
successfully detecting the ready state resulting from that setting<a class='hidden_link' href='#futures.state-9.sentence-1'>.</a></div> <div id='futures.state-9.sentence-2' class='sentence'>The storage of the result
(whether normal or exceptional) into the shared state
<a href='intro.multithread#def:synchronize_with'>synchronizes with</a>
the successful return from a call to a waiting function on the shared state<a class='hidden_link' href='#futures.state-9.sentence-2'>.</a></div></div><div class='para' id='futures.state-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3876'>#</a></div><div id='futures.state-10.sentence-1' class='sentence'>Some functions (e.g., <span class='texttt'>promise&#x200b;::&#x200b;set_&shy;value_&shy;at_&shy;thread_&shy;exit</span>) delay making
the shared state ready until the calling thread exits<a class='hidden_link' href='#futures.state-10.sentence-1'>.</a></div> <div id='futures.state-10.sentence-2' class='sentence'>The destruction of
each of that thread's objects with <a href='basic.stc.thread'>thread storage duration</a>
is sequenced before making that shared state ready<a class='hidden_link' href='#futures.state-10.sentence-2'>.</a></div></div><div class='para' id='futures.state-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3882'>#</a></div><div id='futures.state-11.sentence-1' class='sentence'>Access to the result of the same shared state may <a href='intro.multithread#def:conflict'>conflict</a><a class='hidden_link' href='#futures.state-11.sentence-1'>.</a></div> <div id='futures.state-11.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.state-11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.state-11.sentence-2' class='sentence'>This explicitly specifies that the result of the shared state is
visible in the objects that reference this state in the sense of <a href='res.on.data.races'>data race
avoidance</a><a class='hidden_link' href='#futures.state-11.sentence-2'>.</a></div> <div id='futures.state-11.sentence-3' class='sentence'>For example, concurrent accesses through
references returned by <span class='texttt'>shared_&shy;future&#x200b;::&#x200b;get()</span> (<a href='futures.shared_future'>[futures.shared_future]</a>) must either use read-only operations or provide additional synchronization<a class='hidden_link' href='#futures.state-11.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='futures.promise' class='section'><h3 ><a class='secnum' href='#futures.promise' style='min-width:103pt'>33.6.6</a> Class template <span class='texttt'>promise</span> <a class='abbr_ref' href='futures.promise'>[futures.promise]</a></h3><span class='indexparent'><a class='index' id='lib:promise'></a></span><pre class='codeblock'>
namespace std {
  template &lt;class R&gt;
  class promise {
  public:
    promise();
    template &lt;class Allocator&gt;
      promise(allocator_arg_t, const Allocator&amp; a);
    promise(promise&amp;&amp; rhs) noexcept;
    promise(const promise&amp; rhs) = delete;
    ~promise();

    <span class='comment'>// assignment
</span>    promise&amp; operator=(promise&amp;&amp; rhs) noexcept;
    promise&amp; operator=(const promise&amp; rhs) = delete;
    void swap(promise&amp; other) noexcept;

    <span class='comment'>// retrieving the result
</span>    future&lt;R&gt; get_future();

    <span class='comment'>// setting the result
</span>    void set_value(<span class='textit'><span class='texttt'>see below</span></span>);
    void set_exception(exception_ptr p);

    <span class='comment'>// setting the result with deferred notification
</span>    void set_value_at_thread_exit(<span class='textit'><span class='texttt'>see below</span></span>);
    void set_exception_at_thread_exit(exception_ptr p);
  };

  template &lt;class R&gt;
    void swap(promise&lt;R&gt;&amp; x, promise&lt;R&gt;&amp; y) noexcept;

  template &lt;class R, class Alloc&gt;
    struct uses_allocator&lt;promise&lt;R&gt;, Alloc&gt;;
}</pre><div class='para' id='futures.promise-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3931'>#</a></div><div id='futures.promise-1.sentence-1' class='sentence'>The implementation shall provide the template <span class='texttt'>promise</span> and two specializations,
<span class='texttt'>promise&lt;R&amp;&gt;</span> and <span class='texttt'>promise&lt;&#x200b;void&gt;</span><a class='hidden_link' href='#futures.promise-1.sentence-1'>.</a></div> <div id='futures.promise-1.sentence-2' class='sentence'>These differ only in the argument type
of the member functions <span class='texttt'>set_&shy;value</span> and <span class='texttt'>set_&shy;value_&shy;at_&shy;thread_&shy;exit</span>,
as set out in their descriptions, below<a class='hidden_link' href='#futures.promise-1.sentence-2'>.</a></div></div><div class='para' id='futures.promise-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3937'>#</a></div><div id='futures.promise-2.sentence-1' class='sentence'>The <span class='texttt'>set_&shy;value</span>, <span class='texttt'>set_&shy;exception</span>, <span class='texttt'>set_&shy;value_&shy;at_&shy;thread_&shy;exit</span>,
and <span class='texttt'>set_&shy;exception_&shy;at_&shy;thread_&shy;exit</span> member functions behave as though
they acquire a single mutex associated with the promise object while updating the
promise object<a class='hidden_link' href='#futures.promise-2.sentence-1'>.</a></div> <span class='indexparent'><a class='index' id='lib:uses_allocator,promise'></a></span></div><code class='itemdecl'>template &lt;class R, class Alloc&gt;
  struct uses_allocator&lt;promise&lt;R&gt;, Alloc&gt;
    : true_type { };
</code><div class='itemdescr'></div><div class='para' id='futures.promise-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3951'>#</a></div><div id='futures.promise-3.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>Alloc</span> shall be an <a href='allocator.requirements'>Allocator</a><a class='hidden_link' href='#futures.promise-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:promise,constructor'></a></span><code class='itemdecl'>promise();
template &lt;class Allocator&gt;
  promise(allocator_arg_t, const Allocator&amp; a);
</code><div class='itemdescr'></div><div class='para' id='futures.promise-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3964'>#</a></div><div id='futures.promise-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a <span class='texttt'>promise</span> object and a shared state<a class='hidden_link' href='#futures.promise-4.sentence-1'>.</a></div> <div id='futures.promise-4.sentence-2' class='sentence'>The second
constructor uses the allocator <span class='texttt'>a</span> to allocate memory for the shared
state<a class='hidden_link' href='#futures.promise-4.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:promise,constructor_'></a></span><code class='itemdecl'>promise(promise&amp;&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.promise-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3976'>#</a></div><div id='futures.promise-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a new <span class='texttt'>promise</span> object and transfers ownership of the shared state
of <span class='texttt'>rhs</span> (if any) to the newly-constructed object<a class='hidden_link' href='#futures.promise-5.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3980'>#</a></div><div id='futures.promise-6.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>rhs</span> has no shared state<a class='hidden_link' href='#futures.promise-6.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:promise,destructor'></a></span><code class='itemdecl'>~promise();
</code><div class='itemdescr'></div><div class='para' id='futures.promise-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L3990'>#</a></div><div id='futures.promise-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
Abandons any shared state (<a href='futures.state'>[futures.state]</a>)<a class='hidden_link' href='#futures.promise-7.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,promise'></a></span><span class='indexparent'><a class='index' id='lib:promise,operator='></a></span><code class='itemdecl'>promise&amp; operator=(promise&amp;&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.promise-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4001'>#</a></div><div id='futures.promise-8.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
Abandons any shared state (<a href='futures.state'>[futures.state]</a>) and then as if
<span class='texttt'>promise(std&#x200b;::&#x200b;move(rhs)).swap(*this)</span><a class='hidden_link' href='#futures.promise-8.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4006'>#</a></div><div id='futures.promise-9.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*this</span><a class='hidden_link' href='#futures.promise-9.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:swap,promise'></a></span><span class='indexparent'><a class='index' id='lib:promise,swap'></a></span><code class='itemdecl'>void swap(promise&amp; other) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.promise-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4016'>#</a></div><div id='futures.promise-10.sentence-1' class='sentence'><span class='textit'>Effects:</span> Exchanges the shared state of <span class='texttt'>*this</span> and <span class='texttt'>other</span><a class='hidden_link' href='#futures.promise-10.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4019'>#</a></div><div id='futures.promise-11.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>*this</span> has the shared state (if any) that <span class='texttt'>other</span> had
prior to the call to <span class='texttt'>swap</span><a class='hidden_link' href='#futures.promise-11.sentence-1'>.</a></div> <div id='futures.promise-11.sentence-2' class='sentence'><span class='texttt'>other</span> has the shared state (if any) that
<span class='texttt'>*this</span> had prior to the call to <span class='texttt'>swap</span><a class='hidden_link' href='#futures.promise-11.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:get_future,promise'></a></span><span class='indexparent'><a class='index' id='lib:promise,get_future'></a></span><code class='itemdecl'>future&lt;R&gt; get_future();
</code><div class='itemdescr'></div><div class='para' id='futures.promise-12'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4031'>#</a></div><div id='futures.promise-12.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>future&lt;R&gt;</span> object with the same shared state as
<span class='texttt'>*this</span><a class='hidden_link' href='#futures.promise-12.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-13'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4035'>#</a></div><div id='futures.promise-13.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>future_&shy;error</span> if <span class='texttt'>*this</span> has no shared state or if
<span class='texttt'>get_&shy;future</span> has already been called on a <span class='texttt'>promise</span> with the same
shared state as <span class='texttt'>*this</span><a class='hidden_link' href='#futures.promise-13.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-14'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4040'>#</a></div><div id='futures.promise-14.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> </div><div id='futures.promise-14.sentence-2' class='sentence'><ul class='itemize'><li id='futures.promise-14.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-14.1'>(14.1)</a></div><div id='futures.promise-14.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;already_&shy;retrieved</span> if <span class='texttt'>get_&shy;future</span> has already been called on
a <span class='texttt'>promise</span> with the same shared state as <span class='texttt'>*this</span><a class='hidden_link' href='#futures.promise-14.1.sentence-1'>.</a></div></li><li id='futures.promise-14.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-14.2'>(14.2)</a></div><div id='futures.promise-14.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span> has no shared state<a class='hidden_link' href='#futures.promise-14.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:set_value,promise'></a></span><span class='indexparent'><a class='index' id='lib:promise,set_value'></a></span><code class='itemdecl'>void promise::set_value(const R&amp; r);
void promise::set_value(R&amp;&amp; r);
void promise&lt;R&amp;&gt;::set_value(R&amp; r);
void promise&lt;void&gt;::set_value();
</code><div class='itemdescr'></div><div class='para' id='futures.promise-15'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4060'>#</a></div><div id='futures.promise-15.sentence-1' class='sentence'><span class='textit'>Effects:</span> Atomically stores the value <span class='texttt'>r</span> in the shared state and
makes that state ready (<a href='futures.state'>[futures.state]</a>)<a class='hidden_link' href='#futures.promise-15.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-16'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4064'>#</a></div><div id='futures.promise-16.sentence-1' class='sentence'><span class='textit'>Throws:</span> </div><div id='futures.promise-16.sentence-2' class='sentence'><ul class='itemize'><li id='futures.promise-16.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-16.1'>(16.1)</a></div><div id='futures.promise-16.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;error</span> if its shared state
already has a stored value or exception, or</div></li><li id='futures.promise-16.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-16.2'>(16.2)</a></div><div id='futures.promise-16.2.sentence-1' class='sentence'>for the first version, any exception thrown by the constructor selected to copy an object of <span class='texttt'>R</span>, or</div></li><li id='futures.promise-16.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-16.3'>(16.3)</a></div><div id='futures.promise-16.3.sentence-1' class='sentence'>for the second version, any exception thrown by the constructor selected to move an object of <span class='texttt'>R</span><a class='hidden_link' href='#futures.promise-16.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.promise-17'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4074'>#</a></div><div id='futures.promise-17.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='futures.promise-17.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-17.1'>(17.1)</a></div><div id='futures.promise-17.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-17.1.sentence-1'>.</a></div></li><li id='futures.promise-17.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-17.2'>(17.2)</a></div><div id='futures.promise-17.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span> has no shared state<a class='hidden_link' href='#futures.promise-17.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:set_exception,promise'></a></span><span class='indexparent'><a class='index' id='lib:promise,set_exception'></a></span><code class='itemdecl'>void set_exception(exception_ptr p);
</code><div class='itemdescr'></div><div class='para' id='futures.promise-18'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4089'>#</a></div><div id='futures.promise-18.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> is not null<a class='hidden_link' href='#futures.promise-18.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-19'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4092'>#</a></div><div id='futures.promise-19.sentence-1' class='sentence'><span class='textit'>Effects:</span> Atomically stores the exception pointer <span class='texttt'>p</span> in the shared state
and makes that state ready (<a href='futures.state'>[futures.state]</a>)<a class='hidden_link' href='#futures.promise-19.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-20'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4096'>#</a></div><div id='futures.promise-20.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>future_&shy;error</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-20.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-21'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4100'>#</a></div><div id='futures.promise-21.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> </div><div id='futures.promise-21.sentence-2' class='sentence'><ul class='itemize'><li id='futures.promise-21.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-21.1'>(21.1)</a></div><div id='futures.promise-21.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-21.1.sentence-1'>.</a></div></li><li id='futures.promise-21.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-21.2'>(21.2)</a></div><div id='futures.promise-21.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span> has no shared state<a class='hidden_link' href='#futures.promise-21.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:set_value_at_thread_exit,promise'></a></span><span class='indexparent'><a class='index' id='lib:promise,set_value_at_thread_exit'></a></span><code class='itemdecl'>void promise::set_value_at_thread_exit(const R&amp; r);
void promise::set_value_at_thread_exit(R&amp;&amp; r);
void promise&lt;R&amp;&gt;::set_value_at_thread_exit(R&amp; r);
void promise&lt;void&gt;::set_value_at_thread_exit();
</code><div class='itemdescr'></div><div class='para' id='futures.promise-22'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4119'>#</a></div><div id='futures.promise-22.sentence-1' class='sentence'><span class='textit'>Effects:</span> Stores the value <span class='texttt'>r</span> in the shared state without making that
state ready immediately<a class='hidden_link' href='#futures.promise-22.sentence-1'>.</a></div> <div id='futures.promise-22.sentence-2' class='sentence'>Schedules that state to be made ready when the current
thread exits, after all objects of thread storage duration associated with the
current thread have been destroyed<a class='hidden_link' href='#futures.promise-22.sentence-2'>.</a></div></div></div><div class='para' id='futures.promise-23'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4125'>#</a></div><div id='futures.promise-23.sentence-1' class='sentence'><span class='textit'>Throws:</span> </div><div id='futures.promise-23.sentence-2' class='sentence'><ul class='itemize'><li id='futures.promise-23.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-23.1'>(23.1)</a></div><div id='futures.promise-23.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;error</span> if its shared state
already has a stored value or exception, or</div></li><li id='futures.promise-23.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-23.2'>(23.2)</a></div><div id='futures.promise-23.2.sentence-1' class='sentence'>for the first version, any exception thrown by the constructor selected to copy an object of <span class='texttt'>R</span>, or</div></li><li id='futures.promise-23.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-23.3'>(23.3)</a></div><div id='futures.promise-23.3.sentence-1' class='sentence'>for the second version, any exception thrown by the constructor selected to move an object of <span class='texttt'>R</span><a class='hidden_link' href='#futures.promise-23.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.promise-24'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4135'>#</a></div><div id='futures.promise-24.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='futures.promise-24.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-24.1'>(24.1)</a></div><div id='futures.promise-24.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-24.1.sentence-1'>.</a></div></li><li id='futures.promise-24.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-24.2'>(24.2)</a></div><div id='futures.promise-24.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span> has no shared state<a class='hidden_link' href='#futures.promise-24.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:set_exception_at_thread_exit,promise'></a></span><span class='indexparent'><a class='index' id='lib:promise,set_exception_at_thread_exit'></a></span><code class='itemdecl'>void set_exception_at_thread_exit(exception_ptr p);
</code><div class='itemdescr'></div><div class='para' id='futures.promise-25'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4150'>#</a></div><div id='futures.promise-25.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> is not null<a class='hidden_link' href='#futures.promise-25.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-26'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4153'>#</a></div><div id='futures.promise-26.sentence-1' class='sentence'><span class='textit'>Effects:</span> Stores the exception pointer <span class='texttt'>p</span> in the shared state without
making that state ready immediately<a class='hidden_link' href='#futures.promise-26.sentence-1'>.</a></div> <div id='futures.promise-26.sentence-2' class='sentence'>Schedules that state to be made ready when
the current thread exits, after all objects of thread storage duration
associated with the current thread have been destroyed<a class='hidden_link' href='#futures.promise-26.sentence-2'>.</a></div></div></div><div class='para' id='futures.promise-27'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4159'>#</a></div><div id='futures.promise-27.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>future_&shy;error</span> if an error condition occurs<a class='hidden_link' href='#futures.promise-27.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-28'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4162'>#</a></div><div id='futures.promise-28.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='futures.promise-28.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-28.1'>(28.1)</a></div><div id='futures.promise-28.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-28.1.sentence-1'>.</a></div></li><li id='futures.promise-28.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.promise-28.2'>(28.2)</a></div><div id='futures.promise-28.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span> has no shared state<a class='hidden_link' href='#futures.promise-28.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:swap,promise_'></a></span><span class='indexparent'><a class='index' id='lib:promise,swap_'></a></span><code class='itemdecl'>template &lt;class R&gt;
  void swap(promise&lt;R&gt;&amp; x, promise&lt;R&gt;&amp; y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.promise-29'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4178'>#</a></div><div id='futures.promise-29.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>x.swap(y)</span><a class='hidden_link' href='#futures.promise-29.sentence-1'>.</a></div></div></div></div><div id='futures.unique_future' class='section'><h3 ><a class='secnum' href='#futures.unique_future' style='min-width:103pt'>33.6.7</a> Class template <span class='texttt'>future</span> <a class='abbr_ref' href='futures.unique_future'>[futures.unique_future]</a></h3><div class='para' id='futures.unique_future-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4184'>#</a></div><div id='futures.unique_future-1.sentence-1' class='sentence'>The class template <span class='texttt'>future</span> defines a type for asynchronous return objects which
do not share their shared state with other asynchronous return objects<a class='hidden_link' href='#futures.unique_future-1.sentence-1'>.</a></div> <div id='futures.unique_future-1.sentence-2' class='sentence'>A default-constructed <span class='texttt'>future</span> object has no
shared state<a class='hidden_link' href='#futures.unique_future-1.sentence-2'>.</a></div> <div id='futures.unique_future-1.sentence-3' class='sentence'>A <span class='texttt'>future</span> object with shared state can be created by
functions on <a href='futures.state#def:asynchronous_provider'>asynchronous providers</a>
or by the move constructor and shares its shared state with
the original asynchronous provider<a class='hidden_link' href='#futures.unique_future-1.sentence-3'>.</a></div> <div id='futures.unique_future-1.sentence-4' class='sentence'>The result (value or exception) of
a <span class='texttt'>future</span> object
can be
set by
calling a respective function on an
object that shares the same
shared state<a class='hidden_link' href='#futures.unique_future-1.sentence-4'>.</a></div></div><div class='para' id='futures.unique_future-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4199'>#</a></div><div id='futures.unique_future-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.unique_future-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.unique_future-2.sentence-1' class='sentence'>Member functions of <span class='texttt'>future</span> do not synchronize with themselves or with
member functions of <span class='texttt'>shared_&shy;future</span><a class='hidden_link' href='#futures.unique_future-2.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='futures.unique_future-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4203'>#</a></div><div id='futures.unique_future-3.sentence-1' class='sentence'>The effect of calling any member function other than the destructor, the
move-assignment operator, <span class='texttt'>share</span>, or <span class='texttt'>valid</span> on a <span class='texttt'>future</span> object for which
<span class='texttt'>valid() == false</span>
is undefined<a class='hidden_link' href='#futures.unique_future-3.sentence-1'>.</a></div> <div id='futures.unique_future-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.unique_future-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.unique_future-3.sentence-2' class='sentence'>It is valid to move from a future object for which <span class='texttt'>valid() == false</span><a class='hidden_link' href='#futures.unique_future-3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='futures.unique_future-3.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.unique_future-3.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.unique_future-3.sentence-3' class='sentence'>Implementations should detect this case and throw an object of type
<span class='texttt'>future_&shy;error</span> with an error condition of <span class='texttt'>future_&shy;errc&#x200b;::&#x200b;no_&shy;state</span><a class='hidden_link' href='#futures.unique_future-3.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> <span class='indexparent'><a class='index' id='lib:future'></a></span><pre class='codeblock'>
namespace std {
  template &lt;class R&gt;
  class future {
  public:
    future() noexcept;
    future(future&amp;&amp;) noexcept;
    future(const future&amp; rhs) = delete;
    ~future();
    future&amp; operator=(const future&amp; rhs) = delete;
    future&amp; operator=(future&amp;&amp;) noexcept;
    shared_future&lt;R&gt; share() noexcept;

    <span class='comment'>// retrieving the value
</span>    <span class='textit'><span class='texttt'>see below</span></span> get();

    <span class='comment'>// functions to check state
</span>    bool valid() const noexcept;

    void wait() const;
    template &lt;class Rep, class Period&gt;
      future_status wait_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time) const;
    template &lt;class Clock, class Duration&gt;
      future_status wait_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time) const;
  };
}</pre></div><div class='para' id='futures.unique_future-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4242'>#</a></div><div id='futures.unique_future-4.sentence-1' class='sentence'>The implementation shall provide the template <span class='texttt'>future</span> and two specializations,
<span class='texttt'>future&lt;R&amp;&gt;</span> and <span class='texttt'>future&lt;&#x200b;void&gt;</span><a class='hidden_link' href='#futures.unique_future-4.sentence-1'>.</a></div> <div id='futures.unique_future-4.sentence-2' class='sentence'>These differ only in the return type and return
value of the member function <span class='texttt'>get</span>, as set out in its description, below<a class='hidden_link' href='#futures.unique_future-4.sentence-2'>.</a></div> <span class='indexparent'><a class='index' id='lib:future,constructor'></a></span></div><code class='itemdecl'>future() noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4253'>#</a></div><div id='futures.unique_future-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an <a class='hidden_link' href='#def:empty_future_object' id='def:empty_future_object'><i >empty</i></a>
<span class='texttt'>future</span> object that does not refer to a
shared state<a class='hidden_link' href='#futures.unique_future-5.sentence-1'>.</a></div></div></div><div class='para' id='futures.unique_future-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4258'>#</a></div><div id='futures.unique_future-6.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>valid() == false</span><a class='hidden_link' href='#futures.unique_future-6.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:future,constructor_'></a></span><code class='itemdecl'>future(future&amp;&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4268'>#</a></div><div id='futures.unique_future-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> Move constructs a <span class='texttt'>future</span> object that refers to the shared
state that
was originally referred to by <span class='texttt'>rhs</span> (if any)<a class='hidden_link' href='#futures.unique_future-7.sentence-1'>.</a></div></div></div><div class='para' id='futures.unique_future-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4273'>#</a></div><div id='futures.unique_future-8.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> 
<ul class='itemize'><li id='futures.unique_future-8.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-8.1'>(8.1)</a></div><div id='futures.unique_future-8.1.sentence-1' class='sentence'><span class='texttt'>valid()</span> returns the same value as <span class='texttt'>rhs.valid()</span> prior to the
constructor invocation<a class='hidden_link' href='#futures.unique_future-8.1.sentence-1'>.</a></div></li><li id='futures.unique_future-8.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-8.2'>(8.2)</a></div><div id='futures.unique_future-8.2.sentence-1' class='sentence'><span class='texttt'>rhs.valid() == false</span><a class='hidden_link' href='#futures.unique_future-8.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:future,constructor__'></a></span><code class='itemdecl'>~future();
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4288'>#</a></div><div id='futures.unique_future-9.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='futures.unique_future-9.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-9.1'>(9.1)</a></div><div id='futures.unique_future-9.1.sentence-1' class='sentence'>Releases any shared state (<a href='futures.state'>[futures.state]</a>);</div></li><li id='futures.unique_future-9.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-9.2'>(9.2)</a></div><div id='futures.unique_future-9.2.sentence-1' class='sentence'>destroys <span class='texttt'>*this</span><a class='hidden_link' href='#futures.unique_future-9.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,future'></a></span><span class='indexparent'><a class='index' id='lib:future,operator='></a></span><code class='itemdecl'>future&amp; operator=(future&amp;&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4304'>#</a></div><div id='futures.unique_future-10.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='futures.unique_future-10.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-10.1'>(10.1)</a></div><div id='futures.unique_future-10.1.sentence-1' class='sentence'>Releases any shared state (<a href='futures.state'>[futures.state]</a>)<a class='hidden_link' href='#futures.unique_future-10.1.sentence-1'>.</a></div></li><li id='futures.unique_future-10.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-10.2'>(10.2)</a></div><div id='futures.unique_future-10.2.sentence-1' class='sentence'>move assigns the contents of <span class='texttt'>rhs</span> to <span class='texttt'>*this</span><a class='hidden_link' href='#futures.unique_future-10.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.unique_future-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4313'>#</a></div><div id='futures.unique_future-11.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> 
<ul class='itemize'><li id='futures.unique_future-11.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-11.1'>(11.1)</a></div><div id='futures.unique_future-11.1.sentence-1' class='sentence'><span class='texttt'>valid()</span> returns the same value as <span class='texttt'>rhs.valid()</span> prior to the
assignment<a class='hidden_link' href='#futures.unique_future-11.1.sentence-1'>.</a></div></li><li id='futures.unique_future-11.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-11.2'>(11.2)</a></div><div id='futures.unique_future-11.2.sentence-1' class='sentence'><span class='texttt'>rhs.valid() == false</span><a class='hidden_link' href='#futures.unique_future-11.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:share,future'></a></span><span class='indexparent'><a class='index' id='lib:future,share'></a></span><code class='itemdecl'>shared_future&lt;R&gt; share() noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-12'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4331'>#</a></div><div id='futures.unique_future-12.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>shared_&shy;future&lt;R&gt;(std&#x200b;::&#x200b;move(*this))</span><a class='hidden_link' href='#futures.unique_future-12.sentence-1'>.</a></div></div></div><div class='para' id='futures.unique_future-13'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4334'>#</a></div><div id='futures.unique_future-13.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>valid() == false</span><a class='hidden_link' href='#futures.unique_future-13.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:get,future'></a></span><span class='indexparent'><a class='index' id='lib:future,get'></a></span><code class='itemdecl'>R future::get();
R&amp; future&lt;R&amp;&gt;::get();
void future&lt;void&gt;::get();
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-14'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4346'>#</a></div><div id='futures.unique_future-14.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.unique_future-14.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.unique_future-14.sentence-1' class='sentence'>As described above, the template and its two required specializations differ only in
the return type and return value of the member function <span class='texttt'>get</span><a class='hidden_link' href='#futures.unique_future-14.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='futures.unique_future-15'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4352'>#</a></div><div id='futures.unique_future-15.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='futures.unique_future-15.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-15.1'>(15.1)</a></div><div id='futures.unique_future-15.1.sentence-1' class='sentence'><span class='texttt'>wait()</span>s until the shared state is ready, then retrieves the
value stored in the shared state;</div></li><li id='futures.unique_future-15.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-15.2'>(15.2)</a></div><div id='futures.unique_future-15.2.sentence-1' class='sentence'>releases any shared state (<a href='futures.state'>[futures.state]</a>)<a class='hidden_link' href='#futures.unique_future-15.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.unique_future-16'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4360'>#</a></div><div id='futures.unique_future-16.sentence-1' class='sentence'><span class='textit'>Returns:</span> 
<ul class='itemize'><li id='futures.unique_future-16.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-16.1'>(16.1)</a></div><div id='futures.unique_future-16.1.sentence-1' class='sentence'><span class='texttt'>future&#x200b;::&#x200b;get()</span> returns the value <span class='texttt'>v</span> stored in the object's shared state as
<span class='texttt'>std&#x200b;::&#x200b;move(v)</span><a class='hidden_link' href='#futures.unique_future-16.1.sentence-1'>.</a></div></li><li id='futures.unique_future-16.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-16.2'>(16.2)</a></div><div id='futures.unique_future-16.2.sentence-1' class='sentence'><span class='texttt'>future&lt;R&amp;&gt;&#x200b;::&#x200b;get()</span> returns the reference stored as value in the object's shared state<a class='hidden_link' href='#futures.unique_future-16.2.sentence-1'>.</a></div></li><li id='futures.unique_future-16.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-16.3'>(16.3)</a></div><div id='futures.unique_future-16.3.sentence-1' class='sentence'><span class='texttt'>future&lt;void&gt;&#x200b;::&#x200b;get()</span> returns nothing<a class='hidden_link' href='#futures.unique_future-16.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.unique_future-17'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4374'>#</a></div><div id='futures.unique_future-17.sentence-1' class='sentence'><span class='textit'>Throws:</span> The stored exception, if an exception was stored in the shared state<a class='hidden_link' href='#futures.unique_future-17.sentence-1'>.</a></div></div></div><div class='para' id='futures.unique_future-18'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4377'>#</a></div><div id='futures.unique_future-18.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>valid() == false</span><a class='hidden_link' href='#futures.unique_future-18.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:valid,future'></a></span><span class='indexparent'><a class='index' id='lib:future,valid'></a></span><code class='itemdecl'>bool valid() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-19'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4387'>#</a></div><div id='futures.unique_future-19.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> only if <span class='texttt'>*this</span> refers to a shared state<a class='hidden_link' href='#futures.unique_future-19.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait,future'></a></span><span class='indexparent'><a class='index' id='lib:future,wait'></a></span><code class='itemdecl'>void wait() const;
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-20'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4397'>#</a></div><div id='futures.unique_future-20.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
Blocks until the shared state is ready<a class='hidden_link' href='#futures.unique_future-20.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_for,future'></a></span><span class='indexparent'><a class='index' id='lib:future,wait_for'></a></span><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  future_status wait_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time) const;
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-21'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4409'>#</a></div><div id='futures.unique_future-21.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
None if the shared state contains a deferred function (<a href='futures.async'>[futures.async]</a>),
otherwise
blocks until the shared state is ready or until
the relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>rel_&shy;time</span> has expired<a class='hidden_link' href='#futures.unique_future-21.sentence-1'>.</a></div></div></div><div class='para' id='futures.unique_future-22'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4416'>#</a></div><div id='futures.unique_future-22.sentence-1' class='sentence'><span class='textit'>Returns:</span> </div><div id='futures.unique_future-22.sentence-2' class='sentence'><ul class='itemize'><li id='futures.unique_future-22.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-22.1'>(22.1)</a></div><div id='futures.unique_future-22.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;deferred</span> if the shared state contains a deferred
function<a class='hidden_link' href='#futures.unique_future-22.1.sentence-1'>.</a></div></li><li id='futures.unique_future-22.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-22.2'>(22.2)</a></div><div id='futures.unique_future-22.2.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;ready</span> if the shared state is ready<a class='hidden_link' href='#futures.unique_future-22.2.sentence-1'>.</a></div></li><li id='futures.unique_future-22.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-22.3'>(22.3)</a></div><div id='futures.unique_future-22.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;timeout</span> if the function is returning because the
relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>)
specified by <span class='texttt'>rel_&shy;time</span> has expired<a class='hidden_link' href='#futures.unique_future-22.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.unique_future-23'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4430'>#</a></div><div id='futures.unique_future-23.sentence-1' class='sentence'><span class='textit'>Throws:</span> 
timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#futures.unique_future-23.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_until,future'></a></span><span class='indexparent'><a class='index' id='lib:future,wait_until'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  future_status wait_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time) const;
</code><div class='itemdescr'></div><div class='para' id='futures.unique_future-24'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4442'>#</a></div><div id='futures.unique_future-24.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
None if the shared state contains a deferred function (<a href='futures.async'>[futures.async]</a>),
otherwise
blocks until the shared state is ready or until
the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>abs_&shy;time</span> has expired<a class='hidden_link' href='#futures.unique_future-24.sentence-1'>.</a></div></div></div><div class='para' id='futures.unique_future-25'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4449'>#</a></div><div id='futures.unique_future-25.sentence-1' class='sentence'><span class='textit'>Returns:</span> </div><div id='futures.unique_future-25.sentence-2' class='sentence'><ul class='itemize'><li id='futures.unique_future-25.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-25.1'>(25.1)</a></div><div id='futures.unique_future-25.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;deferred</span> if the shared state contains a deferred
function<a class='hidden_link' href='#futures.unique_future-25.1.sentence-1'>.</a></div></li><li id='futures.unique_future-25.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-25.2'>(25.2)</a></div><div id='futures.unique_future-25.2.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;ready</span> if the shared state is ready<a class='hidden_link' href='#futures.unique_future-25.2.sentence-1'>.</a></div></li><li id='futures.unique_future-25.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.unique_future-25.3'>(25.3)</a></div><div id='futures.unique_future-25.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;timeout</span> if the function is returning because the
absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>)
specified by <span class='texttt'>abs_&shy;time</span> has expired<a class='hidden_link' href='#futures.unique_future-25.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.unique_future-26'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique_future-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4463'>#</a></div><div id='futures.unique_future-26.sentence-1' class='sentence'><span class='textit'>Throws:</span> 
timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#futures.unique_future-26.sentence-1'>.</a></div></div></div></div><div id='futures.shared_future' class='section'><h3 ><a class='secnum' href='#futures.shared_future' style='min-width:103pt'>33.6.8</a> Class template <span class='texttt'>shared_&shy;future</span> <a class='abbr_ref' href='futures.shared_future'>[futures.shared_future]</a></h3><div class='para' id='futures.shared_future-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4471'>#</a></div><div id='futures.shared_future-1.sentence-1' class='sentence'>The class template <span class='texttt'>shared_&shy;future</span> defines a type for asynchronous return objects
which may share their shared state with other asynchronous return
objects<a class='hidden_link' href='#futures.shared_future-1.sentence-1'>.</a></div> <div id='futures.shared_future-1.sentence-2' class='sentence'>A default-constructed <span class='texttt'>shared_&shy;future</span>
object has no shared state<a class='hidden_link' href='#futures.shared_future-1.sentence-2'>.</a></div> <div id='futures.shared_future-1.sentence-3' class='sentence'>A <span class='texttt'>shared_&shy;future</span> object with
shared state can
be created
by conversion from a <span class='texttt'>future</span> object and shares its shared state with the
original <a href='futures.state#def:asynchronous_provider'>asynchronous provider</a> of the shared state<a class='hidden_link' href='#futures.shared_future-1.sentence-3'>.</a></div> <div id='futures.shared_future-1.sentence-4' class='sentence'>The result (value or exception) of a <span class='texttt'>shared_&shy;future</span> object
can be set by
calling a respective function on an
object that shares the same shared state<a class='hidden_link' href='#futures.shared_future-1.sentence-4'>.</a></div></div><div class='para' id='futures.shared_future-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4485'>#</a></div><div id='futures.shared_future-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.shared_future-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.shared_future-2.sentence-1' class='sentence'>Member functions of <span class='texttt'>shared_&shy;future</span> do not synchronize with themselves,
but they synchronize with the shared state<a class='hidden_link' href='#futures.shared_future-2.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='futures.shared_future-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4489'>#</a></div><div id='futures.shared_future-3.sentence-1' class='sentence'>The effect of calling any member function other than the destructor,
the move-assignment operator, the copy-assignment operator, or
<span class='texttt'>valid()</span> on a <span class='texttt'>shared_&shy;future</span> object for which <span class='texttt'>valid() == false</span> is undefined<a class='hidden_link' href='#futures.shared_future-3.sentence-1'>.</a></div> <div id='futures.shared_future-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.shared_future-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.shared_future-3.sentence-2' class='sentence'>It is valid to copy or move from a <span class='texttt'>shared_&shy;future</span>
object for which <span class='texttt'>valid()</span> is <span class='texttt'>false</span><a class='hidden_link' href='#futures.shared_future-3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='futures.shared_future-3.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.shared_future-3.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.shared_future-3.sentence-3' class='sentence'>Implementations should detect this case and throw an object of type
<span class='texttt'>future_&shy;error</span> with an error condition of <span class='texttt'>future_&shy;errc&#x200b;::&#x200b;no_&shy;state</span><a class='hidden_link' href='#futures.shared_future-3.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> <span class='indexparent'><a class='index' id='lib:shared_future'></a></span><pre class='codeblock'>
namespace std {
  template &lt;class R&gt;
  class shared_future {
  public:
    shared_future() noexcept;
    shared_future(const shared_future&amp; rhs) noexcept;
    shared_future(future&lt;R&gt;&amp;&amp;) noexcept;
    shared_future(shared_future&amp;&amp; rhs) noexcept;
    ~shared_future();
    shared_future&amp; operator=(const shared_future&amp; rhs) noexcept;
    shared_future&amp; operator=(shared_future&amp;&amp; rhs) noexcept;

    <span class='comment'>// retrieving the value
</span>    <span class='textit'><span class='texttt'>see below</span></span> get() const;

    <span class='comment'>// functions to check state
</span>    bool valid() const noexcept;

    void wait() const;
    template &lt;class Rep, class Period&gt;
      future_status wait_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time) const;
    template &lt;class Clock, class Duration&gt;
      future_status wait_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time) const;
  };
}</pre></div><div class='para' id='futures.shared_future-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4527'>#</a></div><div id='futures.shared_future-4.sentence-1' class='sentence'>The implementation shall provide the template <span class='texttt'>shared_&shy;future</span> and two
specializations, <span class='texttt'>shared_&shy;future&lt;R&amp;&gt;</span> and <span class='texttt'>shared_&shy;future&lt;void&gt;</span><a class='hidden_link' href='#futures.shared_future-4.sentence-1'>.</a></div> <div id='futures.shared_future-4.sentence-2' class='sentence'>These
differ only in the return type and return value of the member function <span class='texttt'>get</span>, as
set out in its description, below<a class='hidden_link' href='#futures.shared_future-4.sentence-2'>.</a></div> <span class='indexparent'><a class='index' id='lib:shared_future,constructor'></a></span></div><code class='itemdecl'>shared_future() noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4539'>#</a></div><div id='futures.shared_future-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an <a class='hidden_link' href='#def:empty_shared_future_object' id='def:empty_shared_future_object'><i >empty</i></a>
<span class='texttt'>shared_&shy;future</span> object that does not refer to a
shared state<a class='hidden_link' href='#futures.shared_future-5.sentence-1'>.</a></div></div></div><div class='para' id='futures.shared_future-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4544'>#</a></div><div id='futures.shared_future-6.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>valid() == false</span><a class='hidden_link' href='#futures.shared_future-6.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_future,constructor_'></a></span><code class='itemdecl'>shared_future(const shared_future&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4554'>#</a></div><div id='futures.shared_future-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a <span class='texttt'>shared_&shy;future</span> object that refers to the same
shared state as <span class='texttt'>rhs</span> (if any)<a class='hidden_link' href='#futures.shared_future-7.sentence-1'>.</a></div></div></div><div class='para' id='futures.shared_future-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4558'>#</a></div><div id='futures.shared_future-8.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>valid()</span> returns the same value as <span class='texttt'>rhs.valid()</span><a class='hidden_link' href='#futures.shared_future-8.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_future,constructor__'></a></span><code class='itemdecl'>shared_future(future&lt;R&gt;&amp;&amp; rhs) noexcept;
shared_future(shared_future&amp;&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4569'>#</a></div><div id='futures.shared_future-9.sentence-1' class='sentence'><span class='textit'>Effects:</span> Move constructs a <span class='texttt'>shared_&shy;future</span> object that refers to the
shared state that was originally referred to by <span class='texttt'>rhs</span> (if any)<a class='hidden_link' href='#futures.shared_future-9.sentence-1'>.</a></div></div></div><div class='para' id='futures.shared_future-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4573'>#</a></div><div id='futures.shared_future-10.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> 
<ul class='itemize'><li id='futures.shared_future-10.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-10.1'>(10.1)</a></div><div id='futures.shared_future-10.1.sentence-1' class='sentence'><span class='texttt'>valid()</span> returns the same value as <span class='texttt'>rhs.valid()</span> returned prior to
the constructor invocation<a class='hidden_link' href='#futures.shared_future-10.1.sentence-1'>.</a></div></li><li id='futures.shared_future-10.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-10.2'>(10.2)</a></div><div id='futures.shared_future-10.2.sentence-1' class='sentence'><span class='texttt'>rhs.valid() == false</span><a class='hidden_link' href='#futures.shared_future-10.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:shared_future,destructor'></a></span><code class='itemdecl'>~shared_future();
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4588'>#</a></div><div id='futures.shared_future-11.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='futures.shared_future-11.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-11.1'>(11.1)</a></div><div id='futures.shared_future-11.1.sentence-1' class='sentence'>Releases any shared state (<a href='futures.state'>[futures.state]</a>);</div></li><li id='futures.shared_future-11.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-11.2'>(11.2)</a></div><div id='futures.shared_future-11.2.sentence-1' class='sentence'>destroys <span class='texttt'>*this</span><a class='hidden_link' href='#futures.shared_future-11.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,shared_future'></a></span><span class='indexparent'><a class='index' id='lib:shared_future,operator='></a></span><code class='itemdecl'>shared_future&amp; operator=(shared_future&amp;&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-12'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4604'>#</a></div><div id='futures.shared_future-12.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='futures.shared_future-12.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-12.1'>(12.1)</a></div><div id='futures.shared_future-12.1.sentence-1' class='sentence'>Releases any shared state (<a href='futures.state'>[futures.state]</a>);</div></li><li id='futures.shared_future-12.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-12.2'>(12.2)</a></div><div id='futures.shared_future-12.2.sentence-1' class='sentence'>move assigns the contents of <span class='texttt'>rhs</span> to <span class='texttt'>*this</span><a class='hidden_link' href='#futures.shared_future-12.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.shared_future-13'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4613'>#</a></div><div id='futures.shared_future-13.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> 
<ul class='itemize'><li id='futures.shared_future-13.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-13.1'>(13.1)</a></div><div id='futures.shared_future-13.1.sentence-1' class='sentence'><span class='texttt'>valid()</span> returns the same value as <span class='texttt'>rhs.valid()</span> returned prior to
the assignment<a class='hidden_link' href='#futures.shared_future-13.1.sentence-1'>.</a></div></li><li id='futures.shared_future-13.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-13.2'>(13.2)</a></div><div id='futures.shared_future-13.2.sentence-1' class='sentence'><span class='texttt'>rhs.valid() == false</span><a class='hidden_link' href='#futures.shared_future-13.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,shared_future_'></a></span><span class='indexparent'><a class='index' id='lib:shared_future,operator=_'></a></span><code class='itemdecl'>shared_future&amp; operator=(const shared_future&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-14'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4631'>#</a></div><div id='futures.shared_future-14.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='futures.shared_future-14.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-14.1'>(14.1)</a></div><div id='futures.shared_future-14.1.sentence-1' class='sentence'>Releases any shared state (<a href='futures.state'>[futures.state]</a>);</div></li><li id='futures.shared_future-14.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-14.2'>(14.2)</a></div><div id='futures.shared_future-14.2.sentence-1' class='sentence'>assigns the contents of <span class='texttt'>rhs</span> to <span class='texttt'>*this</span><a class='hidden_link' href='#futures.shared_future-14.2.sentence-1'>.</a></div> <div id='futures.shared_future-14.2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.shared_future-14.2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.shared_future-14.2.sentence-2' class='sentence'>As a result,
<span class='texttt'>*this</span> refers to the same shared state as <span class='texttt'>rhs</span>
(if any)<a class='hidden_link' href='#futures.shared_future-14.2.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul></div></div></div><div class='para' id='futures.shared_future-15'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4642'>#</a></div><div id='futures.shared_future-15.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>valid() == rhs.valid()</span><a class='hidden_link' href='#futures.shared_future-15.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:get,shared_future'></a></span><span class='indexparent'><a class='index' id='lib:shared_future,get'></a></span><code class='itemdecl'>const R&amp; shared_future::get() const;
R&amp; shared_future&lt;R&amp;&gt;::get() const;
void shared_future&lt;void&gt;::get() const;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-16'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4654'>#</a></div><div id='futures.shared_future-16.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.shared_future-16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.shared_future-16.sentence-1' class='sentence'>As described above, the template and its two required specializations differ only in
the return type and return value of the member function <span class='texttt'>get</span><a class='hidden_link' href='#futures.shared_future-16.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='futures.shared_future-17'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4660'>#</a></div><div id='futures.shared_future-17.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.shared_future-17.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.shared_future-17.sentence-1' class='sentence'>Access to a value object stored in the shared state is
unsynchronized, so programmers should apply only those operations on <span class='texttt'>R</span> that do not
introduce a data race (<a href='intro.multithread'>[intro.multithread]</a>)<a class='hidden_link' href='#futures.shared_future-17.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='futures.shared_future-18'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4667'>#</a></div><div id='futures.shared_future-18.sentence-1' class='sentence'><span class='textit'>Effects:</span> <span class='texttt'>wait()</span>s until the shared state is ready, then retrieves the
value stored in the shared state<a class='hidden_link' href='#futures.shared_future-18.sentence-1'>.</a></div></div></div><div class='para' id='futures.shared_future-19'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4671'>#</a></div><div id='futures.shared_future-19.sentence-1' class='sentence'><span class='textit'>Returns:</span> 
<ul class='itemize'><li id='futures.shared_future-19.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-19.1'>(19.1)</a></div><div id='futures.shared_future-19.1.sentence-1' class='sentence'><span class='texttt'>shared_&shy;future&#x200b;::&#x200b;get()</span> returns a const reference to the value stored in the object's
shared state<a class='hidden_link' href='#futures.shared_future-19.1.sentence-1'>.</a></div> <div id='futures.shared_future-19.1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.shared_future-19.1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.shared_future-19.1.sentence-2' class='sentence'>Access through that reference after the shared state has been
destroyed produces undefined behavior; this can be avoided by not storing the reference in any
storage with a greater lifetime than the <span class='texttt'>shared_&shy;future</span> object that returned the
reference<a class='hidden_link' href='#futures.shared_future-19.1.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li><li id='futures.shared_future-19.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-19.2'>(19.2)</a></div><div id='futures.shared_future-19.2.sentence-1' class='sentence'><span class='texttt'>shared_&shy;future&lt;R&amp;&gt;&#x200b;::&#x200b;get()</span> returns the reference stored as value in the object's
shared state<a class='hidden_link' href='#futures.shared_future-19.2.sentence-1'>.</a></div></li><li id='futures.shared_future-19.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-19.3'>(19.3)</a></div><div id='futures.shared_future-19.3.sentence-1' class='sentence'><span class='texttt'>shared_&shy;future&lt;void&gt;&#x200b;::&#x200b;get()</span> returns nothing<a class='hidden_link' href='#futures.shared_future-19.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.shared_future-20'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4690'>#</a></div><div id='futures.shared_future-20.sentence-1' class='sentence'><span class='textit'>Throws:</span> The stored exception, if an exception was stored in the shared state<a class='hidden_link' href='#futures.shared_future-20.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:valid,shared_future'></a></span><span class='indexparent'><a class='index' id='lib:shared_future,valid'></a></span><code class='itemdecl'>bool valid() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-21'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4700'>#</a></div><div id='futures.shared_future-21.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> only if <span class='texttt'>*this</span> refers to a shared state<a class='hidden_link' href='#futures.shared_future-21.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait,shared_future'></a></span><span class='indexparent'><a class='index' id='lib:shared_future,wait'></a></span><code class='itemdecl'>void wait() const;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-22'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4710'>#</a></div><div id='futures.shared_future-22.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
Blocks until the shared state is ready<a class='hidden_link' href='#futures.shared_future-22.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_for,shared_future'></a></span><span class='indexparent'><a class='index' id='lib:shared_future,wait_for'></a></span><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  future_status wait_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time) const;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-23'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4722'>#</a></div><div id='futures.shared_future-23.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
None if the shared state contains a deferred function (<a href='futures.async'>[futures.async]</a>),
otherwise
blocks until the shared state is ready or until
the relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by
<span class='texttt'>rel_&shy;time</span> has expired<a class='hidden_link' href='#futures.shared_future-23.sentence-1'>.</a></div></div></div><div class='para' id='futures.shared_future-24'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4730'>#</a></div><div id='futures.shared_future-24.sentence-1' class='sentence'><span class='textit'>Returns:</span> </div><div id='futures.shared_future-24.sentence-2' class='sentence'><ul class='itemize'><li id='futures.shared_future-24.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-24.1'>(24.1)</a></div><div id='futures.shared_future-24.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;deferred</span> if the shared state contains a deferred
function<a class='hidden_link' href='#futures.shared_future-24.1.sentence-1'>.</a></div></li><li id='futures.shared_future-24.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-24.2'>(24.2)</a></div><div id='futures.shared_future-24.2.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;ready</span> if the shared state is ready<a class='hidden_link' href='#futures.shared_future-24.2.sentence-1'>.</a></div></li><li id='futures.shared_future-24.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-24.3'>(24.3)</a></div><div id='futures.shared_future-24.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;timeout</span> if the function is returning because the
relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>)
specified by <span class='texttt'>rel_&shy;time</span> has expired<a class='hidden_link' href='#futures.shared_future-24.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.shared_future-25'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4744'>#</a></div><div id='futures.shared_future-25.sentence-1' class='sentence'><span class='textit'>Throws:</span> 
timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#futures.shared_future-25.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:wait_until,shared_future'></a></span><span class='indexparent'><a class='index' id='lib:shared_future,wait_until'></a></span><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  future_status wait_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time) const;
</code><div class='itemdescr'></div><div class='para' id='futures.shared_future-26'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4756'>#</a></div><div id='futures.shared_future-26.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
None if the shared state contains a deferred function (<a href='futures.async'>[futures.async]</a>),
otherwise
blocks until the shared state is ready or until the
absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by
<span class='texttt'>abs_&shy;time</span> has expired<a class='hidden_link' href='#futures.shared_future-26.sentence-1'>.</a></div></div></div><div class='para' id='futures.shared_future-27'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4764'>#</a></div><div id='futures.shared_future-27.sentence-1' class='sentence'><span class='textit'>Returns:</span> </div><div id='futures.shared_future-27.sentence-2' class='sentence'><ul class='itemize'><li id='futures.shared_future-27.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-27.1'>(27.1)</a></div><div id='futures.shared_future-27.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;deferred</span> if the shared state contains a deferred
function<a class='hidden_link' href='#futures.shared_future-27.1.sentence-1'>.</a></div></li><li id='futures.shared_future-27.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-27.2'>(27.2)</a></div><div id='futures.shared_future-27.2.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;ready</span> if the shared state is ready<a class='hidden_link' href='#futures.shared_future-27.2.sentence-1'>.</a></div></li><li id='futures.shared_future-27.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.shared_future-27.3'>(27.3)</a></div><div id='futures.shared_future-27.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;status&#x200b;::&#x200b;timeout</span> if the function is returning because the
absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>)
specified by <span class='texttt'>abs_&shy;time</span> has expired<a class='hidden_link' href='#futures.shared_future-27.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.shared_future-28'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared_future-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4778'>#</a></div><div id='futures.shared_future-28.sentence-1' class='sentence'><span class='textit'>Throws:</span> 
timeout-related exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>)<a class='hidden_link' href='#futures.shared_future-28.sentence-1'>.</a></div></div></div></div><div id='futures.async' class='section'><h3 ><a class='secnum' href='#futures.async' style='min-width:103pt'>33.6.9</a> Function template <span class='texttt'>async</span> <a class='abbr_ref' href='futures.async'>[futures.async]</a></h3><div class='para' id='futures.async-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4785'>#</a></div><div id='futures.async-1.sentence-1' class='sentence'>The function template <span class='texttt'>async</span> provides a mechanism to launch a function potentially
in a new thread and provides the result of the function in a <span class='texttt'>future</span> object with which
it shares a shared state<a class='hidden_link' href='#futures.async-1.sentence-1'>.</a></div> <span class='indexparent'><a class='index' id='lib:async'></a></span></div><code class='itemdecl'>template &lt;class F, class... Args&gt;
  future&lt;invoke_result_t&lt;decay_t&lt;F&gt;, decay_t&lt;Args&gt;...&gt;&gt;
    async(F&amp;&amp; f, Args&amp;&amp;... args);
template &lt;class F, class... Args&gt;
  future&lt;invoke_result_t&lt;decay_t&lt;F&gt;, decay_t&lt;Args&gt;...&gt;&gt;
    async(launch policy, F&amp;&amp; f, Args&amp;&amp;... args);
</code><div class='itemdescr'></div><div class='para' id='futures.async-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4801'>#</a></div><div id='futures.async-2.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>F</span> and each <span class='texttt'>Ti</span> in <span class='texttt'>Args</span> shall
satisfy the
<span class='texttt'>MoveConstructible</span> requirements, and
<pre class='codeblock'>
<span class='textit'>INVOKE</span>(<span class='textit'>DECAY_COPY</span>(std::forward&lt;F&gt;(f)),
       <span class='textit'>DECAY_COPY</span>(std::forward&lt;Args&gt;(args))...)     <span class='comment'>// see <a href='func.require'>[func.require]</a>, <a href='thread.thread.constr'>[thread.thread.constr]</a>
</span></pre>
shall be a valid expression<a class='hidden_link' href='#futures.async-2.sentence-1'>.</a></div></div></div><div class='para' id='futures.async-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4811'>#</a></div><div id='futures.async-3.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
The first function
behaves the same as a call to the second function with a <span class='texttt'>policy</span> argument of
<span class='texttt'>launch&#x200b;::&#x200b;async | launch&#x200b;::&#x200b;deferred</span>
and the same arguments for <span class='texttt'>F</span> and <span class='texttt'>Args</span><a class='hidden_link' href='#futures.async-3.sentence-1'>.</a></div> <div id='futures.async-3.sentence-2' class='sentence'>The second function creates a shared state that is associated with
the returned <span class='texttt'>future</span> object<a class='hidden_link' href='#futures.async-3.sentence-2'>.</a></div> <div id='futures.async-3.sentence-3' class='sentence'>The further behavior
of the second function depends on the <span class='texttt'>policy</span> argument as follows (if
more than one of these conditions applies, the implementation may choose any of
the corresponding policies):</div><div id='futures.async-3.sentence-4' class='sentence'><ul class='itemize'><li id='futures.async-3.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.async-3.1'>(3.1)</a></div><div id='futures.async-3.1.sentence-1' class='sentence'>If <span class='texttt'>launch&#x200b;::&#x200b;async</span> is set in <span class='texttt'>policy</span>, calls
<span class='texttt'><span class='textit'>INVOKE</span>(<span class='textit'>DECAY_&shy;COPY</span>(std&#x200b;::&#x200b;forward&lt;F&gt;(f)),</span>
<span class='texttt'><span class='textit'>DECAY_&shy;COPY</span>(std&#x200b;::&#x200b;forward&lt;Args&gt;(args))...)</span>
(<a href='func.require'>[func.require]</a>, <a href='thread.thread.constr'>[thread.thread.constr]</a>)
as if in a new thread of execution represented by a <span class='texttt'>thread</span> object
with the calls to <span class='texttt'><span class='textit'>DECAY_&shy;COPY</span></span> being evaluated in the thread that called <span class='texttt'>async</span><a class='hidden_link' href='#futures.async-3.1.sentence-1'>.</a></div> <div id='futures.async-3.1.sentence-2' class='sentence'>Any return value
is stored as the result in the
shared state<a class='hidden_link' href='#futures.async-3.1.sentence-2'>.</a></div> <div id='futures.async-3.1.sentence-3' class='sentence'>Any exception propagated from
the execution of
<span class='texttt'><span class='textit'>INVOKE</span>(<span class='textit'>DECAY_&shy;COPY</span>(std&#x200b;::&#x200b;forward&lt;F&gt;(f)),
<span class='textit'>DECAY_&shy;COPY</span>(std&#x200b;::&#x200b;forward&lt;Args&gt;(args))...)</span>
is stored as the exceptional result in the shared state<a class='hidden_link' href='#futures.async-3.1.sentence-3'>.</a></div> <div id='futures.async-3.1.sentence-4' class='sentence'>The <span class='texttt'>thread</span> object is
stored in the shared state
and affects the behavior of any asynchronous return objects that
reference that state<a class='hidden_link' href='#futures.async-3.1.sentence-4'>.</a></div></li><li id='futures.async-3.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.async-3.2'>(3.2)</a></div><div id='futures.async-3.2.sentence-1' class='sentence'>If <span class='texttt'>launch&#x200b;::&#x200b;deferred</span> is set in <span class='texttt'>policy</span>,
stores <span class='texttt'><span class='textit'>DECAY_&shy;COPY</span>(std&#x200b;::&#x200b;forward&lt;F&gt;(f))</span> and
<span class='texttt'><span class='textit'>DECAY_&shy;COPY</span>(std&#x200b;::&#x200b;forward&lt;Args&gt;(args))...</span>
in the shared state<a class='hidden_link' href='#futures.async-3.2.sentence-1'>.</a></div> <div id='futures.async-3.2.sentence-2' class='sentence'>These copies of <span class='texttt'>f</span> and <span class='texttt'>args</span> constitute
a <a class='hidden_link' href='#def:deferred_function' id='def:deferred_function'><i >deferred function</i></a><a class='hidden_link' href='#futures.async-3.2.sentence-2'>.</a></div> <div id='futures.async-3.2.sentence-3' class='sentence'>Invocation of the deferred function evaluates
<span class='texttt'><span class='textit'>INVOKE</span>(std&#x200b;::&#x200b;move(g), std&#x200b;::&#x200b;move(xyz))</span> where <span class='texttt'>g</span> is the stored value of
<span class='texttt'><span class='textit'>DECAY_&shy;COPY</span>(std&#x200b;::&#x200b;forward&lt;F&gt;(f))</span> and <span class='texttt'>xyz</span> is the stored copy of
<span class='texttt'><span class='textit'>DECAY_&shy;COPY</span>(std&#x200b;::&#x200b;forward&lt;Args&gt;(args))...</span><a class='hidden_link' href='#futures.async-3.2.sentence-3'>.</a></div> <div id='futures.async-3.2.sentence-4' class='sentence'>Any return value is stored
as the result in the shared state<a class='hidden_link' href='#futures.async-3.2.sentence-4'>.</a></div> <div id='futures.async-3.2.sentence-5' class='sentence'>Any exception propagated
from the execution
of the deferred function
is stored as the exceptional result
in the shared state<a class='hidden_link' href='#futures.async-3.2.sentence-5'>.</a></div> <div id='futures.async-3.2.sentence-6' class='sentence'>The shared state is not
made ready until the function has completed<a class='hidden_link' href='#futures.async-3.2.sentence-6'>.</a></div> <div id='futures.async-3.2.sentence-7' class='sentence'>The first call to a
non-timed waiting function (<a href='futures.state'>[futures.state]</a>)
on an asynchronous return object referring to
this shared state shall invoke the
deferred function in the thread that called the waiting function<a class='hidden_link' href='#futures.async-3.2.sentence-7'>.</a></div> <div id='futures.async-3.2.sentence-8' class='sentence'>Once evaluation of <span class='texttt'><span class='textit'>INVOKE</span>(std&#x200b;::&#x200b;move(g), std&#x200b;::&#x200b;move(xyz))</span> begins, the function is no longer
considered deferred<a class='hidden_link' href='#futures.async-3.2.sentence-8'>.</a></div> <div id='futures.async-3.2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.async-3.2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.async-3.2.sentence-9' class='sentence'>If this policy is specified together with other policies, such as when using a
<span class='texttt'>policy</span> value of <span class='texttt'>launch&#x200b;::&#x200b;async | launch&#x200b;::&#x200b;deferred</span>, implementations should defer
invocation or the selection of the policy when no more concurrency can be effectively
exploited<a class='hidden_link' href='#futures.async-3.2.sentence-9'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li><li id='futures.async-3.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.async-3.3'>(3.3)</a></div><div id='futures.async-3.3.sentence-1' class='sentence'>If no value is set in the launch policy, or a value is set that is neither specified
in this document nor by the implementation, the behavior is undefined<a class='hidden_link' href='#futures.async-3.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.async-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4878'>#</a></div><div id='futures.async-4.sentence-1' class='sentence'><span class='textit'>Returns:</span> An object of type
<span class='texttt'>future&lt;invoke_&shy;result_&shy;t&lt;decay_&shy;t&lt;F&gt;, decay_&shy;t&lt;Args&gt;...&gt;&gt;</span> that refers
to the shared state created by this call to <span class='texttt'>async</span><a class='hidden_link' href='#futures.async-4.sentence-1'>.</a></div> <div id='futures.async-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.async-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.async-4.sentence-2' class='sentence'>If a future obtained from <span class='texttt'>async</span> is moved outside the local scope,
other code that uses the future should be aware that the future's destructor may
block for the shared state to become ready<a class='hidden_link' href='#futures.async-4.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='futures.async-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4886'>#</a></div><div id='futures.async-5.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> 
Regardless of the provided <span class='texttt'>policy</span> argument,
<ul class='itemize'><li id='futures.async-5.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.async-5.1'>(5.1)</a></div><div id='futures.async-5.1.sentence-1' class='sentence'>the invocation of <span class='texttt'>async</span>
<a href='intro.multithread#def:synchronize_with'>synchronizes with</a> the invocation of <span class='texttt'>f</span><a class='hidden_link' href='#futures.async-5.1.sentence-1'>.</a></div> <div id='futures.async-5.1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.async-5.1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.async-5.1.sentence-3' class='sentence'>This statement applies even when the corresponding <span class='texttt'>future</span> object is moved to
another thread<a class='hidden_link' href='#futures.async-5.1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='futures.async-5.1.sentence-2' class='sentence'>; and</div></li><li id='futures.async-5.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.async-5.2'>(5.2)</a></div><div id='futures.async-5.2.sentence-1' class='sentence'>the completion of the function <span class='texttt'>f</span> is sequenced before (<a href='intro.multithread'>[intro.multithread]</a>) the shared state is made ready<a class='hidden_link' href='#futures.async-5.2.sentence-1'>.</a></div> <div id='futures.async-5.2.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.async-5.2.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.async-5.2.sentence-2' class='sentence'><span class='texttt'>f</span> might not be called at all,
so its completion might never happen<a class='hidden_link' href='#futures.async-5.2.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul></div><div id='futures.async-5.sentence-2' class='sentence'>If the implementation chooses the <span class='texttt'>launch&#x200b;::&#x200b;async</span> policy,</div><div id='futures.async-5.sentence-3' class='sentence'><ul class='itemize'><li id='futures.async-5.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.async-5.3'>(5.3)</a></div><div id='futures.async-5.3.sentence-1' class='sentence'>a call to a waiting function on an asynchronous return
object that shares the shared state created by this <span class='texttt'>async</span> call shall
block until the associated thread has completed, as if joined, or else time
out (<a href='thread.thread.member'>[thread.thread.member]</a>);</div></li><li id='futures.async-5.4'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.async-5.4'>(5.4)</a></div><div id='futures.async-5.4.sentence-1' class='sentence'>the associated thread completion
<a href='intro.multithread#def:synchronize_with'>synchronizes with</a>
the return from
the first function
that successfully detects the ready status of the shared state or
with the return from the last
function that releases the shared state, whichever
happens first<a class='hidden_link' href='#futures.async-5.4.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.async-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4923'>#</a></div><div id='futures.async-6.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> if <span class='texttt'>policy == launch&#x200b;::&#x200b;async</span> and the
implementation is unable to start a new thread, or
<span class='texttt'>std&#x200b;::&#x200b;bad_&shy;alloc</span> if memory for the internal data structures
could not be allocated<a class='hidden_link' href='#futures.async-6.sentence-1'>.</a></div></div></div><div class='para' id='futures.async-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4929'>#</a></div><div id='futures.async-7.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='futures.async-7.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.async-7.1'>(7.1)</a></div><div id='futures.async-7.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if
<span class='texttt'>policy == launch&#x200b;::&#x200b;async</span> and the system is unable to start a new thread<a class='hidden_link' href='#futures.async-7.1.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='futures.async-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4937'>#</a></div><div id='futures.async-8.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#futures.async-8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
int work1(int value);
int work2(int value);
int work(int value) {
  auto handle = std::async([=]{ return work2(value); });
  int tmp = work1(value);
  return tmp + handle.get();    <span class='comment'>// #1
</span>}</pre><div id='futures.async-8.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.async-8.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.async-8.sentence-1' class='sentence'>Line #1 might not result in concurrency because
the <span class='texttt'>async</span> call uses the default policy, which may use
<span class='texttt'>launch&#x200b;::&#x200b;deferred</span>, in which case the lambda might not be invoked until the
<span class='texttt'>get()</span> call; in that case, <span class='texttt'>work1</span> and <span class='texttt'>work2</span> are called on the
same thread and there is no concurrency<a class='hidden_link' href='#futures.async-8.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='futures.task' class='section'><h3 ><a class='secnum' href='#futures.task' style='min-width:103pt'>33.6.10</a> Class template <span class='texttt'>packaged_&shy;task</span> <a class='abbr_ref' href='futures.task'>[futures.task]</a></h3><div class='para' id='futures.task-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.task-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4959'>#</a></div><div id='futures.task-1.sentence-1' class='sentence'>The class template <span class='texttt'>packaged_&shy;task</span> defines a type for wrapping a function or
callable object so that the return value of the function or callable object is stored in
a future when it is invoked<a class='hidden_link' href='#futures.task-1.sentence-1'>.</a></div></div><div class='para' id='futures.task-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.task-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L4964'>#</a></div><div id='futures.task-2.sentence-1' class='sentence'>When the <span class='texttt'>packaged_&shy;task</span> object is invoked, its stored task is invoked and the
result (whether normal or exceptional) stored in the shared state<a class='hidden_link' href='#futures.task-2.sentence-1'>.</a></div> <div id='futures.task-2.sentence-2' class='sentence'>Any futures that
share the shared state will then be able to access the stored result<a class='hidden_link' href='#futures.task-2.sentence-2'>.</a></div><span class='indexparent'><a class='index' id='lib:packaged_task'></a></span><pre class='codeblock'>
namespace std {
  template&lt;class&gt; class packaged_task; <span class='comment'>// not defined
</span>
  template&lt;class R, class... ArgTypes&gt;
  class packaged_task&lt;R(ArgTypes...)&gt; {
  public:
    <span class='comment'>// construction and destruction
</span>    packaged_task() noexcept;
    template &lt;class F&gt;
      explicit packaged_task(F&amp;&amp; f);
    ~packaged_task();

    <span class='comment'>// no copy
</span>    packaged_task(const packaged_task&amp;) = delete;
    packaged_task&amp; operator=(const packaged_task&amp;) = delete;

    <span class='comment'>// move support
</span>    packaged_task(packaged_task&amp;&amp; rhs) noexcept;
    packaged_task&amp; operator=(packaged_task&amp;&amp; rhs) noexcept;
    void swap(packaged_task&amp; other) noexcept;

    bool valid() const noexcept;

    <span class='comment'>// result retrieval
</span>    future&lt;R&gt; get_future();

    <span class='comment'>// execution
</span>    void operator()(ArgTypes... );
    void make_ready_at_thread_exit(ArgTypes...);

    void reset();
  };

  template &lt;class R, class... ArgTypes&gt;
    void swap(packaged_task&lt;R(ArgTypes...)&gt;&amp; x, packaged_task&lt;R(ArgTypes...)&gt;&amp; y) noexcept;

  template &lt;class R, class Alloc&gt;
    struct uses_allocator&lt;packaged_task&lt;R&gt;, Alloc&gt;;
}</pre></div><div id='futures.task.members' class='section'><h4 ><a class='secnum' href='#futures.task.members' style='min-width:118pt'>33.6.10.1</a> <span class='texttt'>packaged_&shy;task</span> member functions <a class='abbr_ref' href='futures.task.members'>[futures.task.members]</a></h4><span class='indexparent'><a class='index' id='lib:packaged_task,constructor'></a></span><code class='itemdecl'>packaged_task() noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5020'>#</a></div><div id='futures.task.members-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a <span class='texttt'>packaged_&shy;task</span> object with no shared state and no stored task<a class='hidden_link' href='#futures.task.members-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:packaged_task,constructor_'></a></span><code class='itemdecl'>template &lt;class F&gt;
  packaged_task(F&amp;&amp; f);
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5031'>#</a></div><div id='futures.task.members-2.sentence-1' class='sentence'><span class='textit'>Requires:</span> 
<span class='texttt'><span class='textit'>INVOKE</span>&lt;R&gt;(f, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_N"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span>)</span> (<a href='func.require'>[func.require]</a>), where <span class='texttt'>t<span class="mjx-chtml"><span class="mjx-math" aria-label="_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_N"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span></span> are values
of the corresponding types in <span class='texttt'>ArgTypes...</span>, shall be a valid expression<a class='hidden_link' href='#futures.task.members-2.sentence-1'>.</a></div> <div id='futures.task.members-2.sentence-2' class='sentence'>Invoking
a copy of <span class='texttt'>f</span> shall behave the same as invoking <span class='texttt'>f</span><a class='hidden_link' href='#futures.task.members-2.sentence-2'>.</a></div></div></div><div class='para' id='futures.task.members-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5037'>#</a></div><div id='futures.task.members-3.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
This constructor shall not participate in overload resolution if <span class='texttt'>decay_&shy;t&lt;F&gt;</span>
is the same type as <span class='texttt'>packaged_&shy;task&lt;R(ArgTypes...)&gt;</span><a class='hidden_link' href='#futures.task.members-3.sentence-1'>.</a></div></div></div><div class='para' id='futures.task.members-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5042'>#</a></div><div id='futures.task.members-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a new <span class='texttt'>packaged_&shy;task</span> object with a shared state and
initializes the object's stored task with <span class='texttt'>std&#x200b;::&#x200b;forward&lt;F&gt;(f)</span><a class='hidden_link' href='#futures.task.members-4.sentence-1'>.</a></div></div></div><div class='para' id='futures.task.members-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5046'>#</a></div><div id='futures.task.members-5.sentence-1' class='sentence'><span class='textit'>Throws:</span> 
<ul class='itemize'><li id='futures.task.members-5.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-5.1'>(5.1)</a></div><div id='futures.task.members-5.1.sentence-1' class='sentence'>Any exceptions thrown by the copy or move constructor of <span class='texttt'>f</span><a class='hidden_link' href='#futures.task.members-5.1.sentence-1'>.</a></div></li><li id='futures.task.members-5.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-5.2'>(5.2)</a></div><div id='futures.task.members-5.2.sentence-1' class='sentence'>For the first version,
   <span class='texttt'>bad_&shy;alloc</span> if memory for the internal data structures could not be allocated<a class='hidden_link' href='#futures.task.members-5.2.sentence-1'>.</a></div></li><li id='futures.task.members-5.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-5.3'>(5.3)</a></div><div id='futures.task.members-5.3.sentence-1' class='sentence'>For the second version,
   any exceptions thrown by <span class='texttt'>allocator_&shy;traits&lt;Allocator&gt;&#x200b;::&#x200b;template</span>
   <span class='texttt'>rebind_&shy;traits&lt;<span class='textit'><span class='texttt'>unspecified</span></span>&gt;&#x200b;::&#x200b;allocate</span><a class='hidden_link' href='#futures.task.members-5.3.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:packaged_task,constructor__'></a></span><code class='itemdecl'>packaged_task(packaged_task&amp;&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5064'>#</a></div><div id='futures.task.members-6.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a new <span class='texttt'>packaged_&shy;task</span> object and transfers ownership of
<span class='texttt'>rhs</span>'s shared state to <span class='texttt'>*this</span>, leaving <span class='texttt'>rhs</span> with no
shared state<a class='hidden_link' href='#futures.task.members-6.sentence-1'>.</a></div> <div id='futures.task.members-6.sentence-2' class='sentence'>Moves the stored task from <span class='texttt'>rhs</span> to <span class='texttt'>*this</span><a class='hidden_link' href='#futures.task.members-6.sentence-2'>.</a></div></div></div><div class='para' id='futures.task.members-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5069'>#</a></div><div id='futures.task.members-7.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>rhs</span> has no shared state<a class='hidden_link' href='#futures.task.members-7.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,packaged_task'></a></span><span class='indexparent'><a class='index' id='lib:packaged_task,operator='></a></span><code class='itemdecl'>packaged_task&amp; operator=(packaged_task&amp;&amp; rhs) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5079'>#</a></div><div id='futures.task.members-8.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
<ul class='itemize'><li id='futures.task.members-8.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-8.1'>(8.1)</a></div><div id='futures.task.members-8.1.sentence-1' class='sentence'>Releases any shared state (<a href='futures.state'>[futures.state]</a>);</div></li><li id='futures.task.members-8.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-8.2'>(8.2)</a></div><div id='futures.task.members-8.2.sentence-1' class='sentence'>calls <span class='texttt'>packaged_&shy;task(std&#x200b;::&#x200b;move(rhs)).swap(*this)</span><a class='hidden_link' href='#futures.task.members-8.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:packaged_task,destructor'></a></span><code class='itemdecl'>~packaged_task();
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5095'>#</a></div><div id='futures.task.members-9.sentence-1' class='sentence'><span class='textit'>Effects:</span> 
Abandons any shared state (<a href='futures.state'>[futures.state]</a>)<a class='hidden_link' href='#futures.task.members-9.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:swap,packaged_task'></a></span><span class='indexparent'><a class='index' id='lib:packaged_task,swap'></a></span><code class='itemdecl'>void swap(packaged_task&amp; other) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5106'>#</a></div><div id='futures.task.members-10.sentence-1' class='sentence'><span class='textit'>Effects:</span> Exchanges the shared states and stored tasks of <span class='texttt'>*this</span> and <span class='texttt'>other</span><a class='hidden_link' href='#futures.task.members-10.sentence-1'>.</a></div></div></div><div class='para' id='futures.task.members-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5109'>#</a></div><div id='futures.task.members-11.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>*this</span> has the same shared state
and stored task (if any) as <span class='texttt'>other</span>
prior to the call to <span class='texttt'>swap</span><a class='hidden_link' href='#futures.task.members-11.sentence-1'>.</a></div> <div id='futures.task.members-11.sentence-2' class='sentence'><span class='texttt'>other</span> has the same shared state
and stored task (if any)
as <span class='texttt'>*this</span> prior to the call to <span class='texttt'>swap</span><a class='hidden_link' href='#futures.task.members-11.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:valid,packaged_task'></a></span><span class='indexparent'><a class='index' id='lib:packaged_task,valid'></a></span><code class='itemdecl'>bool valid() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-12'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5123'>#</a></div><div id='futures.task.members-12.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> only if <span class='texttt'>*this</span> has a shared state<a class='hidden_link' href='#futures.task.members-12.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:get_future,packaged_task'></a></span><span class='indexparent'><a class='index' id='lib:packaged_task,get_future'></a></span><code class='itemdecl'>future&lt;R&gt; get_future();
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-13'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5133'>#</a></div><div id='futures.task.members-13.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>future</span> object that shares the same shared state as <span class='texttt'>*this</span><a class='hidden_link' href='#futures.task.members-13.sentence-1'>.</a></div></div></div><div class='para' id='futures.task.members-14'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5136'>#</a></div><div id='futures.task.members-14.sentence-1' class='sentence'><span class='textit'>Throws:</span> A <span class='texttt'>future_&shy;error</span> object if an error occurs<a class='hidden_link' href='#futures.task.members-14.sentence-1'>.</a></div></div></div><div class='para' id='futures.task.members-15'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5139'>#</a></div><div id='futures.task.members-15.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='futures.task.members-15.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-15.1'>(15.1)</a></div><div id='futures.task.members-15.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;already_&shy;retrieved</span> if <span class='texttt'>get_&shy;future</span> has already been called on
a <span class='texttt'>packaged_&shy;task</span> object with the same shared state as <span class='texttt'>*this</span><a class='hidden_link' href='#futures.task.members-15.1.sentence-1'>.</a></div></li><li id='futures.task.members-15.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-15.2'>(15.2)</a></div><div id='futures.task.members-15.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span> has no shared state<a class='hidden_link' href='#futures.task.members-15.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:operator(),packaged_task'></a></span><span class='indexparent'><a class='index' id='lib:packaged_task,operator()'></a></span><code class='itemdecl'>void operator()(ArgTypes... args);
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-16'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5154'>#</a></div><div id='futures.task.members-16.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'><span class='textit'>INVOKE</span>&lt;R&gt;(f, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_N"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span>)</span> (<a href='func.require'>[func.require]</a>),
where <span class='texttt'>f</span> is the
stored task of <span class='texttt'>*this</span> and
<span class='texttt'>t<span class="mjx-chtml"><span class="mjx-math" aria-label="_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_N"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span></span> are the values in <span class='texttt'>args...</span><a class='hidden_link' href='#futures.task.members-16.sentence-1'>.</a></div> <div id='futures.task.members-16.sentence-2' class='sentence'>If the task returns normally,
the return value is stored as the asynchronous result in the shared state of
<span class='texttt'>*this</span>, otherwise the exception thrown by the task is stored<a class='hidden_link' href='#futures.task.members-16.sentence-2'>.</a></div> <div id='futures.task.members-16.sentence-3' class='sentence'>The
shared state of <span class='texttt'>*this</span> is made ready, and any threads blocked in a
function waiting for
the shared state of <span class='texttt'>*this</span> to become ready are unblocked<a class='hidden_link' href='#futures.task.members-16.sentence-3'>.</a></div></div></div><div class='para' id='futures.task.members-17'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5165'>#</a></div><div id='futures.task.members-17.sentence-1' class='sentence'><span class='textit'>Throws:</span> A <span class='texttt'>future_&shy;error</span> exception object if there is no shared
state or the stored task has already been invoked<a class='hidden_link' href='#futures.task.members-17.sentence-1'>.</a></div></div></div><div class='para' id='futures.task.members-18'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5169'>#</a></div><div id='futures.task.members-18.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='futures.task.members-18.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-18.1'>(18.1)</a></div><div id='futures.task.members-18.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if
the stored task has already been invoked<a class='hidden_link' href='#futures.task.members-18.1.sentence-1'>.</a></div></li><li id='futures.task.members-18.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-18.2'>(18.2)</a></div><div id='futures.task.members-18.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span> has no shared state<a class='hidden_link' href='#futures.task.members-18.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:make_ready_at_thread_exit,packaged_task'></a></span><span class='indexparent'><a class='index' id='lib:packaged_task,make_ready_at_thread_exit'></a></span><code class='itemdecl'>void make_ready_at_thread_exit(ArgTypes... args);
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-19'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5184'>#</a></div><div id='futures.task.members-19.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'><span class='textit'>INVOKE</span>&lt;R&gt;(f, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_N"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span>)</span> (<a href='func.require'>[func.require]</a>),
where <span class='texttt'>f</span> is the stored task and
<span class='texttt'>t<span class="mjx-chtml"><span class="mjx-math" aria-label="_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math" aria-label="_N"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span></span> are the values in <span class='texttt'>args...</span><a class='hidden_link' href='#futures.task.members-19.sentence-1'>.</a></div> <div id='futures.task.members-19.sentence-2' class='sentence'>If the task returns normally,
the return value is stored as the asynchronous result in the shared state of
<span class='texttt'>*this</span>, otherwise the exception thrown by the task is stored<a class='hidden_link' href='#futures.task.members-19.sentence-2'>.</a></div> <div id='futures.task.members-19.sentence-3' class='sentence'>In either
case, this shall be done without making that state ready (<a href='futures.state'>[futures.state]</a>) immediately<a class='hidden_link' href='#futures.task.members-19.sentence-3'>.</a></div> <div id='futures.task.members-19.sentence-4' class='sentence'>Schedules
the shared state to be made ready when the current thread exits,
after all objects of thread storage duration associated with the current thread
have been destroyed<a class='hidden_link' href='#futures.task.members-19.sentence-4'>.</a></div></div></div><div class='para' id='futures.task.members-20'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5195'>#</a></div><div id='futures.task.members-20.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>future_&shy;error</span> if an error condition occurs<a class='hidden_link' href='#futures.task.members-20.sentence-1'>.</a></div></div></div><div class='para' id='futures.task.members-21'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5198'>#</a></div><div id='futures.task.members-21.sentence-1' class='sentence'><span class='textit'>Error conditions:</span> 
<ul class='itemize'><li id='futures.task.members-21.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-21.1'>(21.1)</a></div><div id='futures.task.members-21.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if the
stored task has already been invoked<a class='hidden_link' href='#futures.task.members-21.1.sentence-1'>.</a></div></li><li id='futures.task.members-21.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-21.2'>(21.2)</a></div><div id='futures.task.members-21.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span> has no shared state<a class='hidden_link' href='#futures.task.members-21.2.sentence-1'>.</a></div></li></ul></div></div></div><span class='indexparent'><a class='index' id='lib:reset,packaged_task'></a></span><span class='indexparent'><a class='index' id='lib:packaged_task,reset'></a></span><code class='itemdecl'>void reset();
</code><div class='itemdescr'></div><div class='para' id='futures.task.members-22'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5213'>#</a></div><div id='futures.task.members-22.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if <span class='texttt'>*this = packaged_&shy;task(std&#x200b;::&#x200b;move(f))</span>, where
<span class='texttt'>f</span> is the task stored in
<span class='texttt'>*this</span><a class='hidden_link' href='#futures.task.members-22.sentence-1'>.</a></div> <div id='futures.task.members-22.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#futures.task.members-22.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='futures.task.members-22.sentence-2' class='sentence'>This constructs a new shared state for <span class='texttt'>*this</span><a class='hidden_link' href='#futures.task.members-22.sentence-2'>.</a></div> <div id='futures.task.members-22.sentence-3' class='sentence'>The
old state is abandoned (<a href='futures.state'>[futures.state]</a>)<a class='hidden_link' href='#futures.task.members-22.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='futures.task.members-23'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5219'>#</a></div><div id='futures.task.members-23.sentence-1' class='sentence'><span class='textit'>Throws:</span> 
<ul class='itemize'><li id='futures.task.members-23.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-23.1'>(23.1)</a></div><div id='futures.task.members-23.1.sentence-1' class='sentence'><span class='texttt'>bad_&shy;alloc</span> if memory for the new shared state could not be allocated<a class='hidden_link' href='#futures.task.members-23.1.sentence-1'>.</a></div></li><li id='futures.task.members-23.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-23.2'>(23.2)</a></div><div id='futures.task.members-23.2.sentence-1' class='sentence'>any exception thrown by the move constructor of the task stored in the shared
state<a class='hidden_link' href='#futures.task.members-23.2.sentence-1'>.</a></div></li><li id='futures.task.members-23.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#futures.task.members-23.3'>(23.3)</a></div><div id='futures.task.members-23.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;error</span> with an error condition of <span class='texttt'>no_&shy;state</span> if <span class='texttt'>*this</span>
has no shared state<a class='hidden_link' href='#futures.task.members-23.3.sentence-1'>.</a></div></li></ul></div></div></div></div><div id='futures.task.nonmembers' class='section'><h4 ><a class='secnum' href='#futures.task.nonmembers' style='min-width:118pt'>33.6.10.2</a> <span class='texttt'>packaged_&shy;task</span> globals <a class='abbr_ref' href='futures.task.nonmembers'>[futures.task.nonmembers]</a></h4><span class='indexparent'><a class='index' id='lib:swap,packaged_task_'></a></span><span class='indexparent'><a class='index' id='lib:packaged_task,swap_'></a></span><code class='itemdecl'>template &lt;class R, class... ArgTypes&gt;
  void swap(packaged_task&lt;R(ArgTypes...)&gt;&amp; x, packaged_task&lt;R(ArgTypes...)&gt;&amp; y) noexcept;
</code><div class='itemdescr'></div><div class='para' id='futures.task.nonmembers-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.nonmembers-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5239'>#</a></div><div id='futures.task.nonmembers-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>x.swap(y)</span><a class='hidden_link' href='#futures.task.nonmembers-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:uses_allocator,packaged_task'></a></span><code class='itemdecl'>template &lt;class R, class Alloc&gt;
  struct uses_allocator&lt;packaged_task&lt;R&gt;, Alloc&gt;
    : true_type { };
</code><div class='itemdescr'></div><div class='para' id='futures.task.nonmembers-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.nonmembers-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/4ba4e9c2c04b7680ac2a56b65c241ec10c427c3f/source/threads.tex#L5251'>#</a></div><div id='futures.task.nonmembers-2.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>Alloc</span> shall be an <a href='allocator.requirements'>Allocator</a><a class='hidden_link' href='#futures.task.nonmembers-2.sentence-1'>.</a></div></div></div></div></div></div></div></body></html>