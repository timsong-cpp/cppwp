<!DOCTYPE html><html lang='en'><head><title>[thread.condition.condvar]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>33</a> Thread support library <a class='abbr_ref' href='./#thread'>[thread]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>33.5</a> Condition variables <a class='abbr_ref' href='thread.condition#condvar'>[thread.condition]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>33.5.3</a> Class <span class='texttt'>condition_&shy;variable</span> <a class='abbr_ref'>[thread.condition.condvar]</a></h3><p ><span class='indexparent'><a class='index' id='lib:condition_variable'></a></span></p><pre class='codeblock'>
namespace std {
  class condition_variable {
  public:

    condition_variable();
    ~condition_variable();

    condition_variable(const condition_variable&amp;) = delete;
    condition_variable&amp; operator=(const condition_variable&amp;) = delete;

    void notify_one() noexcept;
    void notify_all() noexcept;
    void wait(unique_lock&lt;mutex&gt;&amp; lock);
    template &lt;class Predicate&gt;
      void wait(unique_lock&lt;mutex&gt;&amp; lock, Predicate pred);
    template &lt;class Clock, class Duration&gt;
      cv_status wait_until(unique_lock&lt;mutex&gt;&amp; lock,
                           const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
    template &lt;class Clock, class Duration, class Predicate&gt;
      bool wait_until(unique_lock&lt;mutex&gt;&amp; lock,
                      const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time,
                      Predicate pred);

    template &lt;class Rep, class Period&gt;
      cv_status wait_for(unique_lock&lt;mutex&gt;&amp; lock,
                         const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
    template &lt;class Rep, class Period, class Predicate&gt;
      bool wait_for(unique_lock&lt;mutex&gt;&amp; lock,
                    const chrono::duration&lt;Rep, Period&gt;&amp; rel_time,
                    Predicate pred);

    using native_handle_type = <span class='textit'>implementation-defined</span>; <span class='comment'>// See <a href='thread.req.native'>[thread.req.native]</a>
</span>    native_handle_type native_handle();                <span class='comment'>// See <a href='thread.req.native'>[thread.req.native]</a>
</span>  };
}</pre><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2902'>#</a></div><p >The class <span class='texttt'>condition_&shy;variable</span> shall be a standard-layout class (Clause <a href='class'>[class]</a>).</p><p ><span class='indexparent'><a class='index' id='lib:condition_variable,constructor'></a></span></p></div><p ><code class='itemdecl'>condition_variable();
</code></p><div class='itemdescr'></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2911'>#</a></div><p ><span class='textit'>Effects:</span> Constructs an object of type <span class='texttt'>condition_&shy;variable</span>.</p></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2914'>#</a></div><p ><span class='textit'>Throws:</span> <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='thread.req.exception'>[thread.req.exception]</a>).</p></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2917'>#</a></div><p ><span class='textit'>Error conditions:</span> 
</p><ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#4.1'>(4.1)</a></div><p ><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if some non-memory resource
limitation prevents initialization.
</p></li></ul></div></div><p ><span class='indexparent'><a class='index' id='lib:condition_variable,destructor'></a></span></p><p ><code class='itemdecl'>~condition_variable();
</code></p><div class='itemdescr'></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2931'>#</a></div><p ><span class='textit'>Requires:</span> There shall be no thread blocked on <span class='texttt'>*this</span>. [<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  That is, all
threads shall have been notified; they may subsequently block on the lock specified in the
wait.
This relaxes the usual rules, which would have required all wait calls to happen before
destruction. Only the notification to unblock the wait must happen before destruction.
The user must take care to ensure that no threads wait on <span class='texttt'>*this</span> once the destructor has
been started, especially when the waiting threads are calling the wait functions in a loop or
using the overloads of <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span> that take a predicate.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2942'>#</a></div><p ><span class='textit'>Effects:</span> Destroys the object.
</p></div></div><p ><span class='indexparent'><a class='index' id='lib:notify_one,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,notify_one'></a></span></p><p ><code class='itemdecl'>void notify_one() noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2951'>#</a></div><p ><span class='textit'>Effects:</span> If any threads are blocked waiting for <span class='texttt'>*this</span>, unblocks one of those threads.
</p></div></div><p ><span class='indexparent'><a class='index' id='lib:notify_all,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,notify_all'></a></span></p><p ><code class='itemdecl'>void notify_all() noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2960'>#</a></div><p ><span class='textit'>Effects:</span> Unblocks all threads that are blocked waiting for <span class='texttt'>*this</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='lib:wait,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait'></a></span></p><p ><code class='itemdecl'>void wait(unique_lock&lt;mutex&gt;&amp; lock);
</code></p><div class='itemdescr'></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2969'>#</a></div><p ><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread, and either
</p><ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#9.1'>(9.1)</a></div><p >no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or
</p></li><li id='9.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#9.2'>(9.2)</a></div><p ><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads.
</p></li></ul></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2979'>#</a></div><p ><span class='textit'>Effects:</span> 
</p><ul class='itemize'><li id='10.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#10.1'>(10.1)</a></div><p >Atomically calls <span class='texttt'>lock.unlock()</span> and blocks on <span class='texttt'>*this</span>.
</p></li><li id='10.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#10.2'>(10.2)</a></div><p >When unblocked, calls <span class='texttt'>lock.lock()</span> (possibly blocking on the lock), then returns.
</p></li><li id='10.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#10.3'>(10.3)</a></div><p >The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one()</span>
or a call to <span class='texttt'>notify_&shy;all()</span>, or spuriously.
</p></li></ul></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2987'>#</a></div><p ><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  This can happen if the re-locking of the mutex throws an exception. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2993'>#</a></div><p ><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread.</p></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L2997'>#</a></div><p ><span class='textit'>Throws:</span> Nothing.</p></div></div><p ><span class='indexparent'><a class='index' id='lib:wait,condition_variable_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_'></a></span></p><p ><code class='itemdecl'>template &lt;class Predicate&gt;
  void wait(unique_lock&lt;mutex&gt;&amp; lock, Predicate pred);
</code></p><div class='itemdescr'></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3008'>#</a></div><p ><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span> is
locked by the calling thread, and either</p><ul class='itemize'><li id='14.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#14.1'>(14.1)</a></div><p >no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or
</p></li><li id='14.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#14.2'>(14.2)</a></div><p ><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads.
</p></li></ul></div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3019'>#</a></div><p ><span class='textit'>Effects:</span> Equivalent to:
</p><pre class='codeblock'>
while (!pred())
  wait(lock);</pre></div></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3026'>#</a></div><p ><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  This can happen if the re-locking of the mutex throws an exception. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3032'>#</a></div><p ><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread.</p></div></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3036'>#</a></div><p ><span class='textit'>Throws:</span> Any exception thrown by <span class='texttt'>pred</span>.</p></div></div><p ><span class='indexparent'><a class='index' id='lib:wait_until,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_until'></a></span></p><p ><code class='itemdecl'>template &lt;class Clock, class Duration&gt;
  cv_status wait_until(unique_lock&lt;mutex&gt;&amp; lock,
                       const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</code></p><div class='itemdescr'></div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3049'>#</a></div><p ><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread, and either
</p><ul class='itemize'><li id='19.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#19.1'>(19.1)</a></div><p >no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or
</p></li><li id='19.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#19.2'>(19.2)</a></div><p ><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads.
</p></li></ul></div></div><div class='para' id='20'><div class='marginalizedparent'><a class='marginalized' href='#20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3059'>#</a></div><p ><span class='textit'>Effects:</span> 
</p><ul class='itemize'><li id='20.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#20.1'>(20.1)</a></div><p >Atomically calls <span class='texttt'>lock.unlock()</span> and blocks on <span class='texttt'>*this</span>.</p></li><li id='20.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#20.2'>(20.2)</a></div><p >When unblocked, calls <span class='texttt'>lock.lock()</span> (possibly blocking on the lock), then returns.</p></li><li id='20.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#20.3'>(20.3)</a></div><p >The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one()</span>, a call to <span class='texttt'>notify_&shy;all()</span>,
expiration of the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>abs_&shy;time</span>,
or spuriously.</p></li><li id='20.4'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#20.4'>(20.4)</a></div><p >If the function exits via an exception, <span class='texttt'>lock.lock()</span> shall be called prior to exiting the function.
</p></li></ul></div></div><div class='para' id='21'><div class='marginalizedparent'><a class='marginalized' href='#21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3077'>#</a></div><p ><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  This can happen if the re-locking of the mutex throws an exception. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='22'><div class='marginalizedparent'><a class='marginalized' href='#22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3083'>#</a></div><p ><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread.</p></div></div><div class='para' id='23'><div class='marginalizedparent'><a class='marginalized' href='#23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3087'>#</a></div><p ><span class='textit'>Returns:</span> <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;timeout</span> if
the absolute timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>abs_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;no_&shy;timeout</span>.</p></div></div><div class='para' id='24'><div class='marginalizedparent'><a class='marginalized' href='#24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3092'>#</a></div><p ><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>).</p></div></div><p ><span class='indexparent'><a class='index' id='lib:wait_for,condition_variable'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_for'></a></span></p><p ><code class='itemdecl'>template &lt;class Rep, class Period&gt;
  cv_status wait_for(unique_lock&lt;mutex&gt;&amp; lock,
                     const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</code></p><div class='itemdescr'></div><div class='para' id='25'><div class='marginalizedparent'><a class='marginalized' href='#25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3105'>#</a></div><p ><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread, and either
</p><ul class='itemize'><li id='25.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#25.1'>(25.1)</a></div><p >no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or
</p></li><li id='25.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#25.2'>(25.2)</a></div><p ><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span> arguments
supplied by all concurrently waiting (via <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or
<span class='texttt'>wait_&shy;until</span>) threads.
</p></li></ul></div></div><div class='para' id='26'><div class='marginalizedparent'><a class='marginalized' href='#26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3115'>#</a></div><p ><span class='textit'>Effects:</span> Equivalent to:
</p><pre class='codeblock'>
return wait_until(lock, chrono::steady_clock::now() + rel_time);</pre></div></div><div class='para' id='27'><div class='marginalizedparent'><a class='marginalized' href='#27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3121'>#</a></div><p ><span class='textit'>Returns:</span> <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;timeout</span> if
the relative timeout (<a href='thread.req.timing'>[thread.req.timing]</a>) specified by <span class='texttt'>rel_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status&#x200b;::&#x200b;no_&shy;timeout</span>.</p></div></div><div class='para' id='28'><div class='marginalizedparent'><a class='marginalized' href='#28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3126'>#</a></div><p ><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  This can happen if the re-locking of the mutex throws an exception. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='29'><div class='marginalizedparent'><a class='marginalized' href='#29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3132'>#</a></div><p ><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread.</p></div></div><div class='para' id='30'><div class='marginalizedparent'><a class='marginalized' href='#30'>30</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3136'>#</a></div><p ><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>).</p></div></div><p ><span class='indexparent'><a class='index' id='lib:wait_until,condition_variable_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_until_'></a></span></p><p ><code class='itemdecl'>template &lt;class Clock, class Duration, class Predicate&gt;
  bool wait_until(unique_lock&lt;mutex&gt;&amp; lock,
                  const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time,
                  Predicate pred);
</code></p><div class='itemdescr'></div><div class='para' id='31'><div class='marginalizedparent'><a class='marginalized' href='#31'>31</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3151'>#</a></div><p ><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span> is
locked by the calling thread, and either</p><ul class='itemize'><li id='31.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#31.1'>(31.1)</a></div><p >no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or
</p></li><li id='31.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#31.2'>(31.2)</a></div><p ><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads.
</p></li></ul></div></div><div class='para' id='32'><div class='marginalizedparent'><a class='marginalized' href='#32'>32</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3162'>#</a></div><p ><span class='textit'>Effects:</span> Equivalent to:
</p><pre class='codeblock'>
while (!pred())
  if (wait_until(lock, abs_time) == cv_status::timeout)
    return pred();
return true;</pre></div></div><div class='para' id='33'><div class='marginalizedparent'><a class='marginalized' href='#33'>33</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3171'>#</a></div><p ><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  This can happen if the re-locking of the mutex throws an exception. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='34'><div class='marginalizedparent'><a class='marginalized' href='#34'>34</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3177'>#</a></div><p ><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread.</p></div></div><div class='para' id='35'><div class='marginalizedparent'><a class='marginalized' href='#35'>35</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3181'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  The returned value indicates whether the predicate evaluated to
<span class='texttt'>true</span> regardless of whether the timeout was triggered. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='36'><div class='marginalizedparent'><a class='marginalized' href='#36'>36</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3185'>#</a></div><p ><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>) or any exception thrown by <span class='texttt'>pred</span>.</p></div></div><p ><span class='indexparent'><a class='index' id='lib:wait_for,condition_variable_'></a></span><span class='indexparent'><a class='index' id='lib:condition_variable,wait_for_'></a></span></p><p ><code class='itemdecl'>template &lt;class Rep, class Period, class Predicate&gt;
  bool wait_for(unique_lock&lt;mutex&gt;&amp; lock,
                const chrono::duration&lt;Rep, Period&gt;&amp; rel_time,
                Predicate pred);
</code></p><div class='itemdescr'></div><div class='para' id='37'><div class='marginalizedparent'><a class='marginalized' href='#37'>37</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3200'>#</a></div><p ><span class='textit'>Requires:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread, and either
</p><ul class='itemize'><li id='37.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#37.1'>(37.1)</a></div><p >no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</p></li><li id='37.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#37.2'>(37.2)</a></div><p ><span class='texttt'>lock.mutex()</span> returns the same value for each of the <span class='texttt'>lock</span> arguments
supplied by all concurrently waiting (via <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or
<span class='texttt'>wait_&shy;until</span>) threads.
</p></li></ul></div></div><div class='para' id='38'><div class='marginalizedparent'><a class='marginalized' href='#38'>38</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3213'>#</a></div><p ><span class='textit'>Effects:</span> Equivalent to:
</p><pre class='codeblock'>
return wait_until(lock, chrono::steady_clock::now() + rel_time, std::move(pred));</pre></div></div><div class='para' id='39'><div class='marginalizedparent'><a class='marginalized' href='#39'>39</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3219'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  There is no blocking if <span class='texttt'>pred()</span> is initially <span class='texttt'>true</span>, even if the
timeout has already expired. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='40'><div class='marginalizedparent'><a class='marginalized' href='#40'>40</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3223'>#</a></div><p ><span class='textit'>Remarks:</span> 
If the function fails to meet the postcondition, <span class='texttt'>terminate()</span>
shall be called (<a href='except.terminate'>[except.terminate]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  This can happen if the re-locking of the mutex throws an exception. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='41'><div class='marginalizedparent'><a class='marginalized' href='#41'>41</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3229'>#</a></div><p ><span class='textit'>Postconditions:</span> <span class='texttt'>lock.owns_&shy;lock()</span> is <span class='texttt'>true</span> and <span class='texttt'>lock.mutex()</span>
is locked by the calling thread.</p></div></div><div class='para' id='42'><div class='marginalizedparent'><a class='marginalized' href='#42'>42</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3233'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>  The returned value indicates whether the predicate evaluates to <span class='texttt'>true</span>
regardless of whether the timeout was triggered. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>] </p></div></div><div class='para' id='43'><div class='marginalizedparent'><a class='marginalized' href='#43'>43</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ef429c6b5066a9ee09566757ca91efde2254d8d4/source/threads.tex#L3237'>#</a></div><p ><span class='textit'>Throws:</span> Timeout-related
exceptions (<a href='thread.req.timing'>[thread.req.timing]</a>) or any exception thrown by <span class='texttt'>pred</span>.</p></div></div></div></body></html>