<!DOCTYPE html><html lang='en'><head><title>[basic.align]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>3</a> Basic concepts <a class='abbr_ref' href='./#basic'>[basic]</a></h1><div id='basic.align'><h2 ><a class='secnum' style='min-width:88pt'>3.11</a> Alignment <a class='abbr_ref'>[basic.align]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4291'>#</a></div><p >Object types have <a class='hidden_link' href='#def:alignment_requirement,implementation-defined' id='def:alignment_requirement,implementation-defined'><i>alignment requirements</i></a> (<a href='basic.fundamental'>[basic.fundamental]</a>, <a href='basic.compound'>[basic.compound]</a>)
which place restrictions on the addresses at which an object of that type
may be allocated. An <a class='hidden_link' href='#def:alignment' id='def:alignment'><i>alignment</i></a> is an <span class='indexparent'><a class='index' id='alignment'></a></span>implementation-defined
integer value representing the number of bytes between successive addresses
at which a given object can be allocated. An object type imposes an alignment
requirement on every object of that type; stricter alignment can be requested
using the alignment specifier (<a href='dcl.align'>[dcl.align]</a>).</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4300'>#</a></div><p ><span class='indexparent'><a class='index' id='alignment,fundamental'></a></span>A <a class='hidden_link' href='#def:fundamental_alignment' id='def:fundamental_alignment'><i>fundamental alignment</i></a> is represented by an alignment
less than or equal to the greatest alignment supported by the implementation in
all contexts, which is equal to
<span class='texttt'>alignof(std::max_align_t)</span> (<a href='support.types'>[support.types]</a>).
The alignment required for a type might be different when it is used as the type
of a complete object and when it is used as the type of a subobject. [ <i>Example:</i>
</p><pre class='codeblock'>
struct B { long double d; };
struct D : virtual B { char c; };</pre><p >When <span class='texttt'>D</span> is the type of a complete object, it will have a subobject of
type <span class='texttt'>B</span>, so it must be aligned appropriately for a <span class='texttt'>long double</span>.
If <span class='texttt'>D</span> appears as a subobject of another object that also has <span class='texttt'>B</span>
as a virtual base class, the <span class='texttt'>B</span> subobject might be part of a different
subobject, reducing the alignment requirements on the <span class='texttt'>D</span> subobject.
<i> — end example</i> ] The result of the <span class='texttt'>alignof</span> operator reflects the alignment
requirement of the type in the complete-object case.</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4321'>#</a></div><p ><span class='indexparent'><a class='index' id='alignment,extended'></a></span><span class='indexparent'><a class='index' id='alignment,new-extended'></a></span><span class='indexparent'><a class='index' id='over-aligned_type'></a></span><span class='indexparent'><a class='index' id='type,over-aligned'></a></span>An <a class='hidden_link' href='#def:extended_alignment' id='def:extended_alignment'><i>extended alignment</i></a> is represented by an alignment
greater than <span class='texttt'>alignof(std::max_align_t)</span>. It is <span class='indexparent'><a class='index' id='support_for_extended_alignments'></a></span>implementation-defined
whether any extended alignments are supported and the contexts in which they are
supported (<a href='dcl.align'>[dcl.align]</a>). A type having an extended alignment
requirement is an <span class='grammarterm'>over-aligned type</span>. [ <i>Note:</i>
Every over-aligned type is or contains a class type
to which extended alignment applies (possibly through a non-static data member).
<i> — end note</i> ]
A <a class='hidden_link' href='#def:new-extended_alignment' id='def:new-extended_alignment'><i>new-extended alignment</i></a> is represented by
an alignment greater than <span class='texttt'>__STDCPP_DEFAULT_NEW_ALIGNMENT__</span> (<a href='cpp.predefined'>[cpp.predefined]</a>).</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4337'>#</a></div><p >Alignments are represented as values of the type <span class='texttt'>std::size_t</span>.
Valid alignments include only those values returned by an <span class='texttt'>alignof</span>
expression for the fundamental types plus an additional <span class='indexparent'><a class='index' id='alignment_additional_values'></a></span>implementation-defined
set of values, which may be empty.
Every alignment value shall be a non-negative integral power of two.</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4345'>#</a></div><p >Alignments have an order from <a class='hidden_link' href='#def:alignment,weaker' id='def:alignment,weaker'><i>weaker</i></a> to
<a class='hidden_link' href='#def:alignment,stronger' id='def:alignment,stronger'><i>stronger</i></a> or <a class='hidden_link' href='#def:alignment,stricter' id='def:alignment,stricter'><i>stricter</i></a> alignments. Stricter
alignments have larger alignment values. An address that satisfies an alignment
requirement also satisfies any weaker valid alignment requirement.</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4351'>#</a></div><p >The alignment requirement of a complete type can be queried using an
<span class='texttt'>alignof</span> expression (<a href='expr.alignof'>[expr.alignof]</a>). Furthermore,
the narrow character types (<a href='basic.fundamental'>[basic.fundamental]</a>) shall have the weakest
alignment requirement.
[ <i>Note:</i> This enables the narrow character types to be used as the
underlying type for an aligned memory area (<a href='dcl.align'>[dcl.align]</a>).<i> — end note</i> ]</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4359'>#</a></div><p >Comparing alignments is meaningful and provides the obvious results:</p><ul class='itemize'><li id='7.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#7.1'>(7.1)</a></div><p >Two alignments are equal when their numeric values are equal.
</p></li><li id='7.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#7.2'>(7.2)</a></div><p >Two alignments are different when their numeric values are not equal.
</p></li><li id='7.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#7.3'>(7.3)</a></div><p >When an alignment is larger than another it represents a stricter alignment.
</p></li></ul></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4368'>#</a></div><p >[ <i>Note:</i> The runtime pointer alignment function (<a href='ptr.align'>[ptr.align]</a>)
can be used to obtain an aligned pointer within a buffer; the aligned-storage templates
in the library (<a href='meta.trans.other'>[meta.trans.other]</a>) can be used to obtain aligned storage.
<i> — end note</i> ]</p></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3acb49d296ba7efdc7542e943262138dc0eb9b74/source/basic.tex#L4374'>#</a></div><p >If a request for a specific extended alignment in a specific context is not
supported by an implementation, the program is ill-formed.
</p></div></div></div></body></html>