<!DOCTYPE html><html lang='en'><head><title>[diff.cpp17]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='annexnum' style='min-width:73pt'>Annex C&emsp;(informative)</a> Compatibility <a class='abbr_ref' href='./#diff'>[diff]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>C.5</a> C++ and ISO C++ 2017 <a class='abbr_ref'>[diff.cpp17]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1a21a65f286cd831d060475043d2be3349c8be7b/source/compatibility.tex#L1798'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':summary,compatibility_with_ISO_C++_2017'></a></span>This subclause lists the differences between C++ and
ISO C++ 2017 (ISO/IEC 14882:2017, <span class='textit'>Programming Languages — C++</span>),
by the chapters of this document<a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div id='lex' class='section'><h3 ><a class='secnum' href='#lex' style='min-width:103pt'>C.5.1</a> <a href='lex'>[lex]</a>: lexical conventions <a class='abbr_ref' href='diff.cpp17.lex'>[diff.cpp17.lex]</a></h3><div class='para' id='lex-1'><div class='marginalizedparent'><a class='marginalized' href='#lex-1'>1</a></div><div id='lex-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='lex.key'>[lex.key]</a>
<br/><b>Change:</b> New keywords<a class='hidden_link' href='#lex-1.sentence-1'>.</a></div> <div id='lex-1.sentence-2' class='sentence'><br/><b>Rationale:</b> Required for new features<a class='hidden_link' href='#lex-1.sentence-2'>.</a></div> <div id='lex-1.sentence-3' class='sentence'>The <span class='texttt'>requires</span> keyword is added
to introduce constraints through a <i ><a href='temp#nt:requires-clause'>requires-clause</a></i> or
a <i ><a href='expr.prim.req#nt:requires-expression'>requires-expression</a></i><a class='hidden_link' href='#lex-1.sentence-3'>.</a></div> <div id='lex-1.sentence-4' class='sentence'>The <span class='texttt'>concept</span> keyword is
added to enable the definition of concepts (<a href='temp.concept'>[temp.concept]</a>)<a class='hidden_link' href='#lex-1.sentence-4'>.</a></div> <div id='lex-1.sentence-5' class='sentence'><br/><b>Effect on original feature:</b> 
Valid ISO C++ 2017 code using <span class='texttt'>concept</span> or <span class='texttt'>requires</span>
as an identifier is not valid in this International Standard<a class='hidden_link' href='#lex-1.sentence-5'>.</a></div></div><div class='para' id='lex-2'><div class='marginalizedparent'><a class='marginalized' href='#lex-2'>2</a></div><div id='lex-2.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='lex.operators'>[lex.operators]</a>
<br/><b>Change:</b> New operator <span class='texttt'>&lt;=&gt;</span><a class='hidden_link' href='#lex-2.sentence-1'>.</a></div> <div id='lex-2.sentence-2' class='sentence'><br/><b>Rationale:</b> Necessary for new functionality<a class='hidden_link' href='#lex-2.sentence-2'>.</a></div> <div id='lex-2.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> Valid C++ 2017 code that contains a <span class='texttt'>&lt;=</span> token
immediately followed by a <span class='texttt'>&gt;</span> token
may be ill-formed or have different semantics in this International Standard:
<pre class='codeblock'>
namespace N {
  struct X {};
  bool operator&lt;=(X, X);
  template&lt;bool(X, X)&gt; struct Y {};
  Y&lt;operator&lt;=&gt; y;              <span class='comment'>// ill-formed; previously well-formed
</span>}</pre></div></div></div><div id='expr' class='section'><h3 ><a class='secnum' href='#expr' style='min-width:103pt'>C.5.2</a> <a href='expr'>[expr]</a>: expressions <a class='abbr_ref' href='diff.cpp17.expr'>[diff.cpp17.expr]</a></h3><div class='para' id='expr-1'><div class='marginalizedparent'><a class='marginalized' href='#expr-1'>1</a></div><div id='expr-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='expr.prim.lambda.capture'>[expr.prim.lambda.capture]</a>
<br/><b>Change:</b> Implicit lambda capture may capture additional entities<a class='hidden_link' href='#expr-1.sentence-1'>.</a></div> <div id='expr-1.sentence-2' class='sentence'><br/><b>Rationale:</b> Rule simplification, necessary to resolve interactions with constexpr if<a class='hidden_link' href='#expr-1.sentence-2'>.</a></div> <div id='expr-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> Lambdas with a <i ><a href='expr.prim.lambda.capture#nt:capture-default'>capture-default</a></i>
may capture local entities
that were not captured in C++ 2017
if those entities are only referenced in contexts
that do not result in an odr-use<a class='hidden_link' href='#expr-1.sentence-3'>.</a></div></div></div><div id='dcl.decl' class='section'><h3 ><a class='secnum' href='#dcl.decl' style='min-width:103pt'>C.5.3</a> <a href='dcl.decl'>[dcl.decl]</a>: declarators <a class='abbr_ref' href='diff.cpp17.dcl.decl'>[diff.cpp17.dcl.decl]</a></h3><div class='para' id='dcl.decl-1'><div class='marginalizedparent'><a class='marginalized' href='#dcl.decl-1'>1</a></div><div id='dcl.decl-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.init.aggr'>[dcl.init.aggr]</a>
<br/><b>Change:</b> A class that has user-declared constructors is never an aggregate<a class='hidden_link' href='#dcl.decl-1.sentence-1'>.</a></div> <div id='dcl.decl-1.sentence-2' class='sentence'><br/><b>Rationale:</b> Remove potentially error-prone aggregate initialization
which may apply notwithstanding the declared constructors of a class<a class='hidden_link' href='#dcl.decl-1.sentence-2'>.</a></div> <div id='dcl.decl-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> Valid C++ 2017 code that aggregate-initializes
a type with a user-declared constructor
may be ill-formed or have different semantics
in this International Standard<a class='hidden_link' href='#dcl.decl-1.sentence-3'>.</a></div> <pre class='codeblock'>
struct A {              <span class='comment'>// not an aggregate; previously an aggregate
</span>  A() = delete;
};

struct B {              <span class='comment'>// not an aggregate; previously an aggregate
</span>  B() = default;
  int i = 0;
};

struct C {              <span class='comment'>// not an aggregate; previously an aggregate
</span>  C(C&amp;&amp;) = default;
  int a, b;
};

A a{};                  <span class='comment'>// ill-formed; previously well-formed
</span>B b = {1};              <span class='comment'>// ill-formed; previously well-formed
</span>auto* c = new C{2, 3};  <span class='comment'>// ill-formed; previously well-formed
</span>
struct Y;

struct X {
  operator Y();
};

struct Y {              <span class='comment'>// not an aggregate; previously an aggregate
</span>  Y(const Y&amp;) = default;
  X x;
};

Y y{X{}};               <span class='comment'>// copy constructor call; previously aggregate-initialization
</span></pre></div></div><div id='special' class='section'><h3 ><a class='secnum' href='#special' style='min-width:103pt'>C.5.4</a> <a href='special'>[special]</a>: special member functions <a class='abbr_ref' href='diff.cpp17.special'>[diff.cpp17.special]</a></h3><div class='para' id='special-1'><div class='marginalizedparent'><a class='marginalized' href='#special-1'>1</a></div><div id='special-1.sentence-1' class='sentence'><b>Affected subclauses:</b> <a href='class.ctor'>[class.ctor]</a>, <a href='class.conv.fct'>[class.conv.fct]</a>
<br/><b>Change:</b> 
The class name can no longer be used parenthesized
immediately after an <span class='texttt'>explicit</span> <i ><a href='dcl.spec#nt:decl-specifier'>decl-specifier</a></i>
in a constructor declaration<a class='hidden_link' href='#special-1.sentence-1'>.</a></div> <div id='special-1.sentence-2' class='sentence'>The <i ><a href='class.conv.fct#nt:conversion-function-id'>conversion-function-id</a></i> can no longer be used parenthesized
immediately after an <span class='texttt'>explicit</span> <i ><a href='dcl.spec#nt:decl-specifier'>decl-specifier</a></i>
in a conversion function declaration<a class='hidden_link' href='#special-1.sentence-2'>.</a></div> <div id='special-1.sentence-3' class='sentence'><br/><b>Rationale:</b> 
Necessary for new functionality<a class='hidden_link' href='#special-1.sentence-3'>.</a></div> <div id='special-1.sentence-4' class='sentence'><br/><b>Effect on original feature:</b> 
Valid C++ 2017 code may fail to compile
in this International Standard<a class='hidden_link' href='#special-1.sentence-4'>.</a></div> <div id='special-1.sentence-5' class='sentence'>For example:
<pre class='codeblock'>
struct S {
  explicit (S)(const S&amp;);       <span class='comment'>// ill-formed; previously well-formed
</span>  explicit (operator int)();    <span class='comment'>// ill-formed; previously well-formed
</span>  explicit(true) (S)(int);      <span class='comment'>// OK
</span>};</pre></div></div><div class='para' id='special-2'><div class='marginalizedparent'><a class='marginalized' href='#special-2'>2</a></div><div id='special-2.sentence-1' class='sentence'><b>Affected subclauses:</b> <a href='class.ctor'>[class.ctor]</a>, <a href='class.dtor'>[class.dtor]</a>
<br/><b>Change:</b> 
A <i ><a href='temp.names#nt:simple-template-id'>simple-template-id</a></i>
is no longer valid as the <i ><a href='dcl.decl#nt:declarator-id'>declarator-id</a></i> of a constructor or destructor<a class='hidden_link' href='#special-2.sentence-1'>.</a></div> <div id='special-2.sentence-2' class='sentence'><br/><b>Rationale:</b> 
Remove potentially error-prone option for redundancy<a class='hidden_link' href='#special-2.sentence-2'>.</a></div> <div id='special-2.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
Valid C++ 2017 code may fail to compile
in this International Standard<a class='hidden_link' href='#special-2.sentence-3'>.</a></div> <div id='special-2.sentence-4' class='sentence'>For example:
<pre class='codeblock'>
template&lt;class T&gt;
struct A {
  A&lt;T&gt;();          <span class='comment'>// error: <span class='grammarterm'>simple-template-id</span> not allowed for constructor
</span>  A(int);          <span class='comment'>// OK, <span class='grammarterm'>injected-class-name</span> used
</span>  ~A&lt;T&gt;();         <span class='comment'>// error: <span class='grammarterm'>simple-template-id</span> not allowed for destructor
</span>};</pre></div></div></div><div id='temp' class='section'><h3 ><a class='secnum' href='#temp' style='min-width:103pt'>C.5.5</a> <a href='temp'>[temp]</a>: templates <a class='abbr_ref' href='diff.cpp17.temp'>[diff.cpp17.temp]</a></h3><div class='para' id='temp-1'><div class='marginalizedparent'><a class='marginalized' href='#temp-1'>1</a></div><div id='temp-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='temp.names'>[temp.names]</a>
<br/><b>Change:</b> 
An <i ><a href='expr.prim.id.unqual#nt:unqualified-id'>unqualified-id</a></i>
that is followed by a <span class='texttt'>&lt;</span>
and for which name lookup
finds nothing or finds a function
will be treated as a <i ><a href='temp.names#nt:template-name'>template-name</a></i>
in order to potentially cause argument dependent lookup to be performed<a class='hidden_link' href='#temp-1.sentence-1'>.</a></div> <div id='temp-1.sentence-2' class='sentence'><br/><b>Rationale:</b> 
It was problematic to call a function template
with an explicit template argument list
via argument dependent lookup
because of the need to have a template with the same name
visible via normal lookup<a class='hidden_link' href='#temp-1.sentence-2'>.</a></div> <div id='temp-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
Previously valid code that uses a function name
as the left operand of a <span class='texttt'>&lt;</span> operator
would become ill-formed<a class='hidden_link' href='#temp-1.sentence-3'>.</a></div> <pre class='codeblock'>
struct A {};
bool operator&lt;(void (*fp)(), A);
void f() {}
int main() {
  A a;
  f &lt; a;    <span class='comment'>// ill-formed; previously well-formed
</span>  (f) &lt; a;  <span class='comment'>// still well formed
</span>}</pre></div></div><div id='except' class='section'><h3 ><a class='secnum' href='#except' style='min-width:103pt'>C.5.6</a> <a href='except'>[except]</a>: exception handling <a class='abbr_ref' href='diff.cpp17.except'>[diff.cpp17.except]</a></h3><div class='para' id='except-1'><div class='marginalizedparent'><a class='marginalized' href='#except-1'>1</a></div><div id='except-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='except.spec'>[except.spec]</a>
<br/><b>Change:</b> Remove <span class='texttt'>throw()</span> exception specification<a class='hidden_link' href='#except-1.sentence-1'>.</a></div> <div id='except-1.sentence-2' class='sentence'><br/><b>Rationale:</b> 
Removal of obsolete feature that has been replaced by <span class='texttt'>noexcept</span><a class='hidden_link' href='#except-1.sentence-2'>.</a></div> <div id='except-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 function declaration, member function declaration, function
pointer declaration, or function reference declaration that uses <span class='texttt'>throw()</span>
for its exception specification will be rejected as ill-formed in this
International Standard<a class='hidden_link' href='#except-1.sentence-3'>.</a></div> <div id='except-1.sentence-4' class='sentence'>It should simply be replaced with <span class='texttt'>noexcept</span> for no
change of meaning since C++ 2017<a class='hidden_link' href='#except-1.sentence-4'>.</a></div> <div id='except-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#except-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='except-1.sentence-5' class='sentence'>There is no way to write a function declaration
that is non-throwing in this International Standard
and is also non-throwing in C++ 2003
except by using the preprocessor to generate
a different token sequence in each case<a class='hidden_link' href='#except-1.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='library' class='section'><h3 ><a class='secnum' href='#library' style='min-width:103pt'>C.5.7</a> <a href='library'>[library]</a>: library introduction <a class='abbr_ref' href='diff.cpp17.library'>[diff.cpp17.library]</a></h3><div class='para' id='library-1'><div class='marginalizedparent'><a class='marginalized' href='#library-1'>1</a></div><div id='library-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='headers'>[headers]</a>
<br/><b>Change:</b> New headers<a class='hidden_link' href='#library-1.sentence-1'>.</a></div> <div id='library-1.sentence-2' class='sentence'><br/><b>Rationale:</b> New functionality<a class='hidden_link' href='#library-1.sentence-2'>.</a></div> <div id='library-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
The following C++ headers are new:
<span class='texttt'>&lt;bit&gt;</span>,
<span class='texttt'>&lt;compare&gt;</span>,
<span class='texttt'>&lt;concepts&gt;</span>,
<span class='texttt'>&lt;contract&gt;</span>,
<span class='texttt'>&lt;span&gt;</span>,
<span class='texttt'>&lt;syncstream&gt;</span>, and
<span class='texttt'>&lt;version&gt;</span><a class='hidden_link' href='#library-1.sentence-3'>.</a></div> <div id='library-1.sentence-4' class='sentence'>Valid C++ 2017 code that <span class='texttt'>#include</span>s headers with these names may be
invalid in this International Standard<a class='hidden_link' href='#library-1.sentence-4'>.</a></div></div><div class='para' id='library-2'><div class='marginalizedparent'><a class='marginalized' href='#library-2'>2</a></div><div id='library-2.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='headers'>[headers]</a>
<br/><b>Change:</b> Remove vacuous C++ header files<a class='hidden_link' href='#library-2.sentence-1'>.</a></div> <div id='library-2.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The empty headers implied a false requirement to achieve C compatibility with the C++ headers<a class='hidden_link' href='#library-2.sentence-2'>.</a></div> <div id='library-2.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that <span class='texttt'>#include</span>s any of the following headers may fail to compile:
<span class='texttt'>&lt;ccomplex&gt;</span>,
<span class='texttt'>&lt;ciso646&gt;</span>,
<span class='texttt'>&lt;cstdalign&gt;</span>,
<span class='texttt'>&lt;cstdbool&gt;</span>, and
<span class='texttt'>&lt;ctgmath&gt;</span><a class='hidden_link' href='#library-2.sentence-3'>.</a></div> <div id='library-2.sentence-4' class='sentence'>To retain the same behavior:
<ul class='itemize'><li id='library-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#library-2.1'>(2.1)</a></div><div id='library-2.1.sentence-1' class='sentence'>a <span class='texttt'>#include</span> of <span class='texttt'>&lt;ccomplex&gt;</span> can be replaced by
a <span class='texttt'>#include</span> of <span class='texttt'>&lt;complex&gt;</span> (<a href='complex.syn'>[complex.syn]</a>),</div></li><li id='library-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#library-2.2'>(2.2)</a></div><div id='library-2.2.sentence-1' class='sentence'>a <span class='texttt'>#include</span> of <span class='texttt'>&lt;ctgmath&gt;</span> can be replaced by
a <span class='texttt'>#include</span> of <span class='texttt'>&lt;cmath&gt;</span> (<a href='cmath.syn'>[cmath.syn]</a>) and
a <span class='texttt'>#include</span> of <span class='texttt'>&lt;complex&gt;</span>,
and</div></li><li id='library-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#library-2.3'>(2.3)</a></div><div id='library-2.3.sentence-1' class='sentence'>a <span class='texttt'>#include</span> of
<span class='texttt'>&lt;ciso646&gt;</span>,
<span class='texttt'>&lt;cstdalign&gt;</span>, or
<span class='texttt'>&lt;cstdbool&gt;</span>
can simply be removed<a class='hidden_link' href='#library-2.3.sentence-1'>.</a></div></li></ul></div></div></div><div id='containers' class='section'><h3 ><a class='secnum' href='#containers' style='min-width:103pt'>C.5.8</a> <a href='containers'>[containers]</a>: containers library <a class='abbr_ref' href='diff.cpp17.containers'>[diff.cpp17.containers]</a></h3><div class='para' id='containers-1'><div class='marginalizedparent'><a class='marginalized' href='#containers-1'>1</a></div><div id='containers-1.sentence-1' class='sentence'><b>Affected subclauses:</b> <a href='forwardlist'>[forwardlist]</a>, <a href='list'>[list]</a>
<br/><b>Change:</b> 
Return types of <span class='texttt'>remove</span>, <span class='texttt'>remove_&shy;if</span>, and <span class='texttt'>unique</span>
changed from <span class='texttt'>void</span> to <span class='texttt'>container&#x200b;::&#x200b;size_&shy;type</span><a class='hidden_link' href='#containers-1.sentence-1'>.</a></div> <div id='containers-1.sentence-2' class='sentence'><br/><b>Rationale:</b> Improve efficiency and convenience of finding number of removed elements<a class='hidden_link' href='#containers-1.sentence-2'>.</a></div> <div id='containers-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
Code that depends on the return types might have different semantics in this International Standard<a class='hidden_link' href='#containers-1.sentence-3'>.</a></div> <div id='containers-1.sentence-4' class='sentence'>Translation units compiled against this version of C++ may be incompatible with
translation units compiled against C++ 2017, either failing to link or having undefined behavior<a class='hidden_link' href='#containers-1.sentence-4'>.</a></div></div></div><div id='depr' class='section'><h3 ><a class='secnum' href='#depr' style='min-width:103pt'>C.5.9</a> <a href='depr'>[depr]</a>: compatibility features <a class='abbr_ref' href='diff.cpp17.depr'>[diff.cpp17.depr]</a></h3><div class='para' id='depr-1'><div class='marginalizedparent'><a class='marginalized' href='#depr-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1a21a65f286cd831d060475043d2be3349c8be7b/source/compatibility.tex#L2039'>#</a></div><div id='depr-1.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>uncaught_&shy;exception</span><a class='hidden_link' href='#depr-1.sentence-1'>.</a></div> <div id='depr-1.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The function did not have a clear specification when multiple exceptions were
active, and has been superseded by <span class='texttt'>uncaught_&shy;exceptions</span><a class='hidden_link' href='#depr-1.sentence-2'>.</a></div> <div id='depr-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>std&#x200b;::&#x200b;uncaught_&shy;exception</span> may fail
to compile<a class='hidden_link' href='#depr-1.sentence-3'>.</a></div> <div id='depr-1.sentence-4' class='sentence'>It might be revised to use <span class='texttt'>std&#x200b;::&#x200b;uncaught_&shy;exceptions</span> instead,
for clear and portable semantics<a class='hidden_link' href='#depr-1.sentence-4'>.</a></div></div><div class='para' id='depr-2'><div class='marginalizedparent'><a class='marginalized' href='#depr-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1a21a65f286cd831d060475043d2be3349c8be7b/source/compatibility.tex#L2049'>#</a></div><div id='depr-2.sentence-1' class='sentence'><b>Change:</b> Remove support for adaptable function API<a class='hidden_link' href='#depr-2.sentence-1'>.</a></div> <div id='depr-2.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The deprecated support relied on a limited convention that could not be
extended to support the general case or new language features<a class='hidden_link' href='#depr-2.sentence-2'>.</a></div> <div id='depr-2.sentence-3' class='sentence'>It has been
superseded by direct language support with <span class='texttt'>decltype</span>, and by the
<span class='texttt'>std&#x200b;::&#x200b;bind</span> and <span class='texttt'>std&#x200b;::&#x200b;not_&shy;fn</span> function templates<a class='hidden_link' href='#depr-2.sentence-3'>.</a></div> <div id='depr-2.sentence-4' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that relies on the presence of <span class='texttt'>result_&shy;type</span>,
<span class='texttt'>argument_&shy;type</span>, <span class='texttt'>first_&shy;argument_&shy;type</span>, or
<span class='texttt'>second_&shy;argument_&shy;type</span> in a standard library class may fail to compile<a class='hidden_link' href='#depr-2.sentence-4'>.</a></div> <div id='depr-2.sentence-5' class='sentence'>A
valid C++ 2017 program that calls <span class='texttt'>not1</span> or <span class='texttt'>not2</span>, or uses the
class templates <span class='texttt'>unary_&shy;negate</span> or <span class='texttt'>binary_&shy;negate</span>, may fail to
compile<a class='hidden_link' href='#depr-2.sentence-5'>.</a></div></div><div class='para' id='depr-3'><div class='marginalizedparent'><a class='marginalized' href='#depr-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1a21a65f286cd831d060475043d2be3349c8be7b/source/compatibility.tex#L2064'>#</a></div><div id='depr-3.sentence-1' class='sentence'><b>Change:</b> Remove redundant members from <span class='texttt'>std&#x200b;::&#x200b;allocator</span><a class='hidden_link' href='#depr-3.sentence-1'>.</a></div> <div id='depr-3.sentence-2' class='sentence'><br/><b>Rationale:</b> 
<span class='texttt'>std&#x200b;::&#x200b;allocator</span> was overspecified, encouraging direct usage in user containers
rather than relying on <span class='texttt'>std&#x200b;::&#x200b;allocator_&shy;traits</span>, leading to poor containers<a class='hidden_link' href='#depr-3.sentence-2'>.</a></div> <div id='depr-3.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that directly makes use of the <span class='texttt'>pointer</span>,
<span class='texttt'>const_&shy;pointer</span>, <span class='texttt'>reference</span>, <span class='texttt'>const_&shy;reference</span>,
<span class='texttt'>rebind</span>, <span class='texttt'>address</span>, <span class='texttt'>construct</span>, <span class='texttt'>destroy</span>, or
<span class='texttt'>max_&shy;size</span> members of <span class='texttt'>std&#x200b;::&#x200b;allocator</span>, or that directly calls
<span class='texttt'>allocate</span> with an additional hint argument, may fail to compile<a class='hidden_link' href='#depr-3.sentence-3'>.</a></div></div><div class='para' id='depr-4'><div class='marginalizedparent'><a class='marginalized' href='#depr-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1a21a65f286cd831d060475043d2be3349c8be7b/source/compatibility.tex#L2076'>#</a></div><div id='depr-4.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>raw_&shy;storage_&shy;iterator</span><a class='hidden_link' href='#depr-4.sentence-1'>.</a></div> <div id='depr-4.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The iterator encouraged use of algorithms that might throw exceptions, but did
not return the number of elements successfully constructed that might need to
be destroyed in order to avoid leaks<a class='hidden_link' href='#depr-4.sentence-2'>.</a></div> <div id='depr-4.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that uses this iterator class may fail to compile<a class='hidden_link' href='#depr-4.sentence-3'>.</a></div></div><div class='para' id='depr-5'><div class='marginalizedparent'><a class='marginalized' href='#depr-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1a21a65f286cd831d060475043d2be3349c8be7b/source/compatibility.tex#L2085'>#</a></div><div id='depr-5.sentence-1' class='sentence'><b>Change:</b> Remove temporary buffers API<a class='hidden_link' href='#depr-5.sentence-1'>.</a></div> <div id='depr-5.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The temporary buffer facility was intended to provide an efficient optimization
for small memory requests, but there is little evidence this was achieved in
practice, while requiring the user to provide their own exception-safe wrappers
to guard use of the facility in many cases<a class='hidden_link' href='#depr-5.sentence-2'>.</a></div> <div id='depr-5.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>get_&shy;temporary_&shy;buffer</span> or
<span class='texttt'>return_&shy;temporary_&shy;buffer</span> may fail to compile<a class='hidden_link' href='#depr-5.sentence-3'>.</a></div></div><div class='para' id='depr-6'><div class='marginalizedparent'><a class='marginalized' href='#depr-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/1a21a65f286cd831d060475043d2be3349c8be7b/source/compatibility.tex#L2096'>#</a></div><div id='depr-6.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>shared_&shy;ptr&#x200b;::&#x200b;unique</span><a class='hidden_link' href='#depr-6.sentence-1'>.</a></div> <div id='depr-6.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The result of a call to this member function is not reliable in the presence of
multiple threads and weak pointers<a class='hidden_link' href='#depr-6.sentence-2'>.</a></div> <div id='depr-6.sentence-3' class='sentence'>The member function <span class='texttt'>use_&shy;count</span> is
similarly unreliable, but has a clearer contract in such cases, and remains
available for well defined use in single-threaded cases<a class='hidden_link' href='#depr-6.sentence-3'>.</a></div> <div id='depr-6.sentence-4' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>unique</span> on a <span class='texttt'>shared_&shy;ptr</span>
object may fail to compile<a class='hidden_link' href='#depr-6.sentence-4'>.</a></div></div><div class='para' id='depr-7'><div class='marginalizedparent'><a class='marginalized' href='#depr-7'>7</a></div><div id='depr-7.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='depr.meta.types'>[depr.meta.types]</a>
<br/><b>Change:</b> Remove deprecated type traits<a class='hidden_link' href='#depr-7.sentence-1'>.</a></div> <div id='depr-7.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The traits had unreliable or awkward interfaces<a class='hidden_link' href='#depr-7.sentence-2'>.</a></div> <div id='depr-7.sentence-3' class='sentence'>The <span class='texttt'>is_&shy;literal_&shy;type</span>
trait provided no way to detect which subset of constructors and member
functions of a type were declared <span class='texttt'>constexpr</span><a class='hidden_link' href='#depr-7.sentence-3'>.</a></div> <div id='depr-7.sentence-4' class='sentence'>The <span class='texttt'>result_&shy;of</span>
trait had a surprising syntax that could not report the result of a regular
function type<a class='hidden_link' href='#depr-7.sentence-4'>.</a></div> <div id='depr-7.sentence-5' class='sentence'>It has been superseded by the <span class='texttt'>invoke_&shy;result</span> trait<a class='hidden_link' href='#depr-7.sentence-5'>.</a></div> <div id='depr-7.sentence-6' class='sentence'><br/><b>Effect on original feature:</b> 
A valid C++ 2017 program that relies on the <span class='texttt'>is_&shy;literal_&shy;type</span> or
<span class='texttt'>result_&shy;of</span> type traits, on the <span class='texttt'>is_&shy;literal_&shy;type_&shy;v</span> variable template,
or on the <span class='texttt'>result_&shy;of_&shy;t</span> alias template may fail to compile<a class='hidden_link' href='#depr-7.sentence-6'>.</a></div></div></div></div></body></html>