<!DOCTYPE html><html lang='en'><head><title>[diff.cpp17]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='annexnum' style='min-width:73pt'>Annex C&emsp;(informative)</a> Compatibility <a class='abbr_ref' href='./#diff'>[diff]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>C.5</a> C++ and ISO C++ 2017 <a class='abbr_ref'>[diff.cpp17]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1761'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':summary,compatibility_with_ISO_C++_2017'></a></span>This subclause lists the differences between C++ and
ISO C++ 2017 (ISO/IEC 14882:2017, <span class='textit'>Programming Languages — C++</span>),
by the chapters of this document<a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div id='lex' class='section'><h3 ><a class='secnum' href='#lex' style='min-width:103pt'>C.5.1</a> <a href='lex'>[lex]</a>: lexical conventions <a class='abbr_ref' href='diff.cpp17.lex'>[diff.cpp17.lex]</a></h3><div class='para' id='lex-1'><div class='marginalizedparent'><a class='marginalized' href='#lex-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1769'>#</a></div><b>Affected subclause:</b> <a href='lex.key'>[lex.key]</a>
<br/> <div id='lex-1.sentence-1' class='sentence'><b>Change:</b> New keywords<a class='hidden_link' href='#lex-1.sentence-1'>.</a></div> <br/> <div id='lex-1.sentence-2' class='sentence'><b>Rationale:</b> Required for new features<a class='hidden_link' href='#lex-1.sentence-2'>.</a></div> <div id='lex-1.sentence-3' class='sentence'><ul class='itemize'><li id='lex-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lex-1.1'>(1.1)</a></div><div id='lex-1.1.sentence-1' class='sentence'>The <span class='texttt'><span class='keyword'>char8_&shy;t</span></span> keyword is added to differentiate
the types of ordinary and UTF-8 literals (<a href='lex.string'>[lex.string]</a>)<a class='hidden_link' href='#lex-1.1.sentence-1'>.</a></div></li><li id='lex-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lex-1.2'>(1.2)</a></div><div id='lex-1.2.sentence-1' class='sentence'>The <span class='texttt'><span class='keyword'>concept</span></span> keyword is
added to enable the definition of concepts (<a href='temp.concept'>[temp.concept]</a>)<a class='hidden_link' href='#lex-1.2.sentence-1'>.</a></div></li><li id='lex-1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lex-1.3'>(1.3)</a></div><div id='lex-1.3.sentence-1' class='sentence'>The <span class='texttt'><span class='keyword'>consteval</span></span> keyword is added to
declare immediate functions (<a href='dcl.constexpr'>[dcl.constexpr]</a>)<a class='hidden_link' href='#lex-1.3.sentence-1'>.</a></div></li><li id='lex-1.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lex-1.4'>(1.4)</a></div><div id='lex-1.4.sentence-1' class='sentence'>The <span class='texttt'><span class='keyword'>requires</span></span> keyword is added
to introduce constraints through a <i ><a href='temp#nt:requires-clause'>requires-clause</a></i> or
a <i ><a href='expr.prim.req#nt:requires-expression'>requires-expression</a></i><a class='hidden_link' href='#lex-1.4.sentence-1'>.</a></div></li></ul></div> <div id='lex-1.sentence-4' class='sentence'><b>Effect on original feature:</b> 
Valid ISO C++ 2017 code using
<span class='texttt'><span class='keyword'>char8_&shy;t</span></span>,
<span class='texttt'><span class='keyword'>concept</span></span>,
<span class='texttt'><span class='keyword'>consteval</span></span>,
or <span class='texttt'><span class='keyword'>requires</span></span>
as an identifier is not valid in this International Standard<a class='hidden_link' href='#lex-1.sentence-4'>.</a></div></div><div class='para' id='lex-2'><div class='marginalizedparent'><a class='marginalized' href='#lex-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1795'>#</a></div><b>Affected subclause:</b> <a href='lex.operators'>[lex.operators]</a>
<br/> <div id='lex-2.sentence-1' class='sentence'><b>Change:</b> New operator <span class='texttt'><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#lex-2.sentence-1'>.</a></div> <br/> <div id='lex-2.sentence-2' class='sentence'><b>Rationale:</b> Necessary for new functionality<a class='hidden_link' href='#lex-2.sentence-2'>.</a></div> <br/> <div id='lex-2.sentence-3' class='sentence'><b>Effect on original feature:</b> Valid C++ 2017 code that contains a <span class='texttt'><span class='anglebracket'>&lt;</span><span class='operator'>=</span></span> token
immediately followed by a <span class='texttt'><span class='anglebracket'>&gt;</span></span> token
may be ill-formed or have different semantics in this International Standard:
<pre class='codeblock'>
<span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
  <span class='keyword'>struct</span> X <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
  <span class='keyword'>bool</span> <span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='parenthesis'>(</span>X, X<span class='parenthesis'>)</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>bool</span><span class='parenthesis'>(</span>X, X<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Y <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
  Y<span class='anglebracket'>&lt;</span><span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span> y;              <span class='comment'>// ill-formed; previously well-formed</span>
<span class='curlybracket'>}</span>
</pre></div></div><div class='para' id='lex-3'><div class='marginalizedparent'><a class='marginalized' href='#lex-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1810'>#</a></div><b>Affected subclause:</b> <a href='lex.literal'>[lex.literal]</a>
<br/> <div id='lex-3.sentence-1' class='sentence'><b>Change:</b> Type of UTF-8 string and character literals<a class='hidden_link' href='#lex-3.sentence-1'>.</a></div> <br/> <div id='lex-3.sentence-2' class='sentence'><b>Rationale:</b> Required for new features<a class='hidden_link' href='#lex-3.sentence-2'>.</a></div> <div id='lex-3.sentence-3' class='sentence'>The changed types enable function overloading, template specialization, and
type deduction to distinguish ordinary and UTF-8 string and character literals<a class='hidden_link' href='#lex-3.sentence-3'>.</a></div> <br/> <div id='lex-3.sentence-4' class='sentence'><b>Effect on original feature:</b> Valid ISO C++ 2017 code that depends on
UTF-8 string literals having type “array of <span class='texttt'><span class='keyword'>const</span> <span class='keyword'>char</span></span>” and
UTF-8 character literals having type “char”
is not valid in this International Standard<a class='hidden_link' href='#lex-3.sentence-4'>.</a></div> <pre class='codeblock'>
<span class='keyword'>const</span> <span class='keyword'>auto</span> <span class='operator'>*</span>u8s <span class='operator'>=</span> <span class='literal'>u8"text"</span>;     <span class='comment'>// <span class='tcode_in_codeblock'>u8s</span> previously deduced as <span class='tcode_in_codeblock'>const char*</span>; now deduced as <span class='tcode_in_codeblock'>const char8_&shy;t*</span></span>
<span class='keyword'>const</span> <span class='keyword'>char</span> <span class='operator'>*</span>ps <span class='operator'>=</span> u8s;           <span class='comment'>// ill-formed; previously well-formed</span>

<span class='keyword'>auto</span> u8c <span class='operator'>=</span> <span class='literal'>u8'c'</span>;               <span class='comment'>// <span class='tcode_in_codeblock'>u8c</span> previously deduced as <span class='tcode_in_codeblock'>char</span>; now deduced as <span class='tcode_in_codeblock'>char8_&shy;t</span></span>
<span class='keyword'>char</span> <span class='operator'>*</span>pc <span class='operator'>=</span> <span class='operator'>&amp;</span>u8c;                <span class='comment'>// ill-formed; previously well-formed</span>

std<span class='operator'>:</span><span class='operator'>:</span>string s <span class='operator'>=</span> <span class='literal'>u8"text"</span>;       <span class='comment'>// ill-formed; previously well-formed</span>

<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>const</span> <span class='keyword'>char</span> <span class='operator'>*</span>s<span class='parenthesis'>)</span>;
f<span class='parenthesis'>(</span><span class='literal'>u8"text"</span><span class='parenthesis'>)</span>;                    <span class='comment'>// ill-formed; previously well-formed</span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> ct;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> ct<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
  <span class='keyword'>using</span> type <span class='operator'>=</span> <span class='keyword'>char</span>;
<span class='curlybracket'>}</span>;
ct<span class='anglebracket'>&lt;</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='literal'>u8'c'</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='operator'>:</span><span class='operator'>:</span>type x;    <span class='comment'>// ill-formed; previously well-formed.</span>
</pre></div></div><div id='basic' class='section'><h3 ><a class='secnum' href='#basic' style='min-width:103pt'>C.5.2</a> <a href='basic'>[basic]</a>: basics <a class='abbr_ref' href='diff.cpp17.basic'>[diff.cpp17.basic]</a></h3><div class='para' id='basic-1'><div class='marginalizedparent'><a class='marginalized' href='#basic-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1840'>#</a></div><b>Affected subclause:</b> <a href='intro.races'>[intro.races]</a>
<br/> <div id='basic-1.sentence-1' class='sentence'><b>Change:</b> Except for the initial release operation,
a release sequence consists solely of atomic read-modify-write operations<a class='hidden_link' href='#basic-1.sentence-1'>.</a></div> <br/> <div id='basic-1.sentence-2' class='sentence'><b>Rationale:</b> Removal of rarely used and confusing feature<a class='hidden_link' href='#basic-1.sentence-2'>.</a></div> <br/> <div id='basic-1.sentence-3' class='sentence'><b>Effect on original feature:</b> If a <span class='texttt'>memory_&shy;order_&shy;release</span> atomic store is followed
by a <span class='texttt'>memory_&shy;order_&shy;relaxed</span> store to the same variable by the same thread,
then reading the latter value with a <span class='texttt'>memory_&shy;order_&shy;acquire</span> load
no longer provides any “happens before” guarantees,
even in the absence of intervening stores by another thread<a class='hidden_link' href='#basic-1.sentence-3'>.</a></div></div></div><div id='expr' class='section'><h3 ><a class='secnum' href='#expr' style='min-width:103pt'>C.5.3</a> <a href='expr'>[expr]</a>: expressions <a class='abbr_ref' href='diff.cpp17.expr'>[diff.cpp17.expr]</a></h3><div class='para' id='expr-1'><div class='marginalizedparent'><a class='marginalized' href='#expr-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1852'>#</a></div><b>Affected subclause:</b> <a href='expr.prim.lambda.capture'>[expr.prim.lambda.capture]</a>
<br/> <div id='expr-1.sentence-1' class='sentence'><b>Change:</b> Implicit lambda capture may capture additional entities<a class='hidden_link' href='#expr-1.sentence-1'>.</a></div> <br/> <div id='expr-1.sentence-2' class='sentence'><b>Rationale:</b> Rule simplification, necessary to resolve interactions with constexpr if<a class='hidden_link' href='#expr-1.sentence-2'>.</a></div> <br/> <div id='expr-1.sentence-3' class='sentence'><b>Effect on original feature:</b> Lambdas with a <i ><a href='expr.prim.lambda.capture#nt:capture-default'>capture-default</a></i>
may capture local entities
that were not captured in C++ 2017
if those entities are only referenced in contexts
that do not result in an odr-use<a class='hidden_link' href='#expr-1.sentence-3'>.</a></div></div></div><div id='dcl.dcl' class='section'><h3 ><a class='secnum' href='#dcl.dcl' style='min-width:103pt'>C.5.4</a> <a href='dcl.dcl'>[dcl.dcl]</a>: declarations <a class='abbr_ref' href='diff.cpp17.dcl.dcl'>[diff.cpp17.dcl.dcl]</a></h3><div class='para' id='dcl.dcl-1'><div class='marginalizedparent'><a class='marginalized' href='#dcl.dcl-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1863'>#</a></div><b>Affected subclause:</b> <a href='dcl.init.aggr'>[dcl.init.aggr]</a>
<br/> <div id='dcl.dcl-1.sentence-1' class='sentence'><b>Change:</b> A class that has user-declared constructors is never an aggregate<a class='hidden_link' href='#dcl.dcl-1.sentence-1'>.</a></div> <br/> <div id='dcl.dcl-1.sentence-2' class='sentence'><b>Rationale:</b> Remove potentially error-prone aggregate initialization
which may apply notwithstanding the declared constructors of a class<a class='hidden_link' href='#dcl.dcl-1.sentence-2'>.</a></div> <br/> <div id='dcl.dcl-1.sentence-3' class='sentence'><b>Effect on original feature:</b> Valid C++ 2017 code that aggregate-initializes
a type with a user-declared constructor
may be ill-formed or have different semantics
in this International Standard<a class='hidden_link' href='#dcl.dcl-1.sentence-3'>.</a></div> <pre class='codeblock'>
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span>              <span class='comment'>// not an aggregate; previously an aggregate</span>
  A<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> B <span class='curlybracket'>{</span>              <span class='comment'>// not an aggregate; previously an aggregate</span>
  B<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>;
  <span class='keyword'>int</span> i <span class='operator'>=</span> <span class='literal'>0</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> C <span class='curlybracket'>{</span>              <span class='comment'>// not an aggregate; previously an aggregate</span>
  C<span class='parenthesis'>(</span>C<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>;
  <span class='keyword'>int</span> a, b;
<span class='curlybracket'>}</span>;

A a<span class='curlybracket'>{</span><span class='curlybracket'>}</span>;                  <span class='comment'>// ill-formed; previously well-formed</span>
B b <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='literal'>1</span><span class='curlybracket'>}</span>;              <span class='comment'>// ill-formed; previously well-formed</span>
<span class='keyword'>auto</span><span class='operator'>*</span> c <span class='operator'>=</span> <span class='keyword'>new</span> C<span class='curlybracket'>{</span><span class='literal'>2</span>, <span class='literal'>3</span><span class='curlybracket'>}</span>;  <span class='comment'>// ill-formed; previously well-formed</span>

<span class='keyword'>struct</span> Y;

<span class='keyword'>struct</span> X <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> Y<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> Y <span class='curlybracket'>{</span>              <span class='comment'>// not an aggregate; previously an aggregate</span>
  Y<span class='parenthesis'>(</span><span class='keyword'>const</span> Y<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>;
  X x;
<span class='curlybracket'>}</span>;

Y y<span class='curlybracket'>{</span>X<span class='curlybracket'>{</span><span class='curlybracket'>}</span><span class='curlybracket'>}</span>;               <span class='comment'>// copy constructor call; previously aggregate-initialization</span>
</pre></div></div><div id='class' class='section'><h3 ><a class='secnum' href='#class' style='min-width:103pt'>C.5.5</a> <a href='class'>[class]</a>: classes <a class='abbr_ref' href='diff.cpp17.class'>[diff.cpp17.class]</a></h3><div class='para' id='class-1'><div class='marginalizedparent'><a class='marginalized' href='#class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1906'>#</a></div><b>Affected subclauses:</b> <a href='class.ctor'>[class.ctor]</a> and <a href='class.conv.fct'>[class.conv.fct]</a>
<br/> <div id='class-1.sentence-1' class='sentence'><b>Change:</b> 
The class name can no longer be used parenthesized
immediately after an <span class='texttt'><span class='keyword'>explicit</span></span> <i ><a href='dcl.spec#nt:decl-specifier'>decl-specifier</a></i>
in a constructor declaration<a class='hidden_link' href='#class-1.sentence-1'>.</a></div> <div id='class-1.sentence-2' class='sentence'>The <i ><a href='class.conv.fct#nt:conversion-function-id'>conversion-function-id</a></i> can no longer be used parenthesized
immediately after an <span class='texttt'><span class='keyword'>explicit</span></span> <i ><a href='dcl.spec#nt:decl-specifier'>decl-specifier</a></i>
in a conversion function declaration<a class='hidden_link' href='#class-1.sentence-2'>.</a></div> <br/> <div id='class-1.sentence-3' class='sentence'><b>Rationale:</b> 
Necessary for new functionality<a class='hidden_link' href='#class-1.sentence-3'>.</a></div> <br/> <div id='class-1.sentence-4' class='sentence'><b>Effect on original feature:</b> 
Valid C++ 2017 code may fail to compile
in this International Standard<a class='hidden_link' href='#class-1.sentence-4'>.</a></div> <div id='class-1.sentence-5' class='sentence'>For example:
<pre class='codeblock'>
<span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>explicit</span> <span class='parenthesis'>(</span>S<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>const</span> S<span class='operator'>&amp;</span><span class='parenthesis'>)</span>;       <span class='comment'>// ill-formed; previously well-formed</span>
  <span class='keyword'>explicit</span> <span class='parenthesis'>(</span><span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;    <span class='comment'>// ill-formed; previously well-formed</span>
  <span class='keyword'>explicit</span><span class='parenthesis'>(</span><span class='literal'>true</span><span class='parenthesis'>)</span> <span class='parenthesis'>(</span>S<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;      <span class='comment'>// OK</span>
<span class='curlybracket'>}</span>;
</pre></div></div><div class='para' id='class-2'><div class='marginalizedparent'><a class='marginalized' href='#class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1927'>#</a></div><b>Affected subclauses:</b> <a href='class.ctor'>[class.ctor]</a> and <a href='class.dtor'>[class.dtor]</a>
<br/> <div id='class-2.sentence-1' class='sentence'><b>Change:</b> 
A <i ><a href='temp.names#nt:simple-template-id'>simple-template-id</a></i>
is no longer valid as the <i ><a href='dcl.decl#nt:declarator-id'>declarator-id</a></i> of a constructor or destructor<a class='hidden_link' href='#class-2.sentence-1'>.</a></div> <br/> <div id='class-2.sentence-2' class='sentence'><b>Rationale:</b> 
Remove potentially error-prone option for redundancy<a class='hidden_link' href='#class-2.sentence-2'>.</a></div> <br/> <div id='class-2.sentence-3' class='sentence'><b>Effect on original feature:</b> 
Valid C++ 2017 code may fail to compile
in this International Standard<a class='hidden_link' href='#class-2.sentence-3'>.</a></div> <div id='class-2.sentence-4' class='sentence'>For example:
<pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  A<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;          <span class='comment'>// error: <span class='grammarterm'>simple-template-id</span> not allowed for constructor</span>
  A<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;          <span class='comment'>// OK, <span class='grammarterm'>injected-class-name</span> used</span>
  <span class='operator'>~</span>A<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;         <span class='comment'>// error: <span class='grammarterm'>simple-template-id</span> not allowed for destructor</span>
<span class='curlybracket'>}</span>;
</pre></div></div></div><div id='temp' class='section'><h3 ><a class='secnum' href='#temp' style='min-width:103pt'>C.5.6</a> <a href='temp'>[temp]</a>: templates <a class='abbr_ref' href='diff.cpp17.temp'>[diff.cpp17.temp]</a></h3><div class='para' id='temp-1'><div class='marginalizedparent'><a class='marginalized' href='#temp-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1947'>#</a></div><b>Affected subclause:</b> <a href='temp.names'>[temp.names]</a>
<br/> <div id='temp-1.sentence-1' class='sentence'><b>Change:</b> 
An <i ><a href='expr.prim.id.unqual#nt:unqualified-id'>unqualified-id</a></i>
that is followed by a <span class='texttt'><span class='anglebracket'>&lt;</span></span>
and for which name lookup
finds nothing or finds a function
will be treated as a <i ><a href='temp.names#nt:template-name'>template-name</a></i>
in order to potentially cause argument dependent lookup to be performed<a class='hidden_link' href='#temp-1.sentence-1'>.</a></div> <br/> <div id='temp-1.sentence-2' class='sentence'><b>Rationale:</b> 
It was problematic to call a function template
with an explicit template argument list
via argument dependent lookup
because of the need to have a template with the same name
visible via normal lookup<a class='hidden_link' href='#temp-1.sentence-2'>.</a></div> <br/> <div id='temp-1.sentence-3' class='sentence'><b>Effect on original feature:</b> 
Previously valid code that uses a function name
as the left operand of a <span class='texttt'><span class='anglebracket'>&lt;</span></span> operator
would become ill-formed<a class='hidden_link' href='#temp-1.sentence-3'>.</a></div> <pre class='codeblock'>
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
<span class='keyword'>bool</span> <span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='parenthesis'>(</span><span class='keyword'>void</span> <span class='parenthesis'>(</span><span class='operator'>*</span>fp<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>, A<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  A a;
  f <span class='anglebracket'>&lt;</span> a;    <span class='comment'>// ill-formed; previously well-formed</span>
  <span class='parenthesis'>(</span>f<span class='parenthesis'>)</span> <span class='anglebracket'>&lt;</span> a;  <span class='comment'>// still well formed</span>
<span class='curlybracket'>}</span>
</pre></div></div><div id='except' class='section'><h3 ><a class='secnum' href='#except' style='min-width:103pt'>C.5.7</a> <a href='except'>[except]</a>: exception handling <a class='abbr_ref' href='diff.cpp17.except'>[diff.cpp17.except]</a></h3><div class='para' id='except-1'><div class='marginalizedparent'><a class='marginalized' href='#except-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1978'>#</a></div><b>Affected subclause:</b> <a href='except.spec'>[except.spec]</a>
<br/> <div id='except-1.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'><span class='keyword'>throw</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> exception specification<a class='hidden_link' href='#except-1.sentence-1'>.</a></div> <br/> <div id='except-1.sentence-2' class='sentence'><b>Rationale:</b> 
Removal of obsolete feature that has been replaced by <span class='texttt'><span class='keyword'>noexcept</span></span><a class='hidden_link' href='#except-1.sentence-2'>.</a></div> <br/> <div id='except-1.sentence-3' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 function declaration, member function declaration, function
pointer declaration, or function reference declaration that uses <span class='texttt'><span class='keyword'>throw</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
for its exception specification will be rejected as ill-formed in this
International Standard<a class='hidden_link' href='#except-1.sentence-3'>.</a></div> <div id='except-1.sentence-4' class='sentence'>It should simply be replaced with <span class='texttt'><span class='keyword'>noexcept</span></span> for no
change of meaning since C++ 2017<a class='hidden_link' href='#except-1.sentence-4'>.</a></div> <div id='except-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#except-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='except-1.sentence-5' class='sentence'>There is no way to write a function declaration
that is non-throwing in this International Standard
and is also non-throwing in C++ 2003
except by using the preprocessor to generate
a different token sequence in each case<a class='hidden_link' href='#except-1.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='library' class='section'><h3 ><a class='secnum' href='#library' style='min-width:103pt'>C.5.8</a> <a href='library'>[library]</a>: library introduction <a class='abbr_ref' href='diff.cpp17.library'>[diff.cpp17.library]</a></h3><div class='para' id='library-1'><div class='marginalizedparent'><a class='marginalized' href='#library-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L1998'>#</a></div><b>Affected subclause:</b> <a href='headers'>[headers]</a>
<br/> <div id='library-1.sentence-1' class='sentence'><b>Change:</b> New headers<a class='hidden_link' href='#library-1.sentence-1'>.</a></div> <br/> <div id='library-1.sentence-2' class='sentence'><b>Rationale:</b> New functionality<a class='hidden_link' href='#library-1.sentence-2'>.</a></div> <br/> <div id='library-1.sentence-3' class='sentence'><b>Effect on original feature:</b> 
The following C++ headers are new:
<span class='texttt'><span class='anglebracket'>&lt;</span>bit<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>compare<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>concepts<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>contract<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>ranges<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>span<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>syncstream<span class='anglebracket'>&gt;</span></span>, and
<span class='texttt'><span class='anglebracket'>&lt;</span>version<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#library-1.sentence-3'>.</a></div> <div id='library-1.sentence-4' class='sentence'>Valid C++ 2017 code that <span class='texttt'><span class='preprocessordirective'>#include</span></span>s headers with these names may be
invalid in this International Standard<a class='hidden_link' href='#library-1.sentence-4'>.</a></div></div><div class='para' id='library-2'><div class='marginalizedparent'><a class='marginalized' href='#library-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2014'>#</a></div><b>Affected subclause:</b> <a href='headers'>[headers]</a>
<br/> <div id='library-2.sentence-1' class='sentence'><b>Change:</b> Remove vacuous C++ header files<a class='hidden_link' href='#library-2.sentence-1'>.</a></div> <br/> <div id='library-2.sentence-2' class='sentence'><b>Rationale:</b> 
The empty headers implied a false requirement to achieve C compatibility with the C++ headers<a class='hidden_link' href='#library-2.sentence-2'>.</a></div> <br/> <div id='library-2.sentence-3' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that <span class='texttt'><span class='preprocessordirective'>#include</span></span>s any of the following headers may fail to compile:
<span class='texttt'><span class='anglebracket'>&lt;</span>ccomplex<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>ciso646<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>cstdalign<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>cstdbool<span class='anglebracket'>&gt;</span></span>, and
<span class='texttt'><span class='anglebracket'>&lt;</span>ctgmath<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#library-2.sentence-3'>.</a></div> <div id='library-2.sentence-4' class='sentence'>To retain the same behavior:
<ul class='itemize'><li id='library-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#library-2.1'>(2.1)</a></div><div id='library-2.1.sentence-1' class='sentence'>a <span class='texttt'><span class='preprocessordirective'>#include</span></span> of <span class='texttt'><span class='anglebracket'>&lt;</span>ccomplex<span class='anglebracket'>&gt;</span></span> can be replaced by
a <span class='texttt'><span class='preprocessordirective'>#include</span></span> of <span class='texttt'><span class='anglebracket'>&lt;</span>complex<span class='anglebracket'>&gt;</span></span> (<a href='complex.syn'>[complex.syn]</a>),</div></li><li id='library-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#library-2.2'>(2.2)</a></div><div id='library-2.2.sentence-1' class='sentence'>a <span class='texttt'><span class='preprocessordirective'>#include</span></span> of <span class='texttt'><span class='anglebracket'>&lt;</span>ctgmath<span class='anglebracket'>&gt;</span></span> can be replaced by
a <span class='texttt'><span class='preprocessordirective'>#include</span></span> of <span class='texttt'><span class='anglebracket'>&lt;</span>cmath<span class='anglebracket'>&gt;</span></span> (<a href='cmath.syn'>[cmath.syn]</a>) and
a <span class='texttt'><span class='preprocessordirective'>#include</span></span> of <span class='texttt'><span class='anglebracket'>&lt;</span>complex<span class='anglebracket'>&gt;</span></span>,
and</div></li><li id='library-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#library-2.3'>(2.3)</a></div><div id='library-2.3.sentence-1' class='sentence'>a <span class='texttt'><span class='preprocessordirective'>#include</span></span> of
<span class='texttt'><span class='anglebracket'>&lt;</span>ciso646<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'><span class='anglebracket'>&lt;</span>cstdalign<span class='anglebracket'>&gt;</span></span>, or
<span class='texttt'><span class='anglebracket'>&lt;</span>cstdbool<span class='anglebracket'>&gt;</span></span>
can simply be removed<a class='hidden_link' href='#library-2.3.sentence-1'>.</a></div></li></ul></div></div></div><div id='containers' class='section'><h3 ><a class='secnum' href='#containers' style='min-width:103pt'>C.5.9</a> <a href='containers'>[containers]</a>: containers library <a class='abbr_ref' href='diff.cpp17.containers'>[diff.cpp17.containers]</a></h3><div class='para' id='containers-1'><div class='marginalizedparent'><a class='marginalized' href='#containers-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2045'>#</a></div><b>Affected subclauses:</b> <a href='forwardlist'>[forwardlist]</a> and <a href='list'>[list]</a>
<br/> <div id='containers-1.sentence-1' class='sentence'><b>Change:</b> 
Return types of <span class='texttt'>remove</span>, <span class='texttt'>remove_&shy;if</span>, and <span class='texttt'>unique</span>
changed from <span class='texttt'><span class='keyword'>void</span></span> to <span class='texttt'>container<span class='operator'>:</span><span class='operator'>:</span>size_&shy;type</span><a class='hidden_link' href='#containers-1.sentence-1'>.</a></div> <br/> <div id='containers-1.sentence-2' class='sentence'><b>Rationale:</b> Improve efficiency and convenience of finding number of removed elements<a class='hidden_link' href='#containers-1.sentence-2'>.</a></div> <br/> <div id='containers-1.sentence-3' class='sentence'><b>Effect on original feature:</b> 
Code that depends on the return types might have different semantics in this International Standard<a class='hidden_link' href='#containers-1.sentence-3'>.</a></div> <div id='containers-1.sentence-4' class='sentence'>Translation units compiled against this version of C++ may be incompatible with
translation units compiled against C++ 2017, either failing to link or having undefined behavior<a class='hidden_link' href='#containers-1.sentence-4'>.</a></div></div></div><div id='alg.reqs' class='section'><h3 ><a class='secnum' href='#alg.reqs' style='min-width:103pt'>C.5.10</a> <a href='algorithms'>[algorithms]</a>: algorithms library <a class='abbr_ref' href='diff.cpp17.alg.reqs'>[diff.cpp17.alg.reqs]</a></h3><div class='para' id='alg.reqs-1'><div class='marginalizedparent'><a class='marginalized' href='#alg.reqs-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2057'>#</a></div><b>Affected subclause:</b> <a href='algorithms.requirements'>[algorithms.requirements]</a>
<br/> <div id='alg.reqs-1.sentence-1' class='sentence'><b>Change:</b> 
The number and order of deducible template parameters for algorithm declarations
is now unspecified, instead of being as-declared<a class='hidden_link' href='#alg.reqs-1.sentence-1'>.</a></div> <br/> <div id='alg.reqs-1.sentence-2' class='sentence'><b>Rationale:</b> Increase implementor freedom and allow some function templates
to be implemented as function objects with templated call operators<a class='hidden_link' href='#alg.reqs-1.sentence-2'>.</a></div> <br/> <div id='alg.reqs-1.sentence-3' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that passes explicit template arguments to
algorithms not explicitly specified to allow such in this version of C++
may fail to compile or have undefined behavior<a class='hidden_link' href='#alg.reqs-1.sentence-3'>.</a></div></div></div><div id='input.output' class='section'><h3 ><a class='secnum' href='#input.output' style='min-width:103pt'>C.5.11</a> <a href='input.output'>[input.output]</a>: input/output library <a class='abbr_ref' href='diff.cpp17.input.output'>[diff.cpp17.input.output]</a></h3><div class='para' id='input.output-1'><div class='marginalizedparent'><a class='marginalized' href='#input.output-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2070'>#</a></div><b>Affected subclause:</b> <a href='istream.extractors'>[istream.extractors]</a>
<br/> <div id='input.output-1.sentence-1' class='sentence'><b>Change:</b> 
Character array extraction only takes array types<a class='hidden_link' href='#input.output-1.sentence-1'>.</a></div> <br/> <div id='input.output-1.sentence-2' class='sentence'><b>Rationale:</b> Increase safety via preventing buffer overflow at compile time<a class='hidden_link' href='#input.output-1.sentence-2'>.</a></div> <br/> <div id='input.output-1.sentence-3' class='sentence'><b>Effect on original feature:</b> 
Valid C++ 2017 code may fail to compile in this International Standard:
<pre class='codeblock'>
<span class='keyword'>auto</span> p <span class='operator'>=</span> <span class='keyword'>new</span> <span class='keyword'>char</span><span class='squarebracket'>[</span><span class='literal'>100</span><span class='squarebracket'>]</span>;
<span class='keyword'>char</span> q<span class='squarebracket'>[</span><span class='literal'>100</span><span class='squarebracket'>]</span>;
std<span class='operator'>:</span><span class='operator'>:</span>cin <span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> std<span class='operator'>:</span><span class='operator'>:</span>setw<span class='parenthesis'>(</span><span class='literal'>20</span><span class='parenthesis'>)</span> <span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> p;        <span class='comment'>// ill-formed; previously well-formed</span>
std<span class='operator'>:</span><span class='operator'>:</span>cin <span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> std<span class='operator'>:</span><span class='operator'>:</span>setw<span class='parenthesis'>(</span><span class='literal'>20</span><span class='parenthesis'>)</span> <span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> q;        <span class='comment'>// OK</span>
</pre></div></div><div class='para' id='input.output-2'><div class='marginalizedparent'><a class='marginalized' href='#input.output-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2083'>#</a></div><b>Affected subclause:</b> <a href='ostream.inserters.character'>[ostream.inserters.character]</a>
<br/> <div id='input.output-2.sentence-1' class='sentence'><b>Change:</b> 
Overload resolution for ostream inserters used with UTF-8 literals<a class='hidden_link' href='#input.output-2.sentence-1'>.</a></div> <br/> <div id='input.output-2.sentence-2' class='sentence'><b>Rationale:</b> 
Required for new features<a class='hidden_link' href='#input.output-2.sentence-2'>.</a></div> <br/> <div id='input.output-2.sentence-3' class='sentence'><b>Effect on original feature:</b> 
Valid ISO C++ 2017 code that passes UTF-8 literals
to <span class='texttt'>basic_&shy;ostream<span class='operator'>:</span><span class='operator'>:</span>&#x200b;<span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span></span>
no longer calls character-related overloads<a class='hidden_link' href='#input.output-2.sentence-3'>.</a></div> <pre class='codeblock'>
std<span class='operator'>:</span><span class='operator'>:</span>cout <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> <span class='literal'>u8"text"</span>;          <span class='comment'>// previously called <span class='tcode_in_codeblock'>operator&lt;&lt;(const char*)</span> and printed a string;</span>
                                <span class='comment'>// now calls <span class='tcode_in_codeblock'>operator&lt;&lt;(const void*)</span> and prints a pointer value</span>
std<span class='operator'>:</span><span class='operator'>:</span>cout <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> <span class='literal'>u8'X'</span>;             <span class='comment'>// previously called <span class='tcode_in_codeblock'>operator&lt;&lt;(char)</span> and printed a character;</span>
                                <span class='comment'>// now calls <span class='tcode_in_codeblock'>operator&lt;&lt;(int)</span> and prints an integer value</span>
</pre></div><div class='para' id='input.output-3'><div class='marginalizedparent'><a class='marginalized' href='#input.output-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2099'>#</a></div><b>Affected subclause:</b> <a href='fs.class.path'>[fs.class.path]</a>
<br/> <div id='input.output-3.sentence-1' class='sentence'><b>Change:</b> 
Return type of filesystem path format observer member functions<a class='hidden_link' href='#input.output-3.sentence-1'>.</a></div> <br/> <div id='input.output-3.sentence-2' class='sentence'><b>Rationale:</b> 
Required for new features<a class='hidden_link' href='#input.output-3.sentence-2'>.</a></div> <br/> <div id='input.output-3.sentence-3' class='sentence'><b>Effect on original feature:</b> 
Valid ISO C++ 2017 code that depends on the <span class='texttt'>u8string<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and
<span class='texttt'>generic_&shy;u8string<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> member functions of <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>filesystem<span class='operator'>:</span><span class='operator'>:</span>path</span>
returning <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>string</span> is not valid in this International Standard<a class='hidden_link' href='#input.output-3.sentence-3'>.</a></div> <pre class='codeblock'>
std<span class='operator'>:</span><span class='operator'>:</span>filesystem<span class='operator'>:</span><span class='operator'>:</span>path p;
std<span class='operator'>:</span><span class='operator'>:</span>string s1 <span class='operator'>=</span> p<span class='operator'>.</span>u8string<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;          <span class='comment'>// ill-formed; previously well-formed</span>
std<span class='operator'>:</span><span class='operator'>:</span>string s2 <span class='operator'>=</span> p<span class='operator'>.</span>generic_u8string<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;  <span class='comment'>// ill-formed; previously well-formed</span>
</pre></div></div><div id='depr' class='section'><h3 ><a class='secnum' href='#depr' style='min-width:103pt'>C.5.12</a> <a href='depr'>[depr]</a>: compatibility features <a class='abbr_ref' href='diff.cpp17.depr'>[diff.cpp17.depr]</a></h3><div class='para' id='depr-1'><div class='marginalizedparent'><a class='marginalized' href='#depr-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2117'>#</a></div><div id='depr-1.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>uncaught_&shy;exception</span><a class='hidden_link' href='#depr-1.sentence-1'>.</a></div> <br/> <div id='depr-1.sentence-2' class='sentence'><b>Rationale:</b> 
The function did not have a clear specification when multiple exceptions were
active, and has been superseded by <span class='texttt'>uncaught_&shy;exceptions</span><a class='hidden_link' href='#depr-1.sentence-2'>.</a></div> <br/> <div id='depr-1.sentence-3' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>uncaught_&shy;exception</span> may fail
to compile<a class='hidden_link' href='#depr-1.sentence-3'>.</a></div> <div id='depr-1.sentence-4' class='sentence'>It might be revised to use <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>uncaught_&shy;exceptions</span> instead,
for clear and portable semantics<a class='hidden_link' href='#depr-1.sentence-4'>.</a></div></div><div class='para' id='depr-2'><div class='marginalizedparent'><a class='marginalized' href='#depr-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2127'>#</a></div><div id='depr-2.sentence-1' class='sentence'><b>Change:</b> Remove support for adaptable function API<a class='hidden_link' href='#depr-2.sentence-1'>.</a><br/></div> <div id='depr-2.sentence-2' class='sentence'><b>Rationale:</b> 
The deprecated support relied on a limited convention that could not be
extended to support the general case or new language features<a class='hidden_link' href='#depr-2.sentence-2'>.</a></div> <div id='depr-2.sentence-3' class='sentence'>It has been
superseded by direct language support with <span class='texttt'><span class='keyword'>decltype</span></span>, and by the
<span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>bind</span> and <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>not_&shy;fn</span> function templates<a class='hidden_link' href='#depr-2.sentence-3'>.</a></div> <br/> <div id='depr-2.sentence-4' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that relies on the presence of <span class='texttt'>result_&shy;type</span>,
<span class='texttt'>argument_&shy;type</span>, <span class='texttt'>first_&shy;argument_&shy;type</span>, or
<span class='texttt'>second_&shy;argument_&shy;type</span> in a standard library class may fail to compile<a class='hidden_link' href='#depr-2.sentence-4'>.</a></div> <div id='depr-2.sentence-5' class='sentence'>A
valid C++ 2017 program that calls <span class='texttt'>not1</span> or <span class='texttt'>not2</span>, or uses the
class templates <span class='texttt'>unary_&shy;negate</span> or <span class='texttt'>binary_&shy;negate</span>, may fail to
compile<a class='hidden_link' href='#depr-2.sentence-5'>.</a></div></div><div class='para' id='depr-3'><div class='marginalizedparent'><a class='marginalized' href='#depr-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2142'>#</a></div><div id='depr-3.sentence-1' class='sentence'><b>Change:</b> Remove redundant members from <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>allocator</span><a class='hidden_link' href='#depr-3.sentence-1'>.</a></div> <br/> <div id='depr-3.sentence-2' class='sentence'><b>Rationale:</b> 
<span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>allocator</span> was overspecified, encouraging direct usage in user containers
rather than relying on <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>allocator_&shy;traits</span>, leading to poor containers<a class='hidden_link' href='#depr-3.sentence-2'>.</a></div> <br/> <div id='depr-3.sentence-3' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that directly makes use of the <span class='texttt'>pointer</span>,
<span class='texttt'>const_&shy;pointer</span>, <span class='texttt'>reference</span>, <span class='texttt'>const_&shy;reference</span>,
<span class='texttt'>rebind</span>, <span class='texttt'>address</span>, <span class='texttt'>construct</span>, <span class='texttt'>destroy</span>, or
<span class='texttt'>max_&shy;size</span> members of <span class='texttt'>std<span class='operator'>:</span><span class='operator'>:</span>allocator</span>, or that directly calls
<span class='texttt'>allocate</span> with an additional hint argument, may fail to compile<a class='hidden_link' href='#depr-3.sentence-3'>.</a></div></div><div class='para' id='depr-4'><div class='marginalizedparent'><a class='marginalized' href='#depr-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2154'>#</a></div><div id='depr-4.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>raw_&shy;storage_&shy;iterator</span><a class='hidden_link' href='#depr-4.sentence-1'>.</a></div> <br/> <div id='depr-4.sentence-2' class='sentence'><b>Rationale:</b> 
The iterator encouraged use of algorithms that might throw exceptions, but did
not return the number of elements successfully constructed that might need to
be destroyed in order to avoid leaks<a class='hidden_link' href='#depr-4.sentence-2'>.</a></div> <br/> <div id='depr-4.sentence-3' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that uses this iterator class may fail to compile<a class='hidden_link' href='#depr-4.sentence-3'>.</a></div></div><div class='para' id='depr-5'><div class='marginalizedparent'><a class='marginalized' href='#depr-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2163'>#</a></div><div id='depr-5.sentence-1' class='sentence'><b>Change:</b> Remove temporary buffers API<a class='hidden_link' href='#depr-5.sentence-1'>.</a><br/></div> <div id='depr-5.sentence-2' class='sentence'><b>Rationale:</b> 
The temporary buffer facility was intended to provide an efficient optimization
for small memory requests, but there is little evidence this was achieved in
practice, while requiring the user to provide their own exception-safe wrappers
to guard use of the facility in many cases<a class='hidden_link' href='#depr-5.sentence-2'>.</a></div> <br/> <div id='depr-5.sentence-3' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>get_&shy;temporary_&shy;buffer</span> or
<span class='texttt'>return_&shy;temporary_&shy;buffer</span> may fail to compile<a class='hidden_link' href='#depr-5.sentence-3'>.</a></div></div><div class='para' id='depr-6'><div class='marginalizedparent'><a class='marginalized' href='#depr-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2174'>#</a></div><div id='depr-6.sentence-1' class='sentence'><b>Change:</b> Remove <span class='texttt'>shared_&shy;ptr<span class='operator'>:</span><span class='operator'>:</span>unique</span><a class='hidden_link' href='#depr-6.sentence-1'>.</a></div> <br/> <div id='depr-6.sentence-2' class='sentence'><b>Rationale:</b> 
The result of a call to this member function is not reliable in the presence of
multiple threads and weak pointers<a class='hidden_link' href='#depr-6.sentence-2'>.</a></div> <div id='depr-6.sentence-3' class='sentence'>The member function <span class='texttt'>use_&shy;count</span> is
similarly unreliable, but has a clearer contract in such cases, and remains
available for well defined use in single-threaded cases<a class='hidden_link' href='#depr-6.sentence-3'>.</a></div> <br/> <div id='depr-6.sentence-4' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that calls <span class='texttt'>unique</span> on a <span class='texttt'>shared_&shy;ptr</span>
object may fail to compile<a class='hidden_link' href='#depr-6.sentence-4'>.</a></div></div><div class='para' id='depr-7'><div class='marginalizedparent'><a class='marginalized' href='#depr-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/51074104369b0ba60050fddd24685efeb8ba45c5/source/compatibility.tex#L2184'>#</a></div><b>Affected subclause:</b> <a href='depr.meta.types'>[depr.meta.types]</a>
<br/> <div id='depr-7.sentence-1' class='sentence'><b>Change:</b> Remove deprecated type traits<a class='hidden_link' href='#depr-7.sentence-1'>.</a></div> <br/> <div id='depr-7.sentence-2' class='sentence'><b>Rationale:</b> 
The traits had unreliable or awkward interfaces<a class='hidden_link' href='#depr-7.sentence-2'>.</a></div> <div id='depr-7.sentence-3' class='sentence'>The <span class='texttt'>is_&shy;literal_&shy;type</span>
trait provided no way to detect which subset of constructors and member
functions of a type were declared <span class='texttt'><span class='keyword'>constexpr</span></span><a class='hidden_link' href='#depr-7.sentence-3'>.</a></div> <div id='depr-7.sentence-4' class='sentence'>The <span class='texttt'>result_&shy;of</span>
trait had a surprising syntax that could not report the result of a regular
function type<a class='hidden_link' href='#depr-7.sentence-4'>.</a></div> <div id='depr-7.sentence-5' class='sentence'>It has been superseded by the <span class='texttt'>invoke_&shy;result</span> trait<a class='hidden_link' href='#depr-7.sentence-5'>.</a></div> <br/> <div id='depr-7.sentence-6' class='sentence'><b>Effect on original feature:</b> 
A valid C++ 2017 program that relies on the <span class='texttt'>is_&shy;literal_&shy;type</span> or
<span class='texttt'>result_&shy;of</span> type traits, on the <span class='texttt'>is_&shy;literal_&shy;type_&shy;v</span> variable template,
or on the <span class='texttt'>result_&shy;of_&shy;t</span> alias template may fail to compile<a class='hidden_link' href='#depr-7.sentence-6'>.</a></div></div></div></div></body></html>