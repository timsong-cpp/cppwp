<!DOCTYPE html><html lang='en'><head><title>[expr.add]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>7</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>7.6</a> Compound expressions <a class='abbr_ref' href='expr.compound#expr.add'>[expr.compound]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>7.6.6</a> Additive operators <a class='abbr_ref'>[expr.add]</a></h3><div class='texpara'><a class='index' id=':expression,additive_operators'></a><a class='index' id=':operator,additive'></a></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/expressions.tex#L6607'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>The additive operators <span class='texttt'><span class='operator'>+</span></span> and <span class='texttt'><span class='operator'>-</span></span> group left-to-right<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>Each operand shall be a prvalue<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>If both operands have arithmetic or unscoped enumeration type,
the usual arithmetic conversions (<a href='expr.arith.conv' title='7.4&emsp;Usual arithmetic conversions'>[expr.<span class='shy'></span>arith.<span class='shy'></span>conv]</a>) are performed<a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'>Otherwise, if one operand has arithmetic or unscoped enumeration type,
integral promotion is applied (<a href='conv.prom' title='7.3.7&emsp;Integral promotions'>[conv.<span class='shy'></span>prom]</a>) to that operand<a class='hidden_link' href='#1.sentence-4'>.</a></div> <div id='1.sentence-5' class='sentence'>A converted or promoted operand is used in place of
the corresponding original operand for the remainder of this section<a class='hidden_link' href='#1.sentence-5'>.</a></div></div><div class='texpara'><a class='index' id=':operator,addition'></a><a class='index' id=':operator,subtraction'></a><div class='bnf' id='nt:additive-expression'>
<a class='hidden_link' href='#nt:additive-expression' title='7.6.6&emsp;Additive operators&emsp;[expr.add]'><span id='nt:additive-expression'><span id=':additive-expression'>additive-expression<span class='textnormal'>:</span></span></span></a><br><a href='expr.mul#nt:multiplicative-expression' title='7.6.5&emsp;Multiplicative operators&emsp;[expr.mul]'><span id='ntref:multiplicative-expression'><span class='textsf'><i >multiplicative-expression</i></span></span></a><br><a href='#nt:additive-expression' title='7.6.6&emsp;Additive operators&emsp;[expr.add]'><span id='ntref:additive-expression'><span class='textsf'><i >additive-expression</i></span></span></a> <span class='terminal'><span class='operator'>+</span></span> <a href='expr.mul#nt:multiplicative-expression' title='7.6.5&emsp;Multiplicative operators&emsp;[expr.mul]'><span id='ntref:multiplicative-expression_'><span class='textsf'><i >multiplicative-expression</i></span></span></a><br><a href='#nt:additive-expression' title='7.6.6&emsp;Additive operators&emsp;[expr.add]'><span id='ntref:additive-expression_'><span class='textsf'><i >additive-expression</i></span></span></a> <span class='terminal'><span class='operator'>-</span></span> <a href='expr.mul#nt:multiplicative-expression' title='7.6.5&emsp;Multiplicative operators&emsp;[expr.mul]'><span id='ntref:multiplicative-expression__'><span class='textsf'><i >multiplicative-expression</i></span></span></a>
</div></div><div class='texpara'><div id='1.sentence-6' class='sentence'><a class='index' id=':incomplete'></a>For addition, either both operands shall have arithmetic
type, or one operand shall be a pointer to a completely-defined object
type and the other shall have integral type<a class='hidden_link' href='#1.sentence-6'>.</a></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/expressions.tex#L6636'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>For subtraction, one of the following shall hold:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.1'>(2.1)</a></div>both operands have arithmetic type; or</li><li id='2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.2'>(2.2)</a></div><a class='index' id=':arithmetic,pointer'></a>both operands are pointers to cv-qualified or cv-unqualified
versions of the same completely-defined object type; or</li><li id='2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.3'>(2.3)</a></div>the left operand is a pointer to a completely-defined object type
and the right operand has integral type<a class='hidden_link' href='#2.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/expressions.tex#L6650'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>The result of the binary <span class='texttt'><span class='operator'>+</span></span> operator is the sum of the operands<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>The result of the binary <span class='texttt'><span class='operator'>-</span></span> operator is the difference resulting
from the subtraction of the second operand from the first<a class='hidden_link' href='#3.sentence-2'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/expressions.tex#L6655'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'><a class='index' id=':arithmetic,pointer_'></a>When an expression <span class='texttt'>J</span> that has integral type
is added to or subtracted from an expression <span class='texttt'>P</span> of pointer type,
the result has the type of <span class='texttt'>P</span><a class='hidden_link' href='#4.sentence-1'>.</a></div> <ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#4.1'>(4.1)</a></div><div class='texpara'><div id='4.1.sentence-1' class='sentence'>If <span class='texttt'>P</span> evaluates to a null pointer value and
<span class='texttt'>J</span> evaluates to 0, the result is a null pointer value<a class='hidden_link' href='#4.1.sentence-1'>.</a></div></div></li><li id='4.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#4.2'>(4.2)</a></div><div class='texpara'><div id='4.2.sentence-1' class='sentence'>Otherwise, if <span class='texttt'>P</span> points to a (possibly-hypothetical) array element <span class='math'><span class='mathalpha'>i</span></span>
of an array object <span class='texttt'>x</span> with <span class='math'><span class='mathalpha'>n</span></span> elements (<a href='dcl.array' title='9.3.4.5&emsp;Arrays'>[dcl.<span class='shy'></span>array]</a>),<a class='footnoteref' href='#footnote-64' id='footnoteref-64' title='As specified in [basic.compound], an object that is not an array element is considered to belong to a single-element array for this purpose and a pointer past the last element of an array of n elements is considered to be equivalent to a pointer to a hypothetical array element n for this purpose.'>64</a>
the expressions <span class='texttt'>P <span class='operator'>+</span> J</span> and <span class='texttt'>J <span class='operator'>+</span> P</span>
(where <span class='texttt'>J</span> has the value <span class='math'><span class='mathalpha'>j</span></span>)
point to the (possibly-hypothetical) array element
<span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span></span> of <span class='texttt'>x</span> if <span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span>
and the expression <span class='texttt'>P <span class='operator'>-</span> J</span>
points to the (possibly-hypothetical) array element
<span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span></span> of <span class='texttt'>x</span> if <span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span><a class='hidden_link' href='#4.2.sentence-1'>.</a></div></div></li><li id='4.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#4.3'>(4.3)</a></div><div class='texpara'><div id='4.3.sentence-1' class='sentence'>Otherwise, the behavior is undefined<a class='hidden_link' href='#4.3.sentence-1'>.</a></div></div></li></ul> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='4.sentence-2' class='sentence'>Adding a value other than <span class='math'>0</span> or <span class='math'>1</span>
to a pointer to a base class subobject, a member subobject,
or a complete object results in undefined behavior<a class='hidden_link' href='#4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/expressions.tex#L6688'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'><a class='index' id=':ptrdiff_t,implementation-defined_type_of'></a><a class='index' id=':subtraction,implementation-defined_pointer'></a><a class='index' id=':ptrdiff_t'></a><a class='index' id=':comparison,undefined_pointer'></a>When two pointer expressions <span class='texttt'>P</span> and <span class='texttt'>Q</span> are subtracted,
the type of the result is an <a class='index' id=':type_of_ptrdiff_t'></a>implementation-defined signed
integral type; this type shall be the same type that is named by
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>ptrdiff_<span class='shy'></span>t</span> in the <a href='cstddef.syn#header:%3ccstddef%3e' title='17.2.1&emsp;Header &lt;cstddef&gt; synopsis&emsp;[cstddef.syn]'><span id='headerref:<cstddef>'><span class='texttt'>&lt;cstddef&gt;</span></span></a>
header (<a href='support.types.layout' title='17.2.4&emsp;Sizes, alignments, and offsets'>[support.<span class='shy'></span>types.<span class='shy'></span>layout]</a>)<a class='hidden_link' href='#5.sentence-1'>.</a></div> <ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#5.1'>(5.1)</a></div><div class='texpara'><div id='5.1.sentence-1' class='sentence'>If <span class='texttt'>P</span> and <span class='texttt'>Q</span> both evaluate to null pointer values,
the result is 0<a class='hidden_link' href='#5.1.sentence-1'>.</a></div></div></li><li id='5.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#5.2'>(5.2)</a></div><div class='texpara'><div id='5.2.sentence-1' class='sentence'>Otherwise, if <span class='texttt'>P</span> and <span class='texttt'>Q</span> point to, respectively,
array elements <span class='math'><span class='mathalpha'>i</span></span> and <span class='math'><span class='mathalpha'>j</span></span>
of the same array object <span class='texttt'>x</span>,
the expression <span class='texttt'>P <span class='operator'>-</span> Q</span> has the value <span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span></span><a class='hidden_link' href='#5.2.sentence-1'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='5.2.sentence-2' class='sentence'>If the value <span class='math'><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span></span>
is not in the range of representable values
of type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>ptrdiff_<span class='shy'></span>t</span>,
the behavior is undefined (<a href='expr.pre' title='7.1&emsp;Preamble'>[expr.<span class='shy'></span>pre]</a>)<a class='hidden_link' href='#5.2.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li><li id='5.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#5.3'>(5.3)</a></div><div class='texpara'><div id='5.3.sentence-1' class='sentence'>Otherwise, the behavior is undefined<a class='hidden_link' href='#5.3.sentence-1'>.</a></div></div></li></ul></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/ac78ae76c579883a32a9eb5b00346150a41e8e47/source/expressions.tex#L6714'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>For addition or subtraction, if the expressions <span class='texttt'>P</span> or <span class='texttt'>Q</span> have
type “pointer to <span class='mathit'>cv</span> <span class='texttt'>T</span>”, where <span class='texttt'>T</span> and the array element type
are not <a href='conv.qual#def:similar_types' title='7.3.6&emsp;Qualification conversions&emsp;[conv.qual]'>similar</a>, the behavior is undefined<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>int</span> arr<span class='squarebracket'>[</span><span class='literal'>5</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='literal'>1</span>, <span class='literal'>2</span>, <span class='literal'>3</span>, <span class='literal'>4</span>, <span class='literal'>5</span><span class='curlybracket'>}</span>;
<span class='keyword'>unsigned</span> <span class='keyword'>int</span> <span class='operator'>*</span>p <span class='operator'>=</span> <span class='keyword'>reinterpret_cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>unsigned</span> <span class='keyword'>int</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>arr <span class='operator'>+</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;
<span class='keyword'>unsigned</span> <span class='keyword'>int</span> k <span class='operator'>=</span> <span class='operator'>*</span>p;            <span class='comment'>// OK, value of <span class='tcode_in_codeblock'>k</span> is <span class='math'>2</span> (<a href='conv.lval' title='7.3.2&emsp;Lvalue-to-rvalue conversion'>[conv.<span class='shy'></span>lval]</a>)</span>
<span class='keyword'>unsigned</span> <span class='keyword'>int</span> <span class='operator'>*</span>q <span class='operator'>=</span> p <span class='operator'>+</span> <span class='literal'>1</span>;        <span class='comment'>// undefined behavior: <span class='tcode_in_codeblock'>p</span> points to an <span class='tcode_in_codeblock'>int</span>, not an <span class='tcode_in_codeblock'>unsigned int</span> object</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-64'><div class='texpara'><a class='footnotenum' href='#footnote-64'>64)</a><a class='footnoteBacklink' href='#footnoteref-64'>64)</a> <div id='footnote-64.sentence-1' class='sentence'>As specified in <a href='basic.compound' title='6.8.4&emsp;Compound types'>[basic.<span class='shy'></span>compound]</a>,
an object that is not an array element
is considered to belong to a single-element array for this purpose and
a pointer past the last element of an array of <span class='math'><span class='mathalpha'>n</span></span> elements
is considered to be equivalent to a pointer to a hypothetical array element
<span class='math'><span class='mathalpha'>n</span></span> for this purpose<a class='hidden_link' href='#footnote-64.sentence-1'>.</a></div></div></div></div></body></html>