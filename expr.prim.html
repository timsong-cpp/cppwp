<!DOCTYPE html><html lang='en'><head><title>[expr.prim]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>7</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>7.5</a> Primary expressions <a class='abbr_ref'>[expr.prim]</a></h2><span class='indexparent'><a class='index' id=':expression,primary'></a></span><pre class='bnf'><a class='nontermdef' href='#nt:primary-expression' id='nt:primary-expression'>primary-expression:</a>
<a class='grammarterm' href='lex.literal.kinds#nt:literal'>literal</a>
<span class='texttt'><span class='keyword'>this</span></span><span class='indexparent'><a class='index' id=':this'></a></span>
<span class='terminal'><span class='parenthesis'>(</span></span> <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> <span class='terminal'><span class='parenthesis'>)</span></span>
<a class='grammarterm' href='#nt:id-expression'>id-expression</a>
<a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
<a class='grammarterm' href='#nt:fold-expression'>fold-expression</a>
<a class='grammarterm' href='#nt:requires-expression'>requires-expression</a>
</pre><div id='literal' class='section'><h3 ><a class='secnum' href='#literal' style='min-width:103pt'>7.5.1</a> Literals <a class='abbr_ref' href='expr.prim.literal'>[expr.prim.literal]</a></h3><div class='para' id='literal-1'><div class='marginalizedparent'><a class='marginalized' href='#literal-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1154'>#</a></div><div id='literal-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':literal'></a></span><span class='indexparent'><a class='index' id=':constant'></a></span>A <a class='grammarterm' href='lex.literal.kinds#nt:literal'>literal</a> is a primary expression,
whose type is determined based on its form as specified in <a href='lex.literal'>[lex.literal]</a><a class='hidden_link' href='#literal-1.sentence-1'>.</a></div> <div id='literal-1.sentence-2' class='sentence'>A <a class='grammarterm' href='lex.string#nt:string-literal'>string-literal</a> is an lvalue,
a <a class='grammarterm' href='lex.ext#nt:user-defined-literal'>user-defined-literal</a>
has the same value category
as the corresponding operator call expression described in <a href='lex.ext'>[lex.ext]</a>,
and any other <a class='grammarterm' href='lex.literal.kinds#nt:literal'>literal</a> is a prvalue<a class='hidden_link' href='#literal-1.sentence-2'>.</a></div></div></div><div id='this' class='section'><h3 ><a class='secnum' href='#this' style='min-width:103pt'>7.5.2</a> This <a class='abbr_ref' href='expr.prim.this'>[expr.prim.this]</a></h3><div class='para' id='this-1'><div class='marginalizedparent'><a class='marginalized' href='#this-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1167'>#</a></div><div id='this-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':this_'></a></span>The keyword <a href='class.this'><span class='texttt'>this</span></a> names a pointer to the object for which a non-static member
function is invoked or a non-static data member's
initializer (<a href='class.mem'>[class.mem]</a>) is evaluated<a class='hidden_link' href='#this-1.sentence-1'>.</a></div></div><div class='para' id='this-2'><div class='marginalizedparent'><a class='marginalized' href='#this-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1173'>#</a></div><div id='this-2.sentence-1' class='sentence'>If a declaration declares a member function or member function template of a
class <span class='texttt'>X</span>, the expression <span class='texttt'><span class='keyword'>this</span></span> is a prvalue of type “pointer to
<a class='grammarterm' href='dcl.decl#nt:cv-qualifier-seq'>cv-qualifier-seq</a> <span class='texttt'>X</span>” between the optional
<a class='grammarterm' href='dcl.decl#nt:cv-qualifier-seq'>cv-qualifier-seq</a> and the end of the <a class='grammarterm' href='dcl.fct.def.general#nt:function-definition'>function-definition</a>,
<a class='grammarterm' href='class.mem#nt:member-declarator'>member-declarator</a>, or <a class='grammarterm' href='dcl.decl#nt:declarator'>declarator</a><a class='hidden_link' href='#this-2.sentence-1'>.</a></div> <div id='this-2.sentence-2' class='sentence'>It shall not appear
before the optional <a class='grammarterm' href='dcl.decl#nt:cv-qualifier-seq'>cv-qualifier-seq</a> and it shall not appear within
the declaration of a static member function (although its type and value category
are defined within a static member function as they are within a non-static
member function)<a class='hidden_link' href='#this-2.sentence-2'>.</a></div> <div id='this-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#this-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='this-2.sentence-3' class='sentence'>This is because declaration matching does not
occur until the complete declarator is known<a class='hidden_link' href='#this-2.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='this-2.note-2' class='note'>[&nbsp;<a class='note_link' href='#this-2.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='this-2.sentence-4' class='sentence'>In a <a class='grammarterm' href='dcl.decl#nt:trailing-return-type'>trailing-return-type</a>,
the class being defined is not required to be complete
for purposes of <a href='expr.ref'>class member access</a><a class='hidden_link' href='#this-2.sentence-4'>.</a></div> <div id='this-2.sentence-5' class='sentence'>Class members declared later are not visible<a class='hidden_link' href='#this-2.sentence-5'>.</a></div> <div id='this-2.example-1' class='example'>[&nbsp;<a class='example_link' href='#this-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>char</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>auto</span> f<span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>decltype</span><span class='parenthesis'>(</span>t <span class='operator'>+</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
    <span class='curlybracket'>{</span> <span class='keyword'>return</span> t <span class='operator'>+</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
<span class='keyword'>template</span> <span class='keyword'>auto</span> A<span class='operator'>::</span>f<span class='parenthesis'>(</span><span class='keyword'>int</span> t<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>decltype</span><span class='parenthesis'>(</span>t <span class='operator'>+</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='this-3'><div class='marginalizedparent'><a class='marginalized' href='#this-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1204'>#</a></div><div id='this-3.sentence-1' class='sentence'>Otherwise, if a <a class='grammarterm' href='class.mem#nt:member-declarator'>member-declarator</a> declares a non-static <a href='class.mem'>data
member</a> of a class <span class='texttt'>X</span>, the expression <span class='texttt'><span class='keyword'>this</span></span> is
a prvalue of type “pointer to <span class='texttt'>X</span>” within the
optional <a href='class.mem#def:default_member_initializer'>default member initializer</a><a class='hidden_link' href='#this-3.sentence-1'>.</a></div> <div id='this-3.sentence-2' class='sentence'>It shall not appear elsewhere
in the <a class='grammarterm' href='class.mem#nt:member-declarator'>member-declarator</a><a class='hidden_link' href='#this-3.sentence-2'>.</a></div></div><div class='para' id='this-4'><div class='marginalizedparent'><a class='marginalized' href='#this-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1211'>#</a></div><div id='this-4.sentence-1' class='sentence'>The expression <span class='texttt'><span class='keyword'>this</span></span> shall not appear in any other context<a class='hidden_link' href='#this-4.sentence-1'>.</a></div> <div id='this-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#this-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>class</span> Outer <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> a<span class='squarebracket'>[</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;                 <span class='comment'>// error: not inside a member function</span>
  <span class='keyword'>unsigned</span> <span class='keyword'>int</span> sz <span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span>;      <span class='comment'>// OK: in default member initializer</span>

  <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> b<span class='squarebracket'>[</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;               <span class='comment'>// OK</span>

    <span class='keyword'>struct</span> Inner <span class='curlybracket'>{</span>
      <span class='keyword'>int</span> c<span class='squarebracket'>[</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;             <span class='comment'>// error: not inside a member function of <span class='tcode_in_codeblock'>Inner</span></span>
    <span class='curlybracket'>}</span>;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div><div id='paren' class='section'><h3 ><a class='secnum' href='#paren' style='min-width:103pt'>7.5.3</a> Parentheses <a class='abbr_ref' href='expr.prim.paren'>[expr.prim.paren]</a></h3><div class='para' id='paren-1'><div class='marginalizedparent'><a class='marginalized' href='#paren-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1232'>#</a></div><div id='paren-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':expression,parenthesized'></a></span>A parenthesized expression <span class='texttt'><span class='parenthesis'>(</span><span class='math'><span class='mathalpha'>E</span></span><span class='parenthesis'>)</span></span>
is a primary expression whose type, value, and value category are identical to those of <span class='math'><span class='mathalpha'>E</span></span><a class='hidden_link' href='#paren-1.sentence-1'>.</a></div> <div id='paren-1.sentence-2' class='sentence'>The parenthesized expression can be used in exactly the same contexts as
those where <span class='math'><span class='mathalpha'>E</span></span> can be used, and with the same
meaning, except as otherwise indicated<a class='hidden_link' href='#paren-1.sentence-2'>.</a></div></div></div><div id='id' class='section'><h3 ><a class='secnum' href='#id' style='min-width:103pt'>7.5.4</a> Names <a class='abbr_ref' href='expr.prim.id'>[expr.prim.id]</a></h3><pre class='bnf'><a class='nontermdef' href='#nt:id-expression' id='nt:id-expression'>id-expression:</a>
&#9;<a class='grammarterm' href='#nt:unqualified-id'>unqualified-id</a>
&#9;<a class='grammarterm' href='#nt:qualified-id'>qualified-id</a>
</pre><div class='para' id='id-1'><div class='marginalizedparent'><a class='marginalized' href='#id-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1248'>#</a></div><div id='id-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':name'></a></span><span class='indexparent'><a class='index' id=':id-expression'></a></span>An <a class='grammarterm' href='#nt:id-expression'>id-expression</a> is a restricted form of a
<a class='grammarterm' href='#nt:primary-expression'>primary-expression</a><a class='hidden_link' href='#id-1.sentence-1'>.</a></div> <div id='id-1.note-1' class='note'>[&nbsp;<a class='note_link' href='#id-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='id-1.sentence-2' class='sentence'>An <a class='grammarterm' href='#nt:id-expression'>id-expression</a> can appear after
<a href='expr.ref'><span class='texttt'>.</span> and <span class='texttt'>-&gt;</span> operators</a><a class='hidden_link' href='#id-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='id-2'><div class='marginalizedparent'><a class='marginalized' href='#id-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1258'>#</a></div><div id='id-2.sentence-1' class='sentence'>An <a class='grammarterm' href='#nt:id-expression'>id-expression</a> that denotes a non-static data member or
non-static member function of a class can only be used:
<ul class='itemize'><li id='id-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#id-2.1'>(2.1)</a></div>as part of a <a href='expr.ref'>class member access</a> in which the
object expression
refers to the member's class<a class='footnotenum' href='#footnote-57' id='footnoteref-57'>57</a> or a class derived from
that class, or</li><li id='id-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#id-2.2'>(2.2)</a></div>to form a pointer to member (<a href='expr.unary.op'>[expr.unary.op]</a>), or</li><li id='id-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#id-2.3'>(2.3)</a></div>if that <a class='grammarterm' href='#nt:id-expression'>id-expression</a> denotes a non-static data member
and it appears in an unevaluated operand<a class='hidden_link' href='#id-2.sentence-1'>.</a> <div id='id-2.3.example-1' class='example'>[&nbsp;<a class='example_link' href='#id-2.3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> m;
<span class='curlybracket'>}</span>;
<span class='keyword'>int</span> i <span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>S<span class='operator'>::</span>m<span class='parenthesis'>)</span>;           <span class='comment'>// OK</span>
<span class='keyword'>int</span> j <span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>S<span class='operator'>::</span>m <span class='operator'>+</span> <span class='literal'>42</span><span class='parenthesis'>)</span>;      <span class='comment'>// OK</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </li></ul></div></div><div class='para' id='id-3'><div class='marginalizedparent'><a class='marginalized' href='#id-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1283'>#</a></div><div id='id-3.sentence-1' class='sentence'>A potentially-evaluated <a class='grammarterm' href='#nt:id-expression'>id-expression</a>
that denotes an immediate function (<a href='dcl.constexpr'>[dcl.constexpr]</a>)
shall appear only
<ul class='itemize'><li id='id-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#id-3.1'>(3.1)</a></div>as a subexpression of an immediate invocation, or</li><li id='id-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#id-3.2'>(3.2)</a></div>in an immediate function context (<a href='expr.const'>[expr.const]</a>)<a class='hidden_link' href='#id-3.sentence-1'>.</a></li></ul></div></div><div class='para' id='id-4'><div class='marginalizedparent'><a class='marginalized' href='#id-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1292'>#</a></div><div id='id-4.sentence-1' class='sentence'>For an <a class='grammarterm' href='#nt:id-expression'>id-expression</a> that denotes an overload set,
overload resolution is performed
to select a unique function (<a href='over.match'>[over.match]</a>, <a href='over.over'>[over.over]</a>)<a class='hidden_link' href='#id-4.sentence-1'>.</a></div> <div id='id-4.note-1' class='note'>[&nbsp;<a class='note_link' href='#id-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='id-4.sentence-2' class='sentence'>A program cannot refer to a function
with a trailing <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a>
whose <a class='grammarterm' href='temp.constr.decl#nt:constraint-expression'>constraint-expression</a> is not satisfied,
because such functions are never selected by overload resolution<a class='hidden_link' href='#id-4.sentence-2'>.</a></div> <div id='id-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#id-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>static</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span> <span class='keyword'>requires</span> <span class='literal'>false</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  A<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>f<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;                         <span class='comment'>// error: cannot call <span class='tcode_in_codeblock'>f</span></span>
  <span class='keyword'>void</span> <span class='parenthesis'>(</span><span class='operator'>*</span>p1<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span> <span class='operator'>=</span> A<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>f;          <span class='comment'>// error: cannot take the address of <span class='tcode_in_codeblock'>f</span></span>
  <span class='keyword'>decltype</span><span class='parenthesis'>(</span>A<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>f<span class='parenthesis'>)</span><span class='operator'>*</span> p2 <span class='operator'>=</span> <span class='literal'>nullptr</span>;    <span class='comment'>// error: the type <span class='tcode_in_codeblock'>decltype(A&lt;int&gt;&#x200b;::&#x200b;f)</span> is invalid</span>
<span class='curlybracket'>}</span>
</pre> <div id='id-4.sentence-3' class='sentence'>
In each case, the constraints of <span class='texttt'>f</span> are not satisfied<a class='hidden_link' href='#id-4.sentence-3'>.</a></div> <div id='id-4.sentence-4' class='sentence'>In the declaration of <span class='texttt'>p2</span>,
those constraints are required to be satisfied
even though
<span class='texttt'>f</span> is an <a href='expr.prop#def:unevaluated_operand'>unevaluated operand</a><a class='hidden_link' href='#id-4.sentence-4'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='footnote' id='footnote-57'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-57'>57)</a></div><div id='footnote-57.sentence-1' class='sentence'>This also applies when the object expression
is an implicit <span class='texttt'><span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span></span> (<a href='class.mfct.non-static'>[class.mfct.non-static]</a>)<a class='hidden_link' href='#footnote-57.sentence-1'>.</a></div> <a href='#footnoteref-57'>⮥</a></div><div id='id.unqual' class='section'><h4 ><a class='secnum' href='#id.unqual' style='min-width:118pt'>7.5.4.1</a> Unqualified names <a class='abbr_ref' href='expr.prim.id.unqual'>[expr.prim.id.unqual]</a></h4><pre class='bnf'><a class='nontermdef' href='#nt:unqualified-id' id='nt:unqualified-id'>unqualified-id:</a>
&#9;<a class='grammarterm' href='lex.name#nt:identifier'>identifier</a>
&#9;<a class='grammarterm' href='over.oper#nt:operator-function-id'>operator-function-id</a>
&#9;<a class='grammarterm' href='class.conv.fct#nt:conversion-function-id'>conversion-function-id</a>
&#9;<a class='grammarterm' href='over.literal#nt:literal-operator-id'>literal-operator-id</a>
&#9;<span class='terminal'><span class='operator'>~</span></span> <a class='grammarterm' href='dcl.type.simple#nt:type-name'>type-name</a>
&#9;<span class='terminal'><span class='operator'>~</span></span> <a class='grammarterm' href='dcl.type.decltype#nt:decltype-specifier'>decltype-specifier</a>
&#9;<a class='grammarterm' href='temp.names#nt:template-id'>template-id</a>
</pre><div class='para' id='id.unqual-1'><div class='marginalizedparent'><a class='marginalized' href='#id.unqual-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1334'>#</a></div><div id='id.unqual-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':identifier'></a></span>An <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> is only
an <a class='grammarterm' href='#nt:id-expression'>id-expression</a> if it has
been suitably declared (<a href='dcl.dcl'>[dcl.dcl]</a>)
or if it appears as part of a <a class='grammarterm' href='dcl.decl#nt:declarator-id'>declarator-id</a><a class='hidden_link' href='#id.unqual-1.sentence-1'>.</a></div> <div id='id.unqual-1.sentence-2' class='sentence'>An <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> that names a coroutine parameter
refers to the copy of the parameter (<a href='dcl.fct.def.coroutine'>[dcl.fct.def.coroutine]</a>)<a class='hidden_link' href='#id.unqual-1.sentence-2'>.</a></div> <div id='id.unqual-1.note-1' class='note'>[&nbsp;<a class='note_link' href='#id.unqual-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='id.unqual-1.sentence-3' class='sentence'>For <a class='grammarterm' href='over.oper#nt:operator-function-id'>operator-function-id</a><span class='textit'>s</span>, see <a href='over.oper'>[over.oper]</a>; for
<a class='grammarterm' href='class.conv.fct#nt:conversion-function-id'>conversion-function-id</a><span class='textit'>s</span>, see <a href='class.conv.fct'>[class.conv.fct]</a>; for
<a class='grammarterm' href='over.literal#nt:literal-operator-id'>literal-operator-id</a><span class='textit'>s</span>, see <a href='over.literal'>[over.literal]</a>; for
<a class='grammarterm' href='temp.names#nt:template-id'>template-id</a><span class='textit'>s</span>, see <a href='temp.names'>[temp.names]</a><a class='hidden_link' href='#id.unqual-1.sentence-3'>.</a></div> <div id='id.unqual-1.sentence-4' class='sentence'>A <a class='grammarterm' href='dcl.type.simple#nt:type-name'>type-name</a> or <a class='grammarterm' href='dcl.type.decltype#nt:decltype-specifier'>decltype-specifier</a>
prefixed by <span class='texttt'><span class='operator'>~</span></span> denotes the destructor of the type so named;
see <a href='#id.dtor'>[expr.prim.id.dtor]</a><a class='hidden_link' href='#id.unqual-1.sentence-4'>.</a></div> <div id='id.unqual-1.sentence-5' class='sentence'>Within the definition of a non-static member function, an
<a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> that names a non-static member is transformed to a
class member access expression (<a href='class.mfct.non-static'>[class.mfct.non-static]</a>)<a class='hidden_link' href='#id.unqual-1.sentence-5'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='id.unqual-2'><div class='marginalizedparent'><a class='marginalized' href='#id.unqual-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1355'>#</a></div><div id='id.unqual-2.sentence-1' class='sentence'>The result is the entity denoted by the identifier<a class='hidden_link' href='#id.unqual-2.sentence-1'>.</a></div> <div id='id.unqual-2.sentence-2' class='sentence'>If the entity is a local entity
and naming it from outside of an unevaluated operand
within the declarative region where the <a class='grammarterm' href='#nt:unqualified-id'>unqualified-id</a> appears
would result in some intervening <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
capturing it by copy (<a href='#lambda.capture'>[expr.prim.lambda.capture]</a>),
the type of the expression is
the type of a class member access expression (<a href='expr.ref'>[expr.ref]</a>)
naming the non-static data member
that would be declared for such a capture
in the closure object of
the innermost such intervening <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a><a class='hidden_link' href='#id.unqual-2.sentence-2'>.</a></div> <div id='id.unqual-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#id.unqual-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='id.unqual-2.sentence-3' class='sentence'>If that <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> is not declared <span class='texttt'><span class='keyword'>mutable</span></span>,
the type of such an identifier will typically be <span class='texttt'><span class='keyword'>const</span></span> qualified<a class='hidden_link' href='#id.unqual-2.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='id.unqual-2.sentence-4' class='sentence'>
The type of the expression is the type of the result<a class='hidden_link' href='#id.unqual-2.sentence-4'>.</a></div> <div id='id.unqual-2.note-2' class='note'>[&nbsp;<a class='note_link' href='#id.unqual-2.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='id.unqual-2.sentence-5' class='sentence'>If the entity is a template parameter object for
a template parameter of type <span class='texttt'>T</span> (<a href='temp.param'>[temp.param]</a>),
the type of the expression is <span class='texttt'><span class='keyword'>const</span> T</span><a class='hidden_link' href='#id.unqual-2.sentence-5'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='id.unqual-2.note-3' class='note'>[&nbsp;<a class='note_link' href='#id.unqual-2.note-3'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='id.unqual-2.sentence-6' class='sentence'>The type will be adjusted as described in <a href='expr.type'>[expr.type]</a>
if it is cv-qualified or is a reference type<a class='hidden_link' href='#id.unqual-2.sentence-6'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='id.unqual-2.sentence-7' class='sentence'>
The expression is an lvalue
if the entity is a function, variable, structured binding (<a href='dcl.struct.bind'>[dcl.struct.bind]</a>), data member, or
template parameter object
and a prvalue otherwise (<a href='basic.lval'>[basic.lval]</a>);
it is a bit-field if the identifier designates a bit-field<a class='hidden_link' href='#id.unqual-2.sentence-7'>.</a></div> <div id='id.unqual-2.example-1' class='example'>[&nbsp;<a class='example_link' href='#id.unqual-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>float</span> x, <span class='operator'>&amp;</span>r <span class='operator'>=</span> x;
  <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
    <span class='keyword'>decltype</span><span class='parenthesis'>(</span>x<span class='parenthesis'>)</span> y1;             <span class='comment'>// <span class='tcode_in_codeblock'>y1</span> has type <span class='tcode_in_codeblock'>float</span></span>
    <span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span>x<span class='parenthesis'>)</span><span class='parenthesis'>)</span> y2 <span class='operator'>=</span> y1;      <span class='comment'>// <span class='tcode_in_codeblock'>y2</span> has type <span class='tcode_in_codeblock'>float const&amp;</span> because this lambda</span>
                                <span class='comment'>// is not <span class='tcode_in_codeblock'>mutable</span> and <span class='tcode_in_codeblock'>x</span> is an lvalue</span>
    <span class='keyword'>decltype</span><span class='parenthesis'>(</span>r<span class='parenthesis'>)</span> r1 <span class='operator'>=</span> y1;        <span class='comment'>// <span class='tcode_in_codeblock'>r1</span> has type <span class='tcode_in_codeblock'>float&amp;</span></span>
    <span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span>r<span class='parenthesis'>)</span><span class='parenthesis'>)</span> r2 <span class='operator'>=</span> y2;      <span class='comment'>// <span class='tcode_in_codeblock'>r2</span> has type <span class='tcode_in_codeblock'>float const&amp;</span></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div><div id='id.qual' class='section'><h4 ><a class='secnum' href='#id.qual' style='min-width:118pt'>7.5.4.2</a> Qualified names <a class='abbr_ref' href='expr.prim.id.qual'>[expr.prim.id.qual]</a></h4><span class='indexparent'><a class='index' id=':operator,scope_resolution'></a></span><pre class='bnf'><a class='nontermdef' href='#nt:qualified-id' id='nt:qualified-id'>qualified-id:</a>
&#9;<a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> <span class='texttt'><span class='keyword'>template</span></span><span class='indexparent'><a class='index' id=':template'></a></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='#nt:unqualified-id'>unqualified-id</a>
</pre><span class='indexparent'><a class='index' id=':operator,scope_resolution_'></a></span><span class='indexparent'><a class='index' id=':name_hiding'></a></span><pre class='bnf'><a class='nontermdef' href='#nt:nested-name-specifier' id='nt:nested-name-specifier'>nested-name-specifier:</a>
&#9;<span class='terminal'><span class='operator'>::</span></span>
&#9;<a class='grammarterm' href='dcl.type.simple#nt:type-name'>type-name</a> <span class='terminal'><span class='operator'>::</span></span>
&#9;<a class='grammarterm' href='namespace.def#nt:namespace-name'>namespace-name</a> <span class='terminal'><span class='operator'>::</span></span>
&#9;<a class='grammarterm' href='dcl.type.decltype#nt:decltype-specifier'>decltype-specifier</a> <span class='terminal'><span class='operator'>::</span></span>
&#9;<a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <span class='terminal'><span class='operator'>::</span></span>
&#9;<a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> <span class='texttt'><span class='keyword'>template</span></span><span class='indexparent'><a class='index' id=':template_'></a></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='temp.names#nt:simple-template-id'>simple-template-id</a> <span class='terminal'><span class='operator'>::</span></span>
</pre><div class='para' id='id.qual-1'><div class='marginalizedparent'><a class='marginalized' href='#id.qual-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1425'>#</a></div><div id='id.qual-1.sentence-1' class='sentence'>The type denoted by a <a class='grammarterm' href='dcl.type.decltype#nt:decltype-specifier'>decltype-specifier</a> in a
<a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> shall be a class or enumeration
type<a class='hidden_link' href='#id.qual-1.sentence-1'>.</a></div></div><div class='para' id='id.qual-2'><div class='marginalizedparent'><a class='marginalized' href='#id.qual-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1430'>#</a></div><div id='id.qual-2.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> that denotes a class, optionally
followed by the keyword <span class='texttt'><span class='keyword'>template</span></span> (<a href='temp.names'>[temp.names]</a>), and then
followed by the name of a member of either that class (<a href='class.mem'>[class.mem]</a>)
or one of its <a href='class.derived'>base classes</a>, is a
<span class='indexparent'><a class='index' id=':id,qualified'></a></span><a class='grammarterm' href='#nt:qualified-id'>qualified-id</a>; <a href='class.qual'>[class.qual]</a> describes name lookup for
class members that appear in <a class='grammarterm' href='#nt:qualified-id'>qualified-id</a><span class='textit'>s</span><a class='hidden_link' href='#id.qual-2.sentence-1'>.</a></div> <div id='id.qual-2.sentence-2' class='sentence'>The result is the
member<a class='hidden_link' href='#id.qual-2.sentence-2'>.</a></div> <div id='id.qual-2.sentence-3' class='sentence'>The type of the result is the type of the member<a class='hidden_link' href='#id.qual-2.sentence-3'>.</a></div> <div id='id.qual-2.sentence-4' class='sentence'>The result is
an lvalue if the member is a static member function or a data member and a
prvalue otherwise<a class='hidden_link' href='#id.qual-2.sentence-4'>.</a></div> <div id='id.qual-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#id.qual-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='id.qual-2.sentence-5' class='sentence'>A class member can be referred to using a <a class='grammarterm' href='#nt:qualified-id'>qualified-id</a> at any
point in its potential scope (<a href='basic.scope.class'>[basic.scope.class]</a>)<a class='hidden_link' href='#id.qual-2.sentence-5'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='id.qual-2.sentence-6' class='sentence'>
Where
<a class='grammarterm' href='dcl.type.simple#nt:type-name'>type-name</a> <span class='texttt'><span class='operator'>&#x200b;::&#x200b;</span><span class='operator'>~</span></span> <a class='grammarterm' href='dcl.type.simple#nt:type-name'>type-name</a> is used,
the two <a class='grammarterm' href='dcl.type.simple#nt:type-name'>type-name</a><span class='textit'>s</span> shall refer to the same type
(ignoring cv-qualifications);
this notation denotes the destructor of the type so named (<a href='#id.dtor'>[expr.prim.id.dtor]</a>)<a class='hidden_link' href='#id.qual-2.sentence-6'>.</a></div> <div id='id.qual-2.sentence-7' class='sentence'>The <a class='grammarterm' href='#nt:unqualified-id'>unqualified-id</a> in a <a class='grammarterm' href='#nt:qualified-id'>qualified-id</a>
shall not be of the form <span class='texttt'><span class='operator'>~</span></span><a class='grammarterm' href='dcl.type.decltype#nt:decltype-specifier'>decltype-specifier</a><a class='hidden_link' href='#id.qual-2.sentence-7'>.</a></div></div><div class='para' id='id.qual-3'><div class='marginalizedparent'><a class='marginalized' href='#id.qual-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1453'>#</a></div><div id='id.qual-3.sentence-1' class='sentence'>The <a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> <span class='texttt'><span class='operator'>&#x200b;::&#x200b;</span></span> names the global namespace<a class='hidden_link' href='#id.qual-3.sentence-1'>.</a></div> <div id='id.qual-3.sentence-2' class='sentence'>A <a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> that names a
<a href='basic.namespace'>namespace</a>, optionally followed by the keyword
<span class='texttt'><span class='keyword'>template</span></span> (<a href='temp.names'>[temp.names]</a>), and then followed by the name of a member
of that namespace (or the name of a member of a namespace made visible by a
<a class='grammarterm' href='namespace.udir#nt:using-directive'>using-directive</a>), is a
<span class='indexparent'><a class='index' id=':id,qualified_'></a></span><a class='grammarterm' href='#nt:qualified-id'>qualified-id</a>; <a href='namespace.qual'>[namespace.qual]</a> describes name lookup for
namespace members that appear in <a class='grammarterm' href='#nt:qualified-id'>qualified-id</a><span class='textit'>s</span><a class='hidden_link' href='#id.qual-3.sentence-2'>.</a></div> <div id='id.qual-3.sentence-3' class='sentence'>The result is
the member<a class='hidden_link' href='#id.qual-3.sentence-3'>.</a></div> <div id='id.qual-3.sentence-4' class='sentence'>The type of the result is the type of the member<a class='hidden_link' href='#id.qual-3.sentence-4'>.</a></div> <div id='id.qual-3.sentence-5' class='sentence'>The result
is an lvalue if the member is a function, a variable, or a structured binding (<a href='dcl.struct.bind'>[dcl.struct.bind]</a>) and a prvalue otherwise<a class='hidden_link' href='#id.qual-3.sentence-5'>.</a></div></div><div class='para' id='id.qual-4'><div class='marginalizedparent'><a class='marginalized' href='#id.qual-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1466'>#</a></div><div id='id.qual-4.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> that denotes an
<a href='dcl.enum'>enumeration</a>, followed by the name of an
enumerator of that enumeration, is a <a class='grammarterm' href='#nt:qualified-id'>qualified-id</a>
that refers to the enumerator<a class='hidden_link' href='#id.qual-4.sentence-1'>.</a></div> <div id='id.qual-4.sentence-2' class='sentence'>The result is the enumerator<a class='hidden_link' href='#id.qual-4.sentence-2'>.</a></div> <div id='id.qual-4.sentence-3' class='sentence'>The type
of the result is the type of the enumeration<a class='hidden_link' href='#id.qual-4.sentence-3'>.</a></div> <div id='id.qual-4.sentence-4' class='sentence'>The result is a prvalue<a class='hidden_link' href='#id.qual-4.sentence-4'>.</a></div></div><div class='para' id='id.qual-5'><div class='marginalizedparent'><a class='marginalized' href='#id.qual-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1473'>#</a></div><div id='id.qual-5.sentence-1' class='sentence'>In a <a class='grammarterm' href='#nt:qualified-id'>qualified-id</a>, if the
<a class='grammarterm' href='#nt:unqualified-id'>unqualified-id</a>
is a
<a class='grammarterm' href='class.conv.fct#nt:conversion-function-id'>conversion-function-id</a>, its <a class='grammarterm' href='class.conv.fct#nt:conversion-type-id'>conversion-type-id</a>
is first looked up in the class denoted by
the <a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a> of the <a class='grammarterm' href='#nt:qualified-id'>qualified-id</a> and
the name, if found, is used<a class='hidden_link' href='#id.qual-5.sentence-1'>.</a></div> <div id='id.qual-5.sentence-2' class='sentence'>Otherwise, it is looked up in the context in which
the entire <a class='grammarterm' href='#nt:qualified-id'>qualified-id</a> occurs<a class='hidden_link' href='#id.qual-5.sentence-2'>.</a></div> <div id='id.qual-5.sentence-3' class='sentence'>In each of these lookups, only names that denote types or
templates whose specializations are types are considered<a class='hidden_link' href='#id.qual-5.sentence-3'>.</a></div></div></div><div id='id.dtor' class='section'><h4 ><a class='secnum' href='#id.dtor' style='min-width:118pt'>7.5.4.3</a> Destruction <a class='abbr_ref' href='expr.prim.id.dtor'>[expr.prim.id.dtor]</a></h4><div class='para' id='id.dtor-1'><div class='marginalizedparent'><a class='marginalized' href='#id.dtor-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1488'>#</a></div><div id='id.dtor-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':expression,destructor_call'></a></span><span class='indexparent'><a class='index' id=':expression,pseudo-destructor_call'></a></span>An <a class='grammarterm' href='#nt:id-expression'>id-expression</a> that denotes the destructor of a type <span class='texttt'>T</span>
names the destructor of <span class='texttt'>T</span>
if <span class='texttt'>T</span> is a class type (<a href='class.dtor'>[class.dtor]</a>),
otherwise the <a class='grammarterm' href='#nt:id-expression'>id-expression</a> is said
to name a <a class='hidden_link' href='#def:pseudo-destructor' id='def:pseudo-destructor'><i >pseudo-destructor</i></a><a class='hidden_link' href='#id.dtor-1.sentence-1'>.</a></div></div><div class='para' id='id.dtor-2'><div class='marginalizedparent'><a class='marginalized' href='#id.dtor-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1497'>#</a></div><div id='id.dtor-2.sentence-1' class='sentence'>If the <a class='grammarterm' href='#nt:id-expression'>id-expression</a> names a pseudo-destructor,
<span class='texttt'>T</span> shall be a scalar type and
the <a class='grammarterm' href='#nt:id-expression'>id-expression</a> shall appear
as the right operand of a class member access (<a href='expr.ref'>[expr.ref]</a>) that forms
the <a class='grammarterm' href='expr.post#nt:postfix-expression'>postfix-expression</a> of a function call (<a href='expr.call'>[expr.call]</a>)<a class='hidden_link' href='#id.dtor-2.sentence-1'>.</a></div> <div id='id.dtor-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#id.dtor-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='id.dtor-2.sentence-2' class='sentence'>Such a call ends the lifetime of the object (<a href='expr.call'>[expr.call]</a>, <a href='basic.life'>[basic.life]</a>)<a class='hidden_link' href='#id.dtor-2.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='id.dtor-3'><div class='marginalizedparent'><a class='marginalized' href='#id.dtor-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1507'>#</a></div><div id='id.dtor-3.example-1' class='example'>[&nbsp;<a class='example_link' href='#id.dtor-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> C <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  C <span class='operator'>*</span> pc <span class='operator'>=</span> <span class='keyword'>new</span> C;
  <span class='keyword'>using</span> C2 <span class='operator'>=</span> C;
  pc<span class='operator'>-</span><span class='anglebracket'>&gt;</span>C<span class='operator'>::</span><span class='operator'>~</span>C2<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;     <span class='comment'>// OK, destroys <span class='tcode_in_codeblock'>*pc</span></span>
  C<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='operator'>.</span>C<span class='operator'>::</span><span class='operator'>~</span>C<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;      <span class='comment'>// undefined behavior: temporary of type <span class='tcode_in_codeblock'>C</span> destroyed twice</span>
  <span class='keyword'>using</span> T <span class='operator'>=</span> <span class='keyword'>int</span>;
  <span class='literal'>0</span> <span class='operator'>.</span>T<span class='operator'>::</span><span class='operator'>~</span>T<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;       <span class='comment'>// OK, no effect</span>
  <span class='literal'>0.T</span><span class='operator'>::</span><span class='operator'>~</span>T<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;        <span class='comment'>// error: <span class='tcode_in_codeblock'>0.T</span> is a <span class='grammarterm'>user-defined-floating-point-literal</span> (<a href='lex.ext'>[lex.ext]</a>)</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div></div><div id='lambda' class='section'><h3 ><a class='secnum' href='#lambda' style='min-width:103pt'>7.5.5</a> Lambda expressions <a class='abbr_ref' href='expr.prim.lambda'>[expr.prim.lambda]</a></h3><span class='indexparent'><a class='index' id=':expression,lambda'></a></span><pre class='bnf'><a class='nontermdef' href='#nt:lambda-expression' id='nt:lambda-expression'>lambda-expression:</a>
&#9;<a class='grammarterm' href='#nt:lambda-introducer'>lambda-introducer</a> <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a>
&#9;<a class='grammarterm' href='#nt:lambda-introducer'>lambda-introducer</a> <span class='terminal'><span class='anglebracket'>&lt;</span></span> <a class='grammarterm' href='temp.pre#nt:template-parameter-list'>template-parameter-list</a> <span class='terminal'><span class='anglebracket'>&gt;</span></span> <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:lambda-introducer' id='nt:lambda-introducer'>lambda-introducer:</a>
&#9;<span class='terminal'><span class='squarebracket'>[</span></span> <a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='squarebracket'>]</span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:lambda-declarator' id='nt:lambda-declarator'>lambda-declarator:</a>
&#9;<span class='terminal'><span class='parenthesis'>(</span></span> <a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a> <span class='terminal'><span class='parenthesis'>)</span></span> <a class='grammarterm' href='dcl.spec#nt:decl-specifier-seq'>decl-specifier-seq</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
&#9;&#9;<a class='grammarterm' href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='dcl.decl#nt:trailing-return-type'>trailing-return-type</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre><div class='para' id='lambda-1'><div class='marginalizedparent'><a class='marginalized' href='#lambda-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1543'>#</a></div><div id='lambda-1.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> provides
a concise way to create a simple function object<a class='hidden_link' href='#lambda-1.sentence-1'>.</a></div> <div id='lambda-1.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>algorithm<span class='anglebracket'>&gt;</span>
<span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>cmath<span class='anglebracket'>&gt;</span>
<span class='keyword'>void</span> abssort<span class='parenthesis'>(</span><span class='keyword'>float</span><span class='operator'>*</span> x, <span class='keyword'>unsigned</span> N<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  std<span class='operator'>::</span>sort<span class='parenthesis'>(</span>x, x <span class='operator'>+</span> N, <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>float</span> a, <span class='keyword'>float</span> b<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> std<span class='operator'>::</span>abs<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='anglebracket'>&lt;</span> std<span class='operator'>::</span>abs<span class='parenthesis'>(</span>b<span class='parenthesis'>)</span>; <span class='curlybracket'>}</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda-2'><div class='marginalizedparent'><a class='marginalized' href='#lambda-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1556'>#</a></div><div id='lambda-2.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> is a prvalue
whose result object is called the <a class='hidden_link' href='#def:closure_object' id='def:closure_object'><i >closure object</i></a><a class='hidden_link' href='#lambda-2.sentence-1'>.</a></div> <div id='lambda-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda-2.sentence-2' class='sentence'>A closure object behaves like a <a href='function.objects'>function
object</a><a class='hidden_link' href='#lambda-2.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='lambda-3'><div class='marginalizedparent'><a class='marginalized' href='#lambda-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1564'>#</a></div><div id='lambda-3.sentence-1' class='sentence'>In the <a class='grammarterm' href='dcl.spec#nt:decl-specifier-seq'>decl-specifier-seq</a> of the <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a>,
each <a class='grammarterm' href='dcl.spec#nt:decl-specifier'>decl-specifier</a>
shall be one of <span class='texttt'><span class='keyword'>mutable</span></span>, <span class='texttt'><span class='keyword'>constexpr</span></span>, or <span class='texttt'><span class='keyword'>consteval</span></span><a class='hidden_link' href='#lambda-3.sentence-1'>.</a></div> <div id='lambda-3.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda-3.sentence-2' class='sentence'>The trailing <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a> is described in <a href='dcl.decl'>[dcl.decl]</a><a class='hidden_link' href='#lambda-3.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='lambda-4'><div class='marginalizedparent'><a class='marginalized' href='#lambda-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1572'>#</a></div><div id='lambda-4.sentence-1' class='sentence'>If a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> does not include a
<a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a>, it is as if the <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a> were
<span class='texttt'><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lambda-4.sentence-1'>.</a></div> <div id='lambda-4.sentence-2' class='sentence'>The lambda return type is <span class='texttt'><span class='keyword'>auto</span></span>, which is replaced by the
type specified by the
<a class='grammarterm' href='dcl.decl#nt:trailing-return-type'>trailing-return-type</a> if provided and/or deduced from
<span class='texttt'><span class='keyword'>return</span></span> statements as described in <a href='dcl.spec.auto'>[dcl.spec.auto]</a><a class='hidden_link' href='#lambda-4.sentence-2'>.</a></div> <div id='lambda-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>auto</span> x1 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> i; <span class='curlybracket'>}</span>;       <span class='comment'>// OK: return type is <span class='tcode_in_codeblock'>int</span></span>
<span class='keyword'>auto</span> x2 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='curlybracket'>{</span> <span class='literal'>1</span>, <span class='literal'>2</span> <span class='curlybracket'>}</span>; <span class='curlybracket'>}</span>;       <span class='comment'>// error: deducing return type from <span class='grammarterm'>braced-init-list</span></span>
<span class='keyword'>int</span> j;
<span class='keyword'>auto</span> x3 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span><span class='keyword'>auto</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> j; <span class='curlybracket'>}</span>;   <span class='comment'>// OK: return type is <span class='tcode_in_codeblock'>int&amp;</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda-5'><div class='marginalizedparent'><a class='marginalized' href='#lambda-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1589'>#</a></div><div id='lambda-5.sentence-1' class='sentence'>A lambda is a <a class='hidden_link' href='#def:generic_lambda' id='def:generic_lambda'><i >generic lambda</i></a>
if the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
has any generic parameter type placeholders (<a href='dcl.spec.auto'>[dcl.spec.auto]</a>), or
if the lambda has a <a class='grammarterm' href='temp.pre#nt:template-parameter-list'>template-parameter-list</a><a class='hidden_link' href='#lambda-5.sentence-1'>.</a></div> <div id='lambda-5.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>int</span> i <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>int</span> i, <span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> i; <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='literal'>3</span>, <span class='literal'>4</span><span class='parenthesis'>)</span>;                  <span class='comment'>// OK: a generic lambda</span>
<span class='keyword'>int</span> j <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>T t, <span class='keyword'>int</span> i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> i; <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='literal'>3</span>, <span class='literal'>4</span><span class='parenthesis'>)</span>;            <span class='comment'>// OK: a generic lambda</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div id='lambda.closure' class='section'><h4 ><a class='secnum' href='#lambda.closure' style='min-width:118pt'>7.5.5.1</a> Closure types <a class='abbr_ref' href='expr.prim.lambda.closure'>[expr.prim.lambda.closure]</a></h4><div class='para' id='lambda.closure-1'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1603'>#</a></div><div id='lambda.closure-1.sentence-1' class='sentence'>The type of a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> (which is also the type of the
closure object) is a unique, unnamed non-union class type,
called the <a class='hidden_link' href='#def:closure_type' id='def:closure_type'><i >closure type</i></a>,
whose properties are described below<a class='hidden_link' href='#lambda.closure-1.sentence-1'>.</a></div></div><div class='para' id='lambda.closure-2'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1609'>#</a></div><div id='lambda.closure-2.sentence-1' class='sentence'>The closure type is declared in the smallest block
scope, class scope, or namespace scope that contains the corresponding
<a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a><a class='hidden_link' href='#lambda.closure-2.sentence-1'>.</a></div> <div id='lambda.closure-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.closure-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.closure-2.sentence-2' class='sentence'>This determines the set of namespaces and
classes associated with the closure type (<a href='basic.lookup.argdep'>[basic.lookup.argdep]</a>)<a class='hidden_link' href='#lambda.closure-2.sentence-2'>.</a></div> <div id='lambda.closure-2.sentence-3' class='sentence'>The parameter
types of a <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a> do not affect these associated namespaces and
classes<a class='hidden_link' href='#lambda.closure-2.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.closure-2.sentence-4' class='sentence'>
The closure type is not an <a href='dcl.init.aggr#def:aggregate'>aggregate</a> type<a class='hidden_link' href='#lambda.closure-2.sentence-4'>.</a></div> <div id='lambda.closure-2.sentence-5' class='sentence'>An implementation may define the closure type differently from what
is described below provided this does not alter the observable behavior of the program
other than by changing:
<ul class='itemize'><li id='lambda.closure-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.closure-2.1'>(2.1)</a></div>the size and/or alignment of the closure type,</li><li id='lambda.closure-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.closure-2.2'>(2.2)</a></div>whether the closure type is trivially copyable (<a href='class.prop'>[class.prop]</a>), or</li><li id='lambda.closure-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.closure-2.3'>(2.3)</a></div>whether the closure type is a standard-layout class (<a href='class.prop'>[class.prop]</a>)<a class='hidden_link' href='#lambda.closure-2.sentence-5'>.</a></li></ul></div><div id='lambda.closure-2.sentence-6' class='sentence'>An implementation shall not add members of rvalue reference type to the closure
type<a class='hidden_link' href='#lambda.closure-2.sentence-6'>.</a></div></div><div class='para' id='lambda.closure-3'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1634'>#</a></div><div id='lambda.closure-3.sentence-1' class='sentence'>The closure type for a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> has a public
inline function call operator (for a non-generic lambda) or
function call operator template (for a generic lambda) (<a href='over.call'>[over.call]</a>)
whose parameters and return type
are described by the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>'s
<a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a> and <a class='grammarterm' href='dcl.decl#nt:trailing-return-type'>trailing-return-type</a>
respectively, and whose
<a class='grammarterm' href='temp.pre#nt:template-parameter-list'>template-parameter-list</a> consists of
the specified <a class='grammarterm' href='temp.pre#nt:template-parameter-list'>template-parameter-list</a>, if any<a class='hidden_link' href='#lambda.closure-3.sentence-1'>.</a></div> <div id='lambda.closure-3.sentence-2' class='sentence'>The <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a> of the function call operator template
is the <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a> immediately following
<span class='texttt'><span class='anglebracket'>&lt;</span></span> <a class='grammarterm' href='temp.pre#nt:template-parameter-list'>template-parameter-list</a> <span class='texttt'><span class='anglebracket'>&gt;</span></span>, if any<a class='hidden_link' href='#lambda.closure-3.sentence-2'>.</a></div> <div id='lambda.closure-3.sentence-3' class='sentence'>The trailing <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a> of the function call operator
or operator template is the <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a>
of the <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a>, if any<a class='hidden_link' href='#lambda.closure-3.sentence-3'>.</a></div> <div id='lambda.closure-3.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.closure-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.closure-3.sentence-4' class='sentence'>The function call operator template for a generic lambda might be
an abbreviated function template (<a href='dcl.fct'>[dcl.fct]</a>)<a class='hidden_link' href='#lambda.closure-3.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.closure-3.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.closure-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>auto</span> glambda <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a, <span class='keyword'>auto</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> b<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> a <span class='anglebracket'>&lt;</span> b; <span class='curlybracket'>}</span>;
<span class='keyword'>bool</span> b <span class='operator'>=</span> glambda<span class='parenthesis'>(</span><span class='literal'>3</span>, <span class='literal'>3.14</span><span class='parenthesis'>)</span>;                                      <span class='comment'>// OK</span>

<span class='keyword'>auto</span> vglambda <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> printer<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> ts<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>                                   <span class='comment'>// OK: <span class='tcode_in_codeblock'>ts</span> is a function parameter pack</span>
    printer<span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span>ts<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>ts<span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;

    <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
      printer<span class='parenthesis'>(</span>ts <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
    <span class='curlybracket'>}</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;
<span class='keyword'>auto</span> p <span class='operator'>=</span> vglambda<span class='parenthesis'>(</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> v1, <span class='keyword'>auto</span> v2, <span class='keyword'>auto</span> v3<span class='parenthesis'>)</span>
                   <span class='curlybracket'>{</span> std<span class='operator'>::</span>cout <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> v1 <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> v2 <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> v3; <span class='curlybracket'>}</span> <span class='parenthesis'>)</span>;
<span class='keyword'>auto</span> q <span class='operator'>=</span> p<span class='parenthesis'>(</span><span class='literal'>1</span>, <span class='literal'>'a'</span>, <span class='literal'>3.14</span><span class='parenthesis'>)</span>;                                       <span class='comment'>// OK: outputs <span class='tcode_in_codeblock'>1a3.14</span></span>
q<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                                                            <span class='comment'>// OK: outputs <span class='tcode_in_codeblock'>1a3.14</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.closure-4'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1675'>#</a></div><div id='lambda.closure-4.sentence-1' class='sentence'>The function call operator or operator template is declared
<span class='texttt'><span class='keyword'>const</span></span> (<a href='class.mfct.non-static'>[class.mfct.non-static]</a>) if and only if the
<a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>'s <a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a> is not
followed by <span class='texttt'><span class='keyword'>mutable</span></span><a class='hidden_link' href='#lambda.closure-4.sentence-1'>.</a></div> <div id='lambda.closure-4.sentence-2' class='sentence'>It is neither virtual nor declared <span class='texttt'><span class='keyword'>volatile</span></span><a class='hidden_link' href='#lambda.closure-4.sentence-2'>.</a></div> <div id='lambda.closure-4.sentence-3' class='sentence'>Any
<a class='grammarterm' href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a> specified on a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
applies to the corresponding function call operator or operator template<a class='hidden_link' href='#lambda.closure-4.sentence-3'>.</a></div> <div id='lambda.closure-4.sentence-4' class='sentence'>An <a class='grammarterm' href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a> in a <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a> appertains
to the type of the corresponding function call operator or operator template<a class='hidden_link' href='#lambda.closure-4.sentence-4'>.</a></div> <div id='lambda.closure-4.sentence-5' class='sentence'>The function call operator or any given operator template specialization
is a constexpr function if either
the corresponding <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>'s
<a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a>
is followed by <span class='texttt'><span class='keyword'>constexpr</span></span> or <span class='texttt'><span class='keyword'>consteval</span></span>, or
it satisfies the requirements for a constexpr function (<a href='dcl.constexpr'>[dcl.constexpr]</a>)<a class='hidden_link' href='#lambda.closure-4.sentence-5'>.</a></div> <div id='lambda.closure-4.sentence-6' class='sentence'>It is an immediate function (<a href='dcl.constexpr'>[dcl.constexpr]</a>)
if the corresponding <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>'s
<a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a> is followed by <span class='texttt'><span class='keyword'>consteval</span></span><a class='hidden_link' href='#lambda.closure-4.sentence-6'>.</a></div> <div id='lambda.closure-4.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.closure-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.closure-4.sentence-7' class='sentence'>Names referenced in
the <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a> are looked up in the context in which the
<a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> appears<a class='hidden_link' href='#lambda.closure-4.sentence-7'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.closure-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.closure-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>auto</span> ID <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> a; <span class='curlybracket'>}</span>;
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>ID<span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>3</span><span class='parenthesis'>)</span>;                      <span class='comment'>// OK</span>

<span class='keyword'>struct</span> NonLiteral <span class='curlybracket'>{</span>
  NonLiteral<span class='parenthesis'>(</span><span class='keyword'>int</span> n<span class='parenthesis'>)</span> <span class='operator'>:</span> n<span class='parenthesis'>(</span>n<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>
  <span class='keyword'>int</span> n;
<span class='curlybracket'>}</span>;
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>ID<span class='parenthesis'>(</span>NonLiteral<span class='curlybracket'>{</span><span class='literal'>3</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='operator'>.</span>n <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>3</span><span class='parenthesis'>)</span>;        <span class='comment'>// error</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.closure-5'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1711'>#</a></div><div id='lambda.closure-5.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.closure-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>auto</span> monoid <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> v<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> v; <span class='curlybracket'>}</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>auto</span> add <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> m1<span class='parenthesis'>)</span> <span class='keyword'>constexpr</span> <span class='curlybracket'>{</span>
  <span class='keyword'>auto</span> ret <span class='operator'>=</span> m1<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> m2<span class='parenthesis'>)</span> <span class='keyword'>mutable</span> <span class='curlybracket'>{</span>
    <span class='keyword'>auto</span> m1val <span class='operator'>=</span> m1<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>auto</span> plus <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> m2val<span class='parenthesis'>)</span> <span class='keyword'>mutable</span> <span class='keyword'>constexpr</span>
                   <span class='curlybracket'>{</span> <span class='keyword'>return</span> m1val <span class='operator'>+</span><span class='operator'>=</span> m2val; <span class='curlybracket'>}</span>;
    ret <span class='operator'>=</span> plus<span class='parenthesis'>(</span>m2<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
    <span class='keyword'>return</span> monoid<span class='parenthesis'>(</span>ret<span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;
<span class='keyword'>constexpr</span> <span class='keyword'>auto</span> zero <span class='operator'>=</span> monoid<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
<span class='keyword'>constexpr</span> <span class='keyword'>auto</span> one <span class='operator'>=</span> monoid<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>add<span class='parenthesis'>(</span>one<span class='parenthesis'>)</span><span class='parenthesis'>(</span>zero<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> one<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;       <span class='comment'>// OK</span>

<span class='comment'>// Since <span class='tcode_in_codeblock'>two</span> below is not declared <span class='tcode_in_codeblock'>constexpr</span>, an evaluation of its <span class='tcode_in_codeblock'>constexpr</span> member function call operator</span>
<span class='comment'>// cannot perform an lvalue-to-rvalue conversion on one of its subobjects (that represents its capture)</span>
<span class='comment'>// in a constant expression.</span>
<span class='keyword'>auto</span> two <span class='operator'>=</span> monoid<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span>;
assert<span class='parenthesis'>(</span>two<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>2</span><span class='parenthesis'>)</span>; <span class='comment'>// OK, not a constant expression.</span>
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>add<span class='parenthesis'>(</span>one<span class='parenthesis'>)</span><span class='parenthesis'>(</span>one<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> two<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;        <span class='comment'>// error: <span class='tcode_in_codeblock'>two()</span> is not a constant expression</span>
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>add<span class='parenthesis'>(</span>one<span class='parenthesis'>)</span><span class='parenthesis'>(</span>one<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> monoid<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;  <span class='comment'>// OK</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.closure-6'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1739'>#</a></div><div id='lambda.closure-6.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.closure-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.closure-6.sentence-1' class='sentence'>The function call operator or operator template may be constrained (<a href='temp.constr.decl'>[temp.constr.decl]</a>)
by a <a class='grammarterm' href='temp.param#nt:type-constraint'>type-constraint</a>,
a <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a>,
or a trailing <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a> (<a href='dcl.decl'>[dcl.decl]</a>)<a class='hidden_link' href='#lambda.closure-6.sentence-1'>.</a></div> <div id='lambda.closure-6.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.closure-6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C1 <span class='operator'>=</span> <span class='comment'>/* ... */</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span>std<span class='operator'>::</span>size_t N<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C2 <span class='operator'>=</span> <span class='comment'>/* ... */</span>;
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> A, <span class='keyword'>typename</span> B<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C3 <span class='operator'>=</span> <span class='comment'>/* ... */</span>;

<span class='keyword'>auto</span> f <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T1, C1 T2<span class='anglebracket'>&gt;</span> <span class='keyword'>requires</span> C2<span class='anglebracket'>&lt;</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T1<span class='parenthesis'>)</span> <span class='operator'>+</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T2<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>
         <span class='parenthesis'>(</span>T1 a1, T1 b1, T2 a2, <span class='keyword'>auto</span> a3, <span class='keyword'>auto</span> a4<span class='parenthesis'>)</span> <span class='keyword'>requires</span> C3<span class='anglebracket'>&lt;</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span>a4<span class='parenthesis'>)</span>, T2<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
  <span class='comment'>// <span class='tcode_in_codeblock'>T2</span> is constrained by a <span class='grammarterm'>type-constraint</span>.</span>
  <span class='comment'>// <span class='tcode_in_codeblock'>T1</span> and <span class='tcode_in_codeblock'>T2</span> are constrained by a <span class='grammarterm'>requires-clause</span>, and</span>
  <span class='comment'>// <span class='tcode_in_codeblock'>T2</span> and the type of <span class='tcode_in_codeblock'>a4</span> are constrained by a trailing <span class='grammarterm'>requires-clause</span>.</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='lambda.closure-7'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1761'>#</a></div><div id='lambda.closure-7.sentence-1' class='sentence'>The closure type for a non-generic <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> with no
<a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a>
whose constraints (if any) are satisfied
has a conversion function to pointer to
function with C++ language <a href='dcl.link'>linkage</a> having
the same parameter and return types as the closure type's function call operator<a class='hidden_link' href='#lambda.closure-7.sentence-1'>.</a></div> <div id='lambda.closure-7.sentence-2' class='sentence'>The conversion is to “pointer to <span class='texttt'><span class='keyword'>noexcept</span></span> function”
if the function call operator
has a non-throwing exception specification<a class='hidden_link' href='#lambda.closure-7.sentence-2'>.</a></div> <div id='lambda.closure-7.sentence-3' class='sentence'>The value returned by this conversion function
is the address of a function <span class='texttt'>F</span> that, when invoked,
has the same effect as invoking the closure type's function call operator
on a default-constructed instance of the closure type<a class='hidden_link' href='#lambda.closure-7.sentence-3'>.</a></div> <div id='lambda.closure-7.sentence-4' class='sentence'><span class='texttt'>F</span> is a constexpr function
if the function call operator is a constexpr function
and is an immediate function
if the function call operator is an immediate function<a class='hidden_link' href='#lambda.closure-7.sentence-4'>.</a></div></div><div class='para' id='lambda.closure-8'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1780'>#</a></div><div id='lambda.closure-8.sentence-1' class='sentence'>For a generic lambda with no <a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a>, the closure type has a
conversion function template to
pointer to function<a class='hidden_link' href='#lambda.closure-8.sentence-1'>.</a></div> <div id='lambda.closure-8.sentence-2' class='sentence'>The conversion function template has the same invented
template parameter list, and the pointer to function has the same
parameter types, as the function call operator template<a class='hidden_link' href='#lambda.closure-8.sentence-2'>.</a></div> <div id='lambda.closure-8.sentence-3' class='sentence'>The return type of
the pointer to function shall behave as if it were a
<a class='grammarterm' href='dcl.type.decltype#nt:decltype-specifier'>decltype-specifier</a> denoting the return type of the corresponding
function call operator template specialization<a class='hidden_link' href='#lambda.closure-8.sentence-3'>.</a></div></div><div class='para' id='lambda.closure-9'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1790'>#</a></div><div id='lambda.closure-9.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.closure-9.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.closure-9.sentence-1' class='sentence'>If the generic lambda has no <a class='grammarterm' href='dcl.decl#nt:trailing-return-type'>trailing-return-type</a> or
the <a class='grammarterm' href='dcl.decl#nt:trailing-return-type'>trailing-return-type</a> contains a placeholder type, return type
deduction of the corresponding function call operator template specialization
has to be done<a class='hidden_link' href='#lambda.closure-9.sentence-1'>.</a></div> <div id='lambda.closure-9.sentence-2' class='sentence'>The corresponding specialization is that instantiation of the
function call operator template with the same template arguments as those
deduced for the conversion function template<a class='hidden_link' href='#lambda.closure-9.sentence-2'>.</a></div> <div id='lambda.closure-9.sentence-3' class='sentence'>Consider the following:
<pre class='codeblock'>
<span class='keyword'>auto</span> glambda <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> a; <span class='curlybracket'>}</span>;
<span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span>fp<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span> <span class='operator'>=</span> glambda;
</pre></div> <div id='lambda.closure-9.sentence-4' class='sentence'>
The behavior of the conversion function of <span class='texttt'>glambda</span> above is like
that of the following conversion function:
<pre class='codeblock'>
<span class='keyword'>struct</span> Closure <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>auto</span> <span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='curlybracket'>{</span> <span class='comment'>/* ... */</span> <span class='curlybracket'>}</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>static</span> <span class='keyword'>auto</span> lambda_call_operator_invoker<span class='parenthesis'>(</span>T a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='comment'>// forwards execution to <span class='tcode_in_codeblock'>operator()(a)</span> and therefore has</span>
    <span class='comment'>// the same return type deduced</span>
    <span class='comment'>/* ... */</span>
  <span class='curlybracket'>}</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>using</span> fptr_t <span class='operator'>=</span>
     <span class='keyword'>decltype</span><span class='parenthesis'>(</span>lambda_call_operator_invoker<span class='parenthesis'>(</span>declval<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>operator</span> fptr_t<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>
    <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='operator'>&amp;</span>lambda_call_operator_invoker; <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
</pre></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> <div id='lambda.closure-9.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.closure-9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f1<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>   <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>
<span class='keyword'>void</span> f2<span class='parenthesis'>(</span><span class='keyword'>char</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>  <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>

<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>    <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>     <span class='comment'>// #1</span>
<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='keyword'>char</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>char</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>  <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>     <span class='comment'>// #2</span>

<span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>    <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>     <span class='comment'>// #3</span>
<span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='keyword'>char</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>   <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>     <span class='comment'>// #4</span>

<span class='keyword'>auto</span> glambda <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> a; <span class='curlybracket'>}</span>;
f1<span class='parenthesis'>(</span>glambda<span class='parenthesis'>)</span>;                    <span class='comment'>// OK</span>
f2<span class='parenthesis'>(</span>glambda<span class='parenthesis'>)</span>;                    <span class='comment'>// error: ID is not convertible</span>
g<span class='parenthesis'>(</span>glambda<span class='parenthesis'>)</span>;                     <span class='comment'>// error: ambiguous</span>
h<span class='parenthesis'>(</span>glambda<span class='parenthesis'>)</span>;                     <span class='comment'>// OK: calls #3 since it is convertible from ID</span>
<span class='keyword'>int</span><span class='operator'>&amp;</span> <span class='parenthesis'>(</span><span class='operator'>*</span>fpi<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='operator'>*</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span><span class='operator'>*</span> a<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>auto</span><span class='operator'>&amp;</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='operator'>*</span>a; <span class='curlybracket'>}</span>;        <span class='comment'>// OK</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.closure-10'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1841'>#</a></div><div id='lambda.closure-10.sentence-1' class='sentence'>The value returned by any given specialization of this conversion function
template is the address of a function <span class='texttt'>F</span> that, when invoked, has the same
effect as invoking the generic lambda's corresponding function call operator
template specialization on a default-constructed instance of the closure type<a class='hidden_link' href='#lambda.closure-10.sentence-1'>.</a></div> <div id='lambda.closure-10.sentence-2' class='sentence'><span class='texttt'>F</span> is a constexpr function
if the corresponding specialization is a constexpr function and
<span class='texttt'>F</span> is an immediate function
if the function call operator template specialization is an immediate function<a class='hidden_link' href='#lambda.closure-10.sentence-2'>.</a></div> <div id='lambda.closure-10.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.closure-10.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.closure-10.sentence-3' class='sentence'>This will result in the implicit instantiation of the generic lambda's body<a class='hidden_link' href='#lambda.closure-10.sentence-3'>.</a></div> <div id='lambda.closure-10.sentence-4' class='sentence'>The instantiated generic lambda's return type and parameter types are required to match
the return type and parameter types of the pointer to function<a class='hidden_link' href='#lambda.closure-10.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.closure-10.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.closure-10.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>auto</span> GL <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> std<span class='operator'>::</span>cout <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> a; <span class='keyword'>return</span> a; <span class='curlybracket'>}</span>;
<span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span>GL_int<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span> <span class='operator'>=</span> GL;        <span class='comment'>// OK: through conversion function template</span>
GL_int<span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span>;                      <span class='comment'>// OK: same as <span class='tcode_in_codeblock'>GL(3)</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.closure-11'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1863'>#</a></div><div id='lambda.closure-11.sentence-1' class='sentence'>The conversion function or conversion function template is public,
constexpr, non-virtual, non-explicit, const, and has a non-throwing <a href='except.spec'>exception
specification</a><a class='hidden_link' href='#lambda.closure-11.sentence-1'>.</a></div> <div id='lambda.closure-11.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.closure-11.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>auto</span> Fwd <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span>fp<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>, <span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> fp<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>auto</span> C <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> a; <span class='curlybracket'>}</span>;

<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>Fwd<span class='parenthesis'>(</span>C,<span class='literal'>3</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>3</span><span class='parenthesis'>)</span>;   <span class='comment'>// OK</span>

<span class='comment'>// No specialization of the function call operator template can be constexpr (due to the local static).</span>
<span class='keyword'>auto</span> NC <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>static</span> <span class='keyword'>int</span> s; <span class='keyword'>return</span> a; <span class='curlybracket'>}</span>;
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span>Fwd<span class='parenthesis'>(</span>NC,<span class='literal'>3</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>3</span><span class='parenthesis'>)</span>;  <span class='comment'>// error</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.closure-12'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1880'>#</a></div><div id='lambda.closure-12.sentence-1' class='sentence'>The <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>'s <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a> yields the
<a class='grammarterm' href='dcl.fct.def.general#nt:function-body'>function-body</a> (<a href='dcl.fct.def'>[dcl.fct.def]</a>) of the function call operator, but for
purposes of <a href='basic.lookup'>name lookup</a>, determining the type and value of
<a href='class.this'><span class='texttt'>this</span></a> and transforming <a class='grammarterm' href='#nt:id-expression'>id-expression</a><span class='textit'>s</span>
referring to non-static class members into class member access expressions using
<span class='texttt'><span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span></span> (<a href='class.mfct.non-static'>[class.mfct.non-static]</a>), the <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a> is
considered in the context of the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a><a class='hidden_link' href='#lambda.closure-12.sentence-1'>.</a></div> <div id='lambda.closure-12.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.closure-12.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> S1 <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x, y;
  <span class='keyword'>int</span> <span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
  <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span><span class='keyword'>int</span> <span class='curlybracket'>{</span>
      <span class='keyword'>return</span> <span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>this</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span>x <span class='operator'>+</span> y<span class='parenthesis'>)</span>;   <span class='comment'>// equivalent to <span class='tcode_in_codeblock'>S1&#x200b;::&#x200b;operator()(this-&gt;x + (*this).y)</span></span>
                                        <span class='comment'>// <span class='tcode_in_codeblock'>this</span> has type <span class='tcode_in_codeblock'>S1*</span></span>
    <span class='curlybracket'>}</span>;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='lambda.closure-12.sentence-2' class='sentence'>
Further, a variable <span class='texttt'>__func__</span> is implicitly defined at the beginning of
the <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a> of the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>,
with semantics as described in <a href='dcl.fct.def.general'>[dcl.fct.def.general]</a><a class='hidden_link' href='#lambda.closure-12.sentence-2'>.</a></div></div><div class='para' id='lambda.closure-13'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1906'>#</a></div><div id='lambda.closure-13.sentence-1' class='sentence'>The closure type associated with a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> has no
default constructor
if the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> has a <a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a>
and a defaulted default constructor otherwise<a class='hidden_link' href='#lambda.closure-13.sentence-1'>.</a></div> <div id='lambda.closure-13.sentence-2' class='sentence'>It has a defaulted copy constructor and a defaulted move constructor (<a href='class.copy.ctor'>[class.copy.ctor]</a>)<a class='hidden_link' href='#lambda.closure-13.sentence-2'>.</a></div> <div id='lambda.closure-13.sentence-3' class='sentence'>It has a deleted copy assignment operator if the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
has a <a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a> and defaulted copy and move assignment
operators otherwise (<a href='class.copy.assign'>[class.copy.assign]</a>)<a class='hidden_link' href='#lambda.closure-13.sentence-3'>.</a></div> <div id='lambda.closure-13.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.closure-13.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.closure-13.sentence-4' class='sentence'>These special member functions are implicitly defined as
usual, and might therefore be defined as deleted<a class='hidden_link' href='#lambda.closure-13.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='lambda.closure-14'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1920'>#</a></div><div id='lambda.closure-14.sentence-1' class='sentence'>The closure type associated with a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> has an
implicitly-declared destructor (<a href='class.dtor'>[class.dtor]</a>)<a class='hidden_link' href='#lambda.closure-14.sentence-1'>.</a></div></div><div class='para' id='lambda.closure-15'><div class='marginalizedparent'><a class='marginalized' href='#lambda.closure-15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1924'>#</a></div><div id='lambda.closure-15.sentence-1' class='sentence'>A member of a closure type shall not be
<a href='temp.explicit'>explicitly instantiated</a>,
<a href='temp.expl.spec'>explicitly specialized</a>, or
named in a <a href='class.friend'>friend declaration</a><a class='hidden_link' href='#lambda.closure-15.sentence-1'>.</a></div></div></div><div id='lambda.capture' class='section'><h4 ><a class='secnum' href='#lambda.capture' style='min-width:118pt'>7.5.5.2</a> Captures <a class='abbr_ref' href='expr.prim.lambda.capture'>[expr.prim.lambda.capture]</a></h4><pre class='bnf'><a class='nontermdef' href='#nt:lambda-capture' id='nt:lambda-capture'>lambda-capture:</a>
&#9;<a class='grammarterm' href='#nt:capture-default'>capture-default</a>
&#9;<a class='grammarterm' href='#nt:capture-list'>capture-list</a>
&#9;<a class='grammarterm' href='#nt:capture-default'>capture-default</a> <span class='terminal'>,</span> <a class='grammarterm' href='#nt:capture-list'>capture-list</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:capture-default' id='nt:capture-default'>capture-default:</a>
&#9;<span class='terminal'><span class='operator'>&amp;</span></span>
&#9;<span class='terminal'><span class='operator'>=</span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:capture-list' id='nt:capture-list'>capture-list:</a>
&#9;<a class='grammarterm' href='#nt:capture'>capture</a>
&#9;<a class='grammarterm' href='#nt:capture-list'>capture-list</a> <span class='terminal'>,</span> <a class='grammarterm' href='#nt:capture'>capture</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:capture' id='nt:capture'>capture:</a>
&#9;<a class='grammarterm' href='#nt:simple-capture'>simple-capture</a>
&#9;<a class='grammarterm' href='#nt:init-capture'>init-capture</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:simple-capture' id='nt:simple-capture'>simple-capture:</a>
&#9;<a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <span class='terminal'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
&#9;<span class='terminal'><span class='operator'>&amp;</span></span> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <span class='terminal'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
&#9;<span class='texttt'><span class='keyword'>this</span></span><span class='indexparent'><a class='index' id=':this__'></a></span>
&#9;<span class='terminal'><span class='operator'>*</span></span> <span class='terminal'><span class='keyword'>this</span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:init-capture' id='nt:init-capture'>init-capture:</a>
&#9;<span class='terminal'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <a class='grammarterm' href='dcl.init#nt:initializer'>initializer</a>
&#9;<span class='terminal'><span class='operator'>&amp;</span></span> <span class='terminal'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <a class='grammarterm' href='dcl.init#nt:initializer'>initializer</a>
</pre><div class='para' id='lambda.capture-1'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1971'>#</a></div><div id='lambda.capture-1.sentence-1' class='sentence'>The body of a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> may refer to variables
with automatic storage duration and the <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> object (if any)
of enclosing block scopes by capturing those entities, as described
below<a class='hidden_link' href='#lambda.capture-1.sentence-1'>.</a></div></div><div class='para' id='lambda.capture-2'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L1977'>#</a></div><div id='lambda.capture-2.sentence-1' class='sentence'>If a <a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a> includes a <a class='grammarterm' href='#nt:capture-default'>capture-default</a> that
is <span class='texttt'><span class='operator'>&amp;</span></span>, no identifier in a <a class='grammarterm' href='#nt:simple-capture'>simple-capture</a> of that
<a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a> shall be preceded
by <span class='texttt'><span class='operator'>&amp;</span></span><a class='hidden_link' href='#lambda.capture-2.sentence-1'>.</a></div> <div id='lambda.capture-2.sentence-2' class='sentence'>If a <a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a> includes a
<a class='grammarterm' href='#nt:capture-default'>capture-default</a> that is <span class='texttt'><span class='operator'>=</span></span>, each
<a class='grammarterm' href='#nt:simple-capture'>simple-capture</a> of that <a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a> shall
be of the form
“<span class='texttt'><span class='operator'>&amp;</span></span> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <span class='texttt'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>”,
“<span class='texttt'><span class='keyword'>this</span></span>”,
or “<span class='texttt'><span class='operator'>*</span> <span class='keyword'>this</span></span>”<a class='hidden_link' href='#lambda.capture-2.sentence-2'>.</a></div> <div id='lambda.capture-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-2.sentence-3' class='sentence'>The form <span class='texttt'><span class='squarebracket'>[</span><span class='operator'>&amp;</span>,<span class='keyword'>this</span><span class='squarebracket'>]</span></span> is redundant but accepted
for compatibility with ISO C++ 2014<a class='hidden_link' href='#lambda.capture-2.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.capture-2.sentence-4' class='sentence'>
Ignoring appearances in
<a class='grammarterm' href='dcl.init#nt:initializer'>initializer</a><span class='textit'>s</span> of <a class='grammarterm' href='#nt:init-capture'>init-capture</a><span class='textit'>s</span>, an identifier or
<span class='texttt'><span class='keyword'>this</span></span> shall not appear more than once in a
<a class='grammarterm' href='#nt:lambda-capture'>lambda-capture</a><a class='hidden_link' href='#lambda.capture-2.sentence-4'>.</a></div> <div id='lambda.capture-2.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> S2 <span class='curlybracket'>{</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>void</span> S2<span class='operator'>::</span>f<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='squarebracket'>[</span><span class='operator'>&amp;</span>, i<span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;        <span class='comment'>// OK</span>
  <span class='squarebracket'>[</span><span class='operator'>&amp;</span>, <span class='keyword'>this</span>, i<span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;  <span class='comment'>// OK, equivalent to <span class='tcode_in_codeblock'>[&amp;, i]</span></span>
  <span class='squarebracket'>[</span><span class='operator'>&amp;</span>, <span class='operator'>&amp;</span>i<span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;       <span class='comment'>// error: <span class='tcode_in_codeblock'>i</span> preceded by <span class='tcode_in_codeblock'>&amp;</span> when <span class='tcode_in_codeblock'>&amp;</span> is the default</span>
  <span class='squarebracket'>[</span><span class='operator'>=</span>, <span class='operator'>*</span><span class='keyword'>this</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;    <span class='comment'>// OK</span>
  <span class='squarebracket'>[</span><span class='operator'>=</span>, <span class='keyword'>this</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;     <span class='comment'>// OK, equivalent to <span class='tcode_in_codeblock'>[=]</span></span>
  <span class='squarebracket'>[</span>i, i<span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;        <span class='comment'>// error: <span class='tcode_in_codeblock'>i</span> repeated</span>
  <span class='squarebracket'>[</span><span class='keyword'>this</span>, <span class='operator'>*</span><span class='keyword'>this</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='curlybracket'>}</span>; <span class='comment'>// error: <span class='tcode_in_codeblock'>this</span> appears twice</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-3'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2011'>#</a></div><div id='lambda.capture-3.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> shall not have
a <a class='grammarterm' href='#nt:capture-default'>capture-default</a> or <a class='grammarterm' href='#nt:simple-capture'>simple-capture</a>
in its <a class='grammarterm' href='#nt:lambda-introducer'>lambda-introducer</a>
unless its innermost enclosing scope is a block scope (<a href='basic.scope.block'>[basic.scope.block]</a>)
or it appears within a default member initializer
and its innermost enclosing scope is
the corresponding class scope (<a href='basic.scope.class'>[basic.scope.class]</a>)<a class='hidden_link' href='#lambda.capture-3.sentence-1'>.</a></div></div><div class='para' id='lambda.capture-4'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2020'>#</a></div><div id='lambda.capture-4.sentence-1' class='sentence'>The <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> in a <a class='grammarterm' href='#nt:simple-capture'>simple-capture</a> is looked up using the
usual rules for <a href='basic.lookup.unqual'>unqualified name lookup</a>; each such lookup
shall find a local entity<a class='hidden_link' href='#lambda.capture-4.sentence-1'>.</a></div> <div id='lambda.capture-4.sentence-2' class='sentence'>The <a class='grammarterm' href='#nt:simple-capture'>simple-capture</a><span class='textit'>s</span> <span class='texttt'><span class='keyword'>this</span></span> and <span class='texttt'><span class='operator'>*</span> <span class='keyword'>this</span></span>
denote the local entity <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#lambda.capture-4.sentence-2'>.</a></div> <div id='lambda.capture-4.sentence-3' class='sentence'>An entity that is designated by a
<a class='grammarterm' href='#nt:simple-capture'>simple-capture</a>
is said to be <a class='hidden_link' href='#def:explicitly_captured' id='def:explicitly_captured'><i >explicitly captured</i></a><a class='hidden_link' href='#lambda.capture-4.sentence-3'>.</a></div></div><div class='para' id='lambda.capture-5'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2030'>#</a></div><div id='lambda.capture-5.sentence-1' class='sentence'>If an <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> in a <a class='grammarterm' href='#nt:simple-capture'>simple-capture</a> appears
as the <a class='grammarterm' href='dcl.decl#nt:declarator-id'>declarator-id</a> of a parameter of
the <a class='grammarterm' href='#nt:lambda-declarator'>lambda-declarator</a>'s <a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a>,
the program is ill-formed<a class='hidden_link' href='#lambda.capture-5.sentence-1'>.</a></div> <div id='lambda.capture-5.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>0</span>;
  <span class='keyword'>auto</span> g <span class='operator'>=</span> <span class='squarebracket'>[</span>x<span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>int</span> x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>0</span>; <span class='curlybracket'>}</span>;    <span class='comment'>// error: parameter and <span class='grammarterm'>simple-capture</span> have the same name</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-6'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2044'>#</a></div><div id='lambda.capture-6.sentence-1' class='sentence'>An <a class='grammarterm' href='#nt:init-capture'>init-capture</a> without ellipsis
behaves as if it declares and explicitly captures a
variable of
the form “<span class='texttt'><span class='keyword'>auto</span></span> <a class='grammarterm' href='#nt:init-capture'>init-capture</a> <span class='texttt'>;</span>”
whose declarative region is the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>'s
<a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a>, except that:
<ul class='itemize'><li id='lambda.capture-6.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-6.1'>(6.1)</a></div>if the capture is by copy (see below), the non-static data member
declared for the capture and the variable are treated as two different ways
of referring to the same object, which has the lifetime of the non-static
data member, and no additional copy and destruction is performed, and</li><li id='lambda.capture-6.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-6.2'>(6.2)</a></div>if the capture is by reference, the variable's lifetime ends when the
closure object's lifetime ends<a class='hidden_link' href='#lambda.capture-6.sentence-1'>.</a></li></ul></div> <div id='lambda.capture-6.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-6.sentence-2' class='sentence'>This enables an <a class='grammarterm' href='#nt:init-capture'>init-capture</a> like
“<span class='texttt'>x <span class='operator'>=</span> std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span></span>”; the second “<span class='texttt'>x</span>” must bind to a
declaration in the surrounding context<a class='hidden_link' href='#lambda.capture-6.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.capture-6.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>4</span>;
<span class='keyword'>auto</span> y <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>&amp;</span>r <span class='operator'>=</span> x, x <span class='operator'>=</span> x<span class='operator'>+</span><span class='literal'>1</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='operator'>-</span><span class='anglebracket'>&gt;</span><span class='keyword'>int</span> <span class='curlybracket'>{</span>
            r <span class='operator'>+</span><span class='operator'>=</span> <span class='literal'>2</span>;
            <span class='keyword'>return</span> x<span class='operator'>+</span><span class='literal'>2</span>;
         <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                               <span class='comment'>// Updates <span class='tcode_in_codeblock'>&#x200b;::&#x200b;x</span> to 6, and initializes <span class='tcode_in_codeblock'>y</span> to 7.</span>

<span class='keyword'>auto</span> z <span class='operator'>=</span> <span class='squarebracket'>[</span>a <span class='operator'>=</span> <span class='literal'>42</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>int</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>1</span>; <span class='curlybracket'>}</span>;     <span class='comment'>// error: parameter and local variable have the same name</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-7'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2076'>#</a></div><div id='lambda.capture-7.sentence-1' class='sentence'>For the purposes of lambda capture,
an expression potentially references local entities as follows:</div><ul class='itemize'><li id='lambda.capture-7.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-7.1'>(7.1)</a></div><div id='lambda.capture-7.1.sentence-1' class='sentence'>An <a class='grammarterm' href='#nt:id-expression'>id-expression</a> that names a local entity
potentially references that entity;
an <a class='grammarterm' href='#nt:id-expression'>id-expression</a> that names
one or more non-static class members
and does not form a pointer to member (<a href='expr.unary.op'>[expr.unary.op]</a>)
potentially references <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#lambda.capture-7.1.sentence-1'>.</a></div> <div id='lambda.capture-7.1.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-7.1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-7.1.sentence-2' class='sentence'>This occurs even if overload resolution
selects a static member function for the <a class='grammarterm' href='#nt:id-expression'>id-expression</a><a class='hidden_link' href='#lambda.capture-7.1.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </li><li id='lambda.capture-7.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-7.2'>(7.2)</a></div><div id='lambda.capture-7.2.sentence-1' class='sentence'>A <span class='texttt'><span class='keyword'>this</span></span> expression potentially references <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#lambda.capture-7.2.sentence-1'>.</a></div></li><li id='lambda.capture-7.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-7.3'>(7.3)</a></div><div id='lambda.capture-7.3.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> potentially references
the local entities named by its <a class='grammarterm' href='#nt:simple-capture'>simple-capture</a><span class='textit'>s</span><a class='hidden_link' href='#lambda.capture-7.3.sentence-1'>.</a></div></li></ul><div id='lambda.capture-7.sentence-2' class='sentence'>If an expression potentially references a local entity
within a declarative region in which it is odr-usable,
and the expression would be potentially evaluated
if the effect of any enclosing <span class='texttt'><span class='keyword'>typeid</span></span> expressions (<a href='expr.typeid'>[expr.typeid]</a>) were ignored,
the entity is said to be <a class='hidden_link' href='#def:capture,implicit' id='def:capture,implicit'><i >implicitly captured</i></a>
by each intervening <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> with an associated
<a class='grammarterm' href='#nt:capture-default'>capture-default</a> that does not explicitly capture it<a class='hidden_link' href='#lambda.capture-7.sentence-2'>.</a></div> <div id='lambda.capture-7.sentence-3' class='sentence'>The implicit capture of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> is deprecated when the
<a class='grammarterm' href='#nt:capture-default'>capture-default</a> is <span class='texttt'><span class='operator'>=</span></span>; see <a href='depr.capture.this'>[depr.capture.this]</a><a class='hidden_link' href='#lambda.capture-7.sentence-3'>.</a></div> <div id='lambda.capture-7.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span>, <span class='keyword'>const</span> <span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span><span class='squarebracket'>[</span><span class='literal'>2</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span>;         <span class='comment'>// #1</span>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span>, <span class='keyword'>const</span> <span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span><span class='squarebracket'>[</span><span class='literal'>1</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span>;       <span class='comment'>// #2</span>
<span class='keyword'>void</span> test<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> <span class='keyword'>int</span> x <span class='operator'>=</span> <span class='literal'>17</span>;
  <span class='keyword'>auto</span> g <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    f<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span>;                       <span class='comment'>// OK: calls #1, does not capture <span class='tcode_in_codeblock'>x</span></span>
  <span class='curlybracket'>}</span>;

  <span class='keyword'>auto</span> g1 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    f<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span>;                       <span class='comment'>// OK: calls #1, captures <span class='tcode_in_codeblock'>x</span></span>
  <span class='curlybracket'>}</span>;

  <span class='keyword'>auto</span> g2 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> selector<span class='squarebracket'>[</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>1</span> <span class='operator'>?</span> <span class='literal'>1</span> <span class='operator'>:</span> <span class='literal'>2</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
    f<span class='parenthesis'>(</span>x, selector<span class='parenthesis'>)</span>;             <span class='comment'>// OK: captures <span class='tcode_in_codeblock'>x</span>, might call #1 or #2</span>
  <span class='curlybracket'>}</span>;

  <span class='keyword'>auto</span> g3 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>typeid</span><span class='parenthesis'>(</span>a <span class='operator'>+</span> x<span class='parenthesis'>)</span>;              <span class='comment'>// captures <span class='tcode_in_codeblock'>x</span> regardless of whether <span class='tcode_in_codeblock'>a + x</span> is an unevaluated operand</span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</pre> <div id='lambda.capture-7.sentence-4' class='sentence'>
Within <span class='texttt'>g1</span>, an implementation might optimize away
the capture of <span class='texttt'>x</span> as it is not odr-used<a class='hidden_link' href='#lambda.capture-7.sentence-4'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='lambda.capture-7.note-2' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-7.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-7.sentence-5' class='sentence'>The set of captured entities is determined syntactically,
and entities might be implicitly captured
even if the expression denoting a local entity
is within a discarded statement (<a href='stmt.if'>[stmt.if]</a>)<a class='hidden_link' href='#lambda.capture-7.sentence-5'>.</a></div> <div id='lambda.capture-7.example-2' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-7.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>bool</span> B<span class='anglebracket'>&gt;</span>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span> n<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>if</span> <span class='keyword'>constexpr</span> <span class='parenthesis'>(</span>B <span class='operator'>&amp;</span><span class='operator'>&amp;</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='anglebracket'>&gt;</span> <span class='literal'>4</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
      <span class='parenthesis'>(</span><span class='keyword'>void</span><span class='parenthesis'>)</span>n;                  <span class='comment'>// captures <span class='tcode_in_codeblock'>n</span> regardless of the value of <span class='tcode_in_codeblock'>B</span> and <span class='tcode_in_codeblock'>sizeof(int)</span></span>
    <span class='curlybracket'>}</span>
  <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-8'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2156'>#</a></div><div id='lambda.capture-8.sentence-1' class='sentence'>An entity is <a class='hidden_link' href='#def:captured' id='def:captured'><i >captured</i></a> if it is captured explicitly or implicitly<a class='hidden_link' href='#lambda.capture-8.sentence-1'>.</a></div> <div id='lambda.capture-8.sentence-2' class='sentence'>An entity
captured by a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> is odr-used (<a href='basic.def.odr'>[basic.def.odr]</a>) in the scope
containing the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a><a class='hidden_link' href='#lambda.capture-8.sentence-2'>.</a></div> <div id='lambda.capture-8.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-8.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-8.sentence-3' class='sentence'>As a consequence, if a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
explicitly captures an entity that is not odr-usable,
the program is ill-formed (<a href='basic.def.odr'>[basic.def.odr]</a>)<a class='hidden_link' href='#lambda.capture-8.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.capture-8.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <span class='indexparent'><a class='index' id=':Bond,James_Bond'></a></span><pre class='codeblock'>
<span class='keyword'>void</span> f1<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> <span class='keyword'>const</span> N <span class='operator'>=</span> <span class='literal'>20</span>;
  <span class='keyword'>auto</span> m1 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span>
    <span class='keyword'>int</span> <span class='keyword'>const</span> M <span class='operator'>=</span> <span class='literal'>30</span>;
    <span class='keyword'>auto</span> m2 <span class='operator'>=</span> <span class='squarebracket'>[</span>i<span class='squarebracket'>]</span><span class='curlybracket'>{</span>
      <span class='keyword'>int</span> x<span class='squarebracket'>[</span>N<span class='squarebracket'>]</span><span class='squarebracket'>[</span>M<span class='squarebracket'>]</span>;          <span class='comment'>// OK: <span class='tcode_in_codeblock'>N</span> and <span class='tcode_in_codeblock'>M</span> are not odr-used</span>
      x<span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span><span class='squarebracket'>[</span><span class='literal'>0</span><span class='squarebracket'>]</span> <span class='operator'>=</span> i;          <span class='comment'>// OK: <span class='tcode_in_codeblock'>i</span> is explicitly captured by <span class='tcode_in_codeblock'>m2</span> and implicitly captured by <span class='tcode_in_codeblock'>m1</span></span>
    <span class='curlybracket'>}</span>;
  <span class='curlybracket'>}</span>;
  <span class='keyword'>struct</span> s1 <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> f;
    <span class='keyword'>void</span> work<span class='parenthesis'>(</span><span class='keyword'>int</span> n<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
      <span class='keyword'>int</span> m <span class='operator'>=</span> n<span class='operator'>*</span>n;
      <span class='keyword'>int</span> j <span class='operator'>=</span> <span class='literal'>40</span>;
      <span class='keyword'>auto</span> m3 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='keyword'>this</span>,m<span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
        <span class='keyword'>auto</span> m4 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>&amp;</span>,j<span class='squarebracket'>]</span> <span class='curlybracket'>{</span>   <span class='comment'>// error: <span class='tcode_in_codeblock'>j</span> not odr-usable due to intervening lambda <span class='tcode_in_codeblock'>m3</span></span>
          <span class='keyword'>int</span> x <span class='operator'>=</span> n;        <span class='comment'>// error: <span class='tcode_in_codeblock'>n</span> is odr-used but not odr-usable due to intervening lambda <span class='tcode_in_codeblock'>m3</span></span>
          x <span class='operator'>+</span><span class='operator'>=</span> m;           <span class='comment'>// OK: <span class='tcode_in_codeblock'>m</span> implicitly captured by <span class='tcode_in_codeblock'>m4</span> and explicitly captured by <span class='tcode_in_codeblock'>m3</span></span>
          x <span class='operator'>+</span><span class='operator'>=</span> i;           <span class='comment'>// error: <span class='tcode_in_codeblock'>i</span> is odr-used but not odr-usable</span>
                            <span class='comment'>// due to intervening function and class scopes</span>
          x <span class='operator'>+</span><span class='operator'>=</span> f;           <span class='comment'>// OK: <span class='tcode_in_codeblock'>this</span> captured implicitly by <span class='tcode_in_codeblock'>m4</span> and explicitly by <span class='tcode_in_codeblock'>m3</span></span>
        <span class='curlybracket'>}</span>;
      <span class='curlybracket'>}</span>;
    <span class='curlybracket'>}</span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>struct</span> s2 <span class='curlybracket'>{</span>
  <span class='keyword'>double</span> ohseven <span class='operator'>=</span> <span class='literal'>.007</span>;
  <span class='keyword'>auto</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='keyword'>this</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
      <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>*</span><span class='keyword'>this</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
          <span class='keyword'>return</span> ohseven;       <span class='comment'>// OK</span>
      <span class='curlybracket'>}</span>;
    <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>
  <span class='keyword'>auto</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
      <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>*</span><span class='keyword'>this</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;   <span class='comment'>// error: <span class='tcode_in_codeblock'>*this</span> not captured by outer <span class='grammarterm'>lambda-expression</span></span>
    <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-9'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2213'>#</a></div><div id='lambda.capture-9.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-9.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-9.sentence-1' class='sentence'>Because local entities are not
odr-usable within a default argument (<a href='basic.def.odr'>[basic.def.odr]</a>),
a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> appearing in a default argument
cannot implicitly or explicitly capture any local entity<a class='hidden_link' href='#lambda.capture-9.sentence-1'>.</a></div> <div id='lambda.capture-9.sentence-2' class='sentence'>Such a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
can still have an <a class='grammarterm' href='#nt:init-capture'>init-capture</a> if
any full-expression in its <a class='grammarterm' href='dcl.init#nt:initializer'>initializer</a>
satisfies the constraints of an expression appearing in
a default argument (<a href='dcl.fct.default'>[dcl.fct.default]</a>)<a class='hidden_link' href='#lambda.capture-9.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.capture-9.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f2<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i <span class='operator'>=</span> <span class='literal'>1</span>;
  <span class='keyword'>void</span> g1<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='squarebracket'>[</span>i<span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> i; <span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;          <span class='comment'>// error</span>
  <span class='keyword'>void</span> g2<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='squarebracket'>[</span>i<span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>0</span>; <span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;          <span class='comment'>// error</span>
  <span class='keyword'>void</span> g3<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> i; <span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;          <span class='comment'>// error</span>
  <span class='keyword'>void</span> g4<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>0</span>; <span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;          <span class='comment'>// OK</span>
  <span class='keyword'>void</span> g5<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='keyword'>sizeof</span> i; <span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;    <span class='comment'>// OK</span>
  <span class='keyword'>void</span> g6<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='squarebracket'>[</span>x<span class='operator'>=</span><span class='literal'>1</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> x; <span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;        <span class='comment'>// OK</span>
  <span class='keyword'>void</span> g7<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='squarebracket'>[</span>x<span class='operator'>=</span>i<span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> x; <span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;        <span class='comment'>// error</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-10'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2240'>#</a></div><div id='lambda.capture-10.sentence-1' class='sentence'>An entity is <a class='hidden_link' href='#def:captured,by_copy' id='def:captured,by_copy'><i >captured by copy</i></a> if
<ul class='itemize'><li id='lambda.capture-10.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-10.1'>(10.1)</a></div>it is implicitly captured,
the <a class='grammarterm' href='#nt:capture-default'>capture-default</a> is <span class='texttt'><span class='operator'>=</span></span>, and
the captured entity is not <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>, or</li><li id='lambda.capture-10.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-10.2'>(10.2)</a></div>it is explicitly captured with a capture that is not of the form
<span class='texttt'><span class='keyword'>this</span></span>,
<span class='texttt'><span class='operator'>&amp;</span></span> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a>, or
<span class='texttt'><span class='operator'>&amp;</span></span> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <a class='grammarterm' href='dcl.init#nt:initializer'>initializer</a><a class='hidden_link' href='#lambda.capture-10.sentence-1'>.</a></li></ul></div> <div id='lambda.capture-10.sentence-2' class='sentence'>
For each entity captured by copy, an
unnamed non-static data member is declared in the closure type<a class='hidden_link' href='#lambda.capture-10.sentence-2'>.</a></div> <div id='lambda.capture-10.sentence-3' class='sentence'>The declaration order of
these members is unspecified<a class='hidden_link' href='#lambda.capture-10.sentence-3'>.</a></div> <div id='lambda.capture-10.sentence-4' class='sentence'>The type of such a data member is
the referenced type if the entity is a reference to an object,
an lvalue reference to the referenced function type if the entity is a reference to a function, or
the type of the corresponding captured entity otherwise<a class='hidden_link' href='#lambda.capture-10.sentence-4'>.</a></div> <div id='lambda.capture-10.sentence-5' class='sentence'>A member of an anonymous union shall not be captured by copy<a class='hidden_link' href='#lambda.capture-10.sentence-5'>.</a></div></div><div class='para' id='lambda.capture-11'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2261'>#</a></div><div id='lambda.capture-11.sentence-1' class='sentence'>Every <a class='grammarterm' href='#nt:id-expression'>id-expression</a> within the <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a> of a
<a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> that is an <a href='basic.def.odr'>odr-use</a> of an
entity captured by copy is transformed into an access to the corresponding unnamed data
member of the closure type<a class='hidden_link' href='#lambda.capture-11.sentence-1'>.</a></div> <div id='lambda.capture-11.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-11.sentence-2' class='sentence'>An <a class='grammarterm' href='#nt:id-expression'>id-expression</a> that is not an odr-use refers to
the original entity, never to a member of the closure type<a class='hidden_link' href='#lambda.capture-11.sentence-2'>.</a></div> <div id='lambda.capture-11.sentence-3' class='sentence'>However, such
an <a class='grammarterm' href='#nt:id-expression'>id-expression</a> can still cause the implicit capture of the
entity<a class='hidden_link' href='#lambda.capture-11.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.capture-11.sentence-4' class='sentence'>
If <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> is captured by copy, each expression that odr-uses <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> is
transformed to instead refer to the corresponding unnamed data member of the closure type<a class='hidden_link' href='#lambda.capture-11.sentence-4'>.</a></div> <div id='lambda.capture-11.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-11.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>*</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> <span class='keyword'>int</span> N <span class='operator'>=</span> <span class='literal'>10</span>;
  <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> arr<span class='squarebracket'>[</span>N<span class='squarebracket'>]</span>;     <span class='comment'>// OK: not an odr-use, refers to automatic variable</span>
    f<span class='parenthesis'>(</span><span class='operator'>&amp;</span>N<span class='parenthesis'>)</span>;          <span class='comment'>// OK: causes <span class='tcode_in_codeblock'>N</span> to be captured; <span class='tcode_in_codeblock'>&amp;N</span> points to</span>
                    <span class='comment'>// the corresponding member of the closure type</span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-12'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2289'>#</a></div><div id='lambda.capture-12.sentence-1' class='sentence'>An entity is <a class='hidden_link' href='#def:captured,by_reference' id='def:captured,by_reference'><i >captured by reference</i></a> if it is implicitly or explicitly
captured but not captured by copy<a class='hidden_link' href='#lambda.capture-12.sentence-1'>.</a></div> <div id='lambda.capture-12.sentence-2' class='sentence'>It is unspecified whether additional unnamed
non-static data members are declared in the closure type for entities captured by
reference<a class='hidden_link' href='#lambda.capture-12.sentence-2'>.</a></div> <div id='lambda.capture-12.sentence-3' class='sentence'>If declared, such non-static data members shall be of literal type<a class='hidden_link' href='#lambda.capture-12.sentence-3'>.</a></div> <div id='lambda.capture-12.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-12.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='comment'>// The inner closure type must be a literal type regardless of how reference captures are represented.</span>
<span class='keyword'>static_assert</span><span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>int</span> n<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>&amp;</span>n<span class='squarebracket'>]</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='operator'>+</span><span class='operator'>+</span>n; <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span><span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>4</span><span class='parenthesis'>)</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='lambda.capture-12.sentence-4' class='sentence'>
A bit-field or a member of an anonymous union
shall not be captured by reference<a class='hidden_link' href='#lambda.capture-12.sentence-4'>.</a></div></div><div class='para' id='lambda.capture-13'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2304'>#</a></div><div id='lambda.capture-13.sentence-1' class='sentence'>An <a class='grammarterm' href='#nt:id-expression'>id-expression</a> within
the <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a> of a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
that is an odr-use of a reference captured by reference
refers to the entity to which the captured reference is bound and
not to the captured reference<a class='hidden_link' href='#lambda.capture-13.sentence-1'>.</a></div> <div id='lambda.capture-13.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-13.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-13.sentence-2' class='sentence'>The validity of such captures is determined by
the lifetime of the object to which the reference refers,
not by the lifetime of the reference itself<a class='hidden_link' href='#lambda.capture-13.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='lambda.capture-13.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-13.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>auto</span> h<span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='operator'>&amp;</span>r<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>&amp;</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span>
    <span class='operator'>+</span><span class='operator'>+</span>r;            <span class='comment'>// Valid after <span class='tcode_in_codeblock'>h</span> returns if the lifetime of the</span>
                    <span class='comment'>// object to which <span class='tcode_in_codeblock'>r</span> is bound has not ended</span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-14'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2326'>#</a></div><div id='lambda.capture-14.sentence-1' class='sentence'>If a <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> <span class='texttt'>m2</span> captures an entity and that entity is
captured by an immediately enclosing <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
<span class='texttt'>m1</span>, then
<span class='texttt'>m2</span>'s capture is transformed as follows:
<ul class='itemize'><li id='lambda.capture-14.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-14.1'>(14.1)</a></div>if <span class='texttt'>m1</span> captures the entity by copy,
<span class='texttt'>m2</span> captures the corresponding
non-static data member of <span class='texttt'>m1</span>'s closure type;</li><li id='lambda.capture-14.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#lambda.capture-14.2'>(14.2)</a></div>if <span class='texttt'>m1</span> captures the entity by reference,
<span class='texttt'>m2</span> captures the same
entity captured by <span class='texttt'>m1</span><a class='hidden_link' href='#lambda.capture-14.sentence-1'>.</a></li></ul></div> <div id='lambda.capture-14.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-14.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='lambda.capture-14.sentence-2' class='sentence'>The nested <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>s and invocations below will output
<span class='texttt'><span class='literal'>123234</span></span><a class='hidden_link' href='#lambda.capture-14.sentence-2'>.</a></div> <pre class='codeblock'>
<span class='keyword'>int</span> a <span class='operator'>=</span> <span class='literal'>1</span>, b <span class='operator'>=</span> <span class='literal'>1</span>, c <span class='operator'>=</span> <span class='literal'>1</span>;
<span class='keyword'>auto</span> m1 <span class='operator'>=</span> <span class='squarebracket'>[</span>a, <span class='operator'>&amp;</span>b, <span class='operator'>&amp;</span>c<span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>mutable</span> <span class='curlybracket'>{</span>
  <span class='keyword'>auto</span> m2 <span class='operator'>=</span> <span class='squarebracket'>[</span>a, b, <span class='operator'>&amp;</span>c<span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>mutable</span> <span class='curlybracket'>{</span>
    std<span class='operator'>::</span>cout <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> a <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> b <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> c;
    a <span class='operator'>=</span> <span class='literal'>4</span>; b <span class='operator'>=</span> <span class='literal'>4</span>; c <span class='operator'>=</span> <span class='literal'>4</span>;
  <span class='curlybracket'>}</span>;
  a <span class='operator'>=</span> <span class='literal'>3</span>; b <span class='operator'>=</span> <span class='literal'>3</span>; c <span class='operator'>=</span> <span class='literal'>3</span>;
  m2<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
a <span class='operator'>=</span> <span class='literal'>2</span>; b <span class='operator'>=</span> <span class='literal'>2</span>; c <span class='operator'>=</span> <span class='literal'>2</span>;
m1<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
std<span class='operator'>::</span>cout <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> a <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> b <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> c;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-15'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2358'>#</a></div><div id='lambda.capture-15.sentence-1' class='sentence'>When the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a> is evaluated, the entities that are
captured by copy are used to direct-initialize each corresponding non-static data member
of the resulting closure object, and the non-static data members corresponding to the
<a class='grammarterm' href='#nt:init-capture'>init-capture</a><span class='textit'>s</span> are initialized as indicated by the corresponding
<a class='grammarterm' href='dcl.init#nt:initializer'>initializer</a> (which may be copy- or direct-initialization)<a class='hidden_link' href='#lambda.capture-15.sentence-1'>.</a></div> <div id='lambda.capture-15.sentence-2' class='sentence'>(For array members, the array elements are
direct-initialized in increasing subscript order<a class='hidden_link' href='#lambda.capture-15.sentence-2'>.</a>)</div> <div id='lambda.capture-15.sentence-3' class='sentence'>These initializations are performed
in the (unspecified) order in which the non-static data members are declared<a class='hidden_link' href='#lambda.capture-15.sentence-3'>.</a></div> <div id='lambda.capture-15.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-15.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-15.sentence-4' class='sentence'>This ensures that the destructions will occur in the reverse order of the constructions<a class='hidden_link' href='#lambda.capture-15.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-16'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2370'>#</a></div><div id='lambda.capture-16.note-1' class='note'>[&nbsp;<a class='note_link' href='#lambda.capture-16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='lambda.capture-16.sentence-1' class='sentence'>If a non-reference entity is implicitly or explicitly captured by reference,
invoking the function call operator of the corresponding <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>
after the lifetime of the entity has ended is likely to result in undefined behavior<a class='hidden_link' href='#lambda.capture-16.sentence-1'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='lambda.capture-17'><div class='marginalizedparent'><a class='marginalized' href='#lambda.capture-17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2377'>#</a></div><div id='lambda.capture-17.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:simple-capture'>simple-capture</a> containing an ellipsis is a pack
expansion (<a href='temp.variadic'>[temp.variadic]</a>)<a class='hidden_link' href='#lambda.capture-17.sentence-1'>.</a></div> <div id='lambda.capture-17.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':init-capture_pack'></a></span>An <a class='grammarterm' href='#nt:init-capture'>init-capture</a> containing an ellipsis is a pack
expansion that introduces an
<a class='grammarterm' href='#nt:init-capture'>init-capture</a> pack (<a href='temp.variadic'>[temp.variadic]</a>)
whose declarative region is
the <a class='grammarterm' href='#nt:lambda-expression'>lambda-expression</a>'s <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a><a class='hidden_link' href='#lambda.capture-17.sentence-2'>.</a></div> <div id='lambda.capture-17.example-1' class='example'>[&nbsp;<a class='example_link' href='#lambda.capture-17.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
<span class='keyword'>void</span> f<span class='parenthesis'>(</span>Args<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>auto</span> lm <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>&amp;</span>, args<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> g<span class='parenthesis'>(</span>args<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
  lm<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

  <span class='keyword'>auto</span> lm2 <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span>xs<span class='operator'>=</span>std<span class='operator'>::</span>move<span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='squarebracket'>]</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> g<span class='parenthesis'>(</span>xs<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
  lm2<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  </div></div></div><div id='fold' class='section'><h3 ><a class='secnum' href='#fold' style='min-width:103pt'>7.5.6</a> Fold expressions <a class='abbr_ref' href='expr.prim.fold'>[expr.prim.fold]</a></h3><span class='indexparent'><a class='index' id=':expression,fold'></a></span><div class='para' id='fold-1'><div class='marginalizedparent'><a class='marginalized' href='#fold-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2403'>#</a></div><div id='fold-1.sentence-1' class='sentence'>A fold expression performs a fold of a
pack (<a href='temp.variadic'>[temp.variadic]</a>) over a binary operator<a class='hidden_link' href='#fold-1.sentence-1'>.</a></div><pre class='bnf'><a class='nontermdef' href='#nt:fold-expression' id='nt:fold-expression'>fold-expression:</a>
&#9;<span class='terminal'><span class='parenthesis'>(</span></span> <a class='grammarterm' href='expr.cast#nt:cast-expression'>cast-expression</a> <a class='grammarterm' href='#nt:fold-operator'>fold-operator</a> <span class='terminal'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> <span class='terminal'><span class='parenthesis'>)</span></span>
&#9;<span class='terminal'><span class='parenthesis'>(</span></span> <span class='terminal'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> <a class='grammarterm' href='#nt:fold-operator'>fold-operator</a> <a class='grammarterm' href='expr.cast#nt:cast-expression'>cast-expression</a> <span class='terminal'><span class='parenthesis'>)</span></span>
&#9;<span class='terminal'><span class='parenthesis'>(</span></span> <a class='grammarterm' href='expr.cast#nt:cast-expression'>cast-expression</a> <a class='grammarterm' href='#nt:fold-operator'>fold-operator</a> <span class='terminal'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> <a class='grammarterm' href='#nt:fold-operator'>fold-operator</a> <a class='grammarterm' href='expr.cast#nt:cast-expression'>cast-expression</a> <span class='terminal'><span class='parenthesis'>)</span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:fold-operator' id='nt:fold-operator'>fold-operator:</a> <span class='textnormal'>one of</span>
&#9;<span class='terminal'><span class='operator'>+</span> </span>&emsp;&ensp;<span class='terminal'><span class='operator'>-</span> </span>&emsp;&ensp;<span class='terminal'><span class='operator'>*</span> </span>&emsp;&ensp;<span class='terminal'><span class='operator'>/</span> </span>&emsp;&ensp;<span class='terminal'><span class='operator'>%</span> </span>&emsp;&ensp;<span class='terminal'><span class='operator'>^</span> </span>&emsp;&ensp;<span class='terminal'><span class='operator'>&amp;</span> </span>&emsp;&ensp;<span class='terminal'><span class='operator'>|</span> </span>&emsp;&ensp;<span class='terminal'><span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> </span>&emsp;&ensp;<span class='terminal'><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> </span>
&#9;<span class='terminal'><span class='operator'>+</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>-</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>*</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>/</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>%</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>^</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>&amp;</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>|</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>=</span></span>
&#9;<span class='terminal'><span class='operator'>=</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>!</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='anglebracket'>&lt;</span> </span>&emsp;&ensp;<span class='terminal'><span class='anglebracket'>&gt;</span> </span>&emsp;&ensp;<span class='terminal'><span class='anglebracket'>&lt;</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='anglebracket'>&gt;</span><span class='operator'>=</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>&amp;</span><span class='operator'>&amp;</span></span>&emsp;&ensp;<span class='terminal'><span class='operator'>|</span><span class='operator'>|</span></span>&emsp;&ensp;<span class='terminal'>,  </span>&emsp;&ensp;<span class='terminal'><span class='operator'>.</span><span class='operator'>*</span> </span>&emsp;&ensp;<span class='terminal'><span class='operator'>-</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span></span>
</pre></div><div class='para' id='fold-2'><div class='marginalizedparent'><a class='marginalized' href='#fold-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2423'>#</a></div><div id='fold-2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':fold,unary'></a></span>An expression of the form
<span class='texttt'><span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> <span class='textit'>op</span> <span class='texttt'>e<span class='parenthesis'>)</span></span>
where <span class='textit'>op</span> is a <a class='grammarterm' href='#nt:fold-operator'>fold-operator</a>
is called a <a class='hidden_link' href='#def:unary_left_fold' id='def:unary_left_fold'><i >unary left fold</i></a><a class='hidden_link' href='#fold-2.sentence-1'>.</a></div> <div id='fold-2.sentence-2' class='sentence'>An expression of the form
<span class='texttt'><span class='parenthesis'>(</span>e</span> <span class='textit'>op</span> <span class='texttt'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span>
where <span class='textit'>op</span> is a <a class='grammarterm' href='#nt:fold-operator'>fold-operator</a>
is called a <a class='hidden_link' href='#def:unary_right_fold' id='def:unary_right_fold'><i >unary right fold</i></a><a class='hidden_link' href='#fold-2.sentence-2'>.</a></div> <div id='fold-2.sentence-3' class='sentence'>Unary left folds and unary right folds
are collectively called <a class='hidden_link' href='#def:unary_fold' id='def:unary_fold'><i >unary folds</i></a><a class='hidden_link' href='#fold-2.sentence-3'>.</a></div> <div id='fold-2.sentence-4' class='sentence'>In a unary fold,
the <a class='grammarterm' href='expr.cast#nt:cast-expression'>cast-expression</a>
shall contain an unexpanded pack (<a href='temp.variadic'>[temp.variadic]</a>)<a class='hidden_link' href='#fold-2.sentence-4'>.</a></div></div><div class='para' id='fold-3'><div class='marginalizedparent'><a class='marginalized' href='#fold-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2439'>#</a></div><div id='fold-3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':fold,binary'></a></span>An expression of the form
<span class='texttt'><span class='parenthesis'>(</span>e1</span> <span class='textit'>op1</span> <span class='texttt'><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span> <span class='textit'>op2</span> <span class='texttt'>e2<span class='parenthesis'>)</span></span>
where <span class='textit'>op1</span> and <span class='textit'>op2</span> are <a class='grammarterm' href='#nt:fold-operator'>fold-operator</a><span class='textit'>s</span>
is called a <a class='hidden_link' href='#def:binary_fold' id='def:binary_fold'><i >binary fold</i></a><a class='hidden_link' href='#fold-3.sentence-1'>.</a></div> <div id='fold-3.sentence-2' class='sentence'>In a binary fold,
<span class='textit'>op1</span> and <span class='textit'>op2</span>
shall be the same <a class='grammarterm' href='#nt:fold-operator'>fold-operator</a>,
and either <span class='texttt'>e1</span>
shall contain an unexpanded pack
or <span class='texttt'>e2</span>
shall contain an unexpanded pack,
but not both<a class='hidden_link' href='#fold-3.sentence-2'>.</a></div> <div id='fold-3.sentence-3' class='sentence'>If <span class='texttt'>e2</span> contains an unexpanded pack,
the expression is called a <a class='hidden_link' href='#def:binary_left_fold' id='def:binary_left_fold'><i >binary left fold</i></a><a class='hidden_link' href='#fold-3.sentence-3'>.</a></div> <div id='fold-3.sentence-4' class='sentence'>If <span class='texttt'>e1</span> contains an unexpanded pack,
the expression is called a <a class='hidden_link' href='#def:binary_right_fold' id='def:binary_right_fold'><i >binary right fold</i></a><a class='hidden_link' href='#fold-3.sentence-4'>.</a></div> <div id='fold-3.example-1' class='example'>[&nbsp;<a class='example_link' href='#fold-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span>Args<span class='anglebracket'>&gt;</span>
<span class='keyword'>bool</span> f<span class='parenthesis'>(</span>Args <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span>args<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='parenthesis'>(</span><span class='literal'>true</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span> <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span> args<span class='parenthesis'>)</span>; <span class='comment'>// OK</span>
<span class='curlybracket'>}</span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span>Args<span class='anglebracket'>&gt;</span>
<span class='keyword'>bool</span> f<span class='parenthesis'>(</span>Args <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span>args<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='parenthesis'>(</span>args <span class='operator'>+</span> <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> <span class='operator'>+</span> args<span class='parenthesis'>)</span>;   <span class='comment'>// error: both operands contain unexpanded packs</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  </div></div><div id='req' class='section'><h3 ><a class='secnum' href='#req' style='min-width:103pt'>7.5.7</a> Requires expressions <a class='abbr_ref' href='expr.prim.req'>[expr.prim.req]</a></h3><span class='indexparent'><a class='index' id=':expression,requires'></a></span><div class='para' id='req-1'><div class='marginalizedparent'><a class='marginalized' href='#req-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2475'>#</a></div><div id='req-1.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> provides a concise way to express
requirements on template arguments
that can be checked by <a href='basic.lookup'>name lookup</a>
or by checking properties of types and expressions<a class='hidden_link' href='#req-1.sentence-1'>.</a></div><pre class='bnf'><a class='nontermdef' href='#nt:requires-expression' id='nt:requires-expression'>requires-expression:</a>
&#9;<span class='texttt'><span class='keyword'>requires</span></span><span class='indexparent'><a class='index' id=':requires'></a></span> <a class='grammarterm' href='#nt:requirement-parameter-list'>requirement-parameter-list</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='#nt:requirement-body'>requirement-body</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:requirement-parameter-list' id='nt:requirement-parameter-list'>requirement-parameter-list:</a>
&#9;<span class='terminal'><span class='parenthesis'>(</span></span> <a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='parenthesis'>)</span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:requirement-body' id='nt:requirement-body'>requirement-body:</a>
&#9;<span class='terminal'><span class='curlybracket'>{</span></span> <a class='grammarterm' href='#nt:requirement-seq'>requirement-seq</a> <span class='terminal'><span class='curlybracket'>}</span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:requirement-seq' id='nt:requirement-seq'>requirement-seq:</a>
&#9;<a class='grammarterm' href='#nt:requirement'>requirement</a>
&#9;<a class='grammarterm' href='#nt:requirement-seq'>requirement-seq</a> <a class='grammarterm' href='#nt:requirement'>requirement</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:requirement' id='nt:requirement'>requirement:</a>
&#9;<a class='grammarterm' href='#nt:simple-requirement'>simple-requirement</a>
&#9;<a class='grammarterm' href='#nt:type-requirement'>type-requirement</a>
&#9;<a class='grammarterm' href='#nt:compound-requirement'>compound-requirement</a>
&#9;<a class='grammarterm' href='#nt:nested-requirement'>nested-requirement</a>
</pre></div><div class='para' id='req-2'><div class='marginalizedparent'><a class='marginalized' href='#req-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2510'>#</a></div><div id='req-2.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> is a prvalue of type <span class='texttt'><span class='keyword'>bool</span></span>
whose value is described below<a class='hidden_link' href='#req-2.sentence-1'>.</a></div> <div id='req-2.sentence-2' class='sentence'>Expressions appearing within a <a class='grammarterm' href='#nt:requirement-body'>requirement-body</a>
are <a href='expr.prop#def:unevaluated_operand'>unevaluated operands</a><a class='hidden_link' href='#req-2.sentence-2'>.</a></div></div><div class='para' id='req-3'><div class='marginalizedparent'><a class='marginalized' href='#req-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2516'>#</a></div><div id='req-3.example-1' class='example'>[&nbsp;<a class='example_link' href='#req-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='req-3.sentence-1' class='sentence'>A common use of <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a>s is to define
requirements in concepts such as the one below:
<pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>concept</span> R <span class='operator'>=</span> <span class='keyword'>requires</span> <span class='parenthesis'>(</span>T i<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>typename</span> T<span class='operator'>::</span>type;
    <span class='curlybracket'>{</span><span class='operator'>*</span>i<span class='curlybracket'>}</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> std<span class='operator'>::</span>convertible_to<span class='indexparent'><a class='index' id=':convertible_to'></a></span><span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>typename</span> T<span class='operator'>::</span>type<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span>;
  <span class='curlybracket'>}</span>;
</pre></div> <div id='req-3.sentence-2' class='sentence'>
A <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> can also be used in a
<a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a> as a way of writing ad hoc
constraints on template arguments such as the one below:
<pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>requires</span> <span class='keyword'>requires</span> <span class='parenthesis'>(</span>T x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> x <span class='operator'>+</span> x; <span class='curlybracket'>}</span>
    T add<span class='parenthesis'>(</span>T a, T b<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> a <span class='operator'>+</span> b; <span class='curlybracket'>}</span>
</pre></div> <div id='req-3.sentence-3' class='sentence'>
The first <span class='texttt'><span class='keyword'>requires</span></span> introduces the
<a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a>, and the second
introduces the <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a><a class='hidden_link' href='#req-3.sentence-3'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='req-4'><div class='marginalizedparent'><a class='marginalized' href='#req-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2540'>#</a></div><div id='req-4.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> may introduce local parameters using a
<a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a><a class='hidden_link' href='#req-4.sentence-1'>.</a></div> <div id='req-4.sentence-2' class='sentence'>A local parameter of a <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> shall not have a
default argument<a class='hidden_link' href='#req-4.sentence-2'>.</a></div> <div id='req-4.sentence-3' class='sentence'>Each name introduced by a local parameter is in scope from the point
of its declaration until the closing brace of the
<a class='grammarterm' href='#nt:requirement-body'>requirement-body</a><a class='hidden_link' href='#req-4.sentence-3'>.</a></div> <div id='req-4.sentence-4' class='sentence'>These parameters have no linkage, storage, or lifetime; they are only used
as notation for the purpose of defining <a class='grammarterm' href='#nt:requirement'>requirement</a>s<a class='hidden_link' href='#req-4.sentence-4'>.</a></div> <div id='req-4.sentence-5' class='sentence'>The <a class='grammarterm' href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a> of a
<a class='grammarterm' href='#nt:requirement-parameter-list'>requirement-parameter-list</a>
shall not terminate with an ellipsis<a class='hidden_link' href='#req-4.sentence-5'>.</a></div> <div id='req-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#req-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span>
<span class='keyword'>concept</span> C <span class='operator'>=</span> <span class='keyword'>requires</span><span class='parenthesis'>(</span>T t, <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>    <span class='comment'>// error: terminates with an ellipsis</span>
  t;
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='req-5'><div class='marginalizedparent'><a class='marginalized' href='#req-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2562'>#</a></div><div id='req-5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':requirement'></a></span>The <a class='grammarterm' href='#nt:requirement-body'>requirement-body</a> contains
a sequence of <a class='grammarterm' href='#nt:requirement'>requirement</a>s<a class='hidden_link' href='#req-5.sentence-1'>.</a></div> <div id='req-5.sentence-2' class='sentence'>These <a class='grammarterm' href='#nt:requirement'>requirement</a>s may refer to local
parameters, template parameters, and any other declarations visible from the
enclosing context<a class='hidden_link' href='#req-5.sentence-2'>.</a></div></div><div class='para' id='req-6'><div class='marginalizedparent'><a class='marginalized' href='#req-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2570'>#</a></div><div id='req-6.sentence-1' class='sentence'>The substitution of template arguments into a <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a>
may result in the formation of invalid types or expressions in its
<a class='grammarterm' href='#nt:requirement'>requirement</a>s or the violation of the semantic constraints of those <a class='grammarterm' href='#nt:requirement'>requirement</a>s<a class='hidden_link' href='#req-6.sentence-1'>.</a></div> <div id='req-6.sentence-2' class='sentence'>In such cases, the <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> evaluates to <span class='texttt'><span class='literal'>false</span></span>;
it does not cause the program to be ill-formed<a class='hidden_link' href='#req-6.sentence-2'>.</a></div> <div id='req-6.sentence-3' class='sentence'>The substitution and semantic constraint checking
proceeds in lexical order and stops when a condition that
determines the result of the <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> is encountered<a class='hidden_link' href='#req-6.sentence-3'>.</a></div> <div id='req-6.sentence-4' class='sentence'>If substitution (if any) and semantic constraint checking succeed,
the <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> evaluates to <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#req-6.sentence-4'>.</a></div> <div id='req-6.note-1' class='note'>[&nbsp;<a class='note_link' href='#req-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req-6.sentence-5' class='sentence'>If a <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> contains invalid types or expressions in
its <a class='grammarterm' href='#nt:requirement'>requirement</a>s, and it does not appear within the declaration of a templated
entity, then the program is ill-formed<a class='hidden_link' href='#req-6.sentence-5'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='req-6.sentence-6' class='sentence'>
If the substitution of template arguments into a <a class='grammarterm' href='#nt:requirement'>requirement</a>
would always result in a substitution failure, the program is ill-formed;
no diagnostic required<a class='hidden_link' href='#req-6.sentence-6'>.</a></div> <div id='req-6.example-1' class='example'>[&nbsp;<a class='example_link' href='#req-6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C <span class='operator'>=</span>
<span class='keyword'>requires</span> <span class='curlybracket'>{</span>
  <span class='keyword'>new</span> <span class='keyword'>int</span><span class='squarebracket'>[</span><span class='operator'>-</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span><span class='squarebracket'>]</span>;     <span class='comment'>// ill-formed, no diagnostic required</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div id='req.simple' class='section'><h4 ><a class='secnum' href='#req.simple' style='min-width:118pt'>7.5.7.1</a> Simple requirements <a class='abbr_ref' href='expr.prim.req.simple'>[expr.prim.req.simple]</a></h4><span class='indexparent'><a class='index' id=':requirement,simple'></a></span>
<pre class='bnf'><a class='nontermdef' href='#nt:simple-requirement' id='nt:simple-requirement'>simple-requirement:</a>
&#9;<a class='grammarterm' href='expr.comma#nt:expression'>expression</a> <span class='terminal'>;</span>
</pre><div class='para' id='req.simple-1'><div class='marginalizedparent'><a class='marginalized' href='#req.simple-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2606'>#</a></div><div id='req.simple-1.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:simple-requirement'>simple-requirement</a> asserts
the validity of an <a class='grammarterm' href='expr.comma#nt:expression'>expression</a><a class='hidden_link' href='#req.simple-1.sentence-1'>.</a></div> <div id='req.simple-1.note-1' class='note'>[&nbsp;<a class='note_link' href='#req.simple-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.simple-1.sentence-2' class='sentence'>The enclosing <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> will evaluate to <span class='texttt'><span class='literal'>false</span></span>
if substitution of template arguments into the <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> fails<a class='hidden_link' href='#req.simple-1.sentence-2'>.</a></div> <div id='req.simple-1.sentence-3' class='sentence'>The <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> is an <a href='expr.prop#def:unevaluated_operand'>unevaluated operand</a><a class='hidden_link' href='#req.simple-1.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='req.simple-1.example-1' class='example'>[&nbsp;<a class='example_link' href='#req.simple-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C <span class='operator'>=</span>
  <span class='keyword'>requires</span> <span class='parenthesis'>(</span>T a, T b<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    a <span class='operator'>+</span> b;          <span class='comment'>// <span class='tcode_in_codeblock'>C&lt;T&gt;</span> is <span class='tcode_in_codeblock'>true</span> if <span class='tcode_in_codeblock'>a + b</span> is a valid expression</span>
  <span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='req.simple-2'><div class='marginalizedparent'><a class='marginalized' href='#req.simple-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2623'>#</a></div><div id='req.simple-2.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:requirement'>requirement</a> that starts with a <span class='texttt'><span class='keyword'>requires</span></span><span class='indexparent'><a class='index' id=':requires_'></a></span> token
is never interpreted as a <a class='grammarterm' href='#nt:simple-requirement'>simple-requirement</a><a class='hidden_link' href='#req.simple-2.sentence-1'>.</a></div> <div id='req.simple-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#req.simple-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.simple-2.sentence-2' class='sentence'>This simplifies distinguishing between a <a class='grammarterm' href='#nt:simple-requirement'>simple-requirement</a>
and a <a class='grammarterm' href='#nt:nested-requirement'>nested-requirement</a><a class='hidden_link' href='#req.simple-2.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div></div><div id='req.type' class='section'><h4 ><a class='secnum' href='#req.type' style='min-width:118pt'>7.5.7.2</a> Type requirements <a class='abbr_ref' href='expr.prim.req.type'>[expr.prim.req.type]</a></h4><span class='indexparent'><a class='index' id=':requirement,type'></a></span>
<pre class='bnf'><a class='nontermdef' href='#nt:type-requirement' id='nt:type-requirement'>type-requirement:</a>
&#9;<span class='texttt'><span class='keyword'>typename</span></span><span class='indexparent'><a class='index' id=':typename'></a></span> <a class='grammarterm' href='#nt:nested-name-specifier'>nested-name-specifier</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='dcl.type.simple#nt:type-name'>type-name</a> <span class='terminal'>;</span>
</pre><div class='para' id='req.type-1'><div class='marginalizedparent'><a class='marginalized' href='#req.type-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2639'>#</a></div><div id='req.type-1.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:type-requirement'>type-requirement</a> asserts the validity of a type<a class='hidden_link' href='#req.type-1.sentence-1'>.</a></div> <div id='req.type-1.note-1' class='note'>[&nbsp;<a class='note_link' href='#req.type-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='req.type-1.sentence-2' class='sentence'>The enclosing <a class='grammarterm' href='#nt:requires-expression'>requires-expression</a> will evaluate to <span class='texttt'><span class='literal'>false</span></span>
if substitution of template arguments fails<a class='hidden_link' href='#req.type-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='req.type-1.example-1' class='example'>[&nbsp;<a class='example_link' href='#req.type-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T, <span class='keyword'>typename</span> T<span class='operator'>::</span>type <span class='operator'>=</span> <span class='literal'>0</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> S;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>using</span> Ref <span class='operator'>=</span> T<span class='operator'>&amp;</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C <span class='operator'>=</span> <span class='keyword'>requires</span> <span class='curlybracket'>{</span>
  <span class='keyword'>typename</span> T<span class='operator'>::</span>inner;    <span class='comment'>// required nested member name</span>
  <span class='keyword'>typename</span> S<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span>;        <span class='comment'>// required class template specialization</span>
  <span class='keyword'>typename</span> Ref<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span>;      <span class='comment'>// required alias template substitution, fails if <span class='tcode_in_codeblock'>T</span> is void</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='req.type-2'><div class='marginalizedparent'><a class='marginalized' href='#req.type-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2658'>#</a></div><div id='req.type-2.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:type-requirement'>type-requirement</a> that names a class template specialization
does not require that type to be complete (<a href='basic.types'>[basic.types]</a>)<a class='hidden_link' href='#req.type-2.sentence-1'>.</a></div></div></div><div id='req.compound' class='section'><h4 ><a class='secnum' href='#req.compound' style='min-width:118pt'>7.5.7.3</a> Compound requirements <a class='abbr_ref' href='expr.prim.req.compound'>[expr.prim.req.compound]</a></h4><span class='indexparent'><a class='index' id=':requirement,compound'></a></span>
<pre class='bnf'><a class='nontermdef' href='#nt:compound-requirement' id='nt:compound-requirement'>compound-requirement:</a>
&#9;<span class='terminal'><span class='curlybracket'>{</span></span> <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> <span class='terminal'><span class='curlybracket'>}</span></span> <span class='texttt'><span class='keyword'>noexcept</span></span><span class='indexparent'><a class='index' id=':noexcept'></a></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='#nt:return-type-requirement'>return-type-requirement</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>;</span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:return-type-requirement' id='nt:return-type-requirement'>return-type-requirement:</a>
&#9;<span class='terminal'><span class='operator'>-</span><span class='anglebracket'>&gt;</span></span> <a class='grammarterm' href='temp.param#nt:type-constraint'>type-constraint</a>
</pre><div class='para' id='req.compound-1'><div class='marginalizedparent'><a class='marginalized' href='#req.compound-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2675'>#</a></div><div id='req.compound-1.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:compound-requirement'>compound-requirement</a> asserts properties
of the <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> <span class='math'><span class='mathalpha'>E</span></span><a class='hidden_link' href='#req.compound-1.sentence-1'>.</a></div> <div id='req.compound-1.sentence-2' class='sentence'>Substitution
of template arguments (if any) and verification of
semantic properties proceed in the following order:</div><ul class='itemize'><li id='req.compound-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#req.compound-1.1'>(1.1)</a></div><div id='req.compound-1.1.sentence-1' class='sentence'>Substitution of template arguments (if any)
into the <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> is performed<a class='hidden_link' href='#req.compound-1.1.sentence-1'>.</a></div></li><li id='req.compound-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#req.compound-1.2'>(1.2)</a></div><div id='req.compound-1.2.sentence-1' class='sentence'>If the <span class='texttt'><span class='keyword'>noexcept</span></span> specifier is present,
<span class='math'><span class='mathalpha'>E</span></span> shall not be a potentially-throwing expression (<a href='except.spec'>[except.spec]</a>)<a class='hidden_link' href='#req.compound-1.2.sentence-1'>.</a></div></li><li id='req.compound-1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#req.compound-1.3'>(1.3)</a></div><div id='req.compound-1.3.sentence-1' class='sentence'>If the <a class='grammarterm' href='#nt:return-type-requirement'>return-type-requirement</a> is present, then:</div><ul class='itemize'><li id='req.compound-1.3.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#req.compound-1.3.1'>(1.3.1)</a></div><div id='req.compound-1.3.1.sentence-1' class='sentence'>Substitution of template arguments (if any)
into the <a class='grammarterm' href='#nt:return-type-requirement'>return-type-requirement</a> is performed<a class='hidden_link' href='#req.compound-1.3.1.sentence-1'>.</a></div></li><li id='req.compound-1.3.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#req.compound-1.3.2'>(1.3.2)</a></div><div id='req.compound-1.3.2.sentence-1' class='sentence'>The immediately-declared constraint (<a href='temp.param'>[temp.param]</a>)
of the <a class='grammarterm' href='temp.param#nt:type-constraint'>type-constraint</a> for <span class='texttt'><span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span>E<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span>
shall be satisfied<a class='hidden_link' href='#req.compound-1.3.2.sentence-1'>.</a></div> <div id='req.compound-1.3.2.example-1' class='example'>[&nbsp;<a class='example_link' href='#req.compound-1.3.2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='req.compound-1.3.2.sentence-2' class='sentence'>Given concepts <span class='texttt'>C</span> and <span class='texttt'>D</span>,
<pre class='codeblock'>
<span class='keyword'>requires</span> <span class='curlybracket'>{</span>
  <span class='curlybracket'>{</span> E1 <span class='curlybracket'>}</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> C;
  <span class='curlybracket'>{</span> E2 <span class='curlybracket'>}</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> D<span class='anglebracket'>&lt;</span>A<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, <span class='math'>⋯</span>, A<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>;
</pre>
is equivalent to
<pre class='codeblock'>
<span class='keyword'>requires</span> <span class='curlybracket'>{</span>
  E1; <span class='keyword'>requires</span> C<span class='anglebracket'>&lt;</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span>E1<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;
  E2; <span class='keyword'>requires</span> D<span class='anglebracket'>&lt;</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span>E2<span class='parenthesis'>)</span><span class='parenthesis'>)</span>, A<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, <span class='math'>⋯</span>, A<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>;
</pre>
(including in the case where <span class='math'><span class='mathalpha'>n</span></span> is zero)<a class='hidden_link' href='#req.compound-1.3.2.sentence-2'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </li></ul></li></ul></div><div class='para' id='req.compound-2'><div class='marginalizedparent'><a class='marginalized' href='#req.compound-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2722'>#</a></div><div id='req.compound-2.example-1' class='example'>[&nbsp;<a class='example_link' href='#req.compound-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C1 <span class='operator'>=</span> <span class='keyword'>requires</span><span class='parenthesis'>(</span>T x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='curlybracket'>{</span>x<span class='operator'>+</span><span class='operator'>+</span><span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;
</pre> <div id='req.compound-2.sentence-1' class='sentence'>
The <a class='grammarterm' href='#nt:compound-requirement'>compound-requirement</a> in <span class='texttt'>C1</span>
requires that <span class='texttt'>x<span class='operator'>+</span><span class='operator'>+</span></span> is a valid expression<a class='hidden_link' href='#req.compound-2.sentence-1'>.</a></div> <div id='req.compound-2.sentence-2' class='sentence'>It is equivalent to the <a class='grammarterm' href='#nt:simple-requirement'>simple-requirement</a>
<span class='texttt'>x<span class='operator'>+</span><span class='operator'>+</span>;</span><a class='hidden_link' href='#req.compound-2.sentence-2'>.</a></div><pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C2 <span class='operator'>=</span> <span class='keyword'>requires</span><span class='parenthesis'>(</span>T x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='curlybracket'>{</span><span class='operator'>*</span>x<span class='curlybracket'>}</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> std<span class='operator'>::</span>same_as<span class='indexparent'><a class='index' id=':same_as'></a></span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='operator'>::</span>inner<span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>;
</pre><div id='req.compound-2.sentence-3' class='sentence'>The <a class='grammarterm' href='#nt:compound-requirement'>compound-requirement</a> in <span class='texttt'>C2</span>
requires that <span class='texttt'><span class='operator'>*</span>x</span> is a valid expression,
that <span class='texttt'><span class='keyword'>typename</span> T<span class='operator'>&#x200b;::&#x200b;</span>inner</span> is a valid type, and
that <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span><span class='texttt'>same_&shy;as</span><span class='indexparent'><a class='index' id=':same_as_'></a></span><span class='anglebracket'>&lt;</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span><span class='operator'>*</span>x<span class='parenthesis'>)</span><span class='parenthesis'>)</span>, <span class='keyword'>typename</span> T<span class='operator'>&#x200b;::&#x200b;</span>inner<span class='anglebracket'>&gt;</span></span> is satisfied<a class='hidden_link' href='#req.compound-2.sentence-3'>.</a></div><pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C3 <span class='operator'>=</span>
  <span class='keyword'>requires</span><span class='parenthesis'>(</span>T x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='curlybracket'>{</span>g<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span><span class='curlybracket'>}</span> <span class='keyword'>noexcept</span>;
  <span class='curlybracket'>}</span>;
</pre><div id='req.compound-2.sentence-4' class='sentence'>The <a class='grammarterm' href='#nt:compound-requirement'>compound-requirement</a> in <span class='texttt'>C3</span>
requires that <span class='texttt'>g<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span></span> is a valid expression and
that <span class='texttt'>g<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span></span> is non-throwing<a class='hidden_link' href='#req.compound-2.sentence-4'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div><div id='req.nested' class='section'><h4 ><a class='secnum' href='#req.nested' style='min-width:118pt'>7.5.7.4</a> Nested requirements <a class='abbr_ref' href='expr.prim.req.nested'>[expr.prim.req.nested]</a></h4><span class='indexparent'><a class='index' id=':requirement,nested'></a></span>
<pre class='bnf'><a class='nontermdef' href='#nt:nested-requirement' id='nt:nested-requirement'>nested-requirement:</a>
&#9;<span class='texttt'><span class='keyword'>requires</span></span><span class='indexparent'><a class='index' id=':requires__'></a></span> <a class='grammarterm' href='temp.constr.decl#nt:constraint-expression'>constraint-expression</a> <span class='terminal'>;</span>
</pre><div class='para' id='req.nested-1'><div class='marginalizedparent'><a class='marginalized' href='#req.nested-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2765'>#</a></div><div id='req.nested-1.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:nested-requirement'>nested-requirement</a> can be used
to specify additional constraints in terms of local parameters<a class='hidden_link' href='#req.nested-1.sentence-1'>.</a></div> <div id='req.nested-1.sentence-2' class='sentence'>The <a class='grammarterm' href='temp.constr.decl#nt:constraint-expression'>constraint-expression</a>
shall be satisfied (<a href='temp.constr.decl'>[temp.constr.decl]</a>)
by the substituted template arguments, if any<a class='hidden_link' href='#req.nested-1.sentence-2'>.</a></div> <div id='req.nested-1.sentence-3' class='sentence'>Substitution of template arguments into a <a class='grammarterm' href='#nt:nested-requirement'>nested-requirement</a>
does not result in substitution into the <a class='grammarterm' href='temp.constr.decl#nt:constraint-expression'>constraint-expression</a>
other than as specified in <a href='temp.constr.constr'>[temp.constr.constr]</a><a class='hidden_link' href='#req.nested-1.sentence-3'>.</a></div> <div id='req.nested-1.example-1' class='example'>[&nbsp;<a class='example_link' href='#req.nested-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='req.nested-1.sentence-4' class='sentence'><pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> U<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C <span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>U<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>1</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> D <span class='operator'>=</span> <span class='keyword'>requires</span> <span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>requires</span> C<span class='anglebracket'>&lt;</span><span class='keyword'>decltype</span> <span class='parenthesis'>(</span><span class='operator'>+</span>t<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>;
</pre>
<span class='texttt'>D<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span></span> is satisfied if <span class='texttt'><span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='keyword'>decltype</span> <span class='parenthesis'>(</span><span class='operator'>+</span>t<span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>1</span></span> (<a href='temp.constr.atomic'>[temp.constr.atomic]</a>)<a class='hidden_link' href='#req.nested-1.sentence-4'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='req.nested-2'><div class='marginalizedparent'><a class='marginalized' href='#req.nested-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b6d9e27e75b10cfb0a5f0a99343cce3697042c21/source/expressions.tex#L2785'>#</a></div><div id='req.nested-2.sentence-1' class='sentence'>A local parameter shall only appear as an <a href='expr.prop#def:unevaluated_operand'>unevaluated operand</a>
within the <a class='grammarterm' href='temp.constr.decl#nt:constraint-expression'>constraint-expression</a><a class='hidden_link' href='#req.nested-2.sentence-1'>.</a></div> <div id='req.nested-2.example-1' class='example'>[&nbsp;<a class='example_link' href='#req.nested-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C <span class='operator'>=</span> <span class='keyword'>requires</span> <span class='parenthesis'>(</span>T a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>requires</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>4</span>;      <span class='comment'>// OK</span>
  <span class='keyword'>requires</span> a <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span>;              <span class='comment'>// error: evaluation of a constraint variable</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  
</div></div></div></div></body></html>