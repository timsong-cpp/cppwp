<!DOCTYPE html><html lang='en'><head><title>[lex.phases]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>5</a> Lexical conventions <a class='abbr_ref' href='./#lex'>[lex]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>5.2</a> Phases of translation <a class='abbr_ref'>[lex.phases]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/b2264247505861345c6d297d673209b06c67737f/source/lex.tex#L56'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'><a class='index' id=':translation,phases'></a>The precedence among the syntax rules of translation is specified by the
following phases<a class='hidden_link' href='#1.sentence-1'>.</a><a class='footnoteref' href='#footnote-9' id='footnoteref-9' title='Implementations behave as if these separate phases occur, although in practice different phases can be folded together.'>9</a></div></div><div class='texpara'><table class='enumerate'><tr id='1.1'><td ><a class='enumerated_item_num' href='#1.1'>1.</a></td><td ><div class='texpara'><div id='1.1.sentence-1' class='sentence'><a class='index' id=':character,source_file'></a><a class='index' id=':character_set,basic_source'></a>Physical source file characters are mapped, in an
<a class='index' id=':mapping_physical_source_file_characters_to_translation_character_set'></a>implementation-defined manner,
to the translation character set (<a href='lex.charset' title='5.3&emsp;Character sets'>[lex.<span class='shy'></span>charset]</a>)
(introducing new-line characters for end-of-line indicators)<a class='hidden_link' href='#1.1.sentence-1'>.</a></div> <div id='1.1.sentence-2' class='sentence'>The set of physical source file characters accepted is <a class='index' id=':physical_source_file_characters'></a>implementation-defined<a class='hidden_link' href='#1.1.sentence-2'>.</a></div></div></td></tr><tr id='1.2'><td ><a class='enumerated_item_num' href='#1.2'>2.</a></td><td ><div class='texpara'><div id='1.2.sentence-1' class='sentence'><a class='index' id=':line_splicing'></a>Each sequence of a backslash character (\)
immediately followed by
zero or more whitespace characters other than new-line followed by
a new-line character is deleted, splicing
physical source lines to form logical source lines<a class='hidden_link' href='#1.2.sentence-1'>.</a></div> <div id='1.2.sentence-2' class='sentence'>Only the last
backslash on any physical source line shall be eligible for being part
of such a splice<a class='hidden_link' href='#1.2.sentence-2'>.</a></div> <div id='1.2.sentence-3' class='sentence'>Except for splices reverted in a raw string literal, if a splice results in
a character sequence that matches the
syntax of a <a href='lex.charset#nt:universal-character-name' title='5.3&emsp;Character sets&emsp;[lex.charset]'><span id='ntref:universal-character-name'><span class='textsf'><i >universal-character-name</i></span></span></a>, the behavior is
undefined<a class='hidden_link' href='#1.2.sentence-3'>.</a></div> <div id='1.2.sentence-4' class='sentence'>A source file that is not empty and that does not end in a new-line
character, or that ends in a splice,
shall be processed as if an additional new-line character were appended
to the file<a class='hidden_link' href='#1.2.sentence-4'>.</a></div></div></td></tr><tr id='1.3'><td ><a class='enumerated_item_num' href='#1.3'>3.</a></td><td ><div class='texpara'><div id='1.3.sentence-1' class='sentence'>The source file is decomposed into preprocessing
tokens (<a href='lex.pptoken' title='5.4&emsp;Preprocessing tokens'>[lex.<span class='shy'></span>pptoken]</a>) and sequences of whitespace characters
(including comments)<a class='hidden_link' href='#1.3.sentence-1'>.</a></div> <div id='1.3.sentence-2' class='sentence'>A source file shall not end in a partial
preprocessing token or in a partial comment<a class='hidden_link' href='#1.3.sentence-2'>.</a><a class='footnoteref' href='#footnote-10' id='footnoteref-10' title='A partial preprocessing token would arise from a source file ending in the first portion of a multi-character token that requires a terminating sequence of characters, such as a header-name that is missing the closing " or &gt;. A partial comment would arise from a source file ending with an unclosed /* comment.'>10</a></div> <div id='1.3.sentence-3' class='sentence'>
Each comment is replaced by one space character<a class='hidden_link' href='#1.3.sentence-3'>.</a></div> <div id='1.3.sentence-4' class='sentence'>New-line characters are
retained<a class='hidden_link' href='#1.3.sentence-4'>.</a></div> <div id='1.3.sentence-5' class='sentence'>Whether each nonempty sequence of whitespace characters other
than new-line is retained or replaced by one space character is
unspecified<a class='hidden_link' href='#1.3.sentence-5'>.</a></div> <div id='1.3.sentence-6' class='sentence'>As characters from the source file are consumed
to form the next preprocessing token
(i.e., not being consumed as part of a comment or other forms of whitespace),
except when matching a
<a href='lex.ccon#nt:c-char-sequence' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:c-char-sequence'><span class='textsf'><i >c-char-sequence</i></span></span></a>,
<a href='lex.string#nt:s-char-sequence' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:s-char-sequence'><span class='textsf'><i >s-char-sequence</i></span></span></a>,
<a href='lex.string#nt:r-char-sequence' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:r-char-sequence'><span class='textsf'><i >r-char-sequence</i></span></span></a>,
<a href='lex.header#nt:h-char-sequence' title='5.8&emsp;Header names&emsp;[lex.header]'><span id='ntref:h-char-sequence'><span class='textsf'><i >h-char-sequence</i></span></span></a>, or
<a href='lex.header#nt:q-char-sequence' title='5.8&emsp;Header names&emsp;[lex.header]'><span id='ntref:q-char-sequence'><span class='textsf'><i >q-char-sequence</i></span></span></a>,
<a href='lex.charset#nt:universal-character-name' title='5.3&emsp;Character sets&emsp;[lex.charset]'><span id='ntref:universal-character-name_'><span class='textsf'><i >universal-character-name</i></span></span></a><i >s</i> are recognized and
replaced by the designated element of the translation character set<a class='hidden_link' href='#1.3.sentence-6'>.</a></div> <div id='1.3.sentence-7' class='sentence'>The process of dividing a source file's
characters into preprocessing tokens is context-dependent<a class='hidden_link' href='#1.3.sentence-7'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>: <div id='1.3.sentence-8' class='sentence'>See the handling of <span class='texttt'><span class='anglebracket'>&lt;</span></span> within a <span class='texttt'><span class='preprocessordirective'>#include</span></span> preprocessing
directive<a class='hidden_link' href='#1.3.sentence-8'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></td></tr><tr id='1.4'><td ><a class='enumerated_item_num' href='#1.4'>4.</a></td><td ><div class='texpara'><div id='1.4.sentence-1' class='sentence'>Preprocessing directives are executed, macro invocations are
expanded, and <span class='texttt'><span class='preprocessordirective'>_&shy;Pragma</span></span> unary operator expressions are executed<a class='hidden_link' href='#1.4.sentence-1'>.</a></div> <div id='1.4.sentence-2' class='sentence'>A <span class='texttt'><span class='preprocessordirective'>#include</span></span> preprocessing directive causes the named header or
source file to be processed from phase 1 through phase 4, recursively<a class='hidden_link' href='#1.4.sentence-2'>.</a></div> <div id='1.4.sentence-3' class='sentence'>All preprocessing directives are then deleted<a class='hidden_link' href='#1.4.sentence-3'>.</a></div></div></td></tr><tr id='1.5'><td ><a class='enumerated_item_num' href='#1.5'>5.</a></td><td ><div class='texpara'><div id='1.5.sentence-1' class='sentence'>For a sequence of two or more adjacent <a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal'><span class='textsf'><i >string-literal</i></span></span></a> tokens,
a common <a href='lex.ccon#nt:encoding-prefix' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:encoding-prefix'><span class='textsf'><i >encoding-prefix</i></span></span></a> is determined
as specified in <a href='lex.string' title='5.13.5&emsp;String literals'>[lex.<span class='shy'></span>string]</a><a class='hidden_link' href='#1.5.sentence-1'>.</a></div> <div id='1.5.sentence-2' class='sentence'>Each such <a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal_'><span class='textsf'><i >string-literal</i></span></span></a> token is then considered to have
that common <a href='lex.ccon#nt:encoding-prefix' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:encoding-prefix_'><span class='textsf'><i >encoding-prefix</i></span></span></a><a class='hidden_link' href='#1.5.sentence-2'>.</a></div></div></td></tr><tr id='1.6'><td ><a class='enumerated_item_num' href='#1.6'>6.</a></td><td ><div class='texpara'><div id='1.6.sentence-1' class='sentence'>Adjacent <a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal__'><span class='textsf'><i >string-literal</i></span></span></a> tokens are concatenated (<a href='lex.string' title='5.13.5&emsp;String literals'>[lex.<span class='shy'></span>string]</a>)<a class='hidden_link' href='#1.6.sentence-1'>.</a></div></div></td></tr><tr id='1.7'><td ><a class='enumerated_item_num' href='#1.7'>7.</a></td><td ><div class='texpara'><div id='1.7.sentence-1' class='sentence'>Whitespace characters separating tokens are no longer
significant<a class='hidden_link' href='#1.7.sentence-1'>.</a></div> <div id='1.7.sentence-2' class='sentence'>Each preprocessing token is converted into a
token (<a href='lex.token' title='5.6&emsp;Tokens'>[lex.<span class='shy'></span>token]</a>)<a class='hidden_link' href='#1.7.sentence-2'>.</a></div> <div id='1.7.sentence-3' class='sentence'>The resulting tokens are syntactically and
semantically analyzed and translated as a translation unit<a class='hidden_link' href='#1.7.sentence-3'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>: <div id='1.7.sentence-4' class='sentence'>The process of analyzing and translating the tokens can occasionally
result in one token being replaced by a sequence of other
tokens (<a href='temp.names' title='13.3&emsp;Names of template specializations'>[temp.<span class='shy'></span>names]</a>)<a class='hidden_link' href='#1.7.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='1.7.sentence-5' class='sentence'>
It is
<a class='index' id=':whether_the_sources_for_module_units_and_header_units_on_which_the_current_translation_unit_has_an_interface_dependency_are_required_to_be_available_during_translation'></a>implementation-defined
whether the sources for
module units and header units
on which the current translation unit has an interface
dependency (<a href='module.unit' title='10.1&emsp;Module units and purviews'>[module.<span class='shy'></span>unit]</a>, <a href='module.import' title='10.3&emsp;Import declaration'>[module.<span class='shy'></span>import]</a>)
are required to be available<a class='hidden_link' href='#1.7.sentence-5'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>: <div id='1.7.sentence-6' class='sentence'>Source files, translation
units and translated translation units need not necessarily be stored as
files, nor need there be any one-to-one correspondence between these
entities and any external representation<a class='hidden_link' href='#1.7.sentence-6'>.</a></div> <div id='1.7.sentence-7' class='sentence'>The description is conceptual
only, and does not specify any particular implementation<a class='hidden_link' href='#1.7.sentence-7'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></td></tr><tr id='1.8'><td ><a class='enumerated_item_num' href='#1.8'>8.</a></td><td ><div class='texpara'><div id='1.8.sentence-2' class='sentence'>Translated translation units and instantiation units are combined
as follows:
<div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>: <div id='1.8.sentence-1' class='sentence'>Some or all of these can be supplied from a
library<a class='hidden_link' href='#1.8.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div>
Each translated translation unit is examined to
produce a list of required instantiations<a class='hidden_link' href='#1.8.sentence-2'>.</a></div> <div id='note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-4'>4</a></i>: <div id='1.8.sentence-3' class='sentence'>This can include
instantiations which have been explicitly
requested (<a href='temp.explicit' title='13.9.3&emsp;Explicit instantiation'>[temp.<span class='shy'></span>explicit]</a>)<a class='hidden_link' href='#1.8.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='1.8.sentence-4' class='sentence'>
The definitions of the
required templates are located<a class='hidden_link' href='#1.8.sentence-4'>.</a></div> <div id='1.8.sentence-5' class='sentence'>It is <a class='index' id=':whether_source_of_translation_units_must_be_available_to_locate_template_definitions'></a>implementation-defined whether the
source of the translation units containing these definitions is required
to be available<a class='hidden_link' href='#1.8.sentence-5'>.</a></div> <div id='note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-5'>5</a></i>: <div id='1.8.sentence-6' class='sentence'>An implementation can choose to encode sufficient
information into the translated translation unit so as to ensure the
source is not required here<a class='hidden_link' href='#1.8.sentence-6'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='1.8.sentence-7' class='sentence'>
All the required instantiations
are performed to produce
<a class='hidden_link' href='#def:instantiation_units' title='5.2&emsp;Phases of translation&emsp;[lex.phases]'><span id='def:instantiation_units'><i >instantiation units</i></span></a><a class='hidden_link' href='#1.8.sentence-7'>.</a></div> <div id='note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-6'>6</a></i>: <div id='1.8.sentence-8' class='sentence'>These are similar
to translated translation units, but contain no references to
uninstantiated templates and no template definitions<a class='hidden_link' href='#1.8.sentence-8'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='1.8.sentence-9' class='sentence'>
The
program is ill-formed if any instantiation fails<a class='hidden_link' href='#1.8.sentence-9'>.</a></div></div></td></tr><tr id='1.9'><td ><a class='enumerated_item_num' href='#1.9'>9.</a></td><td ><div class='texpara'><div id='1.9.sentence-1' class='sentence'>All external entity references are resolved<a class='hidden_link' href='#1.9.sentence-1'>.</a></div> <div id='1.9.sentence-2' class='sentence'>Library
components are linked to satisfy external references to
entities not defined in the current translation<a class='hidden_link' href='#1.9.sentence-2'>.</a></div> <div id='1.9.sentence-3' class='sentence'>All such translator
output is collected into a program image which contains information
needed for execution in its execution environment<a class='hidden_link' href='#1.9.sentence-3'>.</a></div> </div></td></tr></table></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-9'><div class='texpara'><a class='footnotenum' href='#footnote-9'>9)</a><a class='footnoteBacklink' href='#footnoteref-9'>9)</a> <div id='footnote-9.sentence-1' class='sentence'>Implementations behave as if these separate phases
occur, although in practice different phases can be folded together<a class='hidden_link' href='#footnote-9.sentence-1'>.</a></div></div></div><div class='footnote' id='footnote-10'><div class='texpara'><a class='footnotenum' href='#footnote-10'>10)</a><a class='footnoteBacklink' href='#footnoteref-10'>10)</a> <div id='footnote-10.sentence-1' class='sentence'>A partial preprocessing
token would arise from a source file
ending in the first portion of a multi-character token that requires a
terminating sequence of characters, such as a <a href='lex.header#nt:header-name' title='5.8&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name'><span class='textsf'><i >header-name</i></span></span></a>
that is missing the closing <span class='texttt'>"</span>
or <span class='texttt'><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#footnote-10.sentence-1'>.</a></div> <div id='footnote-10.sentence-2' class='sentence'>A partial comment
would arise from a source file ending with an unclosed <span class='texttt'><span class='comment'>/*</span></span>
comment<a class='hidden_link' href='#footnote-10.sentence-2'>.</a></div></div></div></div></body></html>