<!DOCTYPE html><html lang='en'><head><title>[module.private.frag]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>10</a> Modules <a class='abbr_ref' href='./#module'>[module]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>10.5</a> Private module fragment <a class='abbr_ref'>[module.private.frag]</a></h2><div class='texpara'><div class='bnf' id='nt:private-module-fragment'>
<a class='hidden_link' href='#nt:private-module-fragment' title='10.5&emsp;Private module fragment&emsp;[module.private.frag]'><span id='nt:private-module-fragment'><span id=':private-module-fragment'>private-module-fragment<span class='textnormal'>:</span></span></span></a><br/>module-keyword <span class='terminal'><span class='operator'>:</span></span> <span id=':private'><span class='texttt'><span class='keyword'>private</span></span></span> <span class='terminal'>;</span> <a href='dcl.pre#nt:declaration-seq' title='9.1&emsp;Preamble&emsp;[dcl.pre]'><span id='ntref:declaration-seq'><span class='textsf'><i >declaration-seq</i></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</div></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f52ffc9054913f3f9a4c5dc6973f6c5c3e7f1096/source/modules.tex#L793'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>A <a href='#nt:private-module-fragment' title='10.5&emsp;Private module fragment&emsp;[module.private.frag]'><span id='ntref:private-module-fragment'><span class='textsf'><i >private-module-fragment</i></span></span></a> shall appear only
in a primary module interface unit (<a href='module.unit' title='10.1&emsp;Module units and purviews'>[module.<span class='shy'></span>unit]</a>)<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>A module unit with a <a href='#nt:private-module-fragment' title='10.5&emsp;Private module fragment&emsp;[module.private.frag]'><span id='ntref:private-module-fragment_'><span class='textsf'><i >private-module-fragment</i></span></span></a>
shall be the only module unit of its module;
no diagnostic is required<a class='hidden_link' href='#1.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f52ffc9054913f3f9a4c5dc6973f6c5c3e7f1096/source/modules.tex#L800'>#</a></div><div class='texpara'><div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='2.sentence-1' class='sentence'>A <a href='#nt:private-module-fragment' title='10.5&emsp;Private module fragment&emsp;[module.private.frag]'><span id='ntref:private-module-fragment__'><span class='textsf'><i >private-module-fragment</i></span></span></a> ends
the portion of the module interface unit
that can affect the behavior of other translation units<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>A <a href='#nt:private-module-fragment' title='10.5&emsp;Private module fragment&emsp;[module.private.frag]'><span id='ntref:private-module-fragment___'><span class='textsf'><i >private-module-fragment</i></span></span></a> allows a module
to be represented as a single translation unit
without making all of the contents of the module reachable to importers<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>The presence of a <a href='#nt:private-module-fragment' title='10.5&emsp;Private module fragment&emsp;[module.private.frag]'><span id='ntref:private-module-fragment____'><span class='textsf'><i >private-module-fragment</i></span></span></a> affects:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.1'>(2.1)</a></div>the point by which the definition of
an inline function or variable
is required (<a href='dcl.inline' title='9.2.8&emsp;The inline specifier'>[dcl.<span class='shy'></span>inline]</a>),</li><li id='2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.2'>(2.2)</a></div>the point by which the definition of
an exported function with a placeholder return type
is required (<a href='dcl.spec.auto' title='9.2.9.6&emsp;Placeholder type specifiers'>[dcl.<span class='shy'></span>spec.<span class='shy'></span>auto]</a>),</li><li id='2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.3'>(2.3)</a></div>whether a declaration is required not to be an exposure (<a href='basic.link' title='6.6&emsp;Program and linkage'>[basic.<span class='shy'></span>link]</a>),</li><li id='2.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.4'>(2.4)</a></div>where definitions for inline functions and templates
must appear (<a href='basic.def.odr' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>, <a href='dcl.inline' title='9.2.8&emsp;The inline specifier'>[dcl.<span class='shy'></span>inline]</a>, <a href='temp.pre' title='13.1&emsp;Preamble'>[temp.<span class='shy'></span>pre]</a>),</li><li id='2.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.5'>(2.5)</a></div>the instantiation contexts of templates
instantiated before it (<a href='module.context' title='10.6&emsp;Instantiation context'>[module.<span class='shy'></span>context]</a>), and</li><li id='2.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#2.6'>(2.6)</a></div>the reachability of declarations within it (<a href='module.reach' title='10.7&emsp;Reachability'>[module.<span class='shy'></span>reach]</a>)<a class='hidden_link' href='#2.sentence-3'>.</a></li></ul></div> â€”&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/f52ffc9054913f3f9a4c5dc6973f6c5c3e7f1096/source/modules.tex#L836'>#</a></div><div class='texpara'><div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>export</span> <span class='keyword'>module</span> A;
<span class='keyword'>export</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> fn_e<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;      <span class='comment'>// error: exported inline function <span class='tcode_in_codeblock'>fn_<span class='shy'></span>e</span> not defined</span>
                                <span class='comment'>// before private module fragment</span>
<span class='keyword'>inline</span> <span class='keyword'>void</span> fn_m<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;             <span class='comment'>// error: non-exported inline function <span class='tcode_in_codeblock'>fn_<span class='shy'></span>m</span> not defined</span>
<span class='keyword'>static</span> <span class='keyword'>void</span> fn_s<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>export</span> <span class='keyword'>struct</span> X;
<span class='keyword'>export</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span>X <span class='operator'>*</span>x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  fn_s<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                       <span class='comment'>// OK, call to static function in same translation unit</span>
<span class='curlybracket'>}</span>
<span class='keyword'>export</span> X <span class='operator'>*</span>factory<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;            <span class='comment'>// OK</span>

<span class='keyword'>module</span> <span class='operator'>:</span><span class='keyword'>private</span>;
<span class='keyword'>struct</span> X <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;                    <span class='comment'>// definition not reachable from importers of <span class='tcode_in_codeblock'>A</span></span>
X <span class='operator'>*</span>factory<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='keyword'>new</span> X <span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>void</span> fn_e<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
<span class='keyword'>void</span> fn_m<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
<span class='keyword'>void</span> fn_s<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>
</span> â€”&nbsp;<i>end example</i>]</div></div></div></div></div></body></html>