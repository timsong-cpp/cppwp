<!DOCTYPE html><html lang='en'><head><title>[dcl.link]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>7</a> Declarations <a class='abbr_ref' href='./#dcl.dcl'>[dcl.dcl]</a></h1><div id='dcl.link'><h2 ><a class='secnum' style='min-width:88pt'>7.5</a> Linkage specifications <a class='abbr_ref'>[dcl.link]</a></h2><p ><span class='indexparent'><a class='index' id='specification,linkage'></a></span></p><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3353'>#</a></div><p >All function types, function names with external linkage, and variable
names with external linkage have a <a class='hidden_link' href='#def:language_linkage' id='def:language_linkage'><i>language linkage</i></a>.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
Some of the properties associated with an entity with language linkage
are specific to each implementation and are not described here. For
example, a particular language linkage may be associated with a
particular form of representing names of objects and functions with
external linkage, or with a particular calling convention, etc.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]
The default language linkage of all function types, function names, and
variable names is C++ language linkage. Two function types with
different language linkages are distinct types even if they are
otherwise identical.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3368'>#</a></div><p >Linkage (<a href='basic.link'>[basic.link]</a>) between C++ and  non-C++ code fragments can
be achieved using a <i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>:</p><p ><span class='indexparent'><a class='index' id='linkage-specification'></a></span><span class='indexparent'><a class='index' id='specification,linkage,extern'></a></span></p><pre class='bnf'><a class='nontermdef' id='nt:linkage-specification'>linkage-specification:</a>
&#9;<span class='terminal'>extern</span> <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> <span class='terminal'>{</span> <i ><a href='dcl.dcl#nt:declaration-seq'>declaration-seq</a></i><span id="MathJax-Element-1-Frame" class="mjx-chtml"><span id="MJXc-Node-1" class="mjx-math"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4" class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5" class="mjx-texatom" style=""><span id="MJXc-Node-6" class="mjx-mrow"><span id="MJXc-Node-7" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span id="MJXc-Node-8" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span id="MJXc-Node-9" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>}</span>
&#9;<span class='terminal'>extern</span> <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> <i ><a href='dcl.dcl#nt:declaration'>declaration</a></i>
</pre><p >The <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> indicates the required language linkage.
This International Standard specifies the semantics for the
<i ><a href='lex.string#nt:string-literal'>string-literals</a></i> <span class='texttt'>"C"</span> and <span class='texttt'>"C++"</span>. Use of a
<i ><a href='lex.string#nt:string-literal'>string-literal</a></i> other than <span class='texttt'>"C"</span> or <span class='texttt'>"C++"</span> is
conditionally-supported, with <span class='indexparent'><a class='index' id='semantics_of_linkage_specifiers'></a></span>implementation-defined semantics.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
Therefore, a linkage-specification with a <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> that
is unknown to the implementation requires a diagnostic.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
It is recommended that the spelling of the <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> be
taken from the document defining that language. For example, <span class='texttt'>Ada</span>
(not <span class='texttt'>ADA</span>) and <span class='texttt'>Fortran</span> or <span class='texttt'>FORTRAN</span>, depending on
the vintage.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3397'>#</a></div><p ><span class='indexparent'><a class='index' id='specification,linkage,implementation-defined'></a></span>Every implementation shall provide for linkage to functions written in
the C programming language,
<span class='indexparent'><a class='index' id='C,linkage_to'></a></span><span class='texttt'>"C"</span>, and linkage to C++ functions, <span class='texttt'>"C++"</span>.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span>
</p><pre class='codeblock'>
complex sqrt(complex);          <span class='comment'>// C++ linkage by default
</span>extern "C" {
  double sqrt(double);          <span class='comment'>// C linkage
</span>}</pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3412'>#</a></div><p ><span class='indexparent'><a class='index' id='specification,linkage,nesting'></a></span>Linkage specifications nest. When linkage specifications nest, the
innermost one determines the language linkage. A linkage specification
does not establish a scope. A <i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i> shall
occur only in namespace scope (<a href='basic.scope'>[basic.scope]</a>). In a
<i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>, the specified language linkage applies
to the function types of all function declarators, function names with
external linkage, and variable names with external linkage declared
within the <i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span>
</p><pre class='codeblock'>
extern "C"                      <span class='comment'>// the name <span class='tcode_in_codeblock'>f1</span> and its function type have C language linkage;
</span>  void f1(void(*pf)(int));      <span class='comment'>// <span class='tcode_in_codeblock'>pf</span> is a pointer to a C function
</span>
extern "C" typedef void FUNC();
FUNC f2;                        <span class='comment'>// the name <span class='tcode_in_codeblock'>f2</span> has C++ language linkage and the
</span>                                <span class='comment'>// function's type has C language linkage
</span>
extern "C" FUNC f3;             <span class='comment'>// the name of function <span class='tcode_in_codeblock'>f3</span> and the function's type have C language linkage
</span>
void (*pf2)(FUNC*);             <span class='comment'>// the name of the variable <span class='tcode_in_codeblock'>pf2</span> has C++ linkage and the type
</span>                                <span class='comment'>// of <span class='tcode_in_codeblock'>pf2</span> is “pointer to C++ function that takes one parameter of type
</span>                                <span class='comment'>// pointer to C function”
</span>extern "C" {
  static void f4();             <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>f4</span> has internal linkage (not C language linkage)
</span>                                <span class='comment'>// and the function's type has C language linkage.
</span>}

extern "C" void f5() {
  extern void f4();             <span class='comment'>// OK: Name linkage (internal) and function type linkage (C language linkage)
</span>                                <span class='comment'>// obtained from previous declaration.
</span>}

extern void f4();               <span class='comment'>// OK: Name linkage (internal) and function type linkage (C language linkage)
</span>                                <span class='comment'>// obtained from previous declaration.
</span>
void f6() {
  extern void f4();             <span class='comment'>// OK: Name linkage (internal) and function type linkage (C language linkage)
</span>                                <span class='comment'>// obtained from previous declaration.
</span>}</pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]
<span class='indexparent'><a class='index' id='class,linkage_specification'></a></span>A C language linkage is ignored
in determining the language linkage of
the names of class members and the
function type of class member functions.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span>
</p><pre class='codeblock'>
extern "C" typedef void FUNC_c();

class C {
  void mf1(FUNC_c*);            <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>mf1</span> and the member function's type have
</span>                                <span class='comment'>// C++ language linkage; the parameter has type “pointer to C function”
</span>
  FUNC_c mf2;                   <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>mf2</span> and the member function's type have
</span>                                <span class='comment'>// C++ language linkage
</span>
  static FUNC_c* q;             <span class='comment'>// the name of the data member <span class='tcode_in_codeblock'>q</span> has C++ language linkage and
</span>                                <span class='comment'>// the data member's type is “pointer to C function”
</span>};

extern "C" {
  class X {
    void mf();                  <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>mf</span> and the member function's type have
</span>                                <span class='comment'>// C++ language linkage
</span>    void mf2(void(*)());        <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>mf2</span> has C++ language linkage;
</span>                                <span class='comment'>// the parameter has type “pointer to C function”
</span>  };
}</pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3486'>#</a></div><p >If two declarations declare functions with the same name and
parameter-type-list (<a href='dcl.fct'>[dcl.fct]</a>) to be members of the same
namespace or declare objects with the same name to be members of the same
namespace and the declarations give the names different language linkages, the
program is ill-formed; no diagnostic is required if the declarations appear in
different translation units.
<span class='indexparent'><a class='index' id='consistency,linkage_specification'></a></span>Except for functions with C++ linkage, a function declaration without a
linkage specification shall not precede the first linkage specification
for that function. A function can be declared without a linkage
specification after an explicit linkage specification has been seen; the
linkage explicitly specified in the earlier declaration is not affected
by such a function declaration.</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3501'>#</a></div><p ><span class='indexparent'><a class='index' id='function,linkage_specification_overloaded'></a></span>At most one function with a particular name can have C language linkage.
Two declarations for a function with C language linkage with the same
function name (ignoring the namespace names that qualify it) that appear
in different namespace scopes refer to the same function. Two
declarations for a variable with C language linkage with the same name
(ignoring the namespace names that qualify it) that appear in different
namespace scopes refer to the same variable.
An entity with C language linkage shall not be declared with the same name
as a variable in global scope, unless both declarations denote the same entity;
no diagnostic is required if the declarations appear in different translation units.
A variable with C language linkage shall not be declared with the same name as a
function with C language linkage (ignoring the namespace names that qualify the
respective names); no diagnostic is required if the declarations appear in
different translation units.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
Only
one definition for an entity with a given name
with C language linkage may appear in the
program (see <a href='basic.def.odr'>[basic.def.odr]</a>);
this implies that such an entity
must not be defined in more
than one namespace scope.<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span></p><pre class='codeblock'>
int x;
namespace A {
  extern "C" int f();
  extern "C" int g() { return 1; }
  extern "C" int h();
  extern "C" int x();               <span class='comment'>// ill-formed: same name as global-space object <span class='tcode_in_codeblock'>x</span>
</span>}

namespace B {
  extern "C" int f();               <span class='comment'>// <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;f</span> and <span class='tcode_in_codeblock'>B&#x200b;::&#x200b;f</span> refer to the same function
</span>  extern "C" int g() { return 1; }  <span class='comment'>// ill-formed, the function <span class='tcode_in_codeblock'>g</span> with C language linkage has two definitions
</span>}

int A::f() { return 98; }           <span class='comment'>// definition for the function <span class='tcode_in_codeblock'>f</span> with C language linkage
</span>extern "C" int h() { return 97; }   <span class='comment'>// definition for the function <span class='tcode_in_codeblock'>h</span> with C language linkage
</span>                                    <span class='comment'>// <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;h</span> and <span class='tcode_in_codeblock'>&#x200b;::&#x200b;h</span> refer to the same function
</span></pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3547'>#</a></div><p >A declaration directly contained in a
<i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>
is treated as if it contains the
<span class='texttt'>extern</span>
specifier (<a href='dcl.stc'>[dcl.stc]</a>) for the purpose of determining the linkage of the
declared name and whether it is a definition. Such a declaration shall
not specify a storage class.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span></p><pre class='codeblock'>
extern "C" double f();
static double f();                  <span class='comment'>// error
</span>extern "C" int i;                   <span class='comment'>// declaration
</span>extern "C" {
  int i;                            <span class='comment'>// definition
</span>}
extern "C" static void g();         <span class='comment'>// error
</span></pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3568'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
Because the language linkage is part of a function type, when
indirecting through a pointer to C function, the function to
which the resulting lvalue refers is considered a C function.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/declarations.tex#L3575'>#</a></div><p ><span class='indexparent'><a class='index' id='object,linkage_specification'></a></span><span class='indexparent'><a class='index' id='linkage,implementation-defined_object'></a></span>Linkage from C++ to objects defined in other languages and to objects
defined in C++ from other languages is <span class='indexparent'><a class='index' id='linkage_of_objects_between_C++_and_other_languages'></a></span>implementation-defined and
language-dependent. Only where the object layout strategies of two
language implementations are similar enough can such linkage be
achieved.<span class='indexparent'><a class='index' id='specification,linkage'></a></span></p></div></div></div></body></html>