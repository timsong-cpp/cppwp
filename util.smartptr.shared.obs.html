<!DOCTYPE html><html lang='en'><head><title>[util.smartptr.shared.obs]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>23</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>23.11</a> Smart pointers <a class='abbr_ref' href='smartptr#util.smartptr.shared.obs'>[smartptr]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>23.11.3</a> Class template <span class='texttt'>shared_&shy;ptr</span> <a class='abbr_ref' href='util.smartptr.shared#obs'>[util.smartptr.shared]</a></h3><h4 ><a class='secnum' style='min-width:118pt'>23.11.3.5</a> <span class='texttt'>shared_&shy;ptr</span> observers <a class='abbr_ref'>[util.smartptr.shared.obs]</a></h4><span class='indexparent'><a class='index' id='lib:get,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,get'></a></span><code class='itemdecl'>element_type* get() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9560'>#</a></div><div id='1.sentence-1' class='sentence'><span class='textit'>Returns:</span> The stored pointer<a class='hidden_link' href='#1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator*,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator*'></a></span><code class='itemdecl'>T&amp; operator*() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9569'>#</a></div><div id='2.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>get() != 0</span><a class='hidden_link' href='#2.sentence-1'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9571'>#</a></div><div id='3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*get()</span><a class='hidden_link' href='#3.sentence-1'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9573'>#</a></div><div id='4.sentence-1' class='sentence'><span class='textit'>Remarks:</span> When <span class='texttt'>T</span> is an array type or <span class='textit'>cv</span> <span class='texttt'>void</span>,
it is unspecified whether this
member function is declared<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>If it is declared, it is unspecified what its
return type is, except that the declaration (although not necessarily the
definition) of the function shall be well-formed<a class='hidden_link' href='#4.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator->,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator->'></a></span><code class='itemdecl'>T* operator-&gt;() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9586'>#</a></div><div id='5.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>get() != 0</span><a class='hidden_link' href='#5.sentence-1'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9588'>#</a></div><div id='6.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>get()</span><a class='hidden_link' href='#6.sentence-1'>.</a></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9590'>#</a></div><div id='7.sentence-1' class='sentence'><span class='textit'>Remarks:</span> When <span class='texttt'>T</span> is an array type,
it is unspecified whether this member function is declared<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>If it is declared, it is unspecified what its return type is,
except that the declaration (although not necessarily the definition)
of the function shall be well-formed<a class='hidden_link' href='#7.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator[],shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator[]'></a></span><code class='itemdecl'>element_type&amp; operator[](ptrdiff_t i) const;
</code><div class='itemdescr'></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9603'>#</a></div><div id='8.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>get() != 0 &amp;&amp; i &gt;= 0</span><a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>If <span class='texttt'>T</span> is <span class='texttt'>U[N]</span>, <span class='texttt'>i &lt; N</span><a class='hidden_link' href='#8.sentence-2'>.</a></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9606'>#</a></div><div id='9.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>get()[i]</span><a class='hidden_link' href='#9.sentence-1'>.</a></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9608'>#</a></div><div id='10.sentence-1' class='sentence'><span class='textit'>Remarks:</span> When <span class='texttt'>T</span> is not an array type,
it is unspecified whether this member function is declared<a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='10.sentence-2' class='sentence'>If it is declared, it is unspecified what its return type is,
except that the declaration (although not necessarily the definition)
of the function shall be well-formed<a class='hidden_link' href='#10.sentence-2'>.</a></div></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9614'>#</a></div><div id='11.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#11.sentence-1'>.</a></div></div></div><div id='sentence-1' class='sentence'><div id='lib:shared_ptr,use_count'><div id='lib:use_count,shared_ptr'>
<code class='itemdecl'>long use_count() const noexcept;
</code>
</div></div></div><div class='itemdescr'></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9624'>#</a></div><div id='12.sentence-1' class='sentence'><span class='textit'>Returns:</span> The number of <span class='texttt'>shared_&shy;ptr</span> objects, <span class='texttt'>*this</span> included,
that share ownership with <span class='texttt'>*this</span>, or <span class='texttt'>0</span> when <span class='texttt'>*this</span> is
empty<a class='hidden_link' href='#12.sentence-1'>.</a></div></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9628'>#</a></div><div id='13.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> None<a class='hidden_link' href='#13.sentence-1'>.</a></div></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9630'>#</a></div><div id='14.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#14.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='14.sentence-1' class='sentence'><span class='texttt'>get() == nullptr</span>
does not imply a specific return value of <span class='texttt'>use_&shy;count()</span><a class='hidden_link' href='#14.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9633'>#</a></div><div id='15.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#15.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='15.sentence-1' class='sentence'><span class='texttt'>weak_&shy;ptr&lt;T&gt;&#x200b;::&#x200b;lock()</span>
can affect the return value of <span class='texttt'>use_&shy;count()</span><a class='hidden_link' href='#15.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9636'>#</a></div><div id='16.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='16.sentence-1' class='sentence'>When multiple threads
can affect the return value of <span class='texttt'>use_&shy;count()</span>,
the result should be treated as approximate<a class='hidden_link' href='#16.sentence-1'>.</a></div> <div id='16.sentence-2' class='sentence'>In particular, <span class='texttt'>use_&shy;count() == 1</span> does not imply that accesses through
a previously destroyed <span class='texttt'>shared_&shy;ptr</span> have in any sense completed<a class='hidden_link' href='#16.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:operator_bool,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator_bool'></a></span><code class='itemdecl'>explicit operator bool() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9649'>#</a></div><div id='17.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>get() != 0</span><a class='hidden_link' href='#17.sentence-1'>.</a></div></div></div><div id='sentence-1' class='sentence'><div id='lib:shared_ptr,owner_before'><div id='lib:owner_before,shared_ptr'>
<code class='itemdecl'>template&lt;class U&gt; bool owner_before(const shared_ptr&lt;U&gt;&amp; b) const noexcept;
template&lt;class U&gt; bool owner_before(const weak_ptr&lt;U&gt;&amp; b) const noexcept;
</code>
</div></div></div><div class='itemdescr'></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/utilities.tex#L9660'>#</a></div><div id='18.sentence-1' class='sentence'><span class='textit'>Returns:</span> An unspecified value such that</div><div id='18.sentence-2' class='sentence'><ul class='itemize'><li id='18.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#18.1'>(18.1)</a></div><div id='18.1.sentence-1' class='sentence'><span class='texttt'>x.owner_&shy;before(y)</span> defines a strict weak ordering as defined in <a href='alg.sorting'>[alg.sorting]</a>;</div></li><li id='18.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#18.2'>(18.2)</a></div><div id='18.2.sentence-1' class='sentence'>under the equivalence relation defined by <span class='texttt'>owner_&shy;before</span>,
<span class='texttt'>!a.owner_&shy;before(b) &amp;&amp; !b.owner_&shy;before(a)</span>, two <span class='texttt'>shared_&shy;ptr</span> or
<span class='texttt'>weak_&shy;ptr</span> instances are equivalent if and only if they share ownership or
are both empty<a class='hidden_link' href='#18.2.sentence-1'>.</a></div></li></ul></div></div></div></div></body></html>