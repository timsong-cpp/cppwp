<!DOCTYPE html><html lang='en'><head><title>[util.smartptr.shared.obs]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>20</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>20.11</a> Smart pointers <a class='abbr_ref' href='smartptr#util.smartptr.shared.obs'>[smartptr]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>20.11.2</a> Shared-ownership pointers <a class='abbr_ref' href='util.smartptr#shared.obs'>[util.smartptr]</a></h3><h4 ><a class='secnum' style='min-width:118pt'>20.11.2.2</a> Class template <span class='texttt'>shared_ptr</span> <a class='abbr_ref' href='util.smartptr.shared#obs'>[util.smartptr.shared]</a></h4><div id='util.smartptr.shared.obs'><h4 ><a class='secnum' style='min-width:133pt'>20.11.2.2.5</a> <span class='texttt'>shared_ptr</span> observers <a class='abbr_ref'>[util.smartptr.shared.obs]</a></h4><p ><span class='indexparent'><a class='index' id='get,shared_ptr'></a></span><span class='indexparent'><a class='index' id='shared_ptr,get'></a></span><code class='itemdecl'>
element_type* get() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9817'>#</a></div><p ><i>Returns:</i> The stored pointer.
</p></div></div><p ><span class='indexparent'><a class='index' id='operator*,shared_ptr'></a></span><span class='indexparent'><a class='index' id='shared_ptr,operator*'></a></span><code class='itemdecl'>
T&amp; operator*() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9826'>#</a></div><p ><i>Requires:</i> <span class='texttt'>get() != 0</span>.</p></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9828'>#</a></div><p ><i>Returns:</i> <span class='texttt'>*get()</span>.</p></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9830'>#</a></div><p ><i>Remarks:</i> When <span class='texttt'>T</span> is an array type or <i>cv</i> <span class='texttt'>void</span>,
it is unspecified whether this
member function is declared. If it is declared, it is unspecified what its
return type is, except that the declaration (although not necessarily the
definition) of the function shall be well formed.
</p></div></div><p ><span class='indexparent'><a class='index' id='operator->,shared_ptr'></a></span><span class='indexparent'><a class='index' id='shared_ptr,operator->'></a></span><code class='itemdecl'>
T* operator-&gt;() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9843'>#</a></div><p ><i>Requires:</i> <span class='texttt'>get() != 0</span>.</p></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9845'>#</a></div><p ><i>Returns:</i> <span class='texttt'>get()</span>.</p></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9847'>#</a></div><p ><i>Remarks:</i> When <span class='texttt'>T</span> is an array type,
it is unspecified whether this member function is declared.
If it is declared, it is unspecified what its return type is,
except that the declaration (although not necessarily the definition)
of the function shall be well formed.
</p></div></div><p ><span class='indexparent'><a class='index' id='operator[],shared_ptr'></a></span><span class='indexparent'><a class='index' id='shared_ptr,operator[]'></a></span><code class='itemdecl'>
element_type&amp; operator[](ptrdiff_t i) const;
</code></p><div class='itemdescr'></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9860'>#</a></div><p ><i>Requires:</i> <span class='texttt'>get() != 0 &amp;&amp; i &gt;= 0</span>.
If <span class='texttt'>T</span> is <span class='texttt'>U[N]</span>, <span class='texttt'>i &lt; N</span>.</p></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9863'>#</a></div><p ><i>Returns:</i> <span class='texttt'>get()[i]</span>.</p></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9865'>#</a></div><p ><i>Remarks:</i> When <span class='texttt'>T</span> is not an array type,
it is unspecified whether this member function is declared.
If it is declared, it is unspecified what its return type is,
except that the declaration (although not necessarily the definition)
of the function shall be well formed.</p></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9871'>#</a></div><p ><i>Throws:</i> Nothing.
</p></div></div><p ><span class='indexparent'><a class='index' id='use_count,shared_ptr'></a></span><span class='indexparent'><a class='index' id='shared_ptr,use_count'></a></span><code class='itemdecl'>
long use_count() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9880'>#</a></div><p ><i>Returns:</i> The number of <span class='texttt'>shared_ptr</span> objects, <span class='texttt'>*this</span> included,
that share ownership with <span class='texttt'>*this</span>, or <span class='texttt'>0</span> when <span class='texttt'>*this</span> is
empty.</p></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9884'>#</a></div><p ><i>Synchronization:</i> None.</p></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9886'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><i>Note:</i> <span class='texttt'>get() == nullptr</span>
does not imply a specific return value of <span class='texttt'>use_count()</span>. <i><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</i><span style='white-space:nowrap'>&thinsp;</span>]</p></div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9889'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><i>Note:</i> <span class='texttt'>weak_ptr&lt;T&gt;::lock()</span>
can affect the return value of <span class='texttt'>use_count()</span>. <i><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</i><span style='white-space:nowrap'>&thinsp;</span>]</p></div></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9892'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><i>Note:</i> When multiple threads
can affect the return value of <span class='texttt'>use_count()</span>,
the result should be treated as approximate.
In particular, <span class='texttt'>use_count() == 1</span> does not imply that accesses through
a previously destroyed <span class='texttt'>shared_ptr</span> have in any sense completed. <i><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</i><span style='white-space:nowrap'>&thinsp;</span>]
</p></div></div><p ><span class='indexparent'><a class='index' id='operator_bool,shared_ptr'></a></span><span class='indexparent'><a class='index' id='shared_ptr,operator_bool'></a></span><code class='itemdecl'>
explicit operator bool() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9905'>#</a></div><p ><i>Returns:</i> <span class='texttt'>get() != 0</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='owner_before,shared_ptr'></a></span><span class='indexparent'><a class='index' id='shared_ptr,owner_before'></a></span><code class='itemdecl'>
template&lt;class U&gt; bool owner_before(const shared_ptr&lt;U&gt;&amp; b) const;
template&lt;class U&gt; bool owner_before(const weak_ptr&lt;U&gt;&amp; b) const;
</code></p><div class='itemdescr'></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8dbc0ac22069c102d3b97e67d31390c4e4c6247a/source/utilities.tex#L9915'>#</a></div><p ><i>Returns:</i> An unspecified value such that</p><ul class='itemize'><li id='18.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#18.1'>(18.1)</a></div><p ><span class='texttt'>x.owner_before(y)</span> defines a strict weak ordering as defined in <a href='alg.sorting'>[alg.sorting]</a>;</p></li><li id='18.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#18.2'>(18.2)</a></div><p >under the equivalence relation defined by <span class='texttt'>owner_before</span>,
<span class='texttt'>!a.owner_before(b) &amp;&amp; !b.owner_before(a)</span>, two <span class='texttt'>shared_ptr</span> or
<span class='texttt'>weak_ptr</span> instances are equivalent if and only if they share ownership or
are both empty.
</p></li></ul></div></div></div></div></body></html>