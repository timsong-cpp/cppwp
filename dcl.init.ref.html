<!DOCTYPE html><html lang='en'><head><title>[dcl.init.ref]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>9</a> Declarations <a class='abbr_ref' href='./#dcl'>[dcl]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>9.5</a> Initializers <a class='abbr_ref' href='dcl.init#ref'>[dcl.init]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>9.5.4</a> References <a class='abbr_ref'>[dcl.init.ref]</a></h3><div class='texpara'><a class='index' id=':initialization,reference'></a></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/declarations.tex#L5995'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'>A variable whose declared type is
“reference to <span class='texttt'>T</span>” (<a href='dcl.ref' title='9.3.4.3&emsp;References'>[dcl.<span class='shy'></span>ref]</a>)
shall be initialized<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>int</span> g<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i;
  <span class='keyword'>int</span><span class='operator'>&amp;</span> r <span class='operator'>=</span> i;                   <span class='comment'>// <span class='tcode_in_codeblock'>r</span> refers to <span class='tcode_in_codeblock'>i</span></span>
  r <span class='operator'>=</span> <span class='literal'>1</span>;                        <span class='comment'>// the value of <span class='tcode_in_codeblock'>i</span> becomes <span class='tcode_in_codeblock'>1</span></span>
  <span class='keyword'>int</span><span class='operator'>*</span> p <span class='operator'>=</span> <span class='operator'>&amp;</span>r;                  <span class='comment'>// <span class='tcode_in_codeblock'>p</span> points to <span class='tcode_in_codeblock'>i</span></span>
  <span class='keyword'>int</span><span class='operator'>&amp;</span> rr <span class='operator'>=</span> r;                  <span class='comment'>// <span class='tcode_in_codeblock'>rr</span> refers to what <span class='tcode_in_codeblock'>r</span> refers to, that is, to <span class='tcode_in_codeblock'>i</span></span>
  <span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>&amp;</span>rg<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span> <span class='operator'>=</span> g;           <span class='comment'>// <span class='tcode_in_codeblock'>rg</span> refers to the function <span class='tcode_in_codeblock'>g</span></span>
  rg<span class='parenthesis'>(</span>i<span class='parenthesis'>)</span>;                        <span class='comment'>// calls function <span class='tcode_in_codeblock'>g</span></span>
  <span class='keyword'>int</span> a<span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span>;
  <span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>&amp;</span>ra<span class='parenthesis'>)</span><span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span> <span class='operator'>=</span> a;             <span class='comment'>// <span class='tcode_in_codeblock'>ra</span> refers to the array <span class='tcode_in_codeblock'>a</span></span>
  ra<span class='squarebracket'>[</span><span class='literal'>1</span><span class='squarebracket'>]</span> <span class='operator'>=</span> i;                    <span class='comment'>// modifies <span class='tcode_in_codeblock'>a[1]</span></span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/declarations.tex#L6017'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>A reference cannot be changed to refer to another object after initialization<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-3' class='sentence'><a class='index' id=':assignment,reference'></a><div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='2.sentence-2' class='sentence'>Assignment to a reference assigns to the object referred to by the reference (<a href='expr.assign' title='7.6.19&emsp;Assignment and compound assignment operators'>[expr.<span class='shy'></span>assign]</a>)<a class='hidden_link' href='#2.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div>
<a class='index' id=':argument_passing,reference_and'></a>Argument passing (<a href='expr.call' title='7.6.1.3&emsp;Function call'>[expr.<span class='shy'></span>call]</a>)
<a class='index' id=':return,reference_and'></a>and function value return (<a href='stmt.return' title='8.7.4&emsp;The return statement'>[stmt.<span class='shy'></span>return]</a>) are initializations<a class='hidden_link' href='#2.sentence-3'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/declarations.tex#L6028'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'>The initializer can be omitted for a reference only in a parameter declaration (<a href='dcl.fct' title='9.3.4.6&emsp;Functions'>[dcl.<span class='shy'></span>fct]</a>),
in the declaration of a function return type, in the declaration of
a class member within its class definition (<a href='class.mem' title='11.4&emsp;Class members'>[class.<span class='shy'></span>mem]</a>), and where the
<span id=':extern'><span class='texttt'><span class='keyword'>extern</span></span></span>
specifier is explicitly used<a class='hidden_link' href='#3.sentence-1'>.</a></div> <a class='index' id=':declaration,extern_reference'></a><div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>int</span><span class='operator'>&amp;</span> r1;                        <span class='comment'>// error: initializer missing</span>
<span class='keyword'>extern</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> r2;                 <span class='comment'>// OK</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/declarations.tex#L6042'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'>Given types “<i >cv1</i> <span class='texttt'>T1</span>” and “<i >cv2</i> <span class='texttt'>T2</span>”,
“<i >cv1</i> <span class='texttt'>T1</span>” is <a class='hidden_link' href='#def:reference-related' title='9.5.4&emsp;References&emsp;[dcl.init.ref]'><span id='def:reference-related'><i >reference-related</i></span></a> to
“<i >cv2</i> <span class='texttt'>T2</span>” if
<span class='texttt'>T1</span> is similar (<a href='conv.qual' title='7.3.6&emsp;Qualification conversions'>[conv.<span class='shy'></span>qual]</a>) to <span class='texttt'>T2</span>, or
<span class='texttt'>T1</span> is a base class of <span class='texttt'>T2</span><a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>“<i >cv1</i> <span class='texttt'>T1</span>” is <a class='hidden_link' href='#def:reference-compatible' title='9.5.4&emsp;References&emsp;[dcl.init.ref]'><span id='def:reference-compatible'><i >reference-compatible</i></span></a>
with “<i >cv2</i> <span class='texttt'>T2</span>” if
a prvalue of type “pointer to <i >cv2</i> <span class='texttt'>T2</span>” can be converted to
the type “pointer to <i >cv1</i> <span class='texttt'>T1</span>”
via a standard conversion sequence (<a href='conv' title='7.3&emsp;Standard conversions'>[conv]</a>)<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>In all cases where the reference-compatible relationship
of two types is used to establish the validity of a reference binding and
the standard conversion sequence would be ill-formed,
a program that necessitates such a binding is ill-formed<a class='hidden_link' href='#4.sentence-3'>.</a></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/declarations.tex#L6058'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>A reference to type “<i >cv1</i> <span class='texttt'>T1</span>” is initialized by
an expression of type “<i >cv2</i> <span class='texttt'>T2</span>” as follows:<a class='index' id=':binding,reference'></a>
<ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#5.1'>(5.1)</a></div><div class='texpara'><div id='5.1.sentence-1' class='sentence'>If the reference is an lvalue reference and the initializer expression
<ul class='itemize'><li id='5.1.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#5.1.1'>(5.1.1)</a></div>is an lvalue (but is not a
bit-field), and
“<i >cv1</i> <span class='texttt'>T1</span>” is reference-compatible with
“<i >cv2</i> <span class='texttt'>T2</span>”, or</li><li id='5.1.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#5.1.2'>(5.1.2)</a></div>has a class type (i.e.,
<span class='texttt'>T2</span>
is a class type), where <span class='texttt'>T1</span> is not reference-related to <span class='texttt'>T2</span>, and can be converted
to an lvalue of type “<i >cv3</i> <span class='texttt'>T3</span>”, where
“<i >cv1</i> <span class='texttt'>T1</span>” is reference-compatible with
“<i >cv3</i> <span class='texttt'>T3</span>”<a class='footnoteref' href='#footnote-80' id='footnoteref-80' title='This requires a conversion function ([class.conv.fct]) returning a reference type.'>80</a>
(this conversion is selected by enumerating the applicable conversion
functions (<a href='over.match.ref' title='12.2.2.7&emsp;Initialization by conversion function for direct reference binding'>[over.<span class='shy'></span>match.<span class='shy'></span>ref]</a>) and choosing the best one through <a href='over.match' title='12.2&emsp;Overload resolution&emsp;[over.match]'>overload
resolution</a>),</li></ul>
then the reference binds to the initializer expression lvalue in the
first case and to the lvalue result of the conversion
in the second case (or, in either case, to the appropriate base class subobject of the object)<a class='hidden_link' href='#5.1.sentence-1'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='5.1.sentence-2' class='sentence'>The usual <a href='conv.lval' title='7.3.2&emsp;Lvalue-to-rvalue conversion&emsp;[conv.lval]'>lvalue-to-rvalue</a>, <a href='conv.array' title='7.3.3&emsp;Array-to-pointer conversion&emsp;[conv.array]'>array-to-pointer</a>,
and <a href='conv.func' title='7.3.4&emsp;Function-to-pointer conversion&emsp;[conv.func]'>function-to-pointer</a> standard
conversions are not needed, and therefore are suppressed, when such
direct bindings to lvalues are done<a class='hidden_link' href='#5.1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>double</span> d <span class='operator'>=</span> <span class='literal'>2.0</span>;
<span class='keyword'>double</span><span class='operator'>&amp;</span> rd <span class='operator'>=</span> d;                 <span class='comment'>// <span class='tcode_in_codeblock'>rd</span> refers to <span class='tcode_in_codeblock'>d</span></span>
<span class='keyword'>const</span> <span class='keyword'>double</span><span class='operator'>&amp;</span> rcd <span class='operator'>=</span> d;          <span class='comment'>// <span class='tcode_in_codeblock'>rcd</span> refers to <span class='tcode_in_codeblock'>d</span></span>

<span class='keyword'>struct</span> A <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='operator'>:</span> A <span class='curlybracket'>{</span> <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='operator'>&amp;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span> b;
A<span class='operator'>&amp;</span> ra <span class='operator'>=</span> b;                      <span class='comment'>// <span class='tcode_in_codeblock'>ra</span> refers to <span class='tcode_in_codeblock'>A</span> subobject in <span class='tcode_in_codeblock'>b</span></span>
<span class='keyword'>const</span> A<span class='operator'>&amp;</span> rca <span class='operator'>=</span> b;               <span class='comment'>// <span class='tcode_in_codeblock'>rca</span> refers to <span class='tcode_in_codeblock'>A</span> subobject in <span class='tcode_in_codeblock'>b</span></span>
<span class='keyword'>int</span><span class='operator'>&amp;</span> ir <span class='operator'>=</span> B<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                  <span class='comment'>// <span class='tcode_in_codeblock'>ir</span> refers to the result of <span class='tcode_in_codeblock'>B&#x200b;::&#x200b;operator int&amp;</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='5.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#5.2'>(5.2)</a></div><div class='texpara'><div id='5.2.sentence-1' class='sentence'>Otherwise,
if the reference is an lvalue reference to a
type that is not const-qualified or is volatile-qualified,
the program is ill-formed<a class='hidden_link' href='#5.2.sentence-1'>.</a></div> <div id='example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-4'>4</a></i>:&ensp;<span class='codeblock'><span class='keyword'>double</span><span class='operator'>&amp;</span> rd2 <span class='operator'>=</span> <span class='literal'>2.0</span>;              <span class='comment'>// error: not an lvalue and reference not <span id=':const'><span class='tcode_in_codeblock'>const</span></span></span>
<span class='keyword'>int</span>  i <span class='operator'>=</span> <span class='literal'>2</span>;
<span class='keyword'>double</span><span class='operator'>&amp;</span> rd3 <span class='operator'>=</span> i;                <span class='comment'>// error: type mismatch and reference not <span id=':const_'><span class='tcode_in_codeblock'>const</span></span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='5.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#5.3'>(5.3)</a></div><div class='texpara'><div id='5.3.sentence-1' class='sentence'>Otherwise, if the initializer expression
<ul class='itemize'><li id='5.3.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#5.3.1'>(5.3.1)</a></div>is an rvalue (but not a bit-field) or an lvalue of function type and
“<i >cv1</i> <span class='texttt'>T1</span>” is
reference-compatible with “<i >cv2</i> <span class='texttt'>T2</span>”, or</li><li id='5.3.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#5.3.2'>(5.3.2)</a></div>has a class type (i.e., <span class='texttt'>T2</span> is a class type), where <span class='texttt'>T1</span>
is not reference-related to <span class='texttt'>T2</span>, and can be converted to
an rvalue of type “<i >cv3</i> <span class='texttt'>T3</span>” or
an lvalue of function type “<i >cv3</i> <span class='texttt'>T3</span>”,
where “<i >cv1</i> <span class='texttt'>T1</span>” is
reference-compatible with “<i >cv3</i> <span class='texttt'>T3</span>” (see <a href='over.match.ref' title='12.2.2.7&emsp;Initialization by conversion function for direct reference binding'>[over.<span class='shy'></span>match.<span class='shy'></span>ref]</a>),</li></ul>
then
the initializer expression in the first case and
the converted expression in the second case
is called the converted initializer<a class='hidden_link' href='#5.3.sentence-1'>.</a></div> <div id='5.3.sentence-2' class='sentence'>If the converted initializer is a prvalue,
let its type be denoted by <span class='texttt'>T4</span>;
the temporary materialization conversion (<a href='conv.rval' title='7.3.5&emsp;Temporary materialization conversion'>[conv.<span class='shy'></span>rval]</a>) is applied,
considering the type of the prvalue to be
“<i >cv1</i> <span class='texttt'>T4</span>” (<a href='conv.qual' title='7.3.6&emsp;Qualification conversions'>[conv.<span class='shy'></span>qual]</a>)<a class='hidden_link' href='#5.3.sentence-2'>.</a></div> <div id='5.3.sentence-3' class='sentence'>In any case,
the reference binds to the resulting glvalue
(or to an appropriate base class subobject)<a class='hidden_link' href='#5.3.sentence-3'>.</a></div></div><div class='texpara'><div id='example-5' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-5'>5</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> A <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='operator'>:</span> A <span class='curlybracket'>{</span> <span class='curlybracket'>}</span> b;
<span class='keyword'>extern</span> B f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>const</span> A<span class='operator'>&amp;</span> rca2 <span class='operator'>=</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                <span class='comment'>// binds to the <span class='tcode_in_codeblock'>A</span> subobject of the <span class='tcode_in_codeblock'>B</span> rvalue.</span>
A<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rra <span class='operator'>=</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                      <span class='comment'>// same as above</span>
<span class='keyword'>struct</span> X <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> B<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='operator'>&amp;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span> x;
<span class='keyword'>const</span> A<span class='operator'>&amp;</span> r <span class='operator'>=</span> x;                     <span class='comment'>// binds to the <span class='tcode_in_codeblock'>A</span> subobject of the result of the conversion</span>
<span class='keyword'>int</span> i2 <span class='operator'>=</span> <span class='literal'>42</span>;
<span class='keyword'>int</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rri <span class='operator'>=</span> <span class='keyword'>static_cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>i2<span class='parenthesis'>)</span>; <span class='comment'>// binds directly to <span class='tcode_in_codeblock'>i2</span></span>
B<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rrb <span class='operator'>=</span> x;                        <span class='comment'>// binds directly to the result of <span class='tcode_in_codeblock'>operator B</span></span>

<span class='keyword'>constexpr</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>const</span> <span class='keyword'>int</span> <span class='operator'>&amp;</span>x <span class='operator'>=</span> <span class='literal'>42</span>;
  <span class='keyword'>const_cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>int</span> <span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>x<span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='literal'>1</span>;         <span class='comment'>// undefined behavior</span>
  <span class='keyword'>return</span> x;
<span class='curlybracket'>}</span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> z <span class='operator'>=</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;              <span class='comment'>// error: not a constant expression</span>

<span class='keyword'>typedef</span> <span class='keyword'>int</span> <span class='operator'>*</span>A<span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span>;                  <span class='comment'>// array of 3 pointer to <span class='tcode_in_codeblock'>int</span></span>
<span class='keyword'>typedef</span> <span class='keyword'>const</span> <span class='keyword'>int</span> <span class='operator'>*</span><span class='keyword'>const</span> CA<span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span>;     <span class='comment'>// array of 3 const pointer to <span class='tcode_in_codeblock'>const int</span></span>
ACPC <span class='operator'>&amp;</span><span class='operator'>&amp;</span>r <span class='operator'>=</span> AP<span class='curlybracket'>{</span><span class='curlybracket'>}</span>;                    <span class='comment'>// binds directly</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li><li id='5.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#5.4'>(5.4)</a></div><div class='texpara'><div id='5.4.sentence-1' class='sentence'>Otherwise, <span class='texttt'>T1</span> shall not be reference-related to <span class='texttt'>T2</span><a class='hidden_link' href='#5.4.sentence-1'>.</a></div> <ul class='itemize'><li id='5.4.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#5.4.1'>(5.4.1)</a></div><div class='texpara'><div id='5.4.1.sentence-1' class='sentence'>If <span class='texttt'>T1</span> or <span class='texttt'>T2</span> is a class type,
user-defined conversions are considered
using the rules for copy-initialization of an object of type
“<i >cv1</i> <span class='texttt'>T1</span>” by
user-defined conversion (<a href='dcl.init' title='9.5&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>, <a href='over.match.copy' title='12.2.2.5&emsp;Copy-initialization of class by user-defined conversion'>[over.<span class='shy'></span>match.<span class='shy'></span>copy]</a>, <a href='over.match.conv' title='12.2.2.6&emsp;Initialization by conversion function'>[over.<span class='shy'></span>match.<span class='shy'></span>conv]</a>);
the program is ill-formed if the corresponding non-reference
copy-initialization would be ill-formed<a class='hidden_link' href='#5.4.1.sentence-1'>.</a></div> <div id='5.4.1.sentence-2' class='sentence'>The result of the call to the
conversion function, as described for the non-reference
copy-initialization, is then used to direct-initialize the reference<a class='hidden_link' href='#5.4.1.sentence-2'>.</a></div> <div id='5.4.1.sentence-3' class='sentence'>For this direct-initialization, user-defined conversions are not considered<a class='hidden_link' href='#5.4.1.sentence-3'>.</a></div></div></li><li id='5.4.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#5.4.2'>(5.4.2)</a></div><div class='texpara'><div id='5.4.2.sentence-1' class='sentence'>Otherwise,
the initializer expression is implicitly converted to a prvalue
of type “<span class='texttt'>T1</span>”<a class='hidden_link' href='#5.4.2.sentence-1'>.</a></div> <div id='5.4.2.sentence-2' class='sentence'>The temporary materialization conversion is applied,
considering the type of the prvalue to be “<i >cv1</i> <span class='texttt'>T1</span>”,
and the reference is bound to the result<a class='hidden_link' href='#5.4.2.sentence-2'>.</a></div></div></li></ul></div><div class='texpara'><div id='example-6' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-6'>6</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> Banana <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> Enigma <span class='curlybracket'>{</span> <span class='keyword'>operator</span> <span class='keyword'>const</span> Banana<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> Alaska <span class='curlybracket'>{</span> <span class='keyword'>operator</span> Banana<span class='operator'>&amp;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>void</span> enigmatic<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>typedef</span> <span class='keyword'>const</span> Banana ConstBanana;
  Banana <span class='operator'>&amp;</span><span class='operator'>&amp;</span>banana1 <span class='operator'>=</span> ConstBanana<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='comment'>// error</span>
  Banana <span class='operator'>&amp;</span><span class='operator'>&amp;</span>banana2 <span class='operator'>=</span> Enigma<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;      <span class='comment'>// error</span>
  Banana <span class='operator'>&amp;</span><span class='operator'>&amp;</span>banana3 <span class='operator'>=</span> Alaska<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;      <span class='comment'>// error</span>
<span class='curlybracket'>}</span>

<span class='keyword'>const</span> <span class='keyword'>double</span><span class='operator'>&amp;</span> rcd2 <span class='operator'>=</span> <span class='literal'>2</span>;             <span class='comment'>// <span class='tcode_in_codeblock'>rcd2</span> refers to temporary with type <span class='tcode_in_codeblock'>const double</span> and value <span class='tcode_in_codeblock'>2.0</span></span>
<span class='keyword'>double</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rrd <span class='operator'>=</span> <span class='literal'>2</span>;                   <span class='comment'>// <span class='tcode_in_codeblock'>rrd</span> refers to temporary with value <span class='tcode_in_codeblock'>2.0</span></span>
<span class='keyword'>const</span> <span class='keyword'>volatile</span> <span class='keyword'>int</span> cvi <span class='operator'>=</span> <span class='literal'>1</span>;
<span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> r2 <span class='operator'>=</span> cvi;                <span class='comment'>// error: cv-qualifier dropped</span>
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span> <span class='keyword'>operator</span> <span class='keyword'>volatile</span> <span class='keyword'>int</span><span class='operator'>&amp;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span> a;
<span class='keyword'>const</span> <span class='keyword'>int</span><span class='operator'>&amp;</span> r3 <span class='operator'>=</span> a;                  <span class='comment'>// error: cv-qualifier dropped</span>
                                    <span class='comment'>// from result of conversion function</span>
<span class='keyword'>double</span> d2 <span class='operator'>=</span> <span class='literal'>1.0</span>;
<span class='keyword'>double</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rrd2 <span class='operator'>=</span> d2;                 <span class='comment'>// error: initializer is lvalue of reference-related type</span>
<span class='keyword'>struct</span> X <span class='curlybracket'>{</span> <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='operator'>&amp;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>int</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rri2 <span class='operator'>=</span> X<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                   <span class='comment'>// error: result of conversion function is</span>
                                    <span class='comment'>// lvalue of reference-related type</span>
<span class='keyword'>int</span> i3 <span class='operator'>=</span> <span class='literal'>2</span>;
<span class='keyword'>double</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rrd3 <span class='operator'>=</span> i3;                 <span class='comment'>// <span class='tcode_in_codeblock'>rrd3</span> refers to temporary with value <span class='tcode_in_codeblock'>2.0</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div></li></ul></div></div><div class='texpara'><div id='5.sentence-2' class='sentence'>In all cases except the last
(i.e., implicitly converting the initializer expression
to the referenced type),
the reference is said to <a class='hidden_link' href='#def:bind_directly' title='9.5.4&emsp;References&emsp;[dcl.init.ref]'><span id='def:bind_directly'><i >bind directly</i></span></a> to the
initializer expression<a class='hidden_link' href='#5.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/declarations.tex#L6237'>#</a></div><div class='texpara'><div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>:&ensp;<div id='6.sentence-1' class='sentence'><a href='class.temporary' title='6.7.7&emsp;Temporary objects'>[class.<span class='shy'></span>temporary]</a> describes the lifetime of temporaries bound to references<a class='hidden_link' href='#6.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-80'><div class='texpara'><a class='footnotenum' href='#footnote-80'>80)</a><a class='footnoteBacklink' href='#footnoteref-80'>80)</a> <div id='footnote-80.sentence-1' class='sentence'>This requires a conversion
function (<a href='class.conv.fct' title='11.4.8.3&emsp;Conversion functions'>[class.<span class='shy'></span>conv.<span class='shy'></span>fct]</a>) returning a reference type<a class='hidden_link' href='#footnote-80.sentence-1'>.</a></div></div></div></div></body></html>