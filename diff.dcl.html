<!DOCTYPE html><html lang='en'><head><title>[diff.dcl]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'/><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'/><link rel='icon' href='icon.png'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/></head><body><div class='wrapper'><h1 ><a class='annexnum' style='min-width:50pt'>Annex C&emsp;(informative)</a> Compatibility <a class='abbr_ref' href='./#diff'>[diff]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>C.7</a> C++ and C <a class='abbr_ref' href='diff.iso#diff.dcl'>[diff.iso]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>C.7.6</a> <a href='dcl.dcl' title='9&emsp;Declarations'>[dcl.<span class='shy'></span>dcl]</a>: declarations <a class='abbr_ref'>[diff.dcl]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3050'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.stc'>[dcl.<span class='shy'></span>stc]</a>
<br/> <div id='1.sentence-1' class='sentence'><b>Change:</b> In C++, the <span id=':static'><span class='texttt'><span class='keyword'>static</span></span></span> or <span id=':extern'><span class='texttt'><span class='keyword'>extern</span></span></span> specifiers can only be applied to names of objects or functions<a class='hidden_link' href='#1.sentence-1'>.</a></div> <br/> <div id='1.sentence-2' class='sentence'>
Using these specifiers with type declarations is illegal in C++<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>In C, these specifiers are ignored when used on type declarations<a class='hidden_link' href='#1.sentence-3'>.</a></div></div><div class='texpara'><div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>static</span> <span class='keyword'>struct</span> S <span class='curlybracket'>{</span>               <span class='comment'>// valid C, invalid in C++</span>
  <span class='keyword'>int</span> i;
<span class='curlybracket'>}</span>;
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='1.sentence-4' class='sentence'><b>Rationale:</b> Storage class specifiers don't have any meaning when associated
with a type<a class='hidden_link' href='#1.sentence-4'>.</a></div> <div id='1.sentence-5' class='sentence'>In C++, class members can be declared with the <span id=':static_'><span class='texttt'><span class='keyword'>static</span></span></span> storage
class specifier<a class='hidden_link' href='#1.sentence-5'>.</a></div> <div id='1.sentence-6' class='sentence'>Storage class specifiers on type
declarations can be confusing for users<a class='hidden_link' href='#1.sentence-6'>.</a></div> <br/> <div id='1.sentence-7' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#1.sentence-7'>.</a></div> <br/> <div id='1.sentence-8' class='sentence'><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#1.sentence-8'>.</a></div> <br/> <div id='1.sentence-9' class='sentence'><b>How widely used:</b> Seldom<a class='hidden_link' href='#1.sentence-9'>.</a></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3078'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.stc'>[dcl.<span class='shy'></span>stc]</a>
<br/> <div id='2.sentence-1' class='sentence'><b>Change:</b> In C++, <span id=':register'><span class='texttt'><span class='keyword'>register</span></span></span> is not a storage class specifier<a class='hidden_link' href='#2.sentence-1'>.</a></div> <br/> <div id='2.sentence-2' class='sentence'><b>Rationale:</b> The storage class specifier had no effect in C++<a class='hidden_link' href='#2.sentence-2'>.</a></div> <br/> <div id='2.sentence-3' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#2.sentence-3'>.</a></div> <br/> <div id='2.sentence-4' class='sentence'><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#2.sentence-4'>.</a></div> <br/> <div id='2.sentence-5' class='sentence'><b>How widely used:</b> Common<a class='hidden_link' href='#2.sentence-5'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3090'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.typedef'>[dcl.<span class='shy'></span>typedef]</a>
<br/> <div id='3.sentence-1' class='sentence'><b>Change:</b> A C++ <a href='dcl.typedef#nt:typedef-name' title='9.2.4&emsp;The typedef specifier&emsp;[dcl.typedef]'><span id='ntref:typedef-name'><span class='textsf'><i >typedef-name</i></span></span></a> must be different from any class type name declared
in the same scope (except if the typedef is a synonym of the class name with the
same name)<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>In C, a <a href='dcl.typedef#nt:typedef-name' title='9.2.4&emsp;The typedef specifier&emsp;[dcl.typedef]'><span id='ntref:typedef-name_'><span class='textsf'><i >typedef-name</i></span></span></a> and a struct tag name declared in the same scope
can have the same name (because they have different name spaces)<a class='hidden_link' href='#3.sentence-2'>.</a></div></div><div class='texpara'><div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>typedef</span> <span class='keyword'>struct</span> name1 <span class='curlybracket'>{</span> <span class='comment'>/* ... */</span> <span class='curlybracket'>}</span> name1;         <span class='comment'>// valid C and C++</span>
<span class='keyword'>struct</span> name <span class='curlybracket'>{</span> <span class='comment'>/* ... */</span> <span class='curlybracket'>}</span>;
<span class='keyword'>typedef</span> <span class='keyword'>int</span> name;               <span class='comment'>// valid C, invalid C++</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='3.sentence-3' class='sentence'><b>Rationale:</b> For ease of use, C++ doesn't require that a type name be prefixed
with the keywords <span id=':class'><span class='texttt'><span class='keyword'>class</span></span></span>, <span id=':struct'><span class='texttt'><span class='keyword'>struct</span></span></span> or <span id=':union'><span class='texttt'><span class='keyword'>union</span></span></span> when used in object
declarations or type casts<a class='hidden_link' href='#3.sentence-3'>.</a></div></div><div class='texpara'><div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>class</span> name <span class='curlybracket'>{</span> <span class='comment'>/* ... */</span> <span class='curlybracket'>}</span>;
name i;                         <span class='comment'>// <span class='tcode_in_codeblock'>i</span> has type <span class='tcode_in_codeblock'>class name</span></span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='3.sentence-4' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#3.sentence-4'>.</a></div> <br/> <div id='3.sentence-5' class='sentence'><b>Difficulty of converting:</b> Semantic transformation<a class='hidden_link' href='#3.sentence-5'>.</a></div> <div id='3.sentence-6' class='sentence'>One of the 2 types has to be renamed<a class='hidden_link' href='#3.sentence-6'>.</a></div> <br/> <div id='3.sentence-7' class='sentence'><b>How widely used:</b> Seldom<a class='hidden_link' href='#3.sentence-7'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3125'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.type'>[dcl.<span class='shy'></span>type]</a> [see also <a href='basic.link' title='6.6&emsp;Program and linkage'>[basic.<span class='shy'></span>link]</a>]
<br/></div> <div id='4.sentence-2' class='sentence'><b>Change:</b> Const objects must be initialized in C++ but can be left uninitialized in C<a class='hidden_link' href='#4.sentence-2'>.</a><br/></div> <div id='4.sentence-3' class='sentence'><b>Rationale:</b> A const object cannot be assigned to so it must be initialized
to hold a useful value<a class='hidden_link' href='#4.sentence-3'>.</a></div> <br/> <div id='4.sentence-4' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#4.sentence-4'>.</a></div> <br/> <div id='4.sentence-5' class='sentence'><b>Difficulty of converting:</b> Semantic transformation<a class='hidden_link' href='#4.sentence-5'>.</a></div> <br/> <div id='4.sentence-6' class='sentence'><b>How widely used:</b> Seldom<a class='hidden_link' href='#4.sentence-6'>.</a></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3138'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.spec.auto'>[dcl.<span class='shy'></span>spec.<span class='shy'></span>auto]</a>
<br/> <div id='5.sentence-1' class='sentence'><b>Change:</b> The keyword <span id=':auto'><span class='texttt'><span class='keyword'>auto</span></span></span> cannot be used as a storage class specifier<a class='hidden_link' href='#5.sentence-1'>.</a></div></div><div class='texpara'><div id='example-4' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-4'>4</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>auto</span> <span class='keyword'>int</span> x;       <span class='comment'>// valid C, invalid C++</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='5.sentence-2' class='sentence'><b>Rationale:</b> Allowing the use of <span id=':auto_'><span class='texttt'><span class='keyword'>auto</span></span></span> to deduce the type
of a variable from its initializer results in undesired interpretations of
<span id=':auto__'><span class='texttt'><span class='keyword'>auto</span></span></span> as a storage class specifier in certain contexts<a class='hidden_link' href='#5.sentence-2'>.</a></div> <br/> <div id='5.sentence-3' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#5.sentence-3'>.</a></div> <br/> <div id='5.sentence-4' class='sentence'><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#5.sentence-4'>.</a></div> <br/> <div id='5.sentence-5' class='sentence'><b>How widely used:</b> Rare<a class='hidden_link' href='#5.sentence-5'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3161'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.fct'>[dcl.<span class='shy'></span>fct]</a>
<br/> <div id='6.sentence-1' class='sentence'><b>Change:</b> In C++, a function declared with an empty parameter list takes no arguments<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>In C, an empty parameter list means that the number and type of the function arguments are unknown<a class='hidden_link' href='#6.sentence-2'>.</a></div></div><div class='texpara'><div id='example-5' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-5'>5</a></i>:&ensp;<span class='codeblock'><span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;            <span class='comment'>// means   <span class='tcode_in_codeblock'>int f(void)</span> in C++</span>
                    <span class='comment'>// <span class='tcode_in_codeblock'>int f(</span> unknown <span class='tcode_in_codeblock'>)</span> in C</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='6.sentence-3' class='sentence'><b>Rationale:</b> This is to avoid function calls
with the wrong number or type of arguments<a class='hidden_link' href='#6.sentence-3'>.</a></div> <br/> <div id='6.sentence-4' class='sentence'><b>Effect on original feature:</b> Change to semantics of well-defined feature<a class='hidden_link' href='#6.sentence-4'>.</a></div> <div id='6.sentence-5' class='sentence'>This feature was marked as “obsolescent” in C<a class='hidden_link' href='#6.sentence-5'>.</a><br/></div> <div id='6.sentence-6' class='sentence'><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#6.sentence-6'>.</a></div> <div id='6.sentence-7' class='sentence'>The function declarations using C incomplete declaration style must
be completed to become full prototype declarations<a class='hidden_link' href='#6.sentence-7'>.</a></div> <div id='6.sentence-8' class='sentence'>A program may need to be updated further if different calls to the
same (non-prototype) function have different numbers of arguments or
if the type of corresponding arguments differed<a class='hidden_link' href='#6.sentence-8'>.</a></div> <br/> <div id='6.sentence-9' class='sentence'><b>How widely used:</b> Common<a class='hidden_link' href='#6.sentence-9'>.</a></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3189'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.fct'>[dcl.<span class='shy'></span>fct]</a> [see <a href='expr.sizeof' title='7.6.2.5&emsp;Sizeof'>[expr.<span class='shy'></span>sizeof]</a>]
<br/></div> <div id='7.sentence-2' class='sentence'><b>Change:</b> In C++, types may not be defined in return or parameter types<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>In C, these type definitions are allowed<a class='hidden_link' href='#7.sentence-3'>.</a></div></div><div class='texpara'><div id='example-6' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-6'>6</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span> <span class='keyword'>struct</span> S <span class='curlybracket'>{</span> <span class='keyword'>int</span> a; <span class='curlybracket'>}</span> arg <span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>    <span class='comment'>// valid C, invalid C++</span>
<span class='keyword'>enum</span> E <span class='curlybracket'>{</span> A, B, C <span class='curlybracket'>}</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>               <span class='comment'>// valid C, invalid C++</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='7.sentence-4' class='sentence'><b>Rationale:</b> When comparing types in different translation units, C++ relies
on name equivalence when C relies on structural equivalence<a class='hidden_link' href='#7.sentence-4'>.</a></div> <div id='7.sentence-5' class='sentence'>Regarding parameter types: since the type defined in a parameter list
would be in the scope of the function, the only legal calls in C++
would be from within the function itself<a class='hidden_link' href='#7.sentence-5'>.</a></div> <br/> <div id='7.sentence-6' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#7.sentence-6'>.</a></div> <br/> <div id='7.sentence-7' class='sentence'><b>Difficulty of converting:</b> Semantic transformation<a class='hidden_link' href='#7.sentence-7'>.</a></div> <div id='7.sentence-8' class='sentence'>The type definitions must be moved to file scope, or in header files<a class='hidden_link' href='#7.sentence-8'>.</a></div> <br/> <div id='7.sentence-9' class='sentence'><b>How widely used:</b> Seldom<a class='hidden_link' href='#7.sentence-9'>.</a></div> <div id='7.sentence-10' class='sentence'>This style of type definition is seen as poor coding style<a class='hidden_link' href='#7.sentence-10'>.</a></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3216'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.fct.def'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>def]</a>
<br/> <div id='8.sentence-1' class='sentence'><b>Change:</b> In C++, the syntax for function definition excludes the “old-style” C function<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>In C, “old-style” syntax is allowed, but deprecated as “obsolescent”<a class='hidden_link' href='#8.sentence-2'>.</a></div> <br/> <div id='8.sentence-3' class='sentence'><b>Rationale:</b> Prototypes are essential to type safety<a class='hidden_link' href='#8.sentence-3'>.</a></div> <br/> <div id='8.sentence-4' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#8.sentence-4'>.</a></div> <br/> <div id='8.sentence-5' class='sentence'><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#8.sentence-5'>.</a></div> <br/> <div id='8.sentence-6' class='sentence'><b>How widely used:</b> Common in old programs, but already known to be obsolescent<a class='hidden_link' href='#8.sentence-6'>.</a></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3229'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.init.aggr'>[dcl.<span class='shy'></span>init.<span class='shy'></span>aggr]</a>
<br/> <div id='9.sentence-1' class='sentence'><b>Change:</b> In C++, designated initialization support is restricted
compared to the corresponding functionality in C<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.sentence-2' class='sentence'>In C++,
designators for non-static data members
must be specified in declaration order,
designators for array elements and nested designators
are not supported,
and
designated and non-designated initializers
cannot be mixed in the same initializer list<a class='hidden_link' href='#9.sentence-2'>.</a></div></div><div class='texpara'><div id='example-7' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-7'>7</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> A <span class='curlybracket'>{</span> <span class='keyword'>int</span> x, y; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span> <span class='keyword'>struct</span> A a; <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> A a <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='operator'>.</span>y <span class='operator'>=</span> <span class='literal'>1</span>, <span class='operator'>.</span>x <span class='operator'>=</span> <span class='literal'>2</span><span class='curlybracket'>}</span>;  <span class='comment'>// valid C, invalid C++</span>
<span class='keyword'>int</span> arr<span class='squarebracket'>[</span><span class='literal'>3</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='squarebracket'>[</span><span class='literal'>1</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='literal'>5</span><span class='curlybracket'>}</span>;         <span class='comment'>// valid C, invalid C++</span>
<span class='keyword'>struct</span> B b <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='operator'>.</span>a<span class='operator'>.</span>x <span class='operator'>=</span> <span class='literal'>0</span><span class='curlybracket'>}</span>;        <span class='comment'>// valid C, invalid C++</span>
<span class='keyword'>struct</span> A c <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='operator'>.</span>x <span class='operator'>=</span> <span class='literal'>1</span>, <span class='literal'>2</span><span class='curlybracket'>}</span>;       <span class='comment'>// valid C, invalid C++</span>
</span> —&nbsp;<i>end example</i>]</div></div> <br/> <div id='9.sentence-3' class='sentence'><b>Rationale:</b> In C++, members are destroyed in reverse construction order
and the elements of an initializer list are evaluated in lexical order,
so member initializers must be specified in order<a class='hidden_link' href='#9.sentence-3'>.</a></div> <div id='9.sentence-4' class='sentence'>Array designators conflict with <a href='expr.prim.lambda.general#nt:lambda-expression' title='7.5.6.1&emsp;General&emsp;[expr.prim.lambda.general]'><span id='ntref:lambda-expression'><span class='textsf'><i >lambda-expression</i></span></span></a> syntax<a class='hidden_link' href='#9.sentence-4'>.</a></div> <div id='9.sentence-5' class='sentence'>Nested designators are seldom used<a class='hidden_link' href='#9.sentence-5'>.</a></div> <br/> <div id='9.sentence-6' class='sentence'><b>Effect on original feature:</b> Deletion of feature that is incompatible with C++<a class='hidden_link' href='#9.sentence-6'>.</a></div> <br/> <div id='9.sentence-7' class='sentence'><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#9.sentence-7'>.</a></div> <br/> <div id='9.sentence-8' class='sentence'><b>How widely used:</b> Out-of-order initializers are common<a class='hidden_link' href='#9.sentence-8'>.</a></div> <div id='9.sentence-9' class='sentence'>The other features are seldom used<a class='hidden_link' href='#9.sentence-9'>.</a></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3266'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.init.string'>[dcl.<span class='shy'></span>init.<span class='shy'></span>string]</a>
<br/> <div id='10.sentence-1' class='sentence'><b>Change:</b> In C++, when initializing an array of character with a string, the number of
characters in the string (including the terminating <span class='texttt'>'\<span class='literal'>0</span>'</span>) must not exceed the
number of elements in the array<a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='10.sentence-2' class='sentence'>In C, an array can be initialized with a string even if
the array is not large enough to contain the string-terminating <span class='texttt'>'\<span class='literal'>0</span>'</span><a class='hidden_link' href='#10.sentence-2'>.</a></div></div><div class='texpara'><div id='example-8' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-8'>8</a></i>:&ensp;<span class='codeblock'><span class='keyword'>char</span> array<span class='squarebracket'>[</span><span class='literal'>4</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='literal'>"abcd"</span>;         <span class='comment'>// valid C, invalid C++</span>
</span> —&nbsp;<i>end example</i>]</div></div> <br/> <div id='10.sentence-3' class='sentence'><b>Rationale:</b> When these non-terminated arrays are manipulated by standard
string functions, there is potential for major catastrophe<a class='hidden_link' href='#10.sentence-3'>.</a></div> <br/> <div id='10.sentence-4' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#10.sentence-4'>.</a></div> <br/> <div id='10.sentence-5' class='sentence'><b>Difficulty of converting:</b> Semantic transformation<a class='hidden_link' href='#10.sentence-5'>.</a></div> <div id='10.sentence-6' class='sentence'>The arrays must be declared one element bigger to contain the
string terminating <span class='texttt'>'\<span class='literal'>0</span>'</span><a class='hidden_link' href='#10.sentence-6'>.</a></div> <br/> <div id='10.sentence-7' class='sentence'><b>How widely used:</b> Seldom<a class='hidden_link' href='#10.sentence-7'>.</a></div> <div id='10.sentence-8' class='sentence'>This style of array initialization is seen as poor coding style<a class='hidden_link' href='#10.sentence-8'>.</a></div></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3291'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.enum'>[dcl.<span class='shy'></span>enum]</a>
<br/> <div id='11.sentence-1' class='sentence'><b>Change:</b> C++ objects of enumeration type can only be assigned values of the same enumeration type<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='11.sentence-2' class='sentence'>In C, objects of enumeration type can be assigned values of any integral type<a class='hidden_link' href='#11.sentence-2'>.</a></div></div><div class='texpara'><div id='example-9' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-9'>9</a></i>:&ensp;<span class='codeblock'><span class='keyword'>enum</span> color <span class='curlybracket'>{</span> red, blue, green <span class='curlybracket'>}</span>;
<span class='keyword'>enum</span> color c <span class='operator'>=</span> <span class='literal'>1</span>;               <span class='comment'>// valid C, invalid C++</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='11.sentence-3' class='sentence'><b>Rationale:</b> The type-safe nature of C++<a class='hidden_link' href='#11.sentence-3'>.</a></div> <br/> <div id='11.sentence-4' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#11.sentence-4'>.</a></div> <br/> <div id='11.sentence-5' class='sentence'><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#11.sentence-5'>.</a></div> <div id='11.sentence-6' class='sentence'>(The type error produced by the assignment can be automatically
corrected by applying an explicit cast<a class='hidden_link' href='#11.sentence-6'>.</a>)</div> <br/> <div id='11.sentence-7' class='sentence'><b>How widely used:</b> Common<a class='hidden_link' href='#11.sentence-7'>.</a></div></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3314'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.enum'>[dcl.<span class='shy'></span>enum]</a>
<br/> <div id='12.sentence-1' class='sentence'><b>Change:</b> In C++, the type of an enumerator is its enumeration<a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.sentence-2' class='sentence'>In C, the type of an enumerator is <span id=':int'><span class='texttt'><span class='keyword'>int</span></span></span><a class='hidden_link' href='#12.sentence-2'>.</a></div></div><div class='texpara'><div id='example-10' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-10'>10</a></i>:&ensp;<span class='codeblock'><span class='keyword'>enum</span> e <span class='curlybracket'>{</span> A <span class='curlybracket'>}</span>;
<span class='keyword'>sizeof</span><span class='parenthesis'>(</span>A<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>        <span class='comment'>// in C</span>
<span class='keyword'>sizeof</span><span class='parenthesis'>(</span>A<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>e<span class='parenthesis'>)</span>          <span class='comment'>// in C++</span>
<span class='comment'>/* and <span class='tcode_in_codeblock'>sizeof(int)</span> is not necessarily equal to <span class='tcode_in_codeblock'>sizeof(e)</span> */</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='12.sentence-3' class='sentence'><b>Rationale:</b> In C++, an enumeration is a distinct type<a class='hidden_link' href='#12.sentence-3'>.</a></div> <br/> <div id='12.sentence-4' class='sentence'><b>Effect on original feature:</b> Change to semantics of well-defined feature<a class='hidden_link' href='#12.sentence-4'>.</a></div> <br/> <div id='12.sentence-5' class='sentence'><b>Difficulty of converting:</b> Semantic transformation<a class='hidden_link' href='#12.sentence-5'>.</a></div> <br/> <div id='12.sentence-6' class='sentence'><b>How widely used:</b> Seldom<a class='hidden_link' href='#12.sentence-6'>.</a></div> <div id='12.sentence-7' class='sentence'>The only time this affects existing C code is when the size of an
enumerator is taken<a class='hidden_link' href='#12.sentence-7'>.</a></div> <div id='12.sentence-8' class='sentence'>Taking the size of an enumerator is not a
common C coding practice<a class='hidden_link' href='#12.sentence-8'>.</a></div></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/399b93910d0bb6f5632405ad188e9f4aad0ae99a/source/compatibility.tex#L3340'>#</a></div><div class='texpara'><b>Affected subclause:</b> <a href='dcl.align'>[dcl.<span class='shy'></span>align]</a>
<br/> <div id='13.sentence-1' class='sentence'><b>Change:</b> In C++,
an <a href='dcl.attr.grammar#nt:alignment-specifier' title='9.12.1&emsp;Attribute syntax and semantics&emsp;[dcl.attr.grammar]'><span id='ntref:alignment-specifier'><span class='textsf'><i >alignment-specifier</i></span></span></a> is an <a href='dcl.attr.grammar#nt:attribute-specifier' title='9.12.1&emsp;Attribute syntax and semantics&emsp;[dcl.attr.grammar]'><span id='ntref:attribute-specifier'><span class='textsf'><i >attribute-specifier</i></span></span></a><a class='hidden_link' href='#13.sentence-1'>.</a></div> <div id='13.sentence-2' class='sentence'>In C, an <a href='dcl.attr.grammar#nt:alignment-specifier' title='9.12.1&emsp;Attribute syntax and semantics&emsp;[dcl.attr.grammar]'><span id='ntref:alignment-specifier_'><span class='textsf'><i >alignment-specifier</i></span></span></a> is a <span class='textsf'><i >declaration-specifier</i></span><a class='hidden_link' href='#13.sentence-2'>.</a></div></div><div class='texpara'><div id='example-11' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-11'>11</a></i>:&ensp;<span class='codeblock'><span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>stdalign<span class='operator'>.</span>h<span class='anglebracket'>&gt;</span>
<span class='keyword'>unsigned</span> <span class='keyword'>alignas</span><span class='parenthesis'>(</span><span class='literal'>8</span><span class='parenthesis'>)</span> <span class='keyword'>int</span> x;      <span class='comment'>// valid C, invalid C++</span>
<span class='keyword'>unsigned</span> <span class='keyword'>int</span> y <span class='keyword'>alignas</span><span class='parenthesis'>(</span><span class='literal'>8</span><span class='parenthesis'>)</span>;      <span class='comment'>// valid C++, invalid C</span>
</span> —&nbsp;<i>end example</i>]</div></div></div><div class='texpara'><br/> <div id='13.sentence-3' class='sentence'><b>Rationale:</b> C++ requires unambiguous placement of the <a href='dcl.attr.grammar#nt:alignment-specifier' title='9.12.1&emsp;Attribute syntax and semantics&emsp;[dcl.attr.grammar]'><span id='ntref:alignment-specifier__'><span class='textsf'><i >alignment-specifier</i></span></span></a><a class='hidden_link' href='#13.sentence-3'>.</a></div> <br/> <div id='13.sentence-4' class='sentence'><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#13.sentence-4'>.</a></div> <br/> <div id='13.sentence-5' class='sentence'><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#13.sentence-5'>.</a></div> <br/> <div id='13.sentence-6' class='sentence'><b>How widely used:</b> Seldom<a class='hidden_link' href='#13.sentence-6'>.</a></div></div></div></div></body></html>