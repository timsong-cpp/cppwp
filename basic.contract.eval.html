<!DOCTYPE html><html lang='en'><head><title>[basic.contract.eval]</title><meta charset='UTF-8'><link rel='stylesheet' type='text/css' href='14882.css'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Serif'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans'><link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css2?family=Noto+Sans+Mono'><link rel='icon' href='icon.png'><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>6.10</a> Contract assertions <a class='abbr_ref' href='basic.contract#eval'>[basic.contract]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>6.10.2</a> Evaluation <a class='abbr_ref'>[basic.contract.eval]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7300'>#</a></div><div class='texpara'><div id='1.sentence-1' class='sentence'><a class='index' id='def:evaluation_semantics|seecontract_evaluation_semantics'></a><a class='index' id='def:checking_semantics|seecontract_evaluation_semanticschecking'></a><a class='index' id='def:terminating_semantics|seecontract_evaluation_semanticsterminating'></a>An evaluation of a contract assertion
uses one of the following four <a class='hidden_link' href='#def:evaluation_semantics' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:evaluation_semantics'><i >evaluation semantics</i></span></a>:
<a class='hidden_link' href='#def:contract_evaluation_semantics,ignore' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:contract_evaluation_semantics,ignore'><i >ignore</i></span></a>,
<a class='hidden_link' href='#def:contract_evaluation_semantics,observe' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:contract_evaluation_semantics,observe'><i >observe</i></span></a>,
<a class='hidden_link' href='#def:contract_evaluation_semantics,enforce' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:contract_evaluation_semantics,enforce'><i >enforce</i></span></a>, or
<a class='hidden_link' href='#def:contract_evaluation_semantics,quick-enforce' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:contract_evaluation_semantics,quick-enforce'><i >quick-enforce</i></span></a><a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>Observe, enforce, and quick-enforce are <a class='hidden_link' href='#def:contract_evaluation_semantics,checking' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:contract_evaluation_semantics,checking'><i >checking semantics</i></span></a>;
enforce and quick-enforce are <a class='hidden_link' href='#def:contract_evaluation_semantics,terminating' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:contract_evaluation_semantics,terminating'><i >terminating semantics</i></span></a><a class='hidden_link' href='#1.sentence-2'>.</a></div></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7313'>#</a></div><div class='texpara'><div id='2.sentence-1' class='sentence'>It is
<a class='index' id=':evaluation_semantic_used_for_the_evaluation_of_a_contract_assertion'></a>implementation-defined
which evaluation semantic is used
for any given evaluation of a contract assertion<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-1'>1</a></i>:&ensp;<div id='2.sentence-2' class='sentence'>The range and flexibility of available choices of
evaluation semantics depends on the implementation
and need not allow all four evaluation semantics as possibilities<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>The evaluation semantics can differ
for different evaluations of the same contract assertion,
including evaluations during constant evaluation<a class='hidden_link' href='#2.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7327'>#</a></div><div class='texpara'><div id='3.sentence-1' class='sentence'><i >Recommended practice</i>: An implementation should provide
the option to translate a program
such that all evaluations of contract assertions use the ignore semantic
as well as
the option to translate a program
such that all evaluations of contract assertions use the enforce semantic<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>By default,
evaluations of contract assertions should use the enforce semantic<a class='hidden_link' href='#3.sentence-2'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7338'>#</a></div><div class='texpara'><div id='4.sentence-1' class='sentence'>The evaluation of a contract assertion using the ignore semantic has no effect<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-2'>2</a></i>:&ensp;<div id='4.sentence-2' class='sentence'>The predicate is potentially evaluated (<a href='basic.def.odr' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>),
but not evaluated<a class='hidden_link' href='#4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7345'>#</a></div><div class='texpara'><div id='5.sentence-1' class='sentence'>The evaluation <span class='math'><span class='mathalpha'>A</span></span> of a contract assertion
using a checking semantic
determines the value of the predicate<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'>It is unspecified
whether the predicate is evaluated<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>Let <span class='math'><span class='mathalpha'>B</span></span> be the value that would result from evaluating the predicate<a class='hidden_link' href='#5.sentence-3'>.</a></div> <div id='note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-3'>3</a></i>:&ensp;<div id='5.sentence-4' class='sentence'>To determine whether a predicate would evaluate
to <span id=':true'><span class='texttt'><span class='literal'>true</span></span></span> or <span id=':false'><span class='texttt'><span class='literal'>false</span></span></span>,
an alternative evaluation
that produces the same value as the predicate
but has no side effects
can occur<a class='hidden_link' href='#5.sentence-4'>.</a></div> <div id='example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-1'>1</a></i>:&ensp;<span class='codeblock'><span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>mutable</span> <span class='keyword'>int</span> g <span class='operator'>=</span> <span class='literal'>5</span>;
<span class='curlybracket'>}</span> s;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>
  pre<span class='parenthesis'>(</span><span class='parenthesis'>(</span> s<span class='operator'>.</span>g<span class='operator'>+</span><span class='operator'>+</span>, <span class='literal'>false</span> <span class='parenthesis'>)</span><span class='parenthesis'>)</span>;    <span class='comment'>// #1</span>
<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>
<span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;  <span class='comment'>// Increment of <span class='tcode_in_codeblock'>s.g</span> might not occur, even if #1 uses a checking semantic.</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7374'>#</a></div><div class='texpara'><div id='6.sentence-1' class='sentence'>There is an observable checkpoint (<a href='intro.abstract' title='4.1.2&emsp;Abstract machine'>[intro.<span class='shy'></span>abstract]</a>) <span class='math'><span class='mathalpha'>C</span></span>
that happens before <span class='math'><span class='mathalpha'>A</span></span>
such that any other operation <span class='math'><span class='mathalpha'>O</span></span>
that happens before <span class='math'><span class='mathalpha'>A</span></span>
also happens before <span class='math'><span class='mathalpha'>C</span></span><a class='hidden_link' href='#6.sentence-1'>.</a></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7381'>#</a></div><div class='texpara'><div id='7.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:contract_violation' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:contract_violation'><i >contract violation</i></span></a> occurs when
<ul class='itemize'><li id='7.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.1'>(7.1)</a></div><span class='math'><span class='mathalpha'>B</span></span> is <span id=':false_'><span class='texttt'><span class='literal'>false</span></span></span>,</li><li id='7.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.2'>(7.2)</a></div>the evaluation of the predicate
exits via an exception, or</li><li id='7.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#7.3'>(7.3)</a></div>the evaluation of the predicate
is performed in a context that is
manifestly constant-evaluated (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>)
and the predicate
is not a core constant expression<a class='hidden_link' href='#7.sentence-1'>.</a></li></ul></div></div><div class='texpara'><div id='note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-4'>4</a></i>:&ensp;<div id='7.sentence-2' class='sentence'>If <span class='math'><span class='mathalpha'>B</span></span> is <span id=':true_'><span class='texttt'><span class='literal'>true</span></span></span>,
no contract violation occurs and
control flow continues normally
after the point of evaluation of the contract assertion<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>The evaluation of the predicate
can fail to produce a value
without causing a contract violation,
for example,
by calling <span class='texttt'>longjmp</span> (<a href='csetjmp.syn' title='17.14.3&emsp;Header &lt;csetjmp&gt; synopsis'>[csetjmp.<span class='shy'></span>syn]</a>)
or terminating the program<a class='hidden_link' href='#7.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7410'>#</a></div><div class='texpara'><div id='8.sentence-1' class='sentence'><a class='index' id='def:contract_evaluation_semantics,terminating_'></a>If a contract violation occurs
in a context that is manifestly constant-evaluated (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>),
and the evaluation semantic is
a terminating semantic,
the program is ill-formed<a class='hidden_link' href='#8.sentence-1'>.</a></div></div><div class='texpara'><div id='note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-5'>5</a></i>:&ensp;<div id='8.sentence-2' class='sentence'>A diagnostic is produced
if the evaluation semantic is observe (<a href='intro.compliance' title='4.1&emsp;Implementation compliance'>[intro.<span class='shy'></span>compliance]</a>)<a class='hidden_link' href='#8.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><div id='note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-6'>6</a></i>:&ensp;<div id='8.sentence-3' class='sentence'>Different evaluation semantics
chosen for the same contract assertion
in different translation units
can result in
violations of the one-definition rule (<a href='basic.def.odr' title='6.3&emsp;One-definition rule'>[basic.<span class='shy'></span>def.<span class='shy'></span>odr]</a>)
when a contract assertion has side effects
that alter the value produced by a constant expression<a class='hidden_link' href='#8.sentence-3'>.</a></div> <div id='example-2' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-2'>2</a></i>:&ensp;<span class='codeblock'><span class='keyword'>constexpr</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span>
<span class='curlybracket'>{</span>
  <span class='keyword'>contract_assert</span><span class='parenthesis'>(</span><span class='parenthesis'>(</span><span class='operator'>+</span><span class='operator'>+</span><span class='keyword'>const_cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>i<span class='parenthesis'>)</span>, <span class='literal'>true</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
  <span class='keyword'>return</span> i;
<span class='curlybracket'>}</span>
<span class='keyword'>inline</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>
<span class='curlybracket'>{</span>
  <span class='keyword'>int</span> a<span class='squarebracket'>[</span>f<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;  <span class='comment'>// size dependent on the evaluation semantic of <span class='tcode_in_codeblock'>contract_<span class='shy'></span>assert</span> above</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7446'>#</a></div><div class='texpara'><div id='9.sentence-1' class='sentence'>When the program is <a class='hidden_link' href='#def:contract-terminated' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:contract-terminated'><i >contract-terminated</i></span></a>,
it is
<a class='index' id=':method_by_which_contract_termination_occurs'></a>implementation-defined
(depending on context) whether
<ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.1'>(9.1)</a></div><span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> is called,</li><li id='9.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.2'>(9.2)</a></div><span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>abort</span> is called, or</li><li id='9.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#9.3'>(9.3)</a></div>execution is terminated<a class='hidden_link' href='#9.sentence-1'>.</a> <div class='texpara'><div id='note-7' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-7'>7</a></i>:&ensp;<div id='9.3.sentence-2' class='sentence'>No further execution steps occur (<a href='intro.progress' title='6.9.2.3&emsp;Forward progress'>[intro.<span class='shy'></span>progress]</a>)<a class='hidden_link' href='#9.3.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li></ul></div></div><div class='texpara'><div id='note-8' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-8'>8</a></i>:&ensp;<div id='9.sentence-2' class='sentence'>Performing the actions of
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>abort</span>
without actually making a library call
is a conforming implementation of
contract-termination (<a href='intro.abstract' title='4.1.2&emsp;Abstract machine'>[intro.<span class='shy'></span>abstract]</a>)<a class='hidden_link' href='#9.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7472'>#</a></div><div class='texpara'><div id='10.sentence-1' class='sentence'><a class='index' id=':contract_evaluation_semantics,enforce'></a><a class='index' id=':contract_evaluation_semantics,quick-enforce'></a>If a contract violation occurs
in a context that is not manifestly constant-evaluated
and the evaluation semantic is quick-enforce,
the program is contract-terminated<a class='hidden_link' href='#10.sentence-1'>.</a></div></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7480'>#</a></div><div class='texpara'><div id='11.sentence-1' class='sentence'><a class='index' id=':contract_violation'></a><a class='index' id=':contract_evaluation_semantics,enforce_'></a><a class='index' id=':contract_evaluation_semantics,observe'></a><a class='index' id='lib:contract_violation'></a>If a contract violation occurs
in a context that is not manifestly constant-evaluated
and the evaluation semantic is enforce or observe,
the contract-violation handler (<a href='basic.contract.handler' title='6.10.3&emsp;Contract-violation handler'>[basic.<span class='shy'></span>contract.<span class='shy'></span>handler]</a>)
is invoked with an lvalue referring to
an object <span class='texttt'>v</span>
of type <span class='texttt'><span class='keyword'>const</span> std<span class='operator'>&#x200b;::&#x200b;</span>contracts<span class='operator'>&#x200b;::&#x200b;</span>contract_<span class='shy'></span>violation</span> (<a href='support.contract.violation' title='17.10.3&emsp;Class contract_&shy;violation'>[support.<span class='shy'></span>contract.<span class='shy'></span>violation]</a>)
containing information about the contract violation<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='11.sentence-2' class='sentence'>Storage for <span class='texttt'>v</span>
is allocated in an unspecified manner
except as noted in <a href='basic.stc.dynamic.allocation' title='6.7.6.5.2&emsp;Allocation functions'>[basic.<span class='shy'></span>stc.<span class='shy'></span>dynamic.<span class='shy'></span>allocation]</a><a class='hidden_link' href='#11.sentence-2'>.</a></div> <div id='11.sentence-3' class='sentence'>The lifetime of <span class='texttt'>v</span>
persists for the duration
of the invocation of the contract-violation handler<a class='hidden_link' href='#11.sentence-3'>.</a></div></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7500'>#</a></div><div class='texpara'><div id='12.sentence-1' class='sentence'>If the contract violation occurred
because the evaluation of the predicate
exited via an exception,
the contract-violation handler is invoked
from within an active implicit handler
for that exception (<a href='except.handle' title='14.4&emsp;Handling an exception'>[except.<span class='shy'></span>handle]</a>)<a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.sentence-2' class='sentence'>If the contract-violation handler
returns normally
and the evaluation semantic is observe,
that implicit handler
is no longer considered active<a class='hidden_link' href='#12.sentence-2'>.</a></div></div><div class='texpara'><div id='note-9' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-9'>9</a></i>:&ensp;<div id='12.sentence-3' class='sentence'>The exception can be inspected or rethrown within the contract-violation handler<a class='hidden_link' href='#12.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7517'>#</a></div><div class='texpara'><div id='13.sentence-1' class='sentence'><a class='index' id=':contract_evaluation_semantics,enforce__'></a>If the contract-violation handler
returns normally
and the evaluation semantic is enforce,
the program is contract-terminated;
if violation occurred
as the result of an uncaught exception
from the evaluation of the predicate,
the implicit handler
remains active when contract termination occurs<a class='hidden_link' href='#13.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7529'>#</a></div><div class='texpara'><a class='index' id=':contract_evaluation_semantics,observe_'></a><div id='note-10' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-10'>10</a></i>:&ensp;<div id='14.sentence-1' class='sentence'>If the contract-violation handler
returns normally
and the evaluation semantic is observe,
control flow continues normally
after the point of evaluation of the contract assertion<a class='hidden_link' href='#14.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7539'>#</a></div><div class='texpara'><div id='15.sentence-1' class='sentence'>There is an observable checkpoint (<a href='intro.abstract' title='4.1.2&emsp;Abstract machine'>[intro.<span class='shy'></span>abstract]</a>) <span class='math'><span class='mathalpha'>C</span></span>
that happens after the contract-violation handler returns normally
such that any other operation <span class='math'><span class='mathalpha'>O</span></span>
that happens after the contract-violation handler returns
also happens after <span class='math'><span class='mathalpha'>C</span></span><a class='hidden_link' href='#15.sentence-1'>.</a></div></div></div><div class='para nonNormativeOnly' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7546'>#</a></div><div class='texpara'><div id='note-11' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-11'>11</a></i>:&ensp;<div id='16.sentence-1' class='sentence'>The terminating semantics terminate the program
if execution would otherwise continue normally
past a contract violation:
the enforce semantic provides the opportunity to
log information about the contract violation
before terminating the program
or to throw an exception to avoid termination,
and the quick-enforce semantic is intended
to terminate the program as soon as possible
as well as
to minimize the impact of contract checks
on the generated code size<a class='hidden_link' href='#16.sentence-1'>.</a></div> <div id='16.sentence-2' class='sentence'>Conversely,
the observe semantic
provides the opportunity to
log information about the contract violation
without having to terminate the program<a class='hidden_link' href='#16.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7567'>#</a></div><div class='texpara'><div id='17.sentence-1' class='sentence'>If a contract-violation handler
invoked from the evaluation of a function contract assertion (<a href='dcl.contract.func' title='9.4.1&emsp;General'>[dcl.<span class='shy'></span>contract.<span class='shy'></span>func]</a>)
exits via an exception,
the behavior is as if
the function body exits via that same exception<a class='hidden_link' href='#17.sentence-1'>.</a></div> <div id='note-12' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-12'>12</a></i>:&ensp;<div id='17.sentence-2' class='sentence'>A <a href='except.pre#nt:function-try-block' title='14.1&emsp;Preamble&emsp;[except.pre]'><span id='ntref:function-try-block'><span class='textsf'><i >function-try-block</i></span></span></a> (<a href='except.pre' title='14.1&emsp;Preamble'>[except.<span class='shy'></span>pre]</a>)
is the function body when present
and thus does not
have an opportunity to catch the exception<a class='hidden_link' href='#17.sentence-2'>.</a></div> <div id='17.sentence-3' class='sentence'>If the function
has a non-throwing exception specification,
the function <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>terminate</span> is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#17.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><div id='note-13' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#note-13'>13</a></i>:&ensp;<div id='17.sentence-4' class='sentence'>If a contract-violation handler
invoked from an <a href='stmt.contract.assert#nt:assertion-statement' title='8.8&emsp;Assertion statement&emsp;[stmt.contract.assert]'><span id='ntref:assertion-statement'><span class='textsf'><i >assertion-statement</i></span></span></a> (<a href='stmt.contract.assert' title='8.8&emsp;Assertion statement'>[stmt.<span class='shy'></span>contract.<span class='shy'></span>assert]</a>))
exits via an exception,
the search for a handler
continues from the execution of that statement<a class='hidden_link' href='#17.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7591'>#</a></div><div class='texpara'><div id='18.sentence-1' class='sentence'>To <a class='hidden_link' href='#def:evaluate_in_sequence' title='6.10.2&emsp;Evaluation&emsp;[basic.contract.eval]'><span id='def:evaluate_in_sequence'><i >evaluate in sequence</i></span></a> a list <span class='math'><span class='mathalpha'>R</span></span> of contract assertions:
<ul class='itemize'><li id='18.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#18.1'>(18.1)</a></div><div class='texpara'><div id='18.1.sentence-1' class='sentence'>Construct a list of contract assertions <span class='math'><span class='mathalpha'>S</span></span> such that
<ul class='itemize'><li id='18.1.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#18.1.1'>(18.1.1)</a></div>all elements of <span class='math'><span class='mathalpha'>R</span></span> are in <span class='math'><span class='mathalpha'>S</span></span>,</li><li id='18.1.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#18.1.2'>(18.1.2)</a></div>each element of <span class='math'><span class='mathalpha'>R</span></span>
may be repeated an
<a class='index' id=':maximum_number_of_repeated_evaluations_of_a_contract_assertion'></a>implementation-defined
number of times
within <span class='math'><span class='mathalpha'>S</span></span>, and</li><li id='18.1.3'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#18.1.3'>(18.1.3)</a></div>if a contract assertion <span class='math'><span class='mathalpha'>A</span></span>
precedes another contract assertion <span class='math'><span class='mathalpha'>B</span></span>
in <span class='math'><span class='mathalpha'>R</span></span>,
then the
first occurrence of <span class='math'><span class='mathalpha'>A</span></span>
precedes the first occurrence of <span class='math'><span class='mathalpha'>B</span></span>
in <span class='math'><span class='mathalpha'>S</span></span><a class='hidden_link' href='#18.1.sentence-1'>.</a></li></ul></div></div></li><li id='18.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#18.2'>(18.2)</a></div><div class='texpara'><div id='18.2.sentence-1' class='sentence'>Evaluate each element of <span class='math'><span class='mathalpha'>S</span></span> such that,
if a contract assertion <span class='math'><span class='mathalpha'>A</span></span>
precedes a contract assertion <span class='math'><span class='mathalpha'>B</span></span>
in <span class='math'><span class='mathalpha'>S</span></span>,
then the evaluation of <span class='math'><span class='mathalpha'>A</span></span>
is sequenced before
the evaluation of <span class='math'><span class='mathalpha'>B</span></span><a class='hidden_link' href='#18.2.sentence-1'>.</a></div></div></li></ul></div></div><div class='texpara'><div id='example-3' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#example-3'>3</a></i>:&ensp;<span class='codeblock'><span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span> i<span class='parenthesis'>)</span>
<span class='curlybracket'>{</span>
  <span class='keyword'>contract_assert</span><span class='parenthesis'>(</span>i <span class='anglebracket'>&gt;</span> <span class='literal'>0</span><span class='parenthesis'>)</span>;   <span class='comment'>// #1</span>
  <span class='keyword'>contract_assert</span><span class='parenthesis'>(</span>i <span class='anglebracket'>&lt;</span> <span class='literal'>10</span><span class='parenthesis'>)</span>;  <span class='comment'>// #2</span>
    <span class='comment'>// valid sequence of evaluations: #1 #2</span>
    <span class='comment'>// valid sequence of evaluations: #1 #1 #2 #2</span>
    <span class='comment'>// valid sequence of evaluations: #1 #2 #1 #2</span>
    <span class='comment'>// valid sequence of evaluations: #1 #2 #2 #1</span>
    <span class='comment'>// invalid sequence of evaluations: #2 #1</span>
<span class='curlybracket'>}</span>
</span> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/9b8a5e51752efe9edd7a447e96ffab0f3313accc/source/basic.tex#L7639'>#</a></div><div class='texpara'><div id='19.sentence-1' class='sentence'><i >Recommended practice</i>: An implementation should
provide an option to perform
a specified number of repeated evaluations
for contract assertions<a class='hidden_link' href='#19.sentence-1'>.</a></div> <div id='19.sentence-2' class='sentence'>By default,
no repeated evaluations should be performed<a class='hidden_link' href='#19.sentence-2'>.</a></div></div></div></div></body></html>